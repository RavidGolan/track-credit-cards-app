/*! For license information please see main.ab618417.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,r)=>{var n=r(853),i=r(43),s=r(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(o(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope");var k=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var P=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var A=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=A&&e[A]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function I(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case m:return"Fragment";case C:return"Profiler";case v:return"StrictMode";case E:return"Suspense";case R:return"SuspenseList";case k:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case f:return"Portal";case y:return(e.displayName||"Context")+".Provider";case b:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:I(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return I(e(t))}catch(r){}}return null}var M=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N={pending:!1,data:null,method:null,action:null},_=[],G=-1;function B(e){return{current:e}}function H(e){0>G||(e.current=_[G],_[G]=null,G--)}function z(e,t){G++,_[G]=e.current,e.current=t}var V=B(null),W=B(null),U=B(null),j=B(null);function $(e,t){switch(z(U,t),z(W,e),z(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?id(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=sd(t=id(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(V),z(V,e)}function K(){H(V),H(W),H(U)}function Y(e){null!==e.memoizedState&&z(j,e);var t=V.current,r=sd(t,e.type);t!==r&&(z(W,e),z(V,r))}function q(e){W.current===e&&(H(V),H(W)),j.current===e&&(H(j),Yd._currentValue=N)}var X=Object.prototype.hasOwnProperty,J=n.unstable_scheduleCallback,Q=n.unstable_cancelCallback,Z=n.unstable_shouldYield,ee=n.unstable_requestPaint,te=n.unstable_now,re=n.unstable_getCurrentPriorityLevel,ne=n.unstable_ImmediatePriority,ie=n.unstable_UserBlockingPriority,se=n.unstable_NormalPriority,oe=n.unstable_LowPriority,ae=n.unstable_IdlePriority,le=n.log,ce=n.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var pe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ge(e)/fe|0)|0},ge=Math.log,fe=Math.LN2;var me=256,ve=4194304;function Ce(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function we(e,t,r){var n=e.pendingLanes;if(0===n)return 0;var i=0,s=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var a=134217727&n;return 0!==a?0!==(n=a&~s)?i=Ce(n):0!==(o&=a)?i=Ce(o):r||0!==(r=a&~e)&&(i=Ce(r)):0!==(a=n&~s)?i=Ce(a):0!==o?i=Ce(o):r||0!==(r=n&~e)&&(i=Ce(r)),0===i?0:0!==t&&t!==i&&0===(t&s)&&((s=i&-i)>=(r=t&-t)||32===s&&0!==(4194048&r))?t:i}function be(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ye(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=me;return 0===(4194048&(me<<=1))&&(me=256),e}function Ee(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Re(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Te(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function xe(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-pe(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|4194090&r}function ke(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-pe(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}function Pe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ae(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var De=Math.random().toString(36).slice(2),Ie="__reactFiber$"+De,Me="__reactProps$"+De,Oe="__reactContainer$"+De,Le="__reactEvents$"+De,Ne="__reactListeners$"+De,_e="__reactHandles$"+De,Ge="__reactResources$"+De,Be="__reactMarker$"+De;function He(e){delete e[Ie],delete e[Me],delete e[Le],delete e[Ne],delete e[_e]}function ze(e){var t=e[Ie];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Oe]||r[Ie]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=wd(e);null!==e;){if(r=e[Ie])return r;e=wd(e)}return t}r=(e=r).parentNode}return null}function Ve(e){if(e=e[Ie]||e[Oe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function We(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function Ue(e){var t=e[Ge];return t||(t=e[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function je(e){e[Be]=!0}var $e=new Set,Ke={};function Ye(e,t){qe(e,t),qe(e+"Capture",t)}function qe(e,t){for(Ke[e]=t,e=0;e<t.length;e++)$e.add(t[e])}var Xe,Je,Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,r){if(i=t,X.call(et,i)||!X.call(Ze,i)&&(Qe.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var i}function rt(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function nt(e,t,r,n){if(null===n)e.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+n)}}function it(e){if(void 0===Xe)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",Je=-1<r.stack.indexOf("\n    at")?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Xe+e+Je}var st=!1;function ot(e,t){if(!e||st)return"";st=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(i){var n=i}Reflect.construct(e,[],r)}else{try{r.call()}catch(s){n=s}e.call(r.prototype)}}else{try{throw Error()}catch(o){n=o}(r=e())&&"function"===typeof r.catch&&r.catch((function(){}))}}catch(a){if(a&&n&&"string"===typeof a.stack)return[a.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=n.DetermineComponentFrameRoot(),o=s[0],a=s[1];if(o&&a){var l=o.split("\n"),c=a.split("\n");for(i=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(n===l.length||i===c.length)for(n=l.length-1,i=c.length-1;1<=n&&0<=i&&l[n]!==c[i];)i--;for(;1<=n&&0<=i;n--,i--)if(l[n]!==c[i]){if(1!==n||1!==i)do{if(n--,0>--i||l[n]!==c[i]){var u="\n"+l[n].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=n&&0<=i);break}}}finally{st=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?it(r):""}function at(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return ot(e.type,!1);case 11:return ot(e.type.render,!1);case 1:return ot(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=at(e),e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ut(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function ft(e){return e.replace(gt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function mt(e,t,r,n,i,s,o,a){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?Ct(e,o,ct(t)):null!=r?Ct(e,o,ct(r)):null!=n&&e.removeAttribute("value"),null==i&&null!=s&&(e.defaultChecked=!!s),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function vt(e,t,r,n,i,s,o,a){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=r){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;r=null!=r?""+ct(r):"",t=null!=t?""+ct(t):r,a||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:i)&&"symbol"!==typeof n&&!!n,e.checked=a?e.checked:!!n,e.defaultChecked=!!n,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function Ct(e,t,r){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function wt(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ct(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function bt(e,t,r){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ct(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function yt(e,t,r,n){if(null==t){if(null!=n){if(null!=r)throw Error(o(92));if(M(n)){if(1<n.length)throw Error(o(93));n=n[0]}r=n}null==r&&(r=""),t=r}r=ct(t),e.defaultValue=r,(n=e.textContent)===r&&""!==n&&null!==n&&(e.value=n)}function St(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rt(e,t,r){var n=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,r):"number"!==typeof r||0===r||Et.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Tt(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=r){for(var n in r)!r.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var i in t)n=t[i],t.hasOwnProperty(i)&&r[i]!==n&&Rt(e,i,n)}else for(var s in t)t.hasOwnProperty(s)&&Rt(e,s,t[s])}function xt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Ft=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var It=null,Mt=null;function Ot(e){var t=Ve(e);if(t&&(e=t.stateNode)){var r=e[Me]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+ft(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=n[Me]||null;if(!i)throw Error(o(90));mt(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<r.length;t++)(n=r[t]).form===e.form&&ht(n)}break e;case"textarea":bt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&wt(e,!!r.multiple,t,!1)}}}var Lt=!1;function Nt(e,t,r){if(Lt)return e(t,r);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==It||null!==Mt)&&(zc(),It&&(t=It,e=Mt,Mt=It=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function _t(e,t){var r=e.stateNode;if(null===r)return null;var n=r[Me]||null;if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var Gt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Bt=!1;if(Gt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Mh){Bt=!1}var zt=null,Vt=null,Wt=null;function Ut(){if(Wt)return Wt;var e,t,r=Vt,n=r.length,i="value"in zt?zt.value:zt.textContent,s=i.length;for(e=0;e<n&&r[e]===i[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===i[s-t];t++);return Wt=i.slice(e,1<t?1-t:void 0)}function jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function $t(){return!0}function Kt(){return!1}function Yt(e){function t(t,r,n,i,s){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?$t:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),t}var qt,Xt,Jt,Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Yt(Qt),er=h({},Qt,{view:0,detail:0}),tr=Yt(er),rr=h({},er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jt&&(Jt&&"mousemove"===e.type?(qt=e.screenX-Jt.screenX,Xt=e.screenY-Jt.screenY):Xt=qt=0,Jt=e),qt)},movementY:function(e){return"movementY"in e?e.movementY:Xt}}),nr=Yt(rr),ir=Yt(h({},rr,{dataTransfer:0})),sr=Yt(h({},er,{relatedTarget:0})),or=Yt(h({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0})),ar=Yt(h({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),lr=Yt(h({},Qt,{data:0})),cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ur={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=dr[e])&&!!t[e]}function pr(){return hr}var gr=Yt(h({},er,{key:function(e){if(e.key){var t=cr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ur[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pr,charCode:function(e){return"keypress"===e.type?jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),fr=Yt(h({},rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mr=Yt(h({},er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pr})),vr=Yt(h({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cr=Yt(h({},rr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wr=Yt(h({},Qt,{newState:0,oldState:0})),br=[9,13,27,32],yr=Gt&&"CompositionEvent"in window,Sr=null;Gt&&"documentMode"in document&&(Sr=document.documentMode);var Er=Gt&&"TextEvent"in window&&!Sr,Rr=Gt&&(!yr||Sr&&8<Sr&&11>=Sr),Tr=String.fromCharCode(32),xr=!1;function kr(e,t){switch(e){case"keyup":return-1!==br.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ar=!1;var Fr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Fr[e.type]:"textarea"===t}function Ir(e,t,r,n){It?Mt?Mt.push(n):Mt=[n]:It=n,0<(t=Uu(t,"onChange")).length&&(r=new Zt("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Mr=null,Or=null;function Lr(e){Nu(e,0)}function Nr(e){if(ht(We(e)))return e}function _r(e,t){if("change"===e)return t}var Gr=!1;if(Gt){var Br;if(Gt){var Hr="oninput"in document;if(!Hr){var zr=document.createElement("div");zr.setAttribute("oninput","return;"),Hr="function"===typeof zr.oninput}Br=Hr}else Br=!1;Gr=Br&&(!document.documentMode||9<document.documentMode)}function Vr(){Mr&&(Mr.detachEvent("onpropertychange",Wr),Or=Mr=null)}function Wr(e){if("value"===e.propertyName&&Nr(Or)){var t=[];Ir(t,Or,e,Dt(e)),Nt(Lr,t)}}function Ur(e,t,r){"focusin"===e?(Vr(),Or=r,(Mr=t).attachEvent("onpropertychange",Wr)):"focusout"===e&&Vr()}function jr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Nr(Or)}function $r(e,t){if("click"===e)return Nr(t)}function Kr(e,t){if("input"===e||"change"===e)return Nr(t)}var Yr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function qr(e,t){if(Yr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!X.call(t,i)||!Yr(e[i],t[i]))return!1}return!0}function Xr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jr(e,t){var r,n=Xr(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Xr(n)}}function Qr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Qr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Zr(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=pt((e=t.contentWindow).document)}return t}function en(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var tn=Gt&&"documentMode"in document&&11>=document.documentMode,rn=null,nn=null,sn=null,on=!1;function an(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;on||null==rn||rn!==pt(n)||("selectionStart"in(n=rn)&&en(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},sn&&qr(sn,n)||(sn=n,0<(n=Uu(nn,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=rn)))}function ln(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var cn={animationend:ln("Animation","AnimationEnd"),animationiteration:ln("Animation","AnimationIteration"),animationstart:ln("Animation","AnimationStart"),transitionrun:ln("Transition","TransitionRun"),transitionstart:ln("Transition","TransitionStart"),transitioncancel:ln("Transition","TransitionCancel"),transitionend:ln("Transition","TransitionEnd")},un={},dn={};function hn(e){if(un[e])return un[e];if(!cn[e])return e;var t,r=cn[e];for(t in r)if(r.hasOwnProperty(t)&&t in dn)return un[e]=r[t];return e}Gt&&(dn=document.createElement("div").style,"AnimationEvent"in window||(delete cn.animationend.animation,delete cn.animationiteration.animation,delete cn.animationstart.animation),"TransitionEvent"in window||delete cn.transitionend.transition);var pn=hn("animationend"),gn=hn("animationiteration"),fn=hn("animationstart"),mn=hn("transitionrun"),vn=hn("transitionstart"),Cn=hn("transitioncancel"),wn=hn("transitionend"),bn=new Map,yn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sn(e,t){bn.set(e,t),Ye(t,[e])}yn.push("scrollEnd");var En=new WeakMap;function Rn(e,t){if("object"===typeof e&&null!==e){var r=En.get(e);return void 0!==r?r:(t={value:e,source:t,stack:lt(t)},En.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Tn=[],xn=0,kn=0;function Pn(){for(var e=xn,t=kn=xn=0;t<e;){var r=Tn[t];Tn[t++]=null;var n=Tn[t];Tn[t++]=null;var i=Tn[t];Tn[t++]=null;var s=Tn[t];if(Tn[t++]=null,null!==n&&null!==i){var o=n.pending;null===o?i.next=i:(i.next=o.next,o.next=i),n.pending=i}0!==s&&In(r,i,s)}}function An(e,t,r,n){Tn[xn++]=e,Tn[xn++]=t,Tn[xn++]=r,Tn[xn++]=n,kn|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Fn(e,t,r,n){return An(e,t,r,n),Mn(e)}function Dn(e,t){return An(e,null,null,t),Mn(e)}function In(e,t,r){e.lanes|=r;var n=e.alternate;null!==n&&(n.lanes|=r);for(var i=!1,s=e.return;null!==s;)s.childLanes|=r,null!==(n=s.alternate)&&(n.childLanes|=r),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(i=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,i&&null!==t&&(i=31-pe(r),null===(n=(e=s.hiddenUpdates)[i])?e[i]=[t]:n.push(t),t.lane=536870912|r),s):null}function Mn(e){if(50<Ic)throw Ic=0,Mc=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var On={};function Ln(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(e,t,r,n){return new Ln(e,t,r,n)}function _n(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Gn(e,t){var r=e.alternate;return null===r?((r=Nn(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Bn(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hn(e,t,r,n,i,s){var a=0;if(n=e,"function"===typeof e)_n(e)&&(a=1);else if("string"===typeof e)a=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case k:return(e=Nn(31,r,t,i)).elementType=k,e.lanes=s,e;case m:return zn(r.children,i,s,t);case v:a=8,i|=24;break;case C:return(e=Nn(12,r,t,2|i)).elementType=C,e.lanes=s,e;case E:return(e=Nn(13,r,t,i)).elementType=E,e.lanes=s,e;case R:return(e=Nn(19,r,t,i)).elementType=R,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:case y:a=10;break e;case b:a=9;break e;case S:a=11;break e;case T:a=14;break e;case x:a=16,n=null;break e}a=29,r=Error(o(130,null===e?"null":typeof e,"")),n=null}return(t=Nn(a,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function zn(e,t,r,n){return(e=Nn(7,e,n,t)).lanes=r,e}function Vn(e,t,r){return(e=Nn(6,e,null,t)).lanes=r,e}function Wn(e,t,r){return(t=Nn(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Un=[],jn=0,$n=null,Kn=0,Yn=[],qn=0,Xn=null,Jn=1,Qn="";function Zn(e,t){Un[jn++]=Kn,Un[jn++]=$n,$n=e,Kn=t}function ei(e,t,r){Yn[qn++]=Jn,Yn[qn++]=Qn,Yn[qn++]=Xn,Xn=e;var n=Jn;e=Qn;var i=32-pe(n)-1;n&=~(1<<i),r+=1;var s=32-pe(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Jn=1<<32-pe(t)+i|r<<i|n,Qn=s+e}else Jn=1<<s|r<<i|n,Qn=e}function ti(e){null!==e.return&&(Zn(e,1),ei(e,1,0))}function ri(e){for(;e===$n;)$n=Un[--jn],Un[jn]=null,Kn=Un[--jn],Un[jn]=null;for(;e===Xn;)Xn=Yn[--qn],Yn[qn]=null,Qn=Yn[--qn],Yn[qn]=null,Jn=Yn[--qn],Yn[qn]=null}var ni=null,ii=null,si=!1,oi=null,ai=!1,li=Error(o(519));function ci(e){throw fi(Rn(Error(o(418,"")),e)),li}function ui(e){var t=e.stateNode,r=e.type,n=e.memoizedProps;switch(t[Ie]=e,t[Me]=n,r){case"dialog":_u("cancel",t),_u("close",t);break;case"iframe":case"object":case"embed":_u("load",t);break;case"video":case"audio":for(r=0;r<Ou.length;r++)_u(Ou[r],t);break;case"source":_u("error",t);break;case"img":case"image":case"link":_u("error",t),_u("load",t);break;case"details":_u("toggle",t);break;case"input":_u("invalid",t),vt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),dt(t);break;case"select":_u("invalid",t);break;case"textarea":_u("invalid",t),yt(t,n.value,n.defaultValue,n.children),dt(t)}"string"!==typeof(r=n.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===n.suppressHydrationWarning||Xu(t.textContent,r)?(null!=n.popover&&(_u("beforetoggle",t),_u("toggle",t)),null!=n.onScroll&&_u("scroll",t),null!=n.onScrollEnd&&_u("scrollend",t),null!=n.onClick&&(t.onclick=Ju),t=!0):t=!1,t||ci(e)}function di(e){for(ni=e.return;ni;)switch(ni.tag){case 5:case 13:return void(ai=!1);case 27:case 3:return void(ai=!0);default:ni=ni.return}}function hi(e){if(e!==ni)return!1;if(!si)return di(e),si=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||od(e.type,e.memoizedProps)),t=!t),t&&ii&&ci(e),di(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,r=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===r){ii=vd(e.nextSibling);break e}r--}else"$"!==t&&"$!"!==t&&"$?"!==t||r++;e=e.nextSibling}ii=null}}else 27===r?(r=ii,pd(e.type)?(e=Cd,Cd=null,ii=e):ii=r):ii=ni?vd(e.stateNode.nextSibling):null;return!0}function pi(){ii=ni=null,si=!1}function gi(){var e=oi;return null!==e&&(null===wc?wc=e:wc.push.apply(wc,e),oi=null),e}function fi(e){null===oi?oi=[e]:oi.push(e)}var mi=B(null),vi=null,Ci=null;function wi(e,t,r){z(mi,t._currentValue),t._currentValue=r}function bi(e){e._currentValue=mi.current,H(mi)}function yi(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Si(e,t,r,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var a=i.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),yi(s.return,r,e),n||(a=null);break e}s=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(o(341));a.lanes|=r,null!==(s=a.alternate)&&(s.lanes|=r),yi(a,r,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function Ei(e,t,r,n){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(0!==(524288&i.flags))s=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(o(387));if(null!==(a=a.memoizedProps)){var l=i.type;Yr(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===j.current){if(null===(a=i.alternate))throw Error(o(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Yd):e=[Yd])}i=i.return}null!==e&&Si(t,e,r,n),t.flags|=262144}function Ri(e){for(e=e.firstContext;null!==e;){if(!Yr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ti(e){vi=e,Ci=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function xi(e){return Pi(vi,e)}function ki(e,t){return null===vi&&Ti(e),Pi(e,t)}function Pi(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===Ci){if(null===e)throw Error(o(308));Ci=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ci=Ci.next=t;return r}var Ai="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Fi=n.unstable_scheduleCallback,Di=n.unstable_NormalPriority,Ii={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Mi(){return{controller:new Ai,data:new Map,refCount:0}}function Oi(e){e.refCount--,0===e.refCount&&Fi(Di,(function(){e.controller.abort()}))}var Li=null,Ni=0,_i=0,Gi=null;function Bi(){if(0===--Ni&&null!==Li){null!==Gi&&(Gi.status="fulfilled");var e=Li;Li=null,_i=0,Gi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Hi=O.S;O.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Li){var r=Li=[];Ni=0,_i=Au(),Gi={status:"pending",value:void 0,then:function(e){r.push(e)}}}Ni++,t.then(Bi,Bi)}(0,t),null!==Hi&&Hi(e,t)};var zi=B(null);function Vi(){var e=zi.current;return null!==e?e:nc.pooledCache}function Wi(e,t){z(zi,null===t?zi.current:t.pool)}function Ui(){var e=Vi();return null===e?null:{parent:Ii._currentValue,pool:e}}var ji=Error(o(460)),$i=Error(o(474)),Ki=Error(o(542)),Yi={then:function(){}};function qi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Xi(){}function Ji(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Xi,Xi),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e;default:if("string"===typeof t.status)t.then(Xi,Xi);else{if(null!==(e=nc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}}),(function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e}throw Qi=t,ji}}var Qi=null;function Zi(){if(null===Qi)throw Error(o(459));var e=Qi;return Qi=null,e}function es(e){if(e===ji||e===Ki)throw Error(o(483))}var ts=!1;function rs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ns(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function is(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&rc)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,t=Mn(e),In(e,null,r),t}return An(e,n,t,r),Mn(e)}function os(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,ke(e,r)}}function as(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var o={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===s?i=s=o:s=s.next=o,r=r.next}while(null!==r);null===s?i=s=t:s=s.next=t}else i=s=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var ls=!1;function cs(){if(ls){if(null!==Gi)throw Gi}}function us(e,t,r,n){ls=!1;var i=e.updateQueue;ts=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(o=0,u=c=l=null,a=s;;){var p=-536870913&a.lane,g=p!==a.lane;if(g?(sc&p)===p:(n&p)===p){0!==p&&p===_i&&(ls=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var f=e,m=a;p=t;var v=r;switch(m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(v,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(v,d,p):f)||void 0===p)break e;d=h({},d,p);break e;case 2:ts=!0}}null!==(p=a.callback)&&(e.flags|=64,g&&(e.flags|=8192),null===(g=i.callbacks)?i.callbacks=[p]:g.push(p))}else g={lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=g,l=d):u=u.next=g,o|=p;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(g=a).next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===s&&(i.shared.lanes=0),pc|=o,e.lanes=o,e.memoizedState=d}}function ds(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function hs(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)ds(r[e],t)}var ps=B(null),gs=B(0);function fs(e,t){z(gs,e=dc),z(ps,t),dc=e|t.baseLanes}function ms(){z(gs,dc),z(ps,ps.current)}function vs(){dc=gs.current,H(ps),H(gs)}var Cs=0,ws=null,bs=null,ys=null,Ss=!1,Es=!1,Rs=!1,Ts=0,xs=0,ks=null,Ps=0;function As(){throw Error(o(321))}function Fs(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yr(e[r],t[r]))return!1;return!0}function Ds(e,t,r,n,i,s){return Cs=s,ws=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?$o:Ko,Rs=!1,s=r(n,i),Rs=!1,Es&&(s=Ms(t,r,n,i)),Is(e),s}function Is(e){O.H=jo;var t=null!==bs&&null!==bs.next;if(Cs=0,ys=bs=ws=null,Ss=!1,xs=0,ks=null,t)throw Error(o(300));null===e||ka||null!==(e=e.dependencies)&&Ri(e)&&(ka=!0)}function Ms(e,t,r,n){ws=e;var i=0;do{if(Es&&(ks=null),xs=0,Es=!1,25<=i)throw Error(o(301));if(i+=1,ys=bs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}O.H=Yo,s=t(r,n)}while(Es);return s}function Os(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?Hs(t):t,e=e.useState()[0],(null!==bs?bs.memoizedState:null)!==e&&(ws.flags|=1024),t}function Ls(){var e=0!==Ts;return Ts=0,e}function Ns(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function _s(e){if(Ss){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ss=!1}Cs=0,ys=bs=ws=null,Es=!1,xs=Ts=0,ks=null}function Gs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ys?ws.memoizedState=ys=e:ys=ys.next=e,ys}function Bs(){if(null===bs){var e=ws.alternate;e=null!==e?e.memoizedState:null}else e=bs.next;var t=null===ys?ws.memoizedState:ys.next;if(null!==t)ys=t,bs=e;else{if(null===e){if(null===ws.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(bs=e).memoizedState,baseState:bs.baseState,baseQueue:bs.baseQueue,queue:bs.queue,next:null},null===ys?ws.memoizedState=ys=e:ys=ys.next=e}return ys}function Hs(e){var t=xs;return xs+=1,null===ks&&(ks=[]),e=Ji(ks,e,t),t=ws,null===(null===ys?t.memoizedState:ys.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?$o:Ko),e}function zs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Hs(e);if(e.$$typeof===y)return xi(e)}throw Error(o(438,String(e)))}function Vs(e){var t=null,r=ws.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var n=ws.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),n=0;n<e;n++)r[n]=P;return t.index++,r}function Ws(e,t){return"function"===typeof t?t(e):t}function Us(e){return js(Bs(),bs,e)}function js(e,t,r){var n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=r;var i=e.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}t.baseQueue=i=s,n.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var l=a=null,c=null,u=t=i.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(sc&h)===h:(Cs&h)===h){var p=u.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===_i&&(d=!0);else{if((Cs&p)===p){u=u.next,p===_i&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=s):c=c.next=h,ws.lanes|=p,pc|=p}h=u.action,Rs&&r(s,h),s=u.hasEagerState?u.eagerState:r(s,h)}else p={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,a=s):c=c.next=p,ws.lanes|=h,pc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?a=s:c.next=l,!Yr(s,e.memoizedState)&&(ka=!0,d&&null!==(r=Gi)))throw r;e.memoizedState=s,e.baseState=a,e.baseQueue=c,n.lastRenderedState=s}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function $s(e){var t=Bs(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);Yr(s,t.memoizedState)||(ka=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ks(e,t,r){var n=ws,i=Bs(),s=si;if(s){if(void 0===r)throw Error(o(407));r=r()}else r=t();var a=!Yr((bs||i).memoizedState,r);if(a&&(i.memoizedState=r,ka=!0),i=i.queue,vo(2048,8,Xs.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||null!==ys&&1&ys.memoizedState.tag){if(n.flags|=2048,go(9,{destroy:void 0,resource:void 0},qs.bind(null,n,i,r,t),null),null===nc)throw Error(o(349));s||0!==(124&Cs)||Ys(n,t,r)}return r}function Ys(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ws.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function qs(e,t,r,n){t.value=r,t.getSnapshot=n,Js(t)&&Qs(e)}function Xs(e,t,r){return r((function(){Js(t)&&Qs(e)}))}function Js(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yr(e,r)}catch(n){return!0}}function Qs(e){var t=Dn(e,2);null!==t&&Nc(t,e,2)}function Zs(e){var t=Gs();if("function"===typeof e){var r=e;if(e=r(),Rs){he(!0);try{r()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:e},t}function eo(e,t,r,n){return e.baseState=r,js(e,bs,"function"===typeof n?n:Ws)}function to(e,t,r,n,i){if(Vo(e))throw Error(o(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==O.T?r(!0):s.isTransition=!1,n(s),null===(r=t.pending)?(s.next=t.pending=s,ro(t,s)):(s.next=r.next,t.pending=r.next=s)}}function ro(e,t){var r=t.action,n=t.payload,i=e.state;if(t.isTransition){var s=O.T,o={};O.T=o;try{var a=r(i,n),l=O.S;null!==l&&l(o,a),no(e,t,a)}catch(c){so(e,t,c)}finally{O.T=s}}else try{no(e,t,s=r(i,n))}catch(u){so(e,t,u)}}function no(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then((function(r){io(e,t,r)}),(function(r){return so(e,t,r)})):io(e,t,r)}function io(e,t,r){t.status="fulfilled",t.value=r,oo(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,ro(e,r)))}function so(e,t,r){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=r,oo(t),t=t.next}while(t!==n)}e.action=null}function oo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ao(e,t){return t}function lo(e,t){if(si){var r=nc.formState;if(null!==r){e:{var n=ws;if(si){if(ii){t:{for(var i=ii,s=ai;8!==i.nodeType;){if(!s){i=null;break t}if(null===(i=vd(i.nextSibling))){i=null;break t}}i="F!"===(s=i.data)||"F"===s?i:null}if(i){ii=vd(i.nextSibling),n="F!"===i.data;break e}}ci(n)}n=!1}n&&(t=r[0])}}return(r=Gs()).memoizedState=r.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:t},r.queue=n,r=Bo.bind(null,ws,n),n.dispatch=r,n=Zs(!1),s=zo.bind(null,ws,!1,n.queue),i={state:t,dispatch:null,action:e,pending:null},(n=Gs()).queue=i,r=to.bind(null,ws,i,s,r),i.dispatch=r,n.memoizedState=e,[t,r,!1]}function co(e){return uo(Bs(),bs,e)}function uo(e,t,r){if(t=js(e,t,ao)[0],e=Us(Ws)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var n=Hs(t)}catch(o){if(o===ji)throw Ki;throw o}else n=t;var i=(t=Bs()).queue,s=i.dispatch;return r!==t.memoizedState&&(ws.flags|=2048,go(9,{destroy:void 0,resource:void 0},ho.bind(null,i,r),null)),[n,s,e]}function ho(e,t){e.action=t}function po(e){var t=Bs(),r=bs;if(null!==r)return uo(t,r,e);Bs(),t=t.memoizedState;var n=(r=Bs()).queue.dispatch;return r.memoizedState=e,[t,n,!1]}function go(e,t,r,n){return e={tag:e,create:r,deps:n,inst:t,next:null},null===(t=ws.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},ws.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function fo(){return Bs().memoizedState}function mo(e,t,r,n){var i=Gs();n=void 0===n?null:n,ws.flags|=e,i.memoizedState=go(1|t,{destroy:void 0,resource:void 0},r,n)}function vo(e,t,r,n){var i=Bs();n=void 0===n?null:n;var s=i.memoizedState.inst;null!==bs&&null!==n&&Fs(n,bs.memoizedState.deps)?i.memoizedState=go(t,s,r,n):(ws.flags|=e,i.memoizedState=go(1|t,s,r,n))}function Co(e,t){mo(8390656,8,e,t)}function wo(e,t){vo(2048,8,e,t)}function bo(e,t){return vo(4,2,e,t)}function yo(e,t){return vo(4,4,e,t)}function So(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Eo(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,vo(4,4,So.bind(null,t,e),r)}function Ro(){}function To(e,t){var r=Bs();t=void 0===t?null:t;var n=r.memoizedState;return null!==t&&Fs(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function xo(e,t){var r=Bs();t=void 0===t?null:t;var n=r.memoizedState;if(null!==t&&Fs(t,n[1]))return n[0];if(n=e(),Rs){he(!0);try{e()}finally{he(!1)}}return r.memoizedState=[n,t],n}function ko(e,t,r){return void 0===r||0!==(1073741824&Cs)?e.memoizedState=t:(e.memoizedState=r,e=Lc(),ws.lanes|=e,pc|=e,r)}function Po(e,t,r,n){return Yr(r,t)?r:null!==ps.current?(e=ko(e,r,n),Yr(e,t)||(ka=!0),e):0===(42&Cs)?(ka=!0,e.memoizedState=r):(e=Lc(),ws.lanes|=e,pc|=e,t)}function Ao(e,t,r,n,i){var s=L.p;L.p=0!==s&&8>s?s:8;var o=O.T,a={};O.T=a,zo(e,!1,t,r);try{var l=i(),c=O.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Ho(e,t,function(e,t){var r=[],n={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then((function(){n.status="fulfilled",n.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)}),(function(e){for(n.status="rejected",n.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)})),n}(l,n),Oc());else Ho(e,t,n,Oc())}catch(u){Ho(e,t,{then:function(){},status:"rejected",reason:u},Oc())}finally{L.p=s,O.T=o}}function Fo(){}function Do(e,t,r,n){if(5!==e.tag)throw Error(o(476));var i=Io(e).queue;Ao(e,i,t,N,null===r?Fo:function(){return Mo(e),r(n)})}function Io(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:N,baseState:N,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:N},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ws,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Mo(e){Ho(e,Io(e).next.queue,{},Oc())}function Oo(){return xi(Yd)}function Lo(){return Bs().memoizedState}function No(){return Bs().memoizedState}function _o(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Oc(),n=ss(t,e=is(r),r);return null!==n&&(Nc(n,t,r),os(n,t,r)),t={cache:Mi()},void(e.payload=t)}t=t.return}}function Go(e,t,r){var n=Oc();r={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Vo(e)?Wo(t,r):null!==(r=Fn(e,t,r,n))&&(Nc(r,e,n),Uo(r,t,n))}function Bo(e,t,r){Ho(e,t,r,Oc())}function Ho(e,t,r,n){var i={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Vo(e))Wo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Yr(a,o))return An(e,t,i,0),null===nc&&Pn(),!1}catch(l){}if(null!==(r=Fn(e,t,i,n)))return Nc(r,e,n),Uo(r,t,n),!0}return!1}function zo(e,t,r,n){if(n={lane:2,revertLane:Au(),action:n,hasEagerState:!1,eagerState:null,next:null},Vo(e)){if(t)throw Error(o(479))}else null!==(t=Fn(e,r,n,2))&&Nc(t,e,2)}function Vo(e){var t=e.alternate;return e===ws||null!==t&&t===ws}function Wo(e,t){Es=Ss=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Uo(e,t,r){if(0!==(4194048&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,ke(e,r)}}var jo={readContext:xi,use:zs,useCallback:As,useContext:As,useEffect:As,useImperativeHandle:As,useLayoutEffect:As,useInsertionEffect:As,useMemo:As,useReducer:As,useRef:As,useState:As,useDebugValue:As,useDeferredValue:As,useTransition:As,useSyncExternalStore:As,useId:As,useHostTransitionStatus:As,useFormState:As,useActionState:As,useOptimistic:As,useMemoCache:As,useCacheRefresh:As},$o={readContext:xi,use:zs,useCallback:function(e,t){return Gs().memoizedState=[e,void 0===t?null:t],e},useContext:xi,useEffect:Co,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,mo(4194308,4,So.bind(null,t,e),r)},useLayoutEffect:function(e,t){return mo(4194308,4,e,t)},useInsertionEffect:function(e,t){mo(4,2,e,t)},useMemo:function(e,t){var r=Gs();t=void 0===t?null:t;var n=e();if(Rs){he(!0);try{e()}finally{he(!1)}}return r.memoizedState=[n,t],n},useReducer:function(e,t,r){var n=Gs();if(void 0!==r){var i=r(t);if(Rs){he(!0);try{r(t)}finally{he(!1)}}}else i=t;return n.memoizedState=n.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},n.queue=e,e=e.dispatch=Go.bind(null,ws,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Gs().memoizedState=e},useState:function(e){var t=(e=Zs(e)).queue,r=Bo.bind(null,ws,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ro,useDeferredValue:function(e,t){return ko(Gs(),e,t)},useTransition:function(){var e=Zs(!1);return e=Ao.bind(null,ws,e.queue,!0,!1),Gs().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var n=ws,i=Gs();if(si){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===nc)throw Error(o(349));0!==(124&sc)||Ys(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Co(Xs.bind(null,n,s,e),[e]),n.flags|=2048,go(9,{destroy:void 0,resource:void 0},qs.bind(null,n,s,r,t),null),r},useId:function(){var e=Gs(),t=nc.identifierPrefix;if(si){var r=Qn;t="\xab"+t+"R"+(r=(Jn&~(1<<32-pe(Jn)-1)).toString(32)+r),0<(r=Ts++)&&(t+="H"+r.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(r=Ps++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Oo,useFormState:lo,useActionState:lo,useOptimistic:function(e){var t=Gs();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=zo.bind(null,ws,!0,r),r.dispatch=t,[e,t]},useMemoCache:Vs,useCacheRefresh:function(){return Gs().memoizedState=_o.bind(null,ws)}},Ko={readContext:xi,use:zs,useCallback:To,useContext:xi,useEffect:wo,useImperativeHandle:Eo,useInsertionEffect:bo,useLayoutEffect:yo,useMemo:xo,useReducer:Us,useRef:fo,useState:function(){return Us(Ws)},useDebugValue:Ro,useDeferredValue:function(e,t){return Po(Bs(),bs.memoizedState,e,t)},useTransition:function(){var e=Us(Ws)[0],t=Bs().memoizedState;return["boolean"===typeof e?e:Hs(e),t]},useSyncExternalStore:Ks,useId:Lo,useHostTransitionStatus:Oo,useFormState:co,useActionState:co,useOptimistic:function(e,t){return eo(Bs(),0,e,t)},useMemoCache:Vs,useCacheRefresh:No},Yo={readContext:xi,use:zs,useCallback:To,useContext:xi,useEffect:wo,useImperativeHandle:Eo,useInsertionEffect:bo,useLayoutEffect:yo,useMemo:xo,useReducer:$s,useRef:fo,useState:function(){return $s(Ws)},useDebugValue:Ro,useDeferredValue:function(e,t){var r=Bs();return null===bs?ko(r,e,t):Po(r,bs.memoizedState,e,t)},useTransition:function(){var e=$s(Ws)[0],t=Bs().memoizedState;return["boolean"===typeof e?e:Hs(e),t]},useSyncExternalStore:Ks,useId:Lo,useHostTransitionStatus:Oo,useFormState:po,useActionState:po,useOptimistic:function(e,t){var r=Bs();return null!==bs?eo(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Vs,useCacheRefresh:No},qo=null,Xo=0;function Jo(e){var t=Xo;return Xo+=1,null===qo&&(qo=[]),Ji(qo,e,t)}function Qo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zo(e,t){if(t.$$typeof===p)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ea(e){return(0,e._init)(e._payload)}function ta(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Gn(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=67108866,r):n:(t.flags|=67108866,r):(t.flags|=1048576,r)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Vn(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var s=r.type;return s===m?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===x&&ea(s)===t.type)?(Qo(t=i(t,r.props),r),t.return=e,t):(Qo(t=Hn(r.type,r.key,r.props,null,e.mode,n),r),t.return=e,t)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Wn(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function d(e,t,r,n,s){return null===t||7!==t.tag?((t=zn(r,e.mode,n,s)).return=e,t):((t=i(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vn(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case g:return Qo(r=Hn(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case f:return(t=Wn(t,e.mode,r)).return=e,t;case x:return h(e,t=(0,t._init)(t._payload),r)}if(M(t)||F(t))return(t=zn(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return h(e,Jo(t),r);if(t.$$typeof===y)return h(e,ki(e,t),r);Zo(e,t)}return null}function p(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==i?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case g:return r.key===i?c(e,t,r,n):null;case f:return r.key===i?u(e,t,r,n):null;case x:return p(e,t,r=(i=r._init)(r._payload),n)}if(M(r)||F(r))return null!==i?null:d(e,t,r,n,null);if("function"===typeof r.then)return p(e,t,Jo(r),n);if(r.$$typeof===y)return p(e,t,ki(e,r),n);Zo(e,r)}return null}function v(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case g:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case f:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case x:return v(e,t,r,n=(0,n._init)(n._payload),i)}if(M(n)||F(n))return d(t,e=e.get(r)||null,n,i,null);if("function"===typeof n.then)return v(e,t,r,Jo(n),i);if(n.$$typeof===y)return v(e,t,r,ki(t,n),i);Zo(t,n)}return null}function C(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===m&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case g:e:{for(var w=u.key;null!==c;){if(c.key===w){if((w=u.type)===m){if(7===c.tag){r(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===w||"object"===typeof w&&null!==w&&w.$$typeof===x&&ea(w)===c.type){r(l,c.sibling),Qo(d=i(c,u.props),u),d.return=l,l=d;break e}r(l,c);break}t(l,c),c=c.sibling}u.type===m?((d=zn(u.props.children,l.mode,d,u.key)).return=l,l=d):(Qo(d=Hn(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return a(l);case f:e:{for(w=u.key;null!==c;){if(c.key===w){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}r(l,c);break}t(l,c),c=c.sibling}(d=Wn(u,l.mode,d)).return=l,l=d}return a(l);case x:return C(l,c,u=(w=u._init)(u._payload),d)}if(M(u))return function(i,o,a,l){for(var c=null,u=null,d=o,g=o=0,f=null;null!==d&&g<a.length;g++){d.index>g?(f=d,d=null):f=d.sibling;var m=p(i,d,a[g],l);if(null===m){null===d&&(d=f);break}e&&d&&null===m.alternate&&t(i,d),o=s(m,o,g),null===u?c=m:u.sibling=m,u=m,d=f}if(g===a.length)return r(i,d),si&&Zn(i,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(o=s(d,o,g),null===u?c=d:u.sibling=d,u=d);return si&&Zn(i,g),c}for(d=n(d);g<a.length;g++)null!==(f=v(d,i,g,a[g],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?g:f.key),o=s(f,o,g),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach((function(e){return t(i,e)})),si&&Zn(i,g),c}(l,c,u,d);if(F(u)){if("function"!==typeof(w=F(u)))throw Error(o(150));return function(i,a,l,c){if(null==l)throw Error(o(151));for(var u=null,d=null,g=a,f=a=0,m=null,C=l.next();null!==g&&!C.done;f++,C=l.next()){g.index>f?(m=g,g=null):m=g.sibling;var w=p(i,g,C.value,c);if(null===w){null===g&&(g=m);break}e&&g&&null===w.alternate&&t(i,g),a=s(w,a,f),null===d?u=w:d.sibling=w,d=w,g=m}if(C.done)return r(i,g),si&&Zn(i,f),u;if(null===g){for(;!C.done;f++,C=l.next())null!==(C=h(i,C.value,c))&&(a=s(C,a,f),null===d?u=C:d.sibling=C,d=C);return si&&Zn(i,f),u}for(g=n(g);!C.done;f++,C=l.next())null!==(C=v(g,i,f,C.value,c))&&(e&&null!==C.alternate&&g.delete(null===C.key?f:C.key),a=s(C,a,f),null===d?u=C:d.sibling=C,d=C);return e&&g.forEach((function(e){return t(i,e)})),si&&Zn(i,f),u}(l,c,u=w.call(u),d)}if("function"===typeof u.then)return C(l,c,Jo(u),d);if(u.$$typeof===y)return C(l,c,ki(l,u),d);Zo(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(d=i(c,u)).return=l,l=d):(r(l,c),(d=Vn(u,l.mode,d)).return=l,l=d),a(l)):r(l,c)}return function(e,t,r,n){try{Xo=0;var i=C(e,t,r,n);return qo=null,i}catch(o){if(o===ji||o===Ki)throw o;var s=Nn(29,o,null,e.mode);return s.lanes=n,s.return=e,s}}}var ra=ta(!0),na=ta(!1),ia=B(null),sa=null;function oa(e){var t=e.alternate;z(ua,1&ua.current),z(ia,e),null===sa&&(null===t||null!==ps.current||null!==t.memoizedState)&&(sa=e)}function aa(e){if(22===e.tag){if(z(ua,ua.current),z(ia,e),null===sa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(sa=e)}}else la()}function la(){z(ua,ua.current),z(ia,ia.current)}function ca(e){H(ia),sa===e&&(sa=null),H(ua)}var ua=B(0);function da(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||md(r)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ha(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:h({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var pa={enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Oc(),i=is(n);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=ss(e,i,n))&&(Nc(t,e,n),os(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Oc(),i=is(n);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=ss(e,i,n))&&(Nc(t,e,n),os(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Oc(),n=is(r);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=ss(e,n,r))&&(Nc(t,e,r),os(t,e,r))}};function ga(e,t,r,n,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!qr(r,n)||!qr(i,s))}function fa(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function ma(e,t){var r=t;if("ref"in t)for(var n in r={},t)"ref"!==n&&(r[n]=t[n]);if(e=e.defaultProps)for(var i in r===t&&(r=h({},r)),e)void 0===r[i]&&(r[i]=e[i]);return r}var va="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function Ca(e){va(e)}function wa(e){console.error(e)}function ba(e){va(e)}function ya(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout((function(){throw r}))}}function Sa(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout((function(){throw n}))}}function Ea(e,t,r){return(r=is(r)).tag=3,r.payload={element:null},r.callback=function(){ya(e,t)},r}function Ra(e){return(e=is(e)).tag=3,e}function Ta(e,t,r,n){var i=r.type.getDerivedStateFromError;if("function"===typeof i){var s=n.value;e.payload=function(){return i(s)},e.callback=function(){Sa(t,r,n)}}var o=r.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Sa(t,r,n),"function"!==typeof i&&(null===Rc?Rc=new Set([this]):Rc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var xa=Error(o(461)),ka=!1;function Pa(e,t,r,n){t.child=null===e?na(t,null,r,n):ra(t,e.child,r,n)}function Aa(e,t,r,n,i){r=r.render;var s=t.ref;if("ref"in n){var o={};for(var a in n)"ref"!==a&&(o[a]=n[a])}else o=n;return Ti(t),n=Ds(e,t,r,o,s,i),a=Ls(),null===e||ka?(si&&a&&ti(t),t.flags|=1,Pa(e,t,n,i),t.child):(Ns(e,t,i),qa(e,t,i))}function Fa(e,t,r,n,i){if(null===e){var s=r.type;return"function"!==typeof s||_n(s)||void 0!==s.defaultProps||null!==r.compare?((e=Hn(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Da(e,t,s,n,i))}if(s=e.child,!Xa(e,i)){var o=s.memoizedProps;if((r=null!==(r=r.compare)?r:qr)(o,n)&&e.ref===t.ref)return qa(e,t,i)}return t.flags|=1,(e=Gn(s,n)).ref=t.ref,e.return=t,t.child=e}function Da(e,t,r,n,i){if(null!==e){var s=e.memoizedProps;if(qr(s,n)&&e.ref===t.ref){if(ka=!1,t.pendingProps=n=s,!Xa(e,i))return t.lanes=e.lanes,qa(e,t,i);0!==(131072&e.flags)&&(ka=!0)}}return La(e,t,r,n,i)}function Ia(e,t,r){var n=t.pendingProps,i=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(0!==(128&t.flags)){if(n=null!==s?s.baseLanes|r:r,null!==e){for(i=t.child=e.child,s=0;null!==i;)s=s|i.lanes|i.childLanes,i=i.sibling;t.childLanes=s&~n}else t.childLanes=0,t.child=null;return Ma(e,t,n,r)}if(0===(536870912&r))return t.lanes=t.childLanes=536870912,Ma(e,t,null!==s?s.baseLanes|r:r,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Wi(0,null!==s?s.cachePool:null),null!==s?fs(t,s):ms(),aa(t)}else null!==s?(Wi(0,s.cachePool),fs(t,s),la(),t.memoizedState=null):(null!==e&&Wi(0,null),ms(),la());return Pa(e,t,i,r),t.child}function Ma(e,t,r,n){var i=Vi();return i=null===i?null:{parent:Ii._currentValue,pool:i},t.memoizedState={baseLanes:r,cachePool:i},null!==e&&Wi(0,null),ms(),aa(t),null!==e&&Ei(e,t,n,!0),null}function Oa(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(o(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function La(e,t,r,n,i){return Ti(t),r=Ds(e,t,r,n,void 0,i),n=Ls(),null===e||ka?(si&&n&&ti(t),t.flags|=1,Pa(e,t,r,i),t.child):(Ns(e,t,i),qa(e,t,i))}function Na(e,t,r,n,i,s){return Ti(t),t.updateQueue=null,r=Ms(t,n,r,i),Is(e),n=Ls(),null===e||ka?(si&&n&&ti(t),t.flags|=1,Pa(e,t,r,s),t.child):(Ns(e,t,s),qa(e,t,s))}function _a(e,t,r,n,i){if(Ti(t),null===t.stateNode){var s=On,o=r.contextType;"object"===typeof o&&null!==o&&(s=xi(o)),s=new r(n,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=pa,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=n,s.state=t.memoizedState,s.refs={},rs(t),o=r.contextType,s.context="object"===typeof o&&null!==o?xi(o):On,s.state=t.memoizedState,"function"===typeof(o=r.getDerivedStateFromProps)&&(ha(t,r,o,n),s.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(o=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),o!==s.state&&pa.enqueueReplaceState(s,s.state,null),us(t,n,s,i),cs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){s=t.stateNode;var a=t.memoizedProps,l=ma(r,a);s.props=l;var c=s.context,u=r.contextType;o=On,"object"===typeof u&&null!==u&&(o=xi(u));var d=r.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a||c!==o)&&fa(t,s,n,o),ts=!1;var h=t.memoizedState;s.state=h,us(t,n,s,i),cs(),c=t.memoizedState,a||h!==c||ts?("function"===typeof d&&(ha(t,r,d,n),c=t.memoizedState),(l=ts||ga(t,r,l,n,h,c,o))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=o,n=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,ns(e,t),u=ma(r,o=t.memoizedProps),s.props=u,d=t.pendingProps,h=s.context,c=r.contextType,l=On,"object"===typeof c&&null!==c&&(l=xi(c)),(c="function"===typeof(a=r.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==l)&&fa(t,s,n,l),ts=!1,h=t.memoizedState,s.state=h,us(t,n,s,i),cs();var p=t.memoizedState;o!==d||h!==p||ts||null!==e&&null!==e.dependencies&&Ri(e.dependencies)?("function"===typeof a&&(ha(t,r,a,n),p=t.memoizedState),(u=ts||ga(t,r,u,n,h,p,l)||null!==e&&null!==e.dependencies&&Ri(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),s.props=n,s.state=p,s.context=l,n=u):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return s=n,Oa(e,t),n=0!==(128&t.flags),s||n?(s=t.stateNode,r=n&&"function"!==typeof r.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&n?(t.child=ra(t,e.child,null,i),t.child=ra(t,null,r,i)):Pa(e,t,r,i),t.memoizedState=s.state,e=t.child):e=qa(e,t,i),e}function Ga(e,t,r,n){return pi(),t.flags|=256,Pa(e,t,r,n),t.child}var Ba={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ha(e){return{baseLanes:e,cachePool:Ui()}}function za(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=mc),e}function Va(e,t,r){var n,i=t.pendingProps,s=!1,a=0!==(128&t.flags);if((n=a)||(n=(null===e||null!==e.memoizedState)&&0!==(2&ua.current)),n&&(s=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(si){if(s?oa(t):la(),si){var l,c=ii;if(l=c){e:{for(l=c,c=ai;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Xn?{id:Jn,overflow:Qn}:null,retryLane:536870912,hydrationErrors:null},(l=Nn(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ni=t,ii=null,l=!0):l=!1}l||ci(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return md(c)?t.lanes=32:t.lanes=536870912,null;ca(t)}return c=i.children,i=i.fallback,s?(la(),c=Ua({mode:"hidden",children:c},s=t.mode),i=zn(i,s,r,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(s=t.child).memoizedState=Ha(r),s.childLanes=za(e,n,r),t.memoizedState=Ba,i):(oa(t),Wa(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(oa(t),t.flags&=-257,t=ja(e,t,r)):null!==t.memoizedState?(la(),t.child=e.child,t.flags|=128,t=null):(la(),s=i.fallback,c=t.mode,i=Ua({mode:"visible",children:i.children},c),(s=zn(s,c,r,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,ra(t,e.child,null,r),(i=t.child).memoizedState=Ha(r),i.childLanes=za(e,n,r),t.memoizedState=Ba,t=s);else if(oa(t),md(c)){if(n=c.nextSibling&&c.nextSibling.dataset)var u=n.dgst;n=u,(i=Error(o(419))).stack="",i.digest=n,fi({value:i,source:null,stack:null}),t=ja(e,t,r)}else if(ka||Ei(e,t,r,!1),n=0!==(r&e.childLanes),ka||n){if(null!==(n=nc)&&(0!==(i=0!==((i=0!==(42&(i=r&-r))?1:Pe(i))&(n.suspendedLanes|r))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Dn(e,i),Nc(n,e,i),xa;"$?"===c.data||Kc(),t=ja(e,t,r)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=vd(c.nextSibling),ni=t,si=!0,oi=null,ai=!1,null!==e&&(Yn[qn++]=Jn,Yn[qn++]=Qn,Yn[qn++]=Xn,Jn=e.id,Qn=e.overflow,Xn=t),(t=Wa(t,i.children)).flags|=4096);return t}return s?(la(),s=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Gn(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?s=Gn(u,s):(s=zn(s,c,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(c=e.child.memoizedState)?c=Ha(r):(null!==(l=c.cachePool)?(u=Ii._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Ui(),c={baseLanes:c.baseLanes|r,cachePool:l}),s.memoizedState=c,s.childLanes=za(e,n,r),t.memoizedState=Ba,i):(oa(t),e=(r=e.child).sibling,(r=Gn(r,{mode:"visible",children:i.children})).return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r)}function Wa(e,t){return(t=Ua({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ua(e,t){return(e=Nn(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function ja(e,t,r){return ra(t,e.child,null,r),(e=Wa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $a(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),yi(e.return,t,r)}function Ka(e,t,r,n,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Ya(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Pa(e,t,n.children,r),0!==(2&(n=ua.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$a(e,r,t);else if(19===e.tag)$a(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(z(ua,n),i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===da(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ka(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===da(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ka(t,!0,r,null,s);break;case"together":Ka(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(Ei(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Gn(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Gn(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Xa(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ri(e))}function Ja(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)ka=!0;else{if(!Xa(e,r)&&0===(128&t.flags))return ka=!1,function(e,t,r){switch(t.tag){case 3:$(t,t.stateNode.containerInfo),wi(0,Ii,e.memoizedState.cache),pi();break;case 27:case 5:Y(t);break;case 4:$(t,t.stateNode.containerInfo);break;case 10:wi(0,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(oa(t),t.flags|=128,null):0!==(r&t.child.childLanes)?Va(e,t,r):(oa(t),null!==(e=qa(e,t,r))?e.sibling:null);oa(t);break;case 19:var i=0!==(128&e.flags);if((n=0!==(r&t.childLanes))||(Ei(e,t,r,!1),n=0!==(r&t.childLanes)),i){if(n)return Ya(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),z(ua,ua.current),n)break;return null;case 22:case 23:return t.lanes=0,Ia(e,t,r);case 24:wi(0,Ii,e.memoizedState.cache)}return qa(e,t,r)}(e,t,r);ka=0!==(131072&e.flags)}else ka=!1,si&&0!==(1048576&t.flags)&&ei(t,Kn,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,i=n._init;if(n=i(n._payload),t.type=n,"function"!==typeof n){if(void 0!==n&&null!==n){if((i=n.$$typeof)===S){t.tag=11,t=Aa(null,t,n,e,r);break e}if(i===T){t.tag=14,t=Fa(null,t,n,e,r);break e}}throw t=I(n)||n,Error(o(306,t,""))}_n(n)?(e=ma(n,e),t.tag=1,t=_a(null,t,n,e,r)):(t.tag=0,t=La(null,t,n,e,r))}return t;case 0:return La(e,t,t.type,t.pendingProps,r);case 1:return _a(e,t,n=t.type,i=ma(n,t.pendingProps),r);case 3:e:{if($(t,t.stateNode.containerInfo),null===e)throw Error(o(387));n=t.pendingProps;var s=t.memoizedState;i=s.element,ns(e,t),us(t,n,null,r);var a=t.memoizedState;if(n=a.cache,wi(0,Ii,n),n!==s.cache&&Si(t,[Ii],r,!0),cs(),n=a.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ga(e,t,n,r);break e}if(n!==i){fi(i=Rn(Error(o(424)),t)),t=Ga(e,t,n,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=vd(e.firstChild),ni=t,si=!0,oi=null,ai=!0,r=na(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(pi(),n===i){t=qa(e,t,r);break e}Pa(e,t,n,r)}t=t.child}return t;case 26:return Oa(e,t),null===e?(r=Pd(t.type,null,t.pendingProps,null))?t.memoizedState=r:si||(r=t.type,e=t.pendingProps,(n=nd(U.current).createElement(r))[Ie]=t,n[Me]=e,ed(n,r,e),je(n),t.stateNode=n):t.memoizedState=Pd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&si&&(n=t.stateNode=bd(t.type,t.pendingProps,U.current),ni=t,ai=!0,i=ii,pd(t.type)?(Cd=i,ii=vd(n.firstChild)):ii=i),Pa(e,t,t.pendingProps.children,r),Oa(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&si&&((i=n=ii)&&(null!==(n=function(e,t,r,n){for(;1===e.nodeType;){var i=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Be])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===s)return e}if(null===(e=vd(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,ai))?(t.stateNode=n,ni=t,ii=vd(n.firstChild),ai=!1,i=!0):i=!1),i||ci(t)),Y(t),i=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,n=s.children,od(i,s)?n=null:null!==a&&od(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=Ds(e,t,Os,null,null,r),Yd._currentValue=i),Oa(e,t),Pa(e,t,n,r),t.child;case 6:return null===e&&si&&((e=r=ii)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(r,t.pendingProps,ai))?(t.stateNode=r,ni=t,ii=null,e=!0):e=!1),e||ci(t)),null;case 13:return Va(e,t,r);case 4:return $(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=ra(t,null,n,r):Pa(e,t,n,r),t.child;case 11:return Aa(e,t,t.type,t.pendingProps,r);case 7:return Pa(e,t,t.pendingProps,r),t.child;case 8:case 12:return Pa(e,t,t.pendingProps.children,r),t.child;case 10:return n=t.pendingProps,wi(0,t.type,n.value),Pa(e,t,n.children,r),t.child;case 9:return i=t.type._context,n=t.pendingProps.children,Ti(t),n=n(i=xi(i)),t.flags|=1,Pa(e,t,n,r),t.child;case 14:return Fa(e,t,t.type,t.pendingProps,r);case 15:return Da(e,t,t.type,t.pendingProps,r);case 19:return Ya(e,t,r);case 31:return n=t.pendingProps,r=t.mode,n={mode:n.mode,children:n.children},null===e?((r=Ua(n,r)).ref=t.ref,t.child=r,r.return=t,t=r):((r=Gn(e.child,n)).ref=t.ref,t.child=r,r.return=t,t=r),t;case 22:return Ia(e,t,r);case 24:return Ti(t),n=xi(Ii),null===e?(null===(i=Vi())&&(i=nc,s=Mi(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=r),i=s),t.memoizedState={parent:n,cache:i},rs(t),wi(0,Ii,i)):(0!==(e.lanes&r)&&(ns(e,t),us(t,null,null,r),cs()),i=e.memoizedState,s=t.memoizedState,i.parent!==n?(i={parent:n,cache:n},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),wi(0,Ii,n)):(n=s.cache,wi(0,Ii,n),n!==i.cache&&Si(t,[Ii],r,!0))),Pa(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}function Qa(e){e.flags|=4}function Za(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!zd(t)){if(null!==(t=ia.current)&&((4194048&sc)===sc?null!==sa:(62914560&sc)!==sc&&0===(536870912&sc)||t!==sa))throw Qi=Yi,$i;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ee():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function rl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=65011712&i.subtreeFlags,n|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function nl(e,t,r){var n=t.pendingProps;switch(ri(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rl(t),null;case 3:return r=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),bi(Ii),K(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?Qa(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,gi())),rl(t),null;case 26:return r=t.memoizedState,null===e?(Qa(t),null!==r?(rl(t),Za(t,r)):(rl(t),t.flags&=-16777217)):r?r!==e.memoizedState?(Qa(t),rl(t),Za(t,r)):(rl(t),t.flags&=-16777217):(e.memoizedProps!==n&&Qa(t),rl(t),t.flags&=-16777217),null;case 27:q(t),r=U.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Qa(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return rl(t),null}e=V.current,hi(t)?ui(t):(e=bd(i,n,r),t.stateNode=e,Qa(t))}return rl(t),null;case 5:if(q(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&Qa(t);else{if(!n){if(null===t.stateNode)throw Error(o(166));return rl(t),null}if(e=V.current,hi(t))ui(t);else{switch(i=nd(U.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof n.is?i.createElement("select",{is:n.is}):i.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e="string"===typeof n.is?i.createElement(r,{is:n.is}):i.createElement(r)}}e[Ie]=t,e[Me]=n;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(ed(e,r,n),r){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Qa(t)}}return rl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&Qa(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(e=U.current,hi(t)){if(e=t.stateNode,r=t.memoizedProps,n=null,null!==(i=ni))switch(i.tag){case 27:case 5:n=i.memoizedProps}e[Ie]=t,(e=!!(e.nodeValue===r||null!==n&&!0===n.suppressHydrationWarning||Xu(e.nodeValue,r)))||ci(t)}else(e=nd(e).createTextNode(n))[Ie]=t,t.stateNode=e}return rl(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=hi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[Ie]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rl(t),i=!1}else i=gi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ca(t),t):(ca(t),null)}if(ca(t),0!==(128&t.flags))return t.lanes=r,t;if(r=null!==n,e=null!==e&&null!==e.memoizedState,r){i=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool);var s=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==i&&(n.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),el(t,t.updateQueue),rl(t),null;case 4:return K(),null===e&&Hu(t.stateNode.containerInfo),rl(t),null;case 10:return bi(t.type),rl(t),null;case 19:if(H(ua),null===(i=t.memoizedState))return rl(t),null;if(n=0!==(128&t.flags),null===(s=i.rendering))if(n)tl(i,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=da(e))){for(t.flags|=128,tl(i,!1),e=s.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)Bn(r,e),r=r.sibling;return z(ua,1&ua.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,n=!0,tl(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=da(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!si)return rl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==r&&(t.flags|=128,n=!0,tl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=ua.current,z(ua,n?1&e|2:1&e),t):(rl(t),null);case 22:case 23:return ca(t),vs(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&r)&&0===(128&t.flags)&&(rl(t),6&t.subtreeFlags&&(t.flags|=8192)):rl(t),null!==(r=t.updateQueue)&&el(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==r&&(t.flags|=2048),null!==e&&H(zi),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),bi(Ii),rl(t),null;case 25:case 30:return null}throw Error(o(156,t.tag))}function il(e,t){switch(ri(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return bi(Ii),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return q(t),null;case 13:if(ca(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return H(ua),null;case 4:return K(),null;case 10:return bi(t.type),null;case 22:case 23:return ca(t),vs(),null!==e&&H(zi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return bi(Ii),null;default:return null}}function sl(e,t){switch(ri(t),t.tag){case 3:bi(Ii),K();break;case 26:case 27:case 5:q(t);break;case 4:K();break;case 13:ca(t);break;case 19:H(ua);break;case 10:bi(t.type);break;case 22:case 23:ca(t),vs(),null!==e&&H(zi);break;case 24:bi(Ii)}}function ol(e,t){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var i=n.next;r=i;do{if((r.tag&e)===e){n=void 0;var s=r.create,o=r.inst;n=s(),o.destroy=n}r=r.next}while(r!==i)}}catch(a){uu(t,t.return,a)}}function al(e,t,r){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var s=i.next;n=s;do{if((n.tag&e)===e){var o=n.inst,a=o.destroy;if(void 0!==a){o.destroy=void 0,i=t;var l=r,c=a;try{c()}catch(u){uu(i,l,u)}}}n=n.next}while(n!==s)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{hs(t,r)}catch(n){uu(e,e.return,n)}}}function cl(e,t,r){r.props=ma(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(n){uu(e,t,n)}}function ul(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"===typeof r?e.refCleanup=r(n):r.current=n}}catch(i){uu(e,t,i)}}function dl(e,t){var r=e.ref,n=e.refCleanup;if(null!==r)if("function"===typeof n)try{n()}catch(i){uu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(s){uu(e,t,s)}else r.current=null}function hl(e){var t=e.type,r=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(i){uu(e,e.return,i)}}function pl(e,t,r){try{var n=e.stateNode;!function(e,t,r,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,a=null,l=null,c=null,u=null,d=null;for(g in r){var h=r[g];if(r.hasOwnProperty(g)&&null!=h)switch(g){case"checked":case"value":break;case"defaultValue":c=h;default:n.hasOwnProperty(g)||Qu(e,t,g,null,n,h)}}for(var p in n){var g=n[p];if(h=r[p],n.hasOwnProperty(p)&&(null!=g||null!=h))switch(p){case"type":s=g;break;case"name":i=g;break;case"checked":u=g;break;case"defaultChecked":d=g;break;case"value":a=g;break;case"defaultValue":l=g;break;case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(o(137,t));break;default:g!==h&&Qu(e,t,p,g,n,h)}}return void mt(e,a,l,c,u,d,s,i);case"select":for(s in g=a=l=p=null,r)if(c=r[s],r.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":g=c;default:n.hasOwnProperty(s)||Qu(e,t,s,null,n,c)}for(i in n)if(s=n[i],c=r[i],n.hasOwnProperty(i)&&(null!=s||null!=c))switch(i){case"value":p=s;break;case"defaultValue":l=s;break;case"multiple":a=s;default:s!==c&&Qu(e,t,i,s,n,c)}return t=l,r=a,n=g,void(null!=p?wt(e,!!r,p,!1):!!n!==!!r&&(null!=t?wt(e,!!r,t,!0):wt(e,!!r,r?[]:"",!1)));case"textarea":for(l in g=p=null,r)if(i=r[l],r.hasOwnProperty(l)&&null!=i&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Qu(e,t,l,null,n,i)}for(a in n)if(i=n[a],s=r[a],n.hasOwnProperty(a)&&(null!=i||null!=s))switch(a){case"value":p=i;break;case"defaultValue":g=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(o(91));break;default:i!==s&&Qu(e,t,a,i,n,s)}return void bt(e,p,g);case"option":for(var f in r)if(p=r[f],r.hasOwnProperty(f)&&null!=p&&!n.hasOwnProperty(f))if("selected"===f)e.selected=!1;else Qu(e,t,f,null,n,p);for(c in n)if(p=n[c],g=r[c],n.hasOwnProperty(c)&&p!==g&&(null!=p||null!=g))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else Qu(e,t,c,p,n,g);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in r)p=r[m],r.hasOwnProperty(m)&&null!=p&&!n.hasOwnProperty(m)&&Qu(e,t,m,null,n,p);for(u in n)if(p=n[u],g=r[u],n.hasOwnProperty(u)&&p!==g&&(null!=p||null!=g))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:Qu(e,t,u,p,n,g)}return;default:if(xt(t)){for(var v in r)p=r[v],r.hasOwnProperty(v)&&void 0!==p&&!n.hasOwnProperty(v)&&Zu(e,t,v,void 0,n,p);for(d in n)p=n[d],g=r[d],!n.hasOwnProperty(d)||p===g||void 0===p&&void 0===g||Zu(e,t,d,p,n,g);return}}for(var C in r)p=r[C],r.hasOwnProperty(C)&&null!=p&&!n.hasOwnProperty(C)&&Qu(e,t,C,null,n,p);for(h in n)p=n[h],g=r[h],!n.hasOwnProperty(h)||p===g||null==p&&null==g||Qu(e,t,h,p,n,g)}(n,e.type,r,t),n[Me]=t}catch(i){uu(e,e.return,i)}}function gl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&pd(e.type)||4===e.tag}function fl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&pd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ml(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Ju));else if(4!==n&&(27===n&&pd(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(ml(e,t,r),e=e.sibling;null!==e;)ml(e,t,r),e=e.sibling}function vl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&(27===n&&pd(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(vl(e,t,r),e=e.sibling;null!==e;)vl(e,t,r),e=e.sibling}function Cl(e){var t=e.stateNode,r=e.memoizedProps;try{for(var n=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);ed(t,n,r),t[Ie]=e,t[Me]=r}catch(s){uu(e,e.return,s)}}var wl=!1,bl=!1,yl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,El=null;function Rl(e,t,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:_l(e,r),4&n&&ol(5,r);break;case 1:if(_l(e,r),4&n)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(o){uu(r,r.return,o)}else{var i=ma(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){uu(r,r.return,a)}}64&n&&ll(r),512&n&&ul(r,r.return);break;case 3:if(_l(e,r),64&n&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{hs(e,t)}catch(o){uu(r,r.return,o)}}break;case 27:null===t&&4&n&&Cl(r);case 26:case 5:_l(e,r),null===t&&4&n&&hl(r),512&n&&ul(r,r.return);break;case 12:_l(e,r);break;case 13:_l(e,r),4&n&&Fl(e,r),64&n&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$?"!==e.data||"complete"===r.readyState)t();else{var n=function(){t(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,r=gu.bind(null,r))));break;case 22:if(!(n=null!==r.memoizedState||wl)){t=null!==t&&null!==t.memoizedState||bl,i=wl;var s=bl;wl=n,(bl=t)&&!s?Bl(e,r,0!==(8772&r.subtreeFlags)):_l(e,r),wl=i,bl=s}break;case 30:break;default:_l(e,r)}}function Tl(e){var t=e.alternate;null!==t&&(e.alternate=null,Tl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&He(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xl=null,kl=!1;function Pl(e,t,r){for(r=r.child;null!==r;)Al(e,t,r),r=r.sibling}function Al(e,t,r){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,r)}catch(s){}switch(r.tag){case 26:bl||dl(r,t),Pl(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:bl||dl(r,t);var n=xl,i=kl;pd(r.type)&&(xl=r.stateNode,kl=!1),Pl(e,t,r),yd(r.stateNode),xl=n,kl=i;break;case 5:bl||dl(r,t);case 6:if(n=xl,i=kl,xl=null,Pl(e,t,r),kl=i,null!==(xl=n))if(kl)try{(9===xl.nodeType?xl.body:"HTML"===xl.nodeName?xl.ownerDocument.body:xl).removeChild(r.stateNode)}catch(o){uu(r,t,o)}else try{xl.removeChild(r.stateNode)}catch(o){uu(r,t,o)}break;case 18:null!==xl&&(kl?(gd(9===(e=xl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),kh(e)):gd(xl,r.stateNode));break;case 4:n=xl,i=kl,xl=r.stateNode.containerInfo,kl=!0,Pl(e,t,r),xl=n,kl=i;break;case 0:case 11:case 14:case 15:bl||al(2,r,t),bl||al(4,r,t),Pl(e,t,r);break;case 1:bl||(dl(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount&&cl(r,t,n)),Pl(e,t,r);break;case 21:Pl(e,t,r);break;case 22:bl=(n=bl)||null!==r.memoizedState,Pl(e,t,r),bl=n;break;default:Pl(e,t,r)}}function Fl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{kh(e)}catch(r){uu(t,t.return,r)}}function Dl(e,t){var r=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(o(435,e.tag))}}(e);t.forEach((function(t){var n=fu.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}function Il(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n],s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(pd(l.type)){xl=l.stateNode,kl=!1;break e}break;case 5:xl=l.stateNode,kl=!1;break e;case 3:case 4:xl=l.stateNode.containerInfo,kl=!0;break e}l=l.return}if(null===xl)throw Error(o(160));Al(s,a,i),xl=null,kl=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ol(t,e),t=t.sibling}var Ml=null;function Ol(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Il(t,e),Ll(e),4&n&&(al(3,e,e.return),ol(3,e),al(5,e,e.return));break;case 1:Il(t,e),Ll(e),512&n&&(bl||null===r||dl(r,r.return)),64&n&&wl&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?n:r.concat(n))));break;case 26:var i=Ml;if(Il(t,e),Ll(e),512&n&&(bl||null===r||dl(r,r.return)),4&n){var s=null!==r?r.memoizedState:null;if(n=e.memoizedState,null===r)if(null===n)if(null===e.stateNode){e:{n=e.type,r=e.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":(!(s=i.getElementsByTagName("title")[0])||s[Be]||s[Ie]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(n),i.head.insertBefore(s,i.querySelector("head > title"))),ed(s,n,r),s[Ie]=e,je(s),n=s;break e;case"link":var a=Bd("link","href",i).get(n+(r.href||""));if(a)for(var l=0;l<a.length;l++)if((s=a[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&s.getAttribute("rel")===(null==r.rel?null:r.rel)&&s.getAttribute("title")===(null==r.title?null:r.title)&&s.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){a.splice(l,1);break t}ed(s=i.createElement(n),n,r),i.head.appendChild(s);break;case"meta":if(a=Bd("meta","content",i).get(n+(r.content||"")))for(l=0;l<a.length;l++)if((s=a[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&s.getAttribute("name")===(null==r.name?null:r.name)&&s.getAttribute("property")===(null==r.property?null:r.property)&&s.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&s.getAttribute("charset")===(null==r.charSet?null:r.charSet)){a.splice(l,1);break t}ed(s=i.createElement(n),n,r),i.head.appendChild(s);break;default:throw Error(o(468,n))}s[Ie]=e,je(s),n=s}e.stateNode=n}else Hd(i,e.type,e.stateNode);else e.stateNode=Od(i,n,e.memoizedProps);else s!==n?(null===s?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):s.count--,null===n?Hd(i,e.type,e.stateNode):Od(i,n,e.memoizedProps)):null===n&&null!==e.stateNode&&pl(e,e.memoizedProps,r.memoizedProps)}break;case 27:Il(t,e),Ll(e),512&n&&(bl||null===r||dl(r,r.return)),null!==r&&4&n&&pl(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Il(t,e),Ll(e),512&n&&(bl||null===r||dl(r,r.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(g){uu(e,e.return,g)}}4&n&&null!=e.stateNode&&pl(e,i=e.memoizedProps,null!==r?r.memoizedProps:i),1024&n&&(yl=!0);break;case 6:if(Il(t,e),Ll(e),4&n){if(null===e.stateNode)throw Error(o(162));n=e.memoizedProps,r=e.stateNode;try{r.nodeValue=n}catch(g){uu(e,e.return,g)}}break;case 3:if(Gd=null,i=Ml,Ml=Rd(t.containerInfo),Il(t,e),Ml=i,Ll(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{kh(t.containerInfo)}catch(g){uu(e,e.return,g)}yl&&(yl=!1,Nl(e));break;case 4:n=Ml,Ml=Rd(e.stateNode.containerInfo),Il(t,e),Ll(e),Ml=n;break;case 12:default:Il(t,e),Ll(e);break;case 13:Il(t,e),Ll(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(yc=te()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Dl(e,n)));break;case 22:i=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,u=wl,d=bl;if(wl=u||i,bl=d||c,Il(t,e),bl=d,wl=u,Ll(e),8192&n)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===r||c||wl||bl||Gl(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(s=c.stateNode,i)"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(g){uu(c,c.return,g)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){uu(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(r=n.retryQueue)&&(n.retryQueue=null,Dl(e,r))));break;case 19:Il(t,e),Ll(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Dl(e,n)));case 30:case 21:}}function Ll(e){var t=e.flags;if(2&t){try{for(var r,n=e.return;null!==n;){if(gl(n)){r=n;break}n=n.return}if(null==r)throw Error(o(160));switch(r.tag){case 27:var i=r.stateNode;vl(e,fl(e),i);break;case 5:var s=r.stateNode;32&r.flags&&(St(s,""),r.flags&=-33),vl(e,fl(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;ml(e,fl(e),a);break;default:throw Error(o(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Nl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Nl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function _l(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Rl(e,t.alternate,t),t=t.sibling}function Gl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:al(4,t,t.return),Gl(t);break;case 1:dl(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&cl(t,t.return,r),Gl(t);break;case 27:yd(t.stateNode);case 26:case 5:dl(t,t.return),Gl(t);break;case 22:null===t.memoizedState&&Gl(t);break;default:Gl(t)}e=e.sibling}}function Bl(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,i=e,s=t,o=s.flags;switch(s.tag){case 0:case 11:case 15:Bl(i,s,r),ol(4,s);break;case 1:if(Bl(i,s,r),"function"===typeof(i=(n=s).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){uu(n,n.return,c)}if(null!==(i=(n=s).updateQueue)){var a=n.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)ds(l[i],a)}catch(c){uu(n,n.return,c)}}r&&64&o&&ll(s),ul(s,s.return);break;case 27:Cl(s);case 26:case 5:Bl(i,s,r),r&&null===n&&4&o&&hl(s),ul(s,s.return);break;case 12:Bl(i,s,r);break;case 13:Bl(i,s,r),r&&4&o&&Fl(i,s);break;case 22:null===s.memoizedState&&Bl(i,s,r),ul(s,s.return);break;case 30:break;default:Bl(i,s,r)}t=t.sibling}}function Hl(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Oi(r))}function zl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e))}function Vl(e,t,r,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Wl(e,t,r,n),t=t.sibling}function Wl(e,t,r,n){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,r,n),2048&i&&ol(9,t);break;case 1:case 13:default:Vl(e,t,r,n);break;case 3:Vl(e,t,r,n),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e)));break;case 12:if(2048&i){Vl(e,t,r,n),e=t.stateNode;try{var s=t.memoizedProps,o=s.id,a=s.onPostCommit;"function"===typeof a&&a(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Vl(e,t,r,n);break;case 23:break;case 22:s=t.stateNode,o=t.alternate,null!==t.memoizedState?2&s._visibility?Vl(e,t,r,n):jl(e,t):2&s._visibility?Vl(e,t,r,n):(s._visibility|=2,Ul(e,t,r,n,0!==(10256&t.subtreeFlags))),2048&i&&Hl(o,t);break;case 24:Vl(e,t,r,n),2048&i&&zl(t.alternate,t)}}function Ul(e,t,r,n,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,o=t,a=r,l=n,c=o.flags;switch(o.tag){case 0:case 11:case 15:Ul(s,o,a,l,i),ol(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?Ul(s,o,a,l,i):jl(s,o):(u._visibility|=2,Ul(s,o,a,l,i)),i&&2048&c&&Hl(o.alternate,o);break;case 24:Ul(s,o,a,l,i),i&&2048&c&&zl(o.alternate,o);break;default:Ul(s,o,a,l,i)}t=t.sibling}}function jl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,n=t,i=n.flags;switch(n.tag){case 22:jl(r,n),2048&i&&Hl(n.alternate,n);break;case 24:jl(r,n),2048&i&&zl(n.alternate,n);break;default:jl(r,n)}t=t.sibling}}var $l=8192;function Kl(e){if(e.subtreeFlags&$l)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Kl(e),e.flags&$l&&null!==e.memoizedState&&function(e,t,r){if(null===Vd)throw Error(o(475));var n=Vd;if("stylesheet"===t.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=Ad(r.href),s=e.querySelector(Fd(i));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(n.count++,n=Ud.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=s,void je(s);s=e.ownerDocument||e,r=Dd(r),(i=Sd.get(i))&&Nd(r,i),je(s=s.createElement("link"));var a=s;a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),ed(s,"link",r),t.instance=s}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(n.count++,t=Ud.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ml,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Ml;Ml=Rd(e.stateNode.containerInfo),Kl(e),Ml=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=$l,$l=16777216,Kl(e),$l=t):Kl(e))}}function ql(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];El=n,Zl(n,e)}ql(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Jl(e),e=e.sibling}function Jl(e){switch(e.tag){case 0:case 11:case 15:Xl(e),2048&e.flags&&al(9,e,e.return);break;case 3:case 12:default:Xl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Ql(e)):Xl(e)}}function Ql(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var n=t[r];El=n,Zl(n,e)}ql(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:al(8,t,t.return),Ql(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,Ql(t));break;default:Ql(t)}e=e.sibling}}function Zl(e,t){for(;null!==El;){var r=El;switch(r.tag){case 0:case 11:case 15:al(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var n=r.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Oi(r.memoizedState.cache)}if(null!==(n=r.child))n.return=r,El=n;else e:for(r=e;null!==El;){var i=(n=El).sibling,s=n.return;if(Tl(n),n===r){El=null;break e}if(null!==i){i.return=s,El=i;break e}El=s}}}var ec={getCacheForType:function(e){var t=xi(Ii),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r}},tc="function"===typeof WeakMap?WeakMap:Map,rc=0,nc=null,ic=null,sc=0,oc=0,ac=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,pc=0,gc=0,fc=0,mc=0,vc=0,Cc=null,wc=null,bc=!1,yc=0,Sc=1/0,Ec=null,Rc=null,Tc=0,xc=null,kc=null,Pc=0,Ac=0,Fc=null,Dc=null,Ic=0,Mc=null;function Oc(){if(0!==(2&rc)&&0!==sc)return sc&-sc;if(null!==O.T){return 0!==_i?_i:Au()}return Fe()}function Lc(){0===mc&&(mc=0===(536870912&sc)||si?Se():536870912);var e=ia.current;return null!==e&&(e.flags|=32),mc}function Nc(e,t,r){(e!==nc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Wc(e,0),Hc(e,sc,mc,!1)),Te(e,r),0!==(2&rc)&&e===nc||(e===nc&&(0===(2&rc)&&(gc|=r),4===hc&&Hc(e,sc,mc,!1)),Su(e))}function _c(e,t,r){if(0!==(6&rc))throw Error(o(327));for(var n=!r&&0===(124&t)&&0===(t&e.expiredLanes)||be(e,t),i=n?function(e,t){var r=rc;rc|=2;var n=jc(),i=$c();nc!==e||sc!==t?(Ec=null,Sc=te()+500,Wc(e,t)):cc=be(e,t);e:for(;;)try{if(0!==oc&&null!==ic){t=ic;var s=ac;t:switch(oc){case 1:oc=0,ac=null,Zc(e,t,s,1);break;case 2:case 9:if(qi(s)){oc=0,ac=null,Qc(t);break}t=function(){2!==oc&&9!==oc||nc!==e||(oc=7),Su(e)},s.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:qi(s)?(oc=0,ac=null,Qc(t)):(oc=0,ac=null,Zc(e,t,s,7));break;case 5:var a=null;switch(ic.tag){case 26:a=ic.memoizedState;case 5:case 27:var l=ic;if(!a||zd(a)){oc=0,ac=null;var c=l.sibling;if(null!==c)ic=c;else{var u=l.return;null!==u?(ic=u,eu(u)):ic=null}break t}}oc=0,ac=null,Zc(e,t,s,5);break;case 6:oc=0,ac=null,Zc(e,t,s,6);break;case 8:Vc(),hc=6;break e;default:throw Error(o(462))}}Xc();break}catch(d){Uc(e,d)}return Ci=vi=null,O.H=n,O.A=i,rc=r,null!==ic?0:(nc=null,sc=0,Pn(),hc)}(e,t):Yc(e,t,!0),s=n;;){if(0===i){cc&&!n&&Hc(e,t,0,!1);break}if(r=e.current.alternate,!s||Bc(r)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=Cc;var c=l.current.memoizedState.isDehydrated;if(c&&(Wc(l,a).flags|=256),2!==(a=Yc(l,a,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=s,gc|=s,i=4;break e}s=wc,wc=i,null!==s&&(null===wc?wc=s:wc.push.apply(wc,s))}i=a}if(s=!1,2!==i)continue}}if(1===i){Wc(e,0),Hc(e,t,0,!0);break}e:{switch(n=e,s=i){case 0:case 1:throw Error(o(345));case 4:if((4194048&t)!==t)break;case 6:Hc(n,t,mc,!lc);break e;case 2:wc=null;break;case 3:case 5:break;default:throw Error(o(329))}if((62914560&t)===t&&10<(i=yc+300-te())){if(Hc(n,t,mc,!lc),0!==we(n,0,!0))break e;n.timeoutHandle=ld(Gc.bind(null,n,r,wc,Ec,bc,t,mc,gc,vc,lc,s,2,-0,0),i)}else Gc(n,r,wc,Ec,bc,t,mc,gc,vc,lc,s,0,-0,0)}break}i=Yc(e,t,!1),s=!1}Su(e)}function Gc(e,t,r,n,i,s,a,l,c,u,d,h,p,g){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Vd={stylesheets:null,count:0,unsuspend:Wd},Yl(t),null!==(h=function(){if(null===Vd)throw Error(o(475));var e=Vd;return e.stylesheets&&0===e.count&&$d(e,e.stylesheets),0<e.count?function(t){var r=setTimeout((function(){if(e.stylesheets&&$d(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}())))return e.cancelPendingCommit=h(ru.bind(null,e,t,s,r,n,i,a,l,c,d,1,p,g)),void Hc(e,s,a,!u);ru(e,t,s,r,n,i,a,l,c)}function Bc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Yr(s(),i))return!1}catch(o){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hc(e,t,r,n){t&=~fc,t&=~gc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var i=t;0<i;){var s=31-pe(i),o=1<<s;n[s]=-1,i&=~o}0!==r&&xe(e,r,t)}function zc(){return 0!==(6&rc)||(Eu(0,!1),!1)}function Vc(){if(null!==ic){if(0===oc)var e=ic.return;else Ci=vi=null,_s(e=ic),qo=null,Xo=0,e=ic;for(;null!==e;)sl(e.alternate,e),e=e.return;ic=null}}function Wc(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,cd(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Vc(),nc=e,ic=r=Gn(e.current,null),sc=t,oc=0,ac=null,lc=!1,cc=be(e,t),uc=!1,vc=mc=fc=gc=pc=hc=0,wc=Cc=null,bc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var i=31-pe(n),s=1<<i;t|=e[i],n&=~s}return dc=t,Pn(),r}function Uc(e,t){ws=null,O.H=jo,t===ji||t===Ki?(t=Zi(),oc=3):t===$i?(t=Zi(),oc=4):oc=t===xa?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ac=t,null===ic&&(hc=1,ya(e,Rn(t,e.current)))}function jc(){var e=O.H;return O.H=jo,null===e?jo:e}function $c(){var e=O.A;return O.A=ec,e}function Kc(){hc=4,lc||(4194048&sc)!==sc&&null!==ia.current||(cc=!0),0===(134217727&pc)&&0===(134217727&gc)||null===nc||Hc(nc,sc,mc,!1)}function Yc(e,t,r){var n=rc;rc|=2;var i=jc(),s=$c();nc===e&&sc===t||(Ec=null,Wc(e,t)),t=!1;var o=hc;e:for(;;)try{if(0!==oc&&null!==ic){var a=ic,l=ac;switch(oc){case 8:Vc(),o=6;break e;case 3:case 2:case 9:case 6:null===ia.current&&(t=!0);var c=oc;if(oc=0,ac=null,Zc(e,a,l,c),r&&cc){o=0;break e}break;default:c=oc,oc=0,ac=null,Zc(e,a,l,c)}}qc(),o=hc;break}catch(u){Uc(e,u)}return t&&e.shellSuspendCounter++,Ci=vi=null,rc=n,O.H=i,O.A=s,null===ic&&(nc=null,sc=0,Pn()),o}function qc(){for(;null!==ic;)Jc(ic)}function Xc(){for(;null!==ic&&!Z();)Jc(ic)}function Jc(e){var t=Ja(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Qc(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Na(r,t,t.pendingProps,t.type,void 0,sc);break;case 11:t=Na(r,t,t.pendingProps,t.type.render,t.ref,sc);break;case 5:_s(t);default:sl(r,t),t=Ja(r,t=ic=Bn(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Zc(e,t,r,n){Ci=vi=null,_s(t),qo=null,Xo=0;var i=t.return;try{if(function(e,t,r,n,i){if(r.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=r.alternate)&&Ei(t,r,i,!0),null!==(r=ia.current)){switch(r.tag){case 13:return null===sa?Kc():null===r.alternate&&0===hc&&(hc=3),r.flags&=-257,r.flags|=65536,r.lanes=i,n===Yi?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([n]):t.add(n),du(e,n,i)),!1;case 22:return r.flags|=65536,n===Yi?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([n]):r.add(n),du(e,n,i)),!1}throw Error(o(435,r.tag))}return du(e,n,i),Kc(),!1}if(si)return null!==(t=ia.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,n!==li&&fi(Rn(e=Error(o(422),{cause:n}),r))):(n!==li&&fi(Rn(t=Error(o(423),{cause:n}),r)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,n=Rn(n,r),as(e,i=Ea(e.stateNode,n,i)),4!==hc&&(hc=2)),!1;var s=Error(o(520),{cause:n});if(s=Rn(s,r),null===Cc?Cc=[s]:Cc.push(s),4!==hc&&(hc=2),null===t)return!0;n=Rn(n,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=i&-i,r.lanes|=e,as(r,e=Ea(r.stateNode,n,e)),!1;case 1:if(t=r.type,s=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Rc||!Rc.has(s))))return r.flags|=65536,i&=-i,r.lanes|=i,Ta(i=Ra(i),e,r,n),as(r,i),!1}r=r.return}while(null!==r);return!1}(e,i,t,r,sc))return hc=1,ya(e,Rn(r,e.current)),void(ic=null)}catch(s){if(null!==i)throw ic=i,s;return hc=1,ya(e,Rn(r,e.current)),void(ic=null)}32768&t.flags?(si||1===n?e=!0:cc||0!==(536870912&sc)?e=!1:(lc=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=ia.current)&&13===n.tag&&(n.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var r=nl(t.alternate,t,dc);if(null!==r)return void(ic=r);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var r=il(e.alternate,e);if(null!==r)return r.flags&=32767,void(ic=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=r}while(null!==e);hc=6,ic=null}function ru(e,t,r,n,i,s,a,l,c){e.cancelPendingCommit=null;do{au()}while(0!==Tc);if(0!==(6&rc))throw Error(o(327));if(null!==t){if(t===e.current)throw Error(o(177));if(s=t.lanes|t.childLanes,function(e,t,r,n,i,s){var o=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=o&~r;0<r;){var u=31-pe(r),d=1<<u;a[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}r&=~d}0!==n&&xe(e,n,0),0!==s&&0===i&&0!==e.tag&&(e.suspendedLanes|=s&~(o&~t))}(e,r,s|=kn,a,l,c),e===nc&&(ic=nc=null,sc=0),kc=t,xc=e,Pc=r,Ac=s,Fc=i,Dc=n,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,J(se,(function(){return lu(),null}))):(e.callbackNode=null,e.callbackPriority=0),n=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||n){n=O.T,O.T=null,i=L.p,L.p=2,a=rc,rc|=4;try{!function(e,t){if(e=e.containerInfo,td=rh,en(e=Zr(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(m){r=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var g;h!==r||0!==i&&3!==h.nodeType||(l=a+i),h!==s||0!==n&&3!==h.nodeType||(c=a+n),3===h.nodeType&&(a+=h.nodeValue.length),null!==(g=h.firstChild);)p=h,h=g;for(;;){if(h===e)break t;if(p===r&&++u===i&&(l=a),p===s&&++d===n&&(c=a),null!==(g=h.nextSibling))break;p=(h=p).parentNode}h=g}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(rd={focusedElem:e,selectionRange:r},rh=!1,El=t;null!==El;)if(e=(t=El).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,El=e;else for(;null!==El;){switch(s=(t=El).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,r=t,i=s.memoizedProps,s=s.memoizedState,n=r.stateNode;try{var f=ma(r.type,i,(r.elementType,r.type));e=n.getSnapshotBeforeUpdate(f,s),n.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(r,r.return,v)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))fd(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":fd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,El=e;break}El=t.return}}(e,t)}finally{rc=a,L.p=i,O.T=n}}Tc=1,nu(),iu(),su()}}function nu(){if(1===Tc){Tc=0;var e=xc,t=kc,r=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null;var n=L.p;L.p=2;var i=rc;rc|=4;try{Ol(t,e);var s=rd,o=Zr(e.containerInfo),a=s.focusedElem,l=s.selectionRange;if(o!==a&&a&&a.ownerDocument&&Qr(a.ownerDocument.documentElement,a)){if(null!==l&&en(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var d=a.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),g=a.textContent.length,f=Math.min(l.start,g),m=void 0===l.end?f:Math.min(l.end,g);!p.extend&&f>m&&(o=m,m=f,f=o);var v=Jr(a,f),C=Jr(a,m);if(v&&C&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==C.node||p.focusOffset!==C.offset)){var w=d.createRange();w.setStart(v.node,v.offset),p.removeAllRanges(),f>m?(p.addRange(w),p.extend(C.node,C.offset)):(w.setEnd(C.node,C.offset),p.addRange(w))}}}}for(d=[],p=a;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<d.length;a++){var b=d[a];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}rh=!!td,rd=td=null}finally{rc=i,L.p=n,O.T=r}}e.current=t,Tc=2}}function iu(){if(2===Tc){Tc=0;var e=xc,t=kc,r=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||r){r=O.T,O.T=null;var n=L.p;L.p=2;var i=rc;rc|=4;try{Rl(e,t.alternate,t)}finally{rc=i,L.p=n,O.T=r}}Tc=3}}function su(){if(4===Tc||3===Tc){Tc=0,ee();var e=xc,t=kc,r=Pc,n=Dc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Tc=5:(Tc=0,kc=xc=null,ou(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Rc=null),Ae(r),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==n){t=O.T,i=L.p,L.p=2,O.T=null;try{for(var s=e.onRecoverableError,o=0;o<n.length;o++){var a=n[o];s(a.value,{componentStack:a.stack})}}finally{O.T=t,L.p=i}}0!==(3&Pc)&&au(),Su(e),i=e.pendingLanes,0!==(4194090&r)&&0!==(42&i)?e===Mc?Ic++:(Ic=0,Mc=e):Ic=0,Eu(0,!1)}}function ou(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Oi(t)))}function au(e){return nu(),iu(),su(),lu()}function lu(){if(5!==Tc)return!1;var e=xc,t=Ac;Ac=0;var r=Ae(Pc),n=O.T,i=L.p;try{L.p=32>r?32:r,O.T=null,r=Fc,Fc=null;var s=xc,a=Pc;if(Tc=0,kc=xc=null,Pc=0,0!==(6&rc))throw Error(o(331));var l=rc;if(rc|=4,Jl(s.current),Wl(s,s.current,a,r),rc=l,Eu(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,s)}catch(c){}return!0}finally{L.p=i,O.T=n,ou(e,t)}}function cu(e,t,r){t=Rn(r,t),null!==(e=ss(e,t=Ea(e.stateNode,t,2),2))&&(Te(e,2),Su(e))}function uu(e,t,r){if(3===e.tag)cu(e,e,r);else for(;null!==t;){if(3===t.tag){cu(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Rc||!Rc.has(n))){e=Rn(r,e),null!==(n=ss(t,r=Ra(2),2))&&(Ta(r,n,t,e),Te(n,2),Su(n));break}}t=t.return}}function du(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new tc;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(uc=!0,i.add(r),e=hu.bind(null,e,t,r),t.then(e,e))}function hu(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,nc===e&&(sc&r)===r&&(4===hc||3===hc&&(62914560&sc)===sc&&300>te()-yc?0===(2&rc)&&Wc(e,0):fc|=r,vc===sc&&(vc=0)),Su(e)}function pu(e,t){0===t&&(t=Ee()),null!==(e=Dn(e,t))&&(Te(e,t),Su(e))}function gu(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),pu(e,r)}function fu(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==n&&n.delete(t),pu(e,r)}var mu=null,vu=null,Cu=!1,wu=!1,bu=!1,yu=0;function Su(e){e!==vu&&null===e.next&&(null===vu?mu=vu=e:vu=vu.next=e),wu=!0,Cu||(Cu=!0,dd((function(){0!==(6&rc)?J(ne,Ru):Tu()})))}function Eu(e,t){if(!bu&&wu){bu=!0;do{for(var r=!1,n=mu;null!==n;){if(!t)if(0!==e){var i=n.pendingLanes;if(0===i)var s=0;else{var o=n.suspendedLanes,a=n.pingedLanes;s=(1<<31-pe(42|e)+1)-1,s=201326741&(s&=i&~(o&~a))?201326741&s|1:s?2|s:0}0!==s&&(r=!0,Pu(n,s))}else s=sc,0===(3&(s=we(n,n===nc?s:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||be(n,s)||(r=!0,Pu(n,s));n=n.next}}while(r);bu=!1}}function Ru(){Tu()}function Tu(){wu=Cu=!1;var e=0;0!==yu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ad&&(ad=e,!0);return ad=null,!1}()&&(e=yu),yu=0);for(var t=te(),r=null,n=mu;null!==n;){var i=n.next,s=xu(n,t);0===s?(n.next=null,null===r?mu=i:r.next=i,null===i&&(vu=r)):(r=n,(0!==e||0!==(3&s))&&(wu=!0)),n=i}Eu(e,!1)}function xu(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var o=31-pe(s),a=1<<o,l=i[o];-1===l?0!==(a&r)&&0===(a&n)||(i[o]=ye(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}if(r=sc,r=we(e,e===(t=nc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===r||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&Q(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||be(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==n&&Q(n),Ae(r)){case 2:case 8:r=ie;break;case 32:default:r=se;break;case 268435456:r=ae}return n=ku.bind(null,e),r=J(r,n),e.callbackPriority=t,e.callbackNode=r,t}return null!==n&&null!==n&&Q(n),e.callbackPriority=2,e.callbackNode=null,2}function ku(e,t){if(0!==Tc&&5!==Tc)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(au()&&e.callbackNode!==r)return null;var n=sc;return 0===(n=we(e,e===nc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(_c(e,n,t),xu(e,te()),null!=e.callbackNode&&e.callbackNode===r?ku.bind(null,e):null)}function Pu(e,t){if(au())return null;_c(e,t,!0)}function Au(){return 0===yu&&(yu=Se()),yu}function Fu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:At(""+e)}function Du(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Iu=0;Iu<yn.length;Iu++){var Mu=yn[Iu];Sn(Mu.toLowerCase(),"on"+(Mu[0].toUpperCase()+Mu.slice(1)))}Sn(pn,"onAnimationEnd"),Sn(gn,"onAnimationIteration"),Sn(fn,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(mn,"onTransitionRun"),Sn(vn,"onTransitionStart"),Sn(Cn,"onTransitionCancel"),Sn(wn,"onTransitionEnd"),qe("onMouseEnter",["mouseout","mouseover"]),qe("onMouseLeave",["mouseout","mouseover"]),qe("onPointerEnter",["pointerout","pointerover"]),qe("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ou));function Nu(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){va(u)}i.currentTarget=null,s=l}else for(o=0;o<n.length;o++){if(l=(a=n[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;s=a,i.currentTarget=c;try{s(i)}catch(u){va(u)}i.currentTarget=null,s=l}}}}function _u(e,t){var r=t[Le];void 0===r&&(r=t[Le]=new Set);var n=e+"__bubble";r.has(n)||(zu(t,e,2,!1),r.add(n))}function Gu(e,t,r){var n=0;t&&(n|=4),zu(r,e,n,t)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function Hu(e){if(!e[Bu]){e[Bu]=!0,$e.forEach((function(t){"selectionchange"!==t&&(Lu.has(t)||Gu(t,!1,e),Gu(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bu]||(t[Bu]=!0,Gu("selectionchange",!1,t))}}function zu(e,t,r,n){switch(ch(t)){case 2:var i=nh;break;case 8:i=ih;break;default:i=sh}r=i.bind(null,t,r,e),i=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Vu(e,t,r,n,i){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var a=n.stateNode.containerInfo;if(a===i)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&o.stateNode.containerInfo===i)return;o=o.return}for(;null!==a;){if(null===(o=ze(a)))return;if(5===(c=o.tag)||6===c||26===c||27===c){n=s=o;continue e}a=a.parentNode}}n=n.return}Nt((function(){var n=s,i=Dt(r),o=[];e:{var a=bn.get(e);if(void 0!==a){var c=Zt,u=e;switch(e){case"keypress":if(0===jt(r))break e;case"keydown":case"keyup":c=gr;break;case"focusin":u="focus",c=sr;break;case"focusout":u="blur",c=sr;break;case"beforeblur":case"afterblur":c=sr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ir;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=mr;break;case pn:case gn:case fn:c=or;break;case wn:c=vr;break;case"scroll":case"scrollend":c=tr;break;case"wheel":c=Cr;break;case"copy":case"cut":case"paste":c=ar;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=fr;break;case"toggle":case"beforetoggle":c=wr}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==a?a+"Capture":null:a;d=[];for(var g,f=n;null!==f;){var m=f;if(g=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===g||null===p||null!=(m=_t(f,p))&&d.push(Wu(f,m,g)),h)break;f=f.return}0<d.length&&(a=new c(a,u,null,r,i),o.push({event:a,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||r===Ft||!(u=r.relatedTarget||r.fromElement)||!ze(u)&&!u[Oe])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=n,null!==(u=(u=r.relatedTarget||r.toElement)?ze(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=n),c!==u)){if(d=nr,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=fr,m="onPointerLeave",p="onPointerEnter",f="pointer"),h=null==c?a:We(c),g=null==u?a:We(u),(a=new d(m,f+"leave",c,r,i)).target=h,a.relatedTarget=g,m=null,ze(i)===n&&((d=new d(p,f+"enter",u,r,i)).target=g,d.relatedTarget=h,m=d),h=m,c&&u)e:{for(p=u,f=0,g=d=c;g;g=ju(g))f++;for(g=0,m=p;m;m=ju(m))g++;for(;0<f-g;)d=ju(d),f--;for(;0<g-f;)p=ju(p),g--;for(;f--;){if(d===p||null!==p&&d===p.alternate)break e;d=ju(d),p=ju(p)}d=null}else d=null;null!==c&&$u(o,a,c,d,!1),null!==u&&null!==h&&$u(o,h,u,d,!0)}if("select"===(c=(a=n?We(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var v=_r;else if(Dr(a))if(Gr)v=Kr;else{v=jr;var C=Ur}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?n&&xt(n.elementType)&&(v=_r):v=$r;switch(v&&(v=v(e,n))?Ir(o,v,r,i):(C&&C(e,a,n),"focusout"===e&&n&&"number"===a.type&&null!=n.memoizedProps.value&&Ct(a,"number",a.value)),C=n?We(n):window,e){case"focusin":(Dr(C)||"true"===C.contentEditable)&&(rn=C,nn=n,sn=null);break;case"focusout":sn=nn=rn=null;break;case"mousedown":on=!0;break;case"contextmenu":case"mouseup":case"dragend":on=!1,an(o,r,i);break;case"selectionchange":if(tn)break;case"keydown":case"keyup":an(o,r,i)}var w;if(yr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Ar?kr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Rr&&"ko"!==r.locale&&(Ar||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ar&&(w=Ut()):(Vt="value"in(zt=i)?zt.value:zt.textContent,Ar=!0)),0<(C=Uu(n,b)).length&&(b=new lr(b,e,null,r,i),o.push({event:b,listeners:C}),w?b.data=w:null!==(w=Pr(r))&&(b.data=w))),(w=Er?function(e,t){switch(e){case"compositionend":return Pr(t);case"keypress":return 32!==t.which?null:(xr=!0,Tr);case"textInput":return(e=t.data)===Tr&&xr?null:e;default:return null}}(e,r):function(e,t){if(Ar)return"compositionend"===e||!yr&&kr(e,t)?(e=Ut(),Wt=Vt=zt=null,Ar=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(b=Uu(n,"onBeforeInput")).length&&(C=new lr("onBeforeInput","beforeinput",null,r,i),o.push({event:C,listeners:b}),C.data=w)),function(e,t,r,n,i){if("submit"===t&&r&&r.stateNode===i){var s=Fu((i[Me]||null).action),o=n.submitter;o&&null!==(t=(t=o[Me]||null)?Fu(t.formAction):o.getAttribute("formAction"))&&(s=t,o=null);var a=new Zt("action","action",null,n,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==yu){var e=o?Du(i,o):new FormData(i);Do(r,{pending:!0,data:e,method:i.method,action:s},null,e)}}else"function"===typeof s&&(a.preventDefault(),e=o?Du(i,o):new FormData(i),Do(r,{pending:!0,data:e,method:i.method,action:s},s,e))},currentTarget:i}]})}}(o,e,n,r,i)}Nu(o,t)}))}function Wu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Uu(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,s=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===s||(null!=(i=_t(e,r))&&n.unshift(Wu(e,i,s)),null!=(i=_t(e,t))&&n.push(Wu(e,i,s))),3===e.tag)return n;e=e.return}return[]}function ju(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function $u(e,t,r,n,i){for(var s=t._reactName,o=[];null!==r&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===n)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=_t(r,s))&&o.unshift(Wu(r,c,l)):i||null!=(c=_t(r,s))&&o.push(Wu(r,c,l))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var Ku=/\r\n?/g,Yu=/\u0000|\uFFFD/g;function qu(e){return("string"===typeof e?e:""+e).replace(Ku,"\n").replace(Yu,"")}function Xu(e,t){return t=qu(t),qu(e)===t}function Ju(){}function Qu(e,t,r,n,i,s){switch(r){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||St(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&St(e,""+n);break;case"className":rt(e,"class",n);break;case"tabIndex":rt(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":rt(e,r,n);break;case"style":Tt(e,n,s);break;case"data":if("object"!==t){rt(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=At(""+n),e.setAttribute(r,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===r?("input"!==t&&Qu(e,t,"name",i.name,i,null),Qu(e,t,"formEncType",i.formEncType,i,null),Qu(e,t,"formMethod",i.formMethod,i,null),Qu(e,t,"formTarget",i.formTarget,i,null)):(Qu(e,t,"encType",i.encType,i,null),Qu(e,t,"method",i.method,i,null),Qu(e,t,"target",i.target,i,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(r);break}n=At(""+n),e.setAttribute(r,n);break;case"onClick":null!=n&&(e.onclick=Ju);break;case"onScroll":null!=n&&_u("scroll",e);break;case"onScrollEnd":null!=n&&_u("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(o(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=r}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}r=At(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""+n):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===n?e.setAttribute(r,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(r,n):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(r,n):e.removeAttribute(r);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(r):e.setAttribute(r,n);break;case"popover":_u("beforetoggle",e),_u("toggle",e),tt(e,"popover",n);break;case"xlinkActuate":nt(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":nt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":nt(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":nt(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":nt(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":nt(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":nt(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":nt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":nt(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":tt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&tt(e,r=kt.get(r)||r,n)}}function Zu(e,t,r,n,i,s){switch(r){case"style":Tt(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(o(61));if(null!=(r=n.__html)){if(null!=i.children)throw Error(o(60));e.innerHTML=r}}break;case"children":"string"===typeof n?St(e,n):("number"===typeof n||"bigint"===typeof n)&&St(e,""+n);break;case"onScroll":null!=n&&_u("scroll",e);break;case"onScrollEnd":null!=n&&_u("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(i=r.endsWith("Capture"),t=r.slice(2,i?r.length-7:void 0),"function"===typeof(s=null!=(s=e[Me]||null)?s[r]:null)&&e.removeEventListener(t,s,i),"function"!==typeof n)?r in e?e[r]=n:!0===n?e.setAttribute(r,""):tt(e,r,n):("function"!==typeof s&&null!==s&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,n,i)))}}function ed(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_u("error",e),_u("load",e);var n,i=!1,s=!1;for(n in r)if(r.hasOwnProperty(n)){var a=r[n];if(null!=a)switch(n){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Qu(e,t,n,a,r,null)}}return s&&Qu(e,t,"srcSet",r.srcSet,r,null),void(i&&Qu(e,t,"src",r.src,r,null));case"input":_u("invalid",e);var l=n=a=s=null,c=null,u=null;for(i in r)if(r.hasOwnProperty(i)){var d=r[i];if(null!=d)switch(i){case"name":s=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":n=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(o(137,t));break;default:Qu(e,t,i,d,r,null)}}return vt(e,n,l,c,u,a,s,!1),void dt(e);case"select":for(s in _u("invalid",e),i=a=n=null,r)if(r.hasOwnProperty(s)&&null!=(l=r[s]))switch(s){case"value":n=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Qu(e,t,s,l,r,null)}return t=n,r=a,e.multiple=!!i,void(null!=t?wt(e,!!i,t,!1):null!=r&&wt(e,!!i,r,!0));case"textarea":for(a in _u("invalid",e),n=s=i=null,r)if(r.hasOwnProperty(a)&&null!=(l=r[a]))switch(a){case"value":i=l;break;case"defaultValue":s=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(o(91));break;default:Qu(e,t,a,l,r,null)}return yt(e,i,s,n),void dt(e);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(i=r[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Qu(e,t,c,i,r,null);return;case"dialog":_u("beforetoggle",e),_u("toggle",e),_u("cancel",e),_u("close",e);break;case"iframe":case"object":_u("load",e);break;case"video":case"audio":for(i=0;i<Ou.length;i++)_u(Ou[i],e);break;case"image":_u("error",e),_u("load",e);break;case"details":_u("toggle",e);break;case"embed":case"source":case"link":_u("error",e),_u("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in r)if(r.hasOwnProperty(u)&&null!=(i=r[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:Qu(e,t,u,i,r,null)}return;default:if(xt(t)){for(d in r)r.hasOwnProperty(d)&&(void 0!==(i=r[d])&&Zu(e,t,d,i,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(i=r[l])&&Qu(e,t,l,i,r,null))}var td=null,rd=null;function nd(e){return 9===e.nodeType?e:e.ownerDocument}function id(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function od(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ad=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout((function(){throw e}))}function pd(e){return"head"===e}function gd(e,t){var r=t,n=0,i=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&8===s.nodeType)if("/$"===(r=s.data)){if(0<n&&8>n){r=n;var o=e.ownerDocument;if(1&r&&yd(o.documentElement),2&r&&yd(o.body),4&r)for(yd(r=o.head),o=r.firstChild;o;){var a=o.nextSibling,l=o.nodeName;o[Be]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===o.rel.toLowerCase()||r.removeChild(o),o=a}}if(0===i)return e.removeChild(s),void kh(t);i--}else"$"===r||"$?"===r||"$!"===r?i++:n=r.charCodeAt(0)-48;else n=0;r=s}while(r);kh(t)}function fd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":fd(r),He(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function md(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var Cd=null;function wd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}function bd(e,t,r){switch(t=nd(r),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}function yd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);He(e)}var Sd=new Map,Ed=new Set;function Rd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Td=L.d;L.d={f:function(){var e=Td.f(),t=zc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Mo(t):Td.r(e)},D:function(e){Td.D(e),kd("dns-prefetch",e,null)},C:function(e,t){Td.C(e,t),kd("preconnect",e,t)},L:function(e,t,r){Td.L(e,t,r);var n=xd;if(n&&e&&t){var i='link[rel="preload"][as="'+ft(t)+'"]';"image"===t&&r&&r.imageSrcSet?(i+='[imagesrcset="'+ft(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(i+='[imagesizes="'+ft(r.imageSizes)+'"]')):i+='[href="'+ft(e)+'"]';var s=i;switch(t){case"style":s=Ad(e);break;case"script":s=Id(e)}Sd.has(s)||(e=h({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Sd.set(s,e),null!==n.querySelector(i)||"style"===t&&n.querySelector(Fd(s))||"script"===t&&n.querySelector(Md(s))||(ed(t=n.createElement("link"),"link",e),je(t),n.head.appendChild(t)))}},m:function(e,t){Td.m(e,t);var r=xd;if(r&&e){var n=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+ft(n)+'"][href="'+ft(e)+'"]',s=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Id(e)}if(!Sd.has(s)&&(e=h({rel:"modulepreload",href:e},t),Sd.set(s,e),null===r.querySelector(i))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Md(s)))return}ed(n=r.createElement("link"),"link",e),je(n),r.head.appendChild(n)}}},X:function(e,t){Td.X(e,t);var r=xd;if(r&&e){var n=Ue(r).hoistableScripts,i=Id(e),s=n.get(i);s||((s=r.querySelector(Md(i)))||(e=h({src:e,async:!0},t),(t=Sd.get(i))&&_d(e,t),je(s=r.createElement("script")),ed(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(i,s))}},S:function(e,t,r){Td.S(e,t,r);var n=xd;if(n&&e){var i=Ue(n).hoistableStyles,s=Ad(e);t=t||"default";var o=i.get(s);if(!o){var a={loading:0,preload:null};if(o=n.querySelector(Fd(s)))a.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Sd.get(s))&&Nd(e,r);var l=o=n.createElement("link");je(l),ed(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Ld(o,t,n)}o={type:"stylesheet",instance:o,count:1,state:a},i.set(s,o)}}},M:function(e,t){Td.M(e,t);var r=xd;if(r&&e){var n=Ue(r).hoistableScripts,i=Id(e),s=n.get(i);s||((s=r.querySelector(Md(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Sd.get(i))&&_d(e,t),je(s=r.createElement("script")),ed(s,"link",e),r.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(i,s))}}};var xd="undefined"===typeof document?null:document;function kd(e,t,r){var n=xd;if(n&&"string"===typeof t&&t){var i=ft(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof r&&(i+='[crossorigin="'+r+'"]'),Ed.has(i)||(Ed.add(i),e={rel:e,crossOrigin:r,href:t},null===n.querySelector(i)&&(ed(t=n.createElement("link"),"link",e),je(t),n.head.appendChild(t)))}}function Pd(e,t,r,n){var i,s,a,l,c=(c=U.current)?Rd(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=Ad(r.href),(n=(r=Ue(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=Ad(r.href);var u=Ue(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Fd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Sd.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Sd.set(e,r),u||(i=c,s=e,a=r,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=i.createElement("link"),l.preload=s,s.addEventListener("load",(function(){return l.loading|=1})),s.addEventListener("error",(function(){return l.loading|=2})),ed(s,"link",a),je(s),i.head.appendChild(s))))),t&&null===n)throw Error(o(528,""));return d}if(t&&null!==n)throw Error(o(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Id(r),(n=(r=Ue(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},r.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function Ad(e){return'href="'+ft(e)+'"'}function Fd(e){return'link[rel="stylesheet"]['+e+"]"}function Dd(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Id(e){return'[src="'+ft(e)+'"]'}function Md(e){return"script[async]"+e}function Od(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+ft(r.href)+'"]');if(n)return t.instance=n,je(n),n;var i=h({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return je(n=(e.ownerDocument||e).createElement("style")),ed(n,"style",i),Ld(n,r.precedence,e),t.instance=n;case"stylesheet":i=Ad(r.href);var s=e.querySelector(Fd(i));if(s)return t.state.loading|=4,t.instance=s,je(s),s;n=Dd(r),(i=Sd.get(i))&&Nd(n,i),je(s=(e.ownerDocument||e).createElement("link"));var a=s;return a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),ed(s,"link",n),t.state.loading|=4,Ld(s,r.precedence,e),t.instance=s;case"script":return s=Id(r.src),(i=e.querySelector(Md(s)))?(t.instance=i,je(i),i):(n=r,(i=Sd.get(s))&&_d(n=h({},r),i),je(i=(e=e.ownerDocument||e).createElement("script")),ed(i,"link",n),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,Ld(n,r.precedence,e));return t.instance}function Ld(e,t,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,s=i,o=0;o<n.length;o++){var a=n[o];if(a.dataset.precedence===t)s=a;else if(s!==i)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Nd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function _d(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Gd=null;function Bd(e,t,r){if(null===Gd){var n=new Map,i=Gd=new Map;i.set(r,n)}else(n=(i=Gd).get(r))||(n=new Map,i.set(r,n));if(n.has(e))return n;for(n.set(e,null),r=r.getElementsByTagName(e),i=0;i<r.length;i++){var s=r[i];if(!(s[Be]||s[Ie]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var o=s.getAttribute(t)||"";o=e+o;var a=n.get(o);a?a.push(s):n.set(o,[s])}}return n}function Hd(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function zd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Vd=null;function Wd(){}function Ud(){if(this.count--,0===this.count)if(this.stylesheets)$d(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var jd=null;function $d(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,jd=new Map,t.forEach(Kd,e),jd=null,Ud.call(e))}function Kd(e,t){if(!(4&t.state.loading)){var r=jd.get(e);if(r)var n=r.get(null);else{r=new Map,jd.set(e,r);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<i.length;s++){var o=i[s];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(r.set(o.dataset.precedence,o),n=o)}n&&r.set(null,n)}o=(i=t.instance).getAttribute("data-precedence"),(s=r.get(o)||n)===n&&r.set(null,i),r.set(o,i),this.count++,n=Ud.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),s?s.parentNode.insertBefore(i,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Yd={$$typeof:y,Provider:null,Consumer:null,_currentValue:N,_currentValue2:N,_threadCount:0};function qd(e,t,r,n,i,s,o,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Re(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Re(0),this.hiddenUpdates=Re(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=s,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Xd(e,t,r,n,i,s,o,a,l,c,u,d){return e=new qd(e,t,r,o,a,l,c,d),t=1,!0===s&&(t|=24),s=Nn(3,null,null,t),e.current=s,s.stateNode=e,(t=Mi()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:n,isDehydrated:r,cache:t},rs(s),e}function Jd(e){return e?e=On:On}function Qd(e,t,r,n,i,s){i=Jd(i),null===n.context?n.context=i:n.pendingContext=i,(n=is(t)).payload={element:r},null!==(s=void 0===s?null:s)&&(n.callback=s),null!==(r=ss(e,n,t))&&(Nc(r,0,t),os(r,e,t))}function Zd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function eh(e,t){Zd(e,t),(e=e.alternate)&&Zd(e,t)}function th(e){if(13===e.tag){var t=Dn(e,67108864);null!==t&&Nc(t,0,67108864),eh(e,67108864)}}var rh=!0;function nh(e,t,r,n){var i=O.T;O.T=null;var s=L.p;try{L.p=2,sh(e,t,r,n)}finally{L.p=s,O.T=i}}function ih(e,t,r,n){var i=O.T;O.T=null;var s=L.p;try{L.p=8,sh(e,t,r,n)}finally{L.p=s,O.T=i}}function sh(e,t,r,n){if(rh){var i=oh(n);if(null===i)Vu(e,t,n,ah,r),Ch(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return dh=wh(dh,e,t,r,n,i),!0;case"dragenter":return hh=wh(hh,e,t,r,n,i),!0;case"mouseover":return ph=wh(ph,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return gh.set(s,wh(gh.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,fh.set(s,wh(fh.get(s)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Ch(e,n),4&t&&-1<vh.indexOf(e)){for(;null!==i;){var s=Ve(i);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var o=Ce(s.pendingLanes);if(0!==o){var a=s;for(a.pendingLanes|=2,a.entangledLanes|=2;o;){var l=1<<31-pe(o);a.entanglements[1]|=l,o&=~l}Su(s),0===(6&rc)&&(Sc=te()+500,Eu(0,!1))}}break;case 13:null!==(a=Dn(s,2))&&Nc(a,0,2),zc(),eh(s,2)}if(null===(s=oh(n))&&Vu(e,t,n,ah,r),s===i)break;i=s}null!==i&&n.stopPropagation()}else Vu(e,t,n,null,r)}}function oh(e){return lh(e=Dt(e))}var ah=null;function lh(e){if(ah=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ah=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(re()){case ne:return 2;case ie:return 8;case se:case oe:return 32;case ae:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,ph=null,gh=new Map,fh=new Map,mh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ch(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":ph=null;break;case"pointerover":case"pointerout":gh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fh.delete(t.pointerId)}}function wh(e,t,r,n,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Ve(t))&&th(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function bh(e){var t=ze(e.target);if(null!==t){var r=l(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void function(e,t){var r=L.p;try{return L.p=e,t()}finally{L.p=r}}(e.priority,(function(){if(13===r.tag){var e=Oc();e=Pe(e);var t=Dn(r,e);null!==t&&Nc(t,0,e),eh(r,e)}}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function yh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=oh(e.nativeEvent);if(null!==r)return null!==(t=Ve(r))&&th(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Ft=n,r.target.dispatchEvent(n),Ft=null,t.shift()}return!0}function Sh(e,t,r){yh(e)&&r.delete(t)}function Eh(){uh=!1,null!==dh&&yh(dh)&&(dh=null),null!==hh&&yh(hh)&&(hh=null),null!==ph&&yh(ph)&&(ph=null),gh.forEach(Sh),fh.forEach(Sh)}function Rh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Eh)))}var Th=null;function xh(e){Th!==e&&(Th=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,(function(){Th===e&&(Th=null);for(var t=0;t<e.length;t+=3){var r=e[t],n=e[t+1],i=e[t+2];if("function"!==typeof n){if(null===lh(n||r))continue;break}var s=Ve(r);null!==s&&(e.splice(t,3),t-=3,Do(s,{pending:!0,data:i,method:r.method,action:n},n,i))}})))}function kh(e){function t(t){return Rh(t,e)}null!==dh&&Rh(dh,e),null!==hh&&Rh(hh,e),null!==ph&&Rh(ph,e),gh.forEach(t),fh.forEach(t);for(var r=0;r<mh.length;r++){var n=mh[r];n.blockedOn===e&&(n.blockedOn=null)}for(;0<mh.length&&null===(r=mh[0]).blockedOn;)bh(r),null===r.blockedOn&&mh.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<r.length;n+=3){var i=r[n],s=r[n+1],o=i[Me]||null;if("function"===typeof s)o||xh(r);else if(o){var a=null;if(s&&s.hasAttribute("formAction")){if(i=s,o=s[Me]||null)a=o.formAction;else if(null!==lh(i))continue}else a=o.action;"function"===typeof a?r[n+1]=a:(r.splice(n,3),n-=3),xh(r)}}}function Ph(e){this._internalRoot=e}function Ah(e){this._internalRoot=e}Ah.prototype.render=Ph.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Qd(t.current,Oc(),e,t,null,null)},Ah.prototype.unmount=Ph.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Qd(e.current,2,null,e,null,null),zc(),t[Oe]=null}},Ah.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var r=0;r<mh.length&&0!==t&&t<mh[r].priority;r++);mh.splice(r,0,e),0===r&&bh(e)}};var Fh=i.version;if("19.1.0"!==Fh)throw Error(o(527,Fh,"19.1.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return u(i),e;if(s===n)return u(i),t;s=s.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,c=i.child;c;){if(c===r){a=!0,r=i,n=s;break}if(c===n){a=!0,n=i,r=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===r){a=!0,r=s,n=i;break}if(c===n){a=!0,n=s,r=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Dh={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ih=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ih.isDisabled&&Ih.supportsFiber)try{ue=Ih.inject(Dh),de=Ih}catch(Oh){}}t.createRoot=function(e,t){if(!a(e))throw Error(o(299));var r=!1,n="",i=Ca,s=wa,l=ba;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Xd(e,1,!1,null,0,r,n,i,s,l,0,null),e[Oe]=t.current,Hu(e),new Ph(t)},t.hydrateRoot=function(e,t,r){if(!a(e))throw Error(o(299));var n=!1,i="",s=Ca,l=wa,c=ba,u=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onUncaughtError&&(s=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.unstable_transitionCallbacks&&r.unstable_transitionCallbacks,void 0!==r.formState&&(u=r.formState)),(t=Xd(e,1,!0,t,0,n,i,s,l,c,0,u)).context=Jd(null),r=t.current,(i=is(n=Pe(n=Oc()))).callback=null,ss(r,i,n),r=n,t.current.lanes=r,Te(t,r),Su(t),e[Oe]=t.current,Hu(e),new Ah(t)},t.version="19.1.0"},43:(e,t,r)=>{e.exports=r(288)},210:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(829)),s=n(r(736)),o=r(745);class a{constructor(e){let{headers:t={},schema:r,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:i=!1,count:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new URL(`${this.url}/rpc/${e}`);let l;n||i?(t=n?"HEAD":"GET",Object.entries(r).filter((e=>{let[t,r]=e;return void 0!==r})).map((e=>{let[t,r]=e;return[t,Array.isArray(r)?`{${r.join(",")}}`:`${r}`]})).forEach((e=>{let[t,r]=e;a.searchParams.append(t,r)}))):(t="POST",l=r);const c=Object.assign({},this.headers);return o&&(c.Prefer=`count=${o}`),new s.default({method:t,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=a},286:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(630)),s=n(r(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,r,n;let i=null,o=null,a=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(o="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&s&&s.length>1&&(a=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,l=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,l=200,c="OK")}catch(u){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null===i||void 0===i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new s.default(i)}return{error:i,data:o,count:a,status:l,statusText:c}}));return this.shouldThrowOnError||(r=r.catch((e=>{var t,r,n;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}}))),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},288:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||g}function C(){}function w(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},C.prototype=v.prototype;var b=w.prototype=new C;b.constructor=w,f(b,v.prototype),b.isPureReactComponent=!0;var y=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},E=Object.prototype.hasOwnProperty;function R(e,t,n,i,s,o){return n=o.ref,{$$typeof:r,type:e,key:t,ref:void 0!==n?n:null,props:o}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var x=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(){}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0;break;case h:return A((u=e._init)(e._payload),t,i,s,o)}}if(u)return o=o(e),u=""===s?"."+k(e,0):s,y(o)?(i="",null!=u&&(i=u.replace(x,"$&/")+"/"),A(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(l=o,c=i+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(x,"$&/")+"/")+u,o=R(l.type,c,void 0,0,0,l.props)),t.push(o)),1;u=0;var d,g=""===s?".":s+":";if(y(e))for(var f=0;f<e.length;f++)u+=A(s=e[f],t,i,a=g+k(s,f),o);else if("function"===typeof(f=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=p&&d[p]||d["@@iterator"])?d:null))for(e=f.call(e),f=0;!(s=e.next()).done;)u+=A(s=s.value,t,i,a=g+k(s,f++),o);else if("object"===a){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(P,P):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,s,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function F(e,t,r){if(null==e)return e;var n=[],i=0;return A(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function M(){}t.Children={map:F,forEach:function(e,t,r){F(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return F(e,(function(){t++})),t},toArray:function(e){return F(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=w,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=f({},e.props),i=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!E.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(n[s]=t[s]);var s=arguments.length-2;if(1===s)n.children=r;else if(1<s){for(var o=Array(s),a=0;a<s;a++)o[a]=arguments[a+2];n.children=o}return R(e.type,i,void 0,0,0,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,r){var n,i={},s=null;if(null!=t)for(n in void 0!==t.key&&(s=""+t.key),t)E.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(i[n]=t[n]);var o=arguments.length-2;if(1===o)i.children=r;else if(1<o){for(var a=Array(o),l=0;l<o;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===i[n]&&(i[n]=o[n]);return R(e,s,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,r={};S.T=r;try{var n=e(),i=S.S;null!==i&&i(r,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(M,I)}catch(s){I(s)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,r){return S.H.useActionState(e,t,r)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,r){var n=S.H;if("function"===typeof r)throw Error("useEffect CRUD overload is not enabled in this build of React.");return n.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,r){return S.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return S.H.useReducer(e,t,r)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return S.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.0"},374:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(286));class s extends i.default{select(e){let t=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t){let{foreignTable:r,referencedTable:n=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i="undefined"===typeof n?"offset":`${n}.offset`,s="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=s},391:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4)},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},579:(e,t,r)=>{e.exports=r(799)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},630:(e,t,r)=>{r.r(t),r.d(t,{Headers:()=>o,Request:()=>a,Response:()=>l,default:()=>s,fetch:()=>i});var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();const i=n.fetch,s=n.fetch.bind(n),o=n.Headers,a=n.Request,l=n.Response},672:(e,t,r)=>{var n=r(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var o={d:{f:s,r:function(){throw Error(i(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=o.p;try{if(l.T=null,o.p=2,e)return e()}finally{l.T=t,o.p=r,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:i,fetchPriority:s}):"script"===r&&o.d.X(e,{crossOrigin:n,integrity:i,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,n=c(r,t.crossOrigin);o.d.L(e,r,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},736:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(374));class s extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:r,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");const s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,r]=e;this.url.searchParams.append(t,`eq.${r}`)})),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=s},745:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const n=r(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},799:(e,t)=>{var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function i(e,t,n){var i=null;if(void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),"key"in t)for(var s in n={},t)"key"!==s&&(n[s]=t[s]);else n=t;return t=n.ref,{$$typeof:r,type:e,key:i,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=i,t.jsxs=i},829:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(736));t.default=class{constructor(e,t){let{headers:r={},schema:n,fetch:i}=t;this.url=e,this.headers=r,this.schema=n,this.fetch=i}select(e){let{head:t=!1,count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?"HEAD":"GET";let s=!1;const o=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e))).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new i.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,r)=>{e.exports=r(896)},896:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<s(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,o=i>>>1;n<o;){var a=2*(n+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,r))c<i&&0>s(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[a]=r,n=a);else{if(!(c<i&&0>s(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,g=!1,f=!1,m=!1,v=!1,C="function"===typeof setTimeout?setTimeout:null,w="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function S(e){if(m=!1,y(e),!f)if(null!==n(c))f=!0,R||(R=!0,E());else{var t=n(u);null!==t&&I(S,t.startTime-e)}}var E,R=!1,T=-1,x=5,k=-1;function P(){return!!v||!(t.unstable_now()-k<x)}function A(){if(v=!1,R){var e=t.unstable_now();k=e;var r=!0;try{e:{f=!1,m&&(m=!1,w(T),T=-1),g=!0;var s=p;try{t:{for(y(e),h=n(c);null!==h&&!(h.expirationTime>e&&P());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){h.callback=a,y(e),r=!0;break t}h===n(c)&&i(c),y(e)}else i(c);h=n(c)}if(null!==h)r=!0;else{var l=n(u);null!==l&&I(S,l.startTime-e),r=!1}}break e}finally{h=null,p=s,g=!1}r=void 0}}finally{r?E():R=!1}}}if("function"===typeof b)E=function(){b(A)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,D=F.port2;F.port1.onmessage=A,E=function(){D.postMessage(null)}}else E=function(){C(A,0)};function I(e,r){T=C((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,r(u,e),null===n(c)&&e===n(u)&&(m?(w(T),T=-1):m=!0,I(S,s-o))):(e.sortIndex=a,r(c,e),f||g||(f=!0,R||(R=!0,E()))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(672)},980:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const i=n(r(210));t.PostgrestClient=i.default;const s=n(r(829));t.PostgrestQueryBuilder=s.default;const o=n(r(736));t.PostgrestFilterBuilder=o.default;const a=n(r(374));t.PostgrestTransformBuilder=a.default;const l=n(r(286));t.PostgrestBuilder=l.default;const c=n(r(611));t.PostgrestError=c.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var s=Object.create(null);r.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,r.d(s,o),s}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+e+"."+{453:"5112912a",952:"ce58d5b6"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="track-credit-cards-app:";r.l=(n,i,s,o)=>{if(e[n])e[n].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+s){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+s),a.src=n),e[n]=[i];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(r))),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/track-credit-cards-app/",(()=>{var e={792:0};r.f.j=(t,n)=>{var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(((r,n)=>i=e[t]=[r,n]));n.push(i[2]=s);var o=r.p+r.u(t),a=new Error;r.l(o,(n=>{if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,s,o=n[0],a=n[1],l=n[2],c=0;if(o.some((t=>0!==e[t]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(l)l(r)}for(t&&t(n);c<o.length;c++)s=o[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunktrack_credit_cards_app=self.webpackChunktrack_credit_cards_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n,i,s,o,a,l,c,u=r(43),d=r.t(u,2),h=r(391),p=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const n=t?this.allAsyncListeners:this.allSyncListeners;let i=n.get(e);return!i&&r&&(i=new Set,n.set(e,i)),i}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.getListeners(e,r,!0).add(t)}removeEventListener(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getListeners(e,r,!1);if(n&&(n.delete(t),0===n.size)){(r?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const t=e.event;t instanceof Event&&(e.eventPath=t.composedPath())}const n=(r,n)=>r.forEach((r=>{if(!n.has(r))return;const i=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>r(e))):()=>r(e);t?this.dispatchAsync(i):i()})),i=this.getListeners(r,t,!1)??new Set,s=new Set(i);s.size>0&&n(s,i);new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach((n=>{const i=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>n(r,e))):()=>n(r,e);t?this.dispatchAsync(i):i()}))}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const e=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(e):e(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach((e=>e()))}};function g(e,t){return t}function f(e){return e?.getLocaleTextFunc()??g}function m(e,t,r){null==r||"string"===typeof r&&""==r?C(e,t):v(e,t,r)}function v(e,t,r){e.setAttribute(w(t),r.toString())}function C(e,t){e.removeAttribute(w(t))}function w(e){return`aria-${e}`}function b(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function y(e,t){m(e,"label",t)}function S(e,t){m(e,"labelledby",t)}function E(e,t){m(e,"live",t)}function R(e,t){m(e,"disabled",t)}function T(e,t){m(e,"hidden",t)}function x(e,t){v(e,"expanded",t)}function k(e){C(e,"expanded")}function P(e,t){v(e,"setsize",t)}function A(e,t){v(e,"posinset",t)}function F(e,t){v(e,"rowcount",t)}function D(e,t){v(e,"rowindex",t)}function I(e,t){v(e,"colcount",t)}function M(e,t){v(e,"colindex",t)}function O(e,t){v(e,"colspan",t)}function L(e,t){v(e,"sort",t)}function N(e){C(e,"sort")}function _(e,t){m(e,"selected",t)}function G(e,t){m(e,"controls",t.id),S(t,e.id)}function B(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function H(){return void 0===n&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),n}function z(){return void 0===i&&(i=/(firefox)/i.test(navigator.userAgent)),i}function V(){return void 0===s&&(s=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),s}function W(){return void 0===o&&(o=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),o}function U(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return-1!==t||null!==r&&(""!==r||z())?t.toString():null}function j(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;0===r&&0===t.clientWidth&&(r=null),t.parentNode&&t.parentNode.removeChild(t),null!=r&&(l=r,a=0===r)}function K(){return null==a&&j(),a}var Y="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function q(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,r=t.call(e,"input, select, button, textarea"),n=t.call(e,Y),i=de(e);return r&&!n&&i}function X(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:n}=r;e.classList.toggle("ag-hidden",!t),n||T(e,!t)}function J(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:n}=r;e.classList.toggle("ag-invisible",!t),n||T(e,!t)}function Q(e,t){const r="disabled",n=t?e=>e.setAttribute(r,""):e=>e.removeAttribute(r);n(e);const i=e.querySelectorAll("input")??[];for(const s of i)n(s)}function Z(e,t,r){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof r){if(++n>r)break}else if(e===r)break}return!1}function ee(e){const{height:t,width:r,borderTopWidth:n,borderRightWidth:i,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(r||"0"),borderTopWidth:parseFloat(n||"0"),borderRightWidth:parseFloat(i||"0"),borderBottomWidth:parseFloat(s||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(u||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:f}}function te(e){const t=ee(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function re(e){const t=ee(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function ne(e){const{height:t,marginBottom:r,marginTop:n}=ee(e);return Math.floor(t+r+n)}function ie(e){const{width:t,marginLeft:r,marginRight:n}=ee(e);return Math.floor(t+r+n)}function se(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:n,borderRightWidth:i,borderBottomWidth:s}=ee(e);return{top:t.top+(r||0),left:t.left+(n||0),right:t.right+(i||0),bottom:t.bottom+(s||0)}}function oe(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r)),r}function ae(e,t,r){r&&(t*=-1),e.scrollLeft=t}function le(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function ce(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ue(e){return!!e.offsetParent}function de(e){const t=e;if(t.checkVisibility)return t.checkVisibility({checkVisibilityCSS:!0});return!(!ue(e)||"visible"!==window.getComputedStyle(e).visibility)}function he(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function pe(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):ge(e,t)}function ge(e,t){t=me(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function fe(e,t){t=me(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function me(e){return"number"===typeof e?`${e}px`:e}function ve(e){return e instanceof Node||e instanceof HTMLElement}function Ce(e,t,r){null==r||""===r?e.removeAttribute(t):e.setAttribute(t,r.toString())}function we(e,t,r){const n=vt(e).ResizeObserver,i=n?new n(r):null;return i?.observe(t),()=>i?.disconnect()}function be(e,t){const r=vt(e);r.requestAnimationFrame?r.requestAnimationFrame(t):r.webkitRequestAnimationFrame?r.webkitRequestAnimationFrame(t):r.setTimeout(t,0)}var ye,Se="data-ref";function Ee(){return ye??(ye=document.createTextNode(" ")),ye.cloneNode()}function Re(e){const{attrs:t,children:r,cls:n,ref:i,role:s,tag:o}=e,a=document.createElement(o);if(n&&(a.className=n),i&&a.setAttribute(Se,i),s&&a.setAttribute("role",s),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(r)if("string"===typeof r)a.textContent=r;else{let e=!0;for(const t of r)t&&("string"===typeof t?(a.appendChild(document.createTextNode(t)),e=!1):(e&&(a.appendChild(Ee()),e=!1),a.append(Re(t)),a.appendChild(Ee())))}return a}function Te(e){return null==e||""===e?null:e}function xe(e){return null!=e&&""!==e}function ke(e){return!xe(e)}function Pe(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function Ae(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function Fe(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=null==e,i=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),n&&i)return 0;if(n)return-1;if(i)return 1;function s(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return s(e,t);if(!r)return s(e,t);try{return e.localeCompare(t)}catch(o){return s(e,t)}}var De="https://www.ag-grid.com",Ie={};function Me(e,t){Ie[t]||(e(),Ie[t]=!0)}function Oe(e,t){if(e.get("debug")){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];console.log("AG Grid: "+t,...n)}}function Le(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Me((()=>console.warn("AG Grid: "+e,...r)),e+r?.join(""))}function Ne(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Me((()=>console.error("AG Grid: "+e,...r)),e+r?.join(""))}var _e={pending:!1,funcs:[]},Ge={pending:!1,funcs:[]};function Be(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"setTimeout",r=arguments.length>2?arguments[2]:void 0;const n="raf"===t?Ge:_e;if(n.funcs.push(e),n.pending)return;n.pending=!0;const i=()=>{const e=n.funcs.slice();n.funcs.length=0,n.pending=!1,e.forEach((e=>e()))};"raf"===t?be(r,i):window.setTimeout(i,0)}function He(e,t,r){let n;return function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];const a=this;window.clearTimeout(n),n=window.setTimeout((function(){e.isAlive()&&t.apply(a,s)}),r)}}function ze(e,t){let r=0;return function(){const n=Date.now();if(!(n-r<t)){r=n;for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];e.apply(this,s)}}}function Ve(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=arguments.length>3?arguments[3]:void 0;const i=Date.now();let s=null,o=!1;const a=()=>{const a=Date.now()-i>r;(e()||a)&&(t(),o=!0,null!=s&&(window.clearInterval(s),s=null),a&&n&&Le(n))};a(),o||(s=window.setInterval(a,10))}var We="33.2.4",Ue="_version_",je=null,$e=`${De}/javascript-data-grid`;function Ke(e,t,r){return je?.getConsoleMessage(e,t)??[Ze(e,t,r)]}function Ye(e,t,r,n){e(`error #${t}`,...Ke(t,r,n))}function qe(e){let t=e;return e instanceof Error?t=e.toString():"object"===typeof e&&(t=function(e){if(!e)return String(e);const t={};for(const r of Object.keys(e))"object"!==typeof e[r]&&"function"!==typeof e[r]&&(t[r]=e[r]);return JSON.stringify(t)}(e)),t}function Xe(e){return void 0===e?"undefined":null===e?"null":e}function Je(e,t){return`${e}?${t.toString()}`}function Qe(e,t){const r=new URLSearchParams;if(r.append(Ue,We),t)for(const s of Object.keys(t))r.append(s,qe(t[s]));const n=`${$e}/errors/${e}`,i=Je(n,r);return i.length<=2e3?i:function(e,t,r){const n=Array.from(t.entries()).sort(((e,t)=>t[1].length-e[1].length));let i=Je(e,t);for(const[s,o]of n){if(s===Ue)continue;const n=i.length-r;if(n<=0)break;const a="...",l=n+a.length,c=o.length-l>100?o.slice(0,o.length-l)+a:o.slice(0,100)+a;t.set(s,c),i=Je(e,t)}return i}(n,r,2e3)}var Ze=(e,t,r)=>`${r?r+" \n":""}Visit ${Qe(e,t)}${r?"":" \n  Alternatively register the ValidationModule to see the full message in the console."}`;function et(){Ye(Le,arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])}function tt(){Ye(Ne,arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])}function rt(e,t,r){Ye(Ne,e,t,r)}function nt(e,t){const r=t[0];return`error #${r} `+Ke(r,t[1],e).join(" ")}function it(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return nt(void 0,t)}function st(e,t){return e.get("rowModelType")===t}function ot(e,t){return st(e,"clientSide")}function at(e,t){return st(e,"serverSide")}function lt(e,t){return e.get("domLayout")===t}function ct(e){return void 0!==Nt(e)}function ut(e){return"function"===typeof e.get("getRowHeight")}function dt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;const{gos:i,environment:s}=e;if(null==n&&(n=s.getDefaultRowHeight()),ut(i)){if(r)return{height:n,estimated:!0};const e={node:t,data:t.data},s=i.getCallback("getRowHeight")(e);if(pt(s))return 0===s&&et(23),{height:Math.max(1,s),estimated:!1}}if(t.detail&&i.get("masterDetail"))return function(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");if(pt(t))return{height:t,estimated:!1};return{height:300,estimated:!1}}(i);const o=i.get("rowHeight");return{height:o&&pt(o)?o:n,estimated:!1}}function ht(e){const{environment:t,gos:r}=e,n=r.get("rowHeight");if(!n||ke(n))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return-1!==i?i:(et(24),t.getDefaultRowHeight())}function pt(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)}function gt(e,t,r){const n=t[e.getDomDataKey()];return n?n[r]:void 0}function ft(e,t,r,n){const i=e.getDomDataKey();let s=t[i];ke(s)&&(s={},t[i]=s),s[r]=n}function mt(e){const{gos:t,eGridDiv:r}=e;let n=null;const i=t.get("getDocument");return i&&xe(i)?n=i():r&&(n=r.ownerDocument),n&&xe(n)?n:document}function vt(e){return mt(e).defaultView||window}function Ct(e){return e.eGridDiv.getRootNode()}function wt(e){return Ct(e).activeElement}function bt(e){let t=null,r=null;try{t=mt(e).fullscreenElement}catch(n){}finally{t||(t=Ct(e));const n=t.querySelector("body");r=n||(t instanceof ShadowRoot?t:t instanceof Document?t?.documentElement:t)}return r}function yt(e,t,r){const n=e.getBoundingClientRect().height,i=function(e){const t=bt(e);return t?.clientWidth??(window.innerHeight||-1)}(r)-2,s=function(e){const t=bt(e);return t?.clientHeight??(window.innerHeight||-1)}(r)-2;if(!e.offsetParent)return;const o=se(e.offsetParent),{clientY:a,clientX:l}=t;let c=a-o.top-n/2,u=l-o.left-10;const d=mt(r),h=d.defaultView||window,p=h.pageYOffset||d.documentElement.scrollTop,g=h.pageXOffset||d.documentElement.scrollLeft;i>0&&u+e.clientWidth>i+g&&(u=i+g-e.clientWidth),u<0&&(u=0),s>0&&c+e.clientHeight>s+p&&(c=s+p-e.clientHeight),c<0&&(c=0),e.style.left=`${u}px`,e.style.top=`${c}px`}function St(e){const t=mt(e),r=wt(e);return null===r||r===t.body}function Et(e){return!e.get("ensureDomOrder")&&e.get("animateRows")}function Rt(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||lt(e,"print"))}function Tt(e){const t=e.get("autoGroupColumnDef");return!t?.comparator&&!e.get("treeData")}function xt(e){const t=e.get("groupAggFiltering");return"function"===typeof t?e.getCallback("groupAggFiltering"):!0===t?()=>!0:void 0}function kt(e){return e.get("grandTotalRow")}function Pt(e){const t=e.get("groupTotalRow");return"function"===typeof t?e.getCallback("groupTotalRow"):()=>t??void 0}function At(e){return!!e.get("groupHideOpenParents")||"multipleColumns"===e.get("groupDisplayType")}function Ft(e,t){return!t&&"groupRows"===e.get("groupDisplayType")}function Dt(e){const t=e.getCallback("getRowId");return void 0===t?t:e=>{let r=t(e);return"string"!==typeof r&&(et(25,{id:r}),r=String(r)),r}}function It(e,t){const r=e.get("suppressGroupChangesColumnVisibility");if(!0===r)return!1;if(t&&"suppressHideOnGroup"===r)return!1;if(!t&&"suppressShowOnUngroup"===r)return!1;const n=e.get("suppressRowGroupHidesColumns");if(t&&!0===n)return!1;const i=e.get("suppressMakeColumnVisibleAfterUnGroup");return!(!t&&!0===i)}function Mt(e){return e?.checkboxes??!0}function Ot(e){if("object"===typeof e)return e.checkboxLocation??"selectionColumn"}function Lt(e){const t=e.get("cellSelection");return void 0!==t?!!t:e.get("enableRangeSelection")}function Nt(e){const t="beanName"in e&&"gos"===e.beanName?e.get("rowSelection"):e.rowSelection;if("string"===typeof t)switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function _t(e){const t=e.get("rowSelection");if("string"===typeof t){const t=e.get("groupSelectsChildren"),r=e.get("groupSelectsFiltered");return t&&r?"filteredDescendants":t?"descendants":"self"}return"multiRow"===t?.mode?t.groupSelects:void 0}function Gt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.get("rowSelection");return"object"!==typeof r?t?"all":void 0:"multiRow"===r.mode?r.selectAll:"all"}function Bt(e){const t=_t(e);return"descendants"===t||"filteredDescendants"===t}function Ht(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function zt(e){return"legacy"===e.get("columnMenu")}function Vt(e){return!zt(e)}function Wt(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function Ut(e,t){return e.addGridCommonParams(t)}function jt(e){return e.get("treeData")?e.get("treeDataParentIdField")?"treeSelfRef":e.get("treeDataChildrenField")?"treeNested":"treePath":"group"}var $t="__ag_Grid_Stop_Propagation",Kt=["touchstart","touchend","touchmove","touchcancel","scroll"],Yt=["wheel"],qt={};function Xt(e){e[$t]=!0}function Jt(e){return!0===e[$t]}var Qt=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t=>{if("boolean"===typeof qt[t])return qt[t];const r=document.createElement(e[t]||"div");return qt[t="on"+t]=t in r}})();function Zt(e,t,r){let n=t;for(;n;){const t=gt(e,n,r);if(t)return t;n=n.parentElement}return null}function er(e,t){return!(!t||!e)&&function(e){const t=e;if(t.path)return t.path;if(t.composedPath)return t.composedPath();return function(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}(t)}(t).indexOf(e)>=0}var tr=e=>{const t=Kt.includes(e),r=Yt.includes(e);return!!t||!r&&void 0},rr=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new p),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.localEventService?.removeEventListener(e,t,r)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const n of Object.keys(t)){const i=t[n];i&&r.push(this._setupListener(e,n,i))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;let n;return!function(e){return void 0!==e.__addEventListener}(e)?(e instanceof HTMLElement?function(e,t,r,n){const i=tr(r);let s;null!=i&&(s={passive:i}),e&&e.addEventListener&&e.addEventListener(t,r,n,s)}(this.beans.frameworkOverrides,e,t,r):e.addEventListener(t,r),n=()=>(e.removeEventListener(t,r),null)):(e.__addEventListener(t,r),n=()=>(e.__removeEventListener(t,r),null)),this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==n)),null)}setupGridOptionListener(e,t){const{gos:r}=this;r.addPropertyEventListener(e,t);const n=()=>(r.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==n)),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,n=e=>{if(e.changeSet){if(e.changeSet&&e.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=e.changeSet.id}const n={type:"gridPropertyChanged",changeSet:e.changeSet,source:e.source};t(n)};e.forEach((e=>this.setupGridOptionListener(e,n)))}getLocaleTextFunc(){return f(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};var nr=new Set(["__proto__","constructor","prototype"]);function ir(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];xe(t)&&function(e,t){if(null!=e)if(Array.isArray(e))for(let r=0;r<e.length;r++)t(r.toString(),e[r]);else for(const r of Object.keys(e))t(r,e[r])}(t,((t,i)=>{if(nr.has(t))return;let s=e[t];if(s!==i){if(n){if(null==s&&null!=i){"object"===typeof i&&i.constructor===Object&&(s={},e[t]=s)}}or(i)&&or(s)&&!Array.isArray(s)?ir(s,i,r,n):(r||void 0!==i)&&(e[t]=i)}}))}function sr(e,t,r){if(!t||!e)return;if(!r)return e[t];const n=t.split(".");let i=e;for(let s=0;s<n.length;s++){if(null==i)return;i=i[n[s]]}return i}function or(e){return"object"===typeof e&&null!==e}var ar=/[&<>"']/g,lr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function cr(e,t){if(null==e)return null;const r=e.toString().toString();return t?r:r.replace(ar,(e=>lr[e]))}var ur={resizable:!0,sortable:!0},dr=0;function hr(){return dr++}function pr(e){return e instanceof gr}var gr=class extends rr{constructor(e,t,r,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=n,this.isColumn=!0,this.instanceId=hr(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new p,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=cr(r)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:r,colFlex:n}}=this;t?.initCol(this);const i=e.hide;this.visible=void 0!==i?!i:!e.initialHide,r?.initCol(this),n?.initCol(this)}setColDef(e,t,r){const n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",r)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:r}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=xe(t)&&t.indexOf(".")>=0&&!n,this.tooltipFieldContainsDots=xe(r)&&r.indexOf(".")>=0&&!n}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=e.width,n=e.initialWidth;return t=null!=r?r:null!=n?n:200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);const r=this.frameworkEventListenerService?.wrap(t)??t;this.colEventSvc.addEventListener(e,r)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(t)??t;this.colEventSvc.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return Ut(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable(this,e)??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??ur[e]}isColumnFunc(e,t){if("boolean"===typeof t)return t;if("function"===typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}createColumnEvent(e,t){return Ut(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return ke(this.sort)}isSorting(){return xe(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return et(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t){const r=!0===e;this.visible!==r&&(this.visible=r,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return Ut(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(ke(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(ke(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,null!=this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}dispatchColEvent(e,t,r){const n=this.createColumnEvent(e,t);r&&ir(n,r),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function fr(e){return e instanceof mr}var mr=class extends rr{constructor(e,t,r,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=r,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=hr(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some((e=>e.isVisible()))}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach((t=>{pr(t)?e.push(t):fr(t)&&t.addLeafColumns(e)}))}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((t=>t.__addEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach((t=>t.__removeEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const n=this.findChildrenRemovingPadding();for(let s=0,o=n.length;s<o;s++){const i=n[s];if(!i.isVisible())continue;const o=i.getColumnGroupShow();"open"===o?(e=!0,r=!0):"closed"===o?(t=!0,r=!0):(e=!0,t=!0)}const i=e&&t&&r;this.expandable!==i&&(this.expandable=i,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{r.forEach((r=>{fr(r)&&r.isPadding()?t(r.children):e.push(r)}))};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},vr={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},Cr=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=Pe(e);let r=0;for(;;){let n=e??t;if(n?0!==r&&(n+="_"+r):n=r,!this.existingKeys[n])return this.existingKeys[n]=!0,String(n);r++}}},wr=Object.freeze([]);function br(e){if(e?.length)return e[e.length-1]}function yr(e,t,r){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every(((e,n)=>r?r(e,t[n]):t[n]===e))}function Sr(e,t){if(e)for(const r of e)t(r)}function Er(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function Rr(e,t,r){for(let n=0;n<t.length;n++)Er(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(r,0,t[n])}var Tr="ag-Grid-AutoColumn",xr="ag-Grid-SelectionColumn",kr="ag-Grid-RowNumbersColumn";function Pr(e){const t=[],r=e=>{for(let n=0;n<e.length;n++){const i=e[n];pr(i)?t.push(i):fr(i)&&r(i.getChildren())}};return r(e),t}function Ar(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}function Fr(e,t,r){const n={};if(!t)return;Ur(null,t,(e=>{n[e.getInstanceId()]=e})),r&&Ur(null,r,(e=>{n[e.getInstanceId()]=null}));const i=Object.values(n).filter((e=>null!=e));e.context.destroyBeans(i)}function Dr(e){return e.getId().startsWith(Tr)}function Ir(e){const t="string"===typeof e?e:"getColId"in e?e.getColId():e.colId;return t?.startsWith(xr)??!1}function Mr(e){const t="string"===typeof e?e:"getColId"in e?e.getColId():e.colId;return t?.startsWith(kr)??!1}function Or(e){let t=[];return e instanceof Array?t=e:"string"===typeof e&&(t=e.split(",")),t}function Lr(e,t){return yr(e,t,((e,t)=>e.getColId()===t.getColId()))}function Nr(e){e.map={},e.list.forEach((t=>e.map[t.getId()]=t))}function _r(e){return"gridOptionsUpdated"===e?"gridOptionsChanged":e}function Gr(e,t){const r=e===t,n=e.getColDef()===t,i=e.getColId()==t;return r||n||i}function Br(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const s=new Cr,{existingCols:o,existingGroups:a,existingColKeys:l}=function(e){const t=[],r=[],n=[];e&&Ur(null,e,(e=>{if(fr(e)){const t=e;r.push(t)}else{const r=e;n.push(r.getId()),t.push(r)}}));return{existingCols:t,existingGroups:r,existingColKeys:n}}(n);s.addExistingKeys(l);const c=Hr(e,t,0,r,o,s,a,i),{colGroupSvc:u}=e,d=u?.findMaxDepth(c,0)??0,h=u?u.balanceColumnTree(c,0,d,s):c;return Ur(null,h,((e,t)=>{fr(e)&&e.setupExpandable(),e.originalParent=t})),{columnTree:h,treeDept:d}}function Hr(e,t,r,n,i,s,o,a){if(!t)return[];const{colGroupSvc:l}=e,c=new Array(t.length);for(let u=0;u<c.length;u++){const d=t[u];l&&void 0!==d.children?c[u]=l.createProvidedColumnGroup(n,d,r,i,s,o,a):c[u]=zr(e,n,d,i,s,a)}return c}function zr(e,t,r,n,i,s){const o=function(e,t){if(!t)return;for(let r=0;r<t.length;r++){const n=t[r].getUserProvidedColDef();if(!n)continue;if(null!=e.colId){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(null!=e.field){if(n.field===e.field)return{idx:r,column:t[r]}}else if(n===e)return{idx:r,column:t[r]}}return}(r,n);o&&n?.splice(o.idx,1);let a=o?.column;if(a){const t=Wr(e,r,a.getColId());a.setColDef(t,r,s),function(e,t,r,n){Vr(e,t,r.hide,r.sort,r.sortIndex,r.pinned,r.flex,n);const i=t.getFlex();if(null!=i&&i>0)return;if(null!=r.width)t.setActualWidth(r.width,n);else{const e=t.getActualWidth();t.setActualWidth(e,n)}}(e,a,t,s)}else{const n=i.getUniqueKey(r.colId,r.field),s=Wr(e,r,n);a=new gr(s,r,n,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function Vr(e,t,r,n,i,s,o,a){const{sortSvc:l,pinnedCols:c,colFlex:u}=e;void 0!==r&&t.setVisible(!r,a),l&&(l.updateColSort(t,n,a),void 0!==i&&l.setColSortIndex(t,i)),void 0!==s&&c?.setColPinned(t,s),void 0!==o&&u?.setColFlex(t,o)}function Wr(e,t,r,n){const{gos:i,dataTypeSvc:s,validation:o}=e,a={};ir(a,i.get("defaultColDef"),!1,!0);const l=function(e,t,r,n){const i=e.dataTypeSvc?.updateColDefAndGetColumnType(t,r,n),s=r.type??i??t.type;return t.type=s,s?Or(s):void 0}(e,a,t,r);l&&function(e,t,r){if(!t.length)return;const n=Object.assign({},vr),i=e.gos.get("columnTypes")||{};for(const s of Object.keys(i)){const e=i[s];if(s in n)et(34,{key:s});else{e.type&&et(35),n[s]=e}}t.forEach((e=>{const t=n[e.trim()];t?ir(r,t,!1,!0):et(36,{t:e})}))}(e,l,a),ir(a,t,!1,!0);const c=i.get("autoGroupColumnDef"),u=Tt(i);return t.rowGroup&&c&&u&&ir(a,{sort:c.sort,initialSort:c.initialSort},!1,!0),s?.validateColDef(a),o?.validateColDef(a,r,n),a}function Ur(e,t,r){if(t)for(let n=0;n<t.length;n++){const i=t[n];fr(i)&&Ur(i,i.getChildren(),r),r(i,e)}}function jr(e,t){const r=[],n=[],i=[];e.forEach((e=>{const t=e.getColDef().lockPosition;"right"===t?i.push(e):"left"===t||!0===t?r.push(e):n.push(e)}));return t.get("enableRtl")?[...i,...n,...r]:[...r,...n,...i]}function $r(e,t){let r=!0;return Ur(null,t,(t=>{if(!fr(t))return;const n=t,i=n.getColGroupDef();if(!(i&&i.marryChildren))return;const s=[];n.getLeafColumns().forEach((t=>{const r=e.indexOf(t);s.push(r)}));Math.max.apply(Math,s)-Math.min.apply(Math,s)>n.getLeafColumns().length-1&&(r=!1)})),r}function Kr(e,t){if(!e||0==e.length)return;const r=t(e[0]);for(let n=1;n<e.length;n++)if(r!==t(e[n]))return;return r}function Yr(e,t,r){if(!t.length)return;const n=1===t.length?t[0]:null,i=Kr(t,(e=>e.getPinned()));e.dispatchEvent({type:"columnPinned",pinned:null!=i?i:null,columns:t,column:n,source:r})}function qr(e,t,r,n){e.dispatchEvent({type:t,columns:r,column:r&&1==r.length?r[0]:null,source:n})}function Xr(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:1===t.length?t[0]:null,flexColumns:i,finished:r,source:n})}function Jr(e,t,r){const{colModel:n,rowGroupColsSvc:i,pivotColsSvc:s,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:u,environment:d,valueColsSvc:h,eventSvc:p,gos:g}=e,f=n.getColDefCols()||[];if(!f?.length)return!1;if(t?.state&&!t.state.forEach)return et(32),!1;const m=(n,o,a,l,c)=>{if(!n)return;const u=((e,t)=>(r,n)=>{const i={value1:void 0,value2:void 0};let s=!1;return e&&(void 0!==e[r]&&(i.value1=e[r],s=!0),xe(n)&&void 0!==e[n]&&(i.value2=e[n],s=!0)),!s&&t&&(void 0!==t[r]&&(i.value1=t[r]),xe(n)&&void 0!==t[n]&&(i.value2=t[n])),i})(o,t.defaultState),p=u("flex").value1;if(Vr(e,n,u("hide").value1,u("sort").value1,u("sortIndex").value1,u("pinned").value1,p,r),null==p){const e=u("width").value1;if(null!=e){const t=n.getColDef().minWidth??d.getDefaultColumnMinWidth();null!=t&&e>=t&&n.setActualWidth(e,r)}}!c&&n.isPrimary()&&(h?.syncColumnWithState(n,r,u),i?.syncColumnWithState(n,r,u,a),s?.syncColumnWithState(n,r,u,l))},v=(l,u,d)=>{const h=Qr(e,r),f=u.slice(),v={},C={},w=[],b=[],y=[];let S=0;const E=i?.columns.slice()??[],R=s?.columns.slice()??[];l.forEach((e=>{const t=e.colId;if(t.startsWith(Tr))return w.push(e),void y.push(e);if(Ir(t))return b.push(e),void y.push(e);const r=d(t);r?(m(r,e,v,C,!1),Er(f,r)):(y.push(e),S+=1)}));const T=e=>m(e,null,v,C,!1);f.forEach(T),i?.sortColumns(tn.bind(i,v,E)),s?.sortColumns(tn.bind(s,C,R)),n.refreshCols(!1);const x=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];t.forEach((t=>{const n=e(t.colId);Er(r,n),m(n,t,null,null,!0)})),r.forEach(T)};return x((e=>o?.getColumn(e)??null),w,o?.getColumns()?.slice()),x((e=>a?.getColumn(e)??null),b,a?.getColumns()?.slice()),function(e,t,r){if(!e.applyOrder||!e.state)return;const n=[];e.state.forEach((e=>{null!=e.colId&&n.push(e.colId)})),function(e,t,r,n){if(null==e)return;let i=[];const s={};t.forEach((t=>{if(s[t])return;const r=e.map[t];r&&(i.push(r),s[t]=!0)}));let o=0;if(e.list.forEach((e=>{const t=e.getColId();if(null!=s[t])return;t.startsWith(Tr)?i.splice(o++,0,e):i.push(e)})),i=jr(i,n),!$r(i,r.getColTree()))return void et(39);e.list=i}(t.cols,n,t,r)}(t,n,g),c.refresh(r),p.dispatchEvent({type:"columnEverythingChanged",source:r}),h(),{unmatchedAndAutoStates:y,unmatchedCount:S}};l?.start();let{unmatchedAndAutoStates:C,unmatchedCount:w}=v(t.state||[],f,(e=>n.getColDefCol(e)));if(C.length>0||xe(t.defaultState)){w=v(C,u?.getPivotResultCols()?.list??[],(e=>u?.getPivotResultCol(e)??null)).unmatchedCount}return l?.finish(),0===w}function Qr(e,t){const{rowGroupColsSvc:r,pivotColsSvc:n,valueColsSvc:i,colModel:s,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:r?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:i?.columns.slice()??[]},c=Zr(e),u={};return c.forEach((e=>{u[e.colId]=e})),()=>{const i=(e,r,n,i)=>{if(yr(r.map(i),n.map(i)))return;const s=new Set(r);n.forEach((e=>{s.delete(e)||s.add(e)}));const o=[...s];a.dispatchEvent({type:e,columns:o,column:1===o.length?o[0]:null,source:t})},d=e=>{const t=[];return s.forAllCols((r=>{const n=u[r.getColId()];n&&e(n,r)&&t.push(r)})),t},h=e=>e.getColId();i("columnRowGroupChanged",l.rowGroupColumns,r?.columns??[],h),i("columnPivotChanged",l.pivotColumns,n?.columns??[],h);const p=d(((e,t)=>{const r=null!=e.aggFunc,n=r!=t.isValueActive(),i=r&&e.aggFunc!=t.getAggFunc();return n||i}));p.length>0&&qr(a,"columnValueChanged",p,t);Xr(a,d(((e,t)=>e.width!=t.getActualWidth())),!0,t);Yr(a,d(((e,t)=>e.pinned!=t.getPinned())),t);!function(e,t,r){if(!t.length)return;const n=1===t.length?t[0]:null,i=Kr(t,(e=>e.isVisible()));e.dispatchEvent({type:"columnVisible",visible:i,columns:t,column:n,source:r})}(a,d(((e,t)=>e.hide==t.isVisible())),t);const g=d(((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()));g.length>0&&o?.dispatchSortChangedEvents(t,g);const f=Zr(e);!function(e,t,r,n,i){const s={};t.forEach((e=>s[e.colId]=e));const o={};e.forEach((e=>{s[e.colId]&&(o[e.colId]=!0)}));const a=e.filter((e=>o[e.colId])),l=t.filter((e=>o[e.colId])),c=[];if(l.forEach(((e,t)=>{const r=a&&a[t];if(r&&r.colId!==e.colId){const e=n.getCol(r.colId);e&&c.push(e)}})),!c.length)return;i.dispatchEvent({type:"columnMoved",columns:c,column:1===c.length?c[0]:null,finished:!0,source:r})}(c,f,t,s,a)}}function Zr(e){const{colModel:t,rowGroupColsSvc:r,pivotColsSvc:n}=e;if(ke(t.getColDefCols())||!t.isAlive())return[];const i=r?.columns,s=n?.columns,o=[];t.forAllCols((e=>(e=>{const t=e.isRowGroupActive()&&i?i.indexOf(e):null,r=e.isPivotActive()&&s?s.indexOf(e):null,n=e.isValueActive()?e.getAggFunc():null,a=null!=e.getSort()?e.getSort():null,l=null!=e.getSortIndex()?e.getSortIndex():null;o.push({colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:a,sortIndex:l,aggFunc:n,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:r,flex:e.getFlex()??null})})(e)));const a=new Map(t.getCols().map(((e,t)=>[e.getColId(),t])));return o.sort(((e,t)=>(a.has(e.colId)?a.get(e.colId):-1)-(a.has(t.colId)?a.get(t.colId):-1))),o}function en(e){const t=(e,t)=>null!=e?e:null!=t?t:null,r=e.getColDef(),n=t(r.sort,r.initialSort),i=t(r.sortIndex,r.initialSortIndex),s=t(r.hide,r.initialHide),o=t(r.pinned,r.initialPinned),a=t(r.width,r.initialWidth),l=t(r.flex,r.initialFlex);let c=t(r.rowGroupIndex,r.initialRowGroupIndex),u=t(r.rowGroup,r.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let d=t(r.pivotIndex,r.initialPivotIndex),h=t(r.pivot,r.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);const p=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:n,sortIndex:i,hide:s,pinned:o,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:p}}var tn=(e,t,r,n)=>{const i=e[r.getId()],s=e[n.getId()],o=null!=i,a=null!=s;if(o&&a)return i-s;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(n),u=l>=0;return u&&c>=0?l-c:u?-1:1},rn=class extends rr{constructor(){super(...arguments),this.dispatchColumnChangedEvent=qr,this.columns=[],this.columnIndexMap={},this.updateIndexMap=()=>{this.columnIndexMap={},this.columns.forEach(((e,t)=>this.columnIndexMap[e.getId()]=t))}}wireBeans(e){this.colModel=e.colModel,this.aggFuncSvc=e.aggFuncSvc,this.visibleCols=e.visibleCols}sortColumns(e){this.columns.sort(e),this.updateIndexMap()}setColumns(e,t){this.setColList(e,this.columns,this.eventName,!0,!0,this.columnProcessors.set,t)}addColumns(e,t){this.updateColList(e,this.columns,!0,!0,this.columnProcessors.add,this.eventName,t)}removeColumns(e,t){this.updateColList(e,this.columns,!1,!0,this.columnProcessors.remove,this.eventName,t)}getColumnIndex(e){return this.columnIndexMap[e]}setColList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;const a=this.colModel.getCols();if(!a||0===a.length)return;const l=new Map;t.forEach(((e,t)=>l.set(e,t))),t.length=0,xe(e)&&e.forEach((e=>{const r=this.colModel.getColDefCol(e);r&&t.push(r)})),t.forEach(((e,t)=>{const r=l.get(e);void 0!==r?n&&r!==t||l.delete(e):l.set(e,0)})),this.updateIndexMap();(this.colModel.getColDefCols()||[]).forEach((e=>{const r=t.indexOf(e)>=0;s(e,r,o)})),i&&this.colModel.refreshCols(!1),this.visibleCols.refresh(o),this.dispatchColumnChangedEvent(this.eventSvc,r,[...l.keys()],o)}updateColList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;if(!e||0===e.length)return;let a=!1;const l=new Set;if(e.forEach((e=>{if(!e)return;const n=this.colModel.getColDefCol(e);if(n){if(l.add(n),r){if(t.indexOf(n)>=0)return;t.push(n)}else{const e=t.indexOf(n);if(e<0)return;for(let r=e+1;r<t.length;r++)l.add(t[r]);Er(t,n)}i(n,r,o),a=!0}})),!a)return;this.updateIndexMap(),n&&this.colModel.refreshCols(!1),this.visibleCols.refresh(o);const c=Array.from(l);this.eventSvc.dispatchEvent({type:s,columns:c,column:1===c.length?c[0]:null,source:o})}extractCols(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=this.columns,n=[],i=[],{setFlagFunc:s,getIndexFunc:o,getInitialIndexFunc:a,getValueFunc:l,getInitialValueFunc:c}=this.columnExtractors;(this.colModel.getColDefCols()||[]).forEach((e=>{const s=t.indexOf(e)<0,u=e.getColDef(),d=l(u),h=c(u),p=o(u),g=a(u);let f;if(f=void 0!==d?d:void 0!==p?null!==p&&p>=0:s?void 0!==h?h:!!(void 0!==g)&&(null!=g&&g>=0):r.indexOf(e)>=0,f){(s?null!=p||null!=g:null!=p)?n.push(e):i.push(e)}}));const u=e=>{const t=o(e.getColDef()),r=a(e.getColDef());return null!=t?t:r};n.sort(((e,t)=>{const r=u(e),n=u(t);return r===n?0:r<n?-1:1}));const d=[].concat(n);return r.forEach((e=>{i.indexOf(e)>=0&&d.push(e)})),i.forEach((e=>{d.indexOf(e)<0&&d.push(e)})),r.forEach((t=>{d.indexOf(t)<0&&s(t,!1,e)})),d.forEach((t=>{r.indexOf(t)<0&&s(t,!0,e)})),this.columns=d,this.updateIndexMap(),this.columns}restoreColumnOrder(e,t){const r=this.columns,n=this.colModel.getColDefCols();if(!r.length||!n)return e;const i=Object.keys(t),s=new Set(i),o=new Set(i),a=new Set(r.map((e=>{const t=e.getColId();return o.delete(t),t})).concat(i)),l=[],c={};let u=0;for(let w=0;w<n.length;w++){const e=n[w].getColId();a.has(e)&&(l.push(e),c[e]=u++)}let d=1e3,h=!1,p=0;const g=this.columnOrdering.enableProp,f=this.columnOrdering.initialEnableProp,m=this.columnOrdering.indexProp,v=this.columnOrdering.initialIndexProp,C=e=>{const r=c[e];for(let n=p;n<r;n++){const e=l[n];o.has(e)&&(t[e][m]=d++,o.delete(e))}p=r};return r.forEach((r=>{const n=r.getColId();if(s.has(n))C(n),t[n][m]=d++;else{const i=r.getColDef();if(null===i[m]||void 0===i[m]&&null==i[v]){if(!h){i[g]||void 0===i[g]&&i[f]?C(n):(o.forEach((e=>{t[e][m]=d+c[e]})),d+=l.length,h=!0)}e[n]||(e[n]={colId:n}),e[n][m]=d++}}})),e}},nn=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return r="number"!==typeof t?0:t+1,this.existingIds[e]=r,r}},sn=class extends rr{};function on(e,t,r){return r&&e.addDestroyFunc((()=>t.destroyBean(r))),r??e}var an=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){this.addOrRemoveCssClass(e,!0)}removeCssClass(e){this.addOrRemoveCssClass(e,!1)}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const r=(e||"").split(" ");if(r.length>1)return void r.forEach((e=>this.addOrRemoveCssClass(e,t)))}if(this.cssClassStates[e]!==t&&e.length){const r=this.getGui();r&&r.classList.toggle(e,t),this.cssClassStates[e]=t}}},ln=0,cn=null,un=class extends rr{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=ln++,this.cssClassManager=new an((()=>this.eGui)),this.componentSelectors=new Map((t??[]).map((e=>[e.selector,e]))),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());const e="component-"+Object.getPrototypeOf(this)?.constructor?.name;this.css?.forEach((t=>this.beans.environment.addGlobalCSS(t,e)))}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(Se):null}applyElementsToComponent(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===t&&(t=this.getDataRefAttribute(e)),t){const i=this[t];if(i===cn)this[t]=n??e;else{const e=r&&r[t];if(!this.suppressDataRefValidation&&!e)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${i}`)}}}createChildComponentsFromTags(e,t){const r=[];for(const n of e.childNodes??[])r.push(n);r.forEach((r=>{if(!(r instanceof HTMLElement))return;const n=this.createComponentFromElement(r,(e=>{const t=e.getGui();if(t)for(const n of r.attributes??[])t.setAttribute(n.name,n.value)}),t);if(n){if(n.addItems&&r.children.length){this.createChildComponentsFromTags(r,t);const e=Array.prototype.slice.call(r.children);n.addItems(e)}this.swapComponentForNode(n,e,r)}else r.childNodes&&this.createChildComponentsFromTags(r,t)}))}createComponentFromElement(e,t,r){const n=e.nodeName,i=this.getDataRefAttribute(e),s=0===n.indexOf("AG-"),o=s?this.componentSelectors.get(n):null;let a=null;if(o){const e=r&&i?r[i]:void 0;a=new o.component(e),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,i,r,a),a}swapComponentForNode(e,t,r){const n=e.getGui();t.replaceChild(n,r),t.insertBefore(document.createComment(r.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach((e=>e.setAttribute("tabindex",t.toString())))}setTemplate(e,t,r){let n;n="string"===typeof e||null==e?he(e):Re(e),this.setTemplateFromElement(n,t,r)}setTemplateFromElement(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let i=0;i<t.length;i++){const e=t[i];this.componentSelectors.set(e.selector,e)}this.wireTemplate(e,r)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let r=t;return null==e?null:(r||(r=this.eGui),ve(e)?{element:e,parent:r}:{element:e.getGui(),parent:r})}prependChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};r&&n&&n.insertAdjacentElement("afterbegin",r)}appendChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};r&&n&&n.appendChild(r)}isDisplayed(){return this.displayed}setVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.visible){this.visible=e;const{skipAriaHidden:r}=t;J(this.eGui,e,{skipAriaHidden:r})}}setDisplayed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:r}=t;X(this.eGui,e,{skipAriaHidden:r});const n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,r){this.eGui.addEventListener(e,t,r),this.addDestroyFunc((()=>this.eGui.removeEventListener(e,t)))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}};var dn=class e{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e((e=>this.onDone(e)),(e=>this.onReject(e)))}static all(t){return t.length?new e((e=>{let r=t.length;const n=new Array(r);t.forEach(((t,i)=>{t.then((t=>{n[i]=t,r--,0===r&&e(n)}))}))})):e.resolve()}static resolve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e((e=>e(t)))}then(t){return new e((e=>{1===this.status?e(t(this.resolution)):this.waiters.push((r=>e(t(r))))}))}onDone(e){this.status=1,this.resolution=e,this.waiters.forEach((t=>t(e)))}onReject(e){}};function hn(e,t,r,n){const{name:i}=r;let s,o,a,l,c,u;if(t){const r=t,d=r[i+"Selector"],h=d?d(n):null,p=t=>{if("string"===typeof t)s=t;else if(null!=t&&!0!==t){e.isFrameworkComponent(t)?a=t:o=t}};h?(p(h.component),l=h.params,c=h.popup,u=h.popupPosition):p(r[i])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}var pn={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},gn={name:"headerComponent",optionalMethods:["refresh"]},fn={name:"innerHeaderComponent"},mn={name:"innerHeaderGroupComponent"},vn={name:"headerGroupComponent"},Cn={name:"innerRenderer",cellRenderer:!0,optionalMethods:["afterGuiAttached"]},wn={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},bn={name:"loadingCellRenderer",cellRenderer:!0},yn={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},Sn={name:"loadingOverlayComponent",optionalMethods:["refresh"]},En={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},Rn={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},Tn={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},xn={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},kn={name:"loadingCellRenderer",cellRenderer:!0},Pn={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},An={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function Fn(e,t,r){return e.getCompDetails(t,Cn,void 0,r)}function Dn(e,t,r){return e.getCompDetails(t,wn,void 0,r)}function In(e,t,r){return e.getCompDetails(t,yn,"agCellEditor",r,!0)}function Mn(e,t,r,n){return e.getCompDetails(t,Rn,n,r,!0)}function On(e,t,r,n){return e.getCompDetails(t,Tn,n,r)}function Ln(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var Nn,_n=new Set,Gn={},Bn={},Hn=!1,zn=!1;function Vn(e){Nn||(Nn=e.version);const t=e=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${e} Please update all modules to the same version.`;if(e.version?function(e){const[t,r]=e.version.split(".")||[],[n,i]=Nn.split(".")||[];return t===n&&r===i}(e)||Ne(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${Nn}.`)):Ne(t(`'${e.moduleName}' is incompatible.`)),e.validate){const t=e.validate();if(!t.isValid){Ne(`${t.message}`)}}}function Wn(e,t){Vn(e);const r=e.rowModels??["all"];let n;_n.add(e),void 0!==t?(Hn=!0,void 0===Bn[t]&&(Bn[t]={}),n=Bn[t]):n=Gn,r.forEach((t=>{void 0===n[t]&&(n[t]={}),n[t][e.moduleName]=e})),e.dependsOn&&e.dependsOn.forEach((e=>Wn(e,t)))}function Un(e,t,r){const n=r=>!!Gn[r]?.[e]||!!Bn[t]?.[r]?.[e];return n(r)||n("all")}function jn(){return Hn}function $n(e,t){const r=Bn[e]??{};return[...Object.values(r.all??{}),...Object.values(r[t]??{})]}var Kn=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,e&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];e.beanClasses.forEach((e=>{const t=new e;t.beanName?this.beans[t.beanName]=t:console.error(`Bean ${e.name} is missing beanName`),this.createdBeans.push(t)})),e.derivedBeans?.forEach((e=>{const{beanName:t,bean:r}=e(this);this.beans[t]=r,this.createdBeans.push(r)})),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("null bean");return this.initBeans([e],t),e}initBeans(e,t){e.forEach((e=>{e.preWireBeans?.(this.beans),e.wireBeans?.(this.beans)})),e.forEach((e=>e.preConstruct?.())),t&&e.forEach(t),e.forEach((e=>e.postConstruct?.()))}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},Yn=class extends Kn{init(e){this.gridId=e.gridId,this.beans.context=this,this.destroyCallback=e.destroyCallback,super.init(e)}destroy(){var e;super.destroy(),e=this.gridId,delete Bn[e],this.destroyCallback?.()}getGridId(){return this.gridId}};function qn(e,t,r,n){return ke(e)?[]:Jn(e.headerClass,e,t,r,n)}function Xn(e,t,r){e.addOrRemoveCssClass("ag-column-first",r.isColAtEdge(t,"first")),e.addOrRemoveCssClass("ag-column-last",r.isColAtEdge(t,"last"))}function Jn(e,t,r,n,i){if(ke(e))return[];let s;if("function"===typeof e){const o=function(e,t,r,n){return Ut(t,{colDef:e,column:r,columnGroup:n})}(t,r,n,i);s=e(o)}else s=e;return"string"===typeof s?[s]:Array.isArray(s)?[...s]:[]}var Qn={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},Zn=!1,ei=0;function ti(e){const t=Zn,r="keydown"===e.type;r&&(e.ctrlKey||e.metaKey||e.altKey)||t!==r&&(Zn=r)}function ri(e){const t=mt(e);var r;return r=t,ei>0||(r.addEventListener("keydown",ti),r.addEventListener("mousedown",ti)),ei++,()=>{ei--,function(e){ei>0||(e.removeEventListener("keydown",ti),e.removeEventListener("mousedown",ti))}(t)}}function ni(){return Zn}function ii(e,t,r){t.addManagedElementListeners(r,{keydown:t=>{if(!t.defaultPrevented&&t.key===Qn.TAB){const n=t.shiftKey;ai(e,r,!1,n)||hi(e,n)&&t.preventDefault()}}})}function si(e,t){let r=Y;t&&(r+=", "+t),arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(r+=', [tabindex="-1"]');const n=Array.prototype.slice.apply(e.querySelectorAll("[tabindex], input, select, button, textarea, [href]")).filter((e=>de(e))),i=Array.prototype.slice.apply(e.querySelectorAll(r));if(!i.length)return n;return s=i,n.filter((e=>-1===s.indexOf(e)));var s}function oi(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=si(e,arguments.length>3&&void 0!==arguments[3]&&arguments[3]?".ag-tab-guard":null,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),n=t?br(r):r[0];return!!n&&(n.focus({preventScroll:!0}),!0)}function ai(e,t,r,n){const i=si(t,r?':not([tabindex="-1"])':null),s=wt(e);let o;o=r?i.findIndex((e=>e.contains(s))):i.indexOf(s);const a=o+(n?-1:1);return a<0||a>=i.length?null:i[a]}function li(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=0;for(;e&&null===U(e)&&++r<=t;)e=e.parentElement;return null===U(e)?null:e}function ci(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function ui(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function di(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function hi(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.ctrlsSvc.get("gridCtrl");return!(r||!n.focusNextInnerContainer(t))||((r||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}var pi=class extends rr{constructor(e,t,r,n){super(),this.cellCtrl=e,this.rowNode=r,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case Qn.ENTER:this.onEnterKeyDown(e);break;case Qn.F2:this.onF2KeyDown(e);break;case Qn.ESCAPE:this.onEscapeKeyDown(e);break;case Qn.TAB:this.onTabKeyDown(e);break;case Qn.BACKSPACE:case Qn.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case Qn.DOWN:case Qn.UP:case Qn.RIGHT:case Qn.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){if(!this.cellCtrl.editing){if(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const r=this.cellCtrl.getFocusedCellPosition();this.beans.navigation?.navigateToNextCell(e,t,r,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:r}=this.beans;if(!t)return;const n=t.extendLatestRangeInDirection(e);n&&r?.ensureCellVisible(n)}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:r,beans:n,rowNode:i}=this,{gos:s,rangeSvc:o,eventSvc:a}=n;if(!r.editing){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),function(e){return e===Qn.DELETE||!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&e===Qn.BACKSPACE&&V()}(e,s.get("enableCellEditingOnBackspace"))){if(o&&Lt(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const{column:e}=r,t=this.beans.valueSvc.getDeleteValue(e,i);i.setDataValue(e,t,"cellClear")}}else n.editSvc?.startRowOrCellEdit(r,e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){const{cellCtrl:t,beans:r}=this;if(t.editing||this.rowCtrl.editing)this.beans.editSvc?.stopRowOrCellEdit(t,!1,!1,e.shiftKey);else if(r.gos.get("enterNavigatesVertically")){const n=e.shiftKey?Qn.UP:Qn.DOWN;r.navigation?.navigateToNextCell(null,n,t.cellPosition,!1)}else r.editSvc?.startRowOrCellEdit(t,Qn.ENTER,e),t.editing&&e.preventDefault()}onF2KeyDown(e){const{cellCtrl:t,beans:r}=this;t.editing||r.editSvc?.startRowOrCellEdit(t,Qn.F2,e)}onEscapeKeyDown(e){const{cellCtrl:t,beans:r}=this;t.editing&&r.editSvc?.stopRowOrCellEdit(t,!0)}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.editing)return;const t=e.key;t===Qn.SPACE?this.onSpaceKeyDown(e):this.beans.editSvc?.startRowOrCellEdit(this.cellCtrl,t,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;!this.cellCtrl.editing&&ct(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,this.rowNode,"spaceKey"),e.preventDefault()}destroy(){super.destroy()}},gi=class extends rr{constructor(e,t,r){super(),this.cellCtrl=e,this.column=r,this.beans=t}onMouseEvent(e,t){if(!Jt(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:r,gos:n,editSvc:i}=this.beans,s=e.ctrlKey||e.metaKey;r&&s&&r.getCellRangeCount(this.cellCtrl.cellPosition)>1&&r.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(o);const a=this.column.getColDef();a.onCellClicked&&window.setTimeout((()=>{this.beans.frameworkOverrides.wrapOutgoing((()=>{a.onCellClicked(o)}))}),0);!((n.get("singleClickEdit")||a.singleClickEdit)&&!n.get("suppressClickEdit"))||e.shiftKey&&0!=r?.getCellRanges().length||i?.startRowOrCellEdit(this.cellCtrl,void 0,e)}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:n}=this,{eventSvc:i,frameworkOverrides:s,gos:o,editSvc:a}=r,l=t.getColDef(),c=n.createEvent(e,"cellDoubleClicked");i.dispatchEvent(c),"function"===typeof l.onCellDoubleClicked&&window.setTimeout((()=>{s.wrapOutgoing((()=>{l.onCellDoubleClicked(c)}))}),0);!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&a?.startRowOrCellEdit(n,null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:r,shiftKey:n}=e,i=e.target,{cellCtrl:s,beans:o}=this,{eventSvc:a,rangeSvc:l,rowNumbersSvc:c,focusSvc:u,gos:d}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&!l.isEmpty(),p=this.containsWidget(i),{cellPosition:g}=s,f=Mr(g.column);if(c&&f&&!c.handleMouseDownOnCell(g,e))return l&&e.preventDefault(),void e.stopImmediatePropagation();if(!n||!h){const t=d.get("enableCellTextSelection")&&e.defaultPrevented,r=(H()||t)&&!s.editing&&!q(i)&&!p;s.focusCell(r)}if(n&&h&&!u.isCellFocused(g)){e.preventDefault();const t=u.getFocusedCell();if(t){const{column:e,rowIndex:r,rowPinned:n}=t,i=o.rowRenderer.getRowByPosition({rowIndex:r,rowPinned:n}),s=i?.getCellCtrl(e);s?.editing&&s.stopEditing(),u.setFocusedCell({column:e,rowIndex:r,rowPinned:n,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!p){if(l)if(f&&e.preventDefault(),n)l.extendLatestRangeToCell(g);else{const e=t||r;l.setRangeToCell(g,e)}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=2===e.button||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(r&&n)return!0}return!1}containsWidget(e){return Z(e,"ag-selection-checkbox",3)||Z(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),r?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),r?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,r=t.contains(e.target),n=t.contains(e.relatedTarget);return r&&n}destroy(){super.destroy()}},fi=class extends rr{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e&&(this.refreshSpanHeight(e),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:this.refreshSpanHeight.bind(this,e),recalculateRowBounds:this.refreshSpanHeight.bind(this,e)}))}refreshSpanHeight(e){const t=e.getCellHeight();null!=t&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();yr(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce(((e,t)=>e+t.getActualWidth()),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,r=e.getColSpan(t),n=[];if(1===r)n.push(e);else{let t=e;const i=e.getPinned();for(let e=0;t&&e<r&&(n.push(t),t=this.beans.visibleCols.getColAfter(t),t&&!ke(t))&&i===t.getPinned();e++);}return n}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gos.get("enableRtl")&&this.colsSpanning?br(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||"left"===this.column.getPinned())return e;const{visibleCols:t}=this.beans,r=t.getColsLeftWidth();if("right"===this.column.getPinned()){return r+t.bodyWidth+(e||0)}return r+(e||0)}_legacyApplyRowSpan(e){if(1===this.rowSpan&&!e)return;const t=ht(this.beans)*this.rowSpan;this.eContent.style.height=`${t}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},mi="cellCtrl";function vi(e,t){return Zt(e,t,mi)}var Ci=0,wi=class extends rr{constructor(e,t,r,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.tooltipFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.beans=r;const{colId:i,colIdSanitised:s}=e;this.instanceId=i+"-"+Ci++,this.colIdSanitised=s,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){const{beans:e}=this;this.positionFeature=new fi(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.mouseListener=new gi(this,e,this.column),this.keyboardListener=new pi(this,e,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();const{rangeSvc:t}=e;t&&Lt(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,r,n,i,s,o){this.comp=e,this.eGui=t,this.printLayout=i,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc((()=>this.removeFeatures())),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),s&&this.isCellEditable()?this.beans.editSvc?.startEditing(this):this.showValue(!1,!0),this.onCompAttachedFuncs.length&&(this.onCompAttachedFuncs.forEach((e=>e())),this.onCompAttachedFuncs=[])}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return null!=e.cellRenderer||null!=e.cellRendererSelector}getValueToDisplay(){return this.valueFormatted??this.value}showValue(e,t){const{beans:r,column:n,rowNode:i,rangeFeature:s}=this,{userCompFactory:o}=r,a=this.getValueToDisplay();let l;const c=i.stub&&null==i.groupData?.[n.getId()],u=n.getColDef();if(c||this.isCellRenderer()){const e=this.createCellRendererParams();l=!c||Mr(n)?Dn(o,u,e):function(e,t,r){return e.getCompDetails(t,bn,"agSkeletonCellRenderer",r,!0)}(o,u,e)}if(!l&&!c&&r.findSvc?.isMatch(i,n)){const e=this.createCellRendererParams();l=Dn(o,{...n.getColDef(),cellRenderer:"agFindCellRenderer"},e)}this.comp.setRenderDetails(l,a,e),!t&&s&&be(r,(()=>s?.refreshHandle()))}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:r}=this.beans.gridOptions,n=Ot(t),i=Ir(this.column);return("custom"!==r||"selectionColumn"===n||!i)&&(e.checkboxSelection||i&&"object"===typeof t&&Mt(t))}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),r=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),i=this.isAutoHeight!=this.column.isAutoHeight();return t||r||n||i}onPopupEditorClosed(){this.editing&&this.beans.editSvc?.stopRowOrCellEdit(this)}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.beans.editSvc?.stopEditing(this,e)??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:r,rowNode:n,comp:i,eGui:s,beans:{valueSvc:o,gos:a}}=this;return Ut(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay(r,n),setValue:e=>o.setValue(n,r,e),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:r.getPinned(),colDef:r.getColDef(),column:r,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:i.getParentOfValue(),registerRowDragger:(e,t,r,n)=>this.registerRowDragger(e,t,n),setTooltip:(e,t)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(e,t),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e)}refreshCell(e){if(this.suppressRefreshCell||this.editing)return;const t=this.column.getColDef(),r=null!=e&&!!e.newData,n=null!=e&&!!e.suppressFlash,i=null==t.field&&null==t.valueGetter&&null==t.showRowGroup,s=e&&e.forceRefresh||i||r,o=!!this.comp,a=this.updateAndFormatValue(o);if(o){if(s||a){this.showValue(r,!1);const e=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!n&&!e&&t.enableCellChangeFlash&&this.beans.cellFlashSvc?.flashCell(this),this.customStyleFeature?.applyUserStyles(),this.customStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshTooltip(),this.customStyleFeature?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,r=this.valueFormatted;return this.value=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=r)}valuesAreEqual(e,t){const r=this.column.getColDef();return r.equals?r.equals(e,t):e===t}addDomData(e){const t=this.eGui;ft(this.beans.gos,t,mi,this),e.addDestroyFunc((()=>ft(this.beans.gos,t,mi,null)))}createEvent(e,t){const{rowNode:r,column:n,value:i,beans:s}=this;return Ut(s.gos,{type:t,node:r,data:r.data,value:i,column:n,colDef:n.getColDef(),rowPinned:r.rowPinned,event:e,rowIndex:r.rowIndex})}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature.getColSpanningList()}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:r}=this;Xn(e,t,r.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);M(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return null!=this.rangeFeature}focusCell(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e})}restoreFocus(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.comp||this.editing||!this.isCellFocused()||!this.beans.focusSvc.shouldTakeFocus())return;const t=()=>{if(!this.isAlive())return;const e=this.comp.getFocusableElement();this.isCellFocused()&&e.focus({preventScroll:!0})};e?setTimeout(t,0):t()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(Mr(this.column)&&(e=!0),Ce(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){const{beans:t}=this;if(di(t))return;if(!this.comp)return void(e&&(this.focusEventWhileNotReady=e));const r=this.isCellFocused();if(this.comp.addOrRemoveCssClass("ag-cell-focus",r),r&&e&&e.forceBrowserFocus){let t=this.comp.getFocusableElement();if(this.editing){const e=si(t,null,!0);e.length&&(t=e[0])}t.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const n="fullRow"===t.gos.get("editType");r||n||!this.editing||t.editSvc?.stopRowOrCellEdit(this),r&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Te(t),column:this.column}}setInlineEditingCss(){this.beans.editSvc?.setInlineEditingCss(this.rowCtrl)}applyStaticCssClasses(){const{comp:e}=this;e.addOrRemoveCssClass("ag-cell",!0),e.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const t=1==this.column.isAutoHeight();e.addOrRemoveCssClass("ag-cell-auto-height",t),e.addOrRemoveCssClass("ag-cell-normal-height",!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0}))}setWrapText(){const e=1==this.column.getColDef().wrapText;this.comp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),r=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(r),t.onCellContextMenu&&window.setTimeout((()=>{n.frameworkOverrides.wrapOutgoing((()=>{t.onCellContextMenu(r)}))}),0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(wt(this.beans))??!1}createSelectionCheckbox(){const e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,r){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const n=this.createRowDragComp(e,t,r);n&&(this.customRowDragComp=n,this.addDestroyFunc((()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null})))}createRowDragComp(e,t,r){const n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,(()=>this.value),e,t,r);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){this.onEditorAttachedFuncs.forEach((e=>e())),this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}},bi="__ag_grid_instance";function yi(e,t){t[bi]=e.gridInstanceId}function Si(e,t){return Ei(e,t.target)}function Ei(e,t){let r=t;for(;r;){const t=r[bi];if(xe(t)){return t===e.gridInstanceId}r=r.parentElement}return!1}function Ri(e,t){return vi(e,t.target)?.getFocusedCellPosition()??null}var Ti=(e=>(e[e.ToolPanel=0]="ToolPanel",e[e.HeaderCell=1]="HeaderCell",e[e.RowDrag=2]="RowDrag",e[e.ChartPanel=3]="ChartPanel",e[e.AdvancedFilterBuilder=4]="AdvancedFilterBuilder",e))(Ti||{});function xi(e,t){const r=e.column===t.column,n=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return r&&n&&i}function ki(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(xe(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}function Pi(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Ai(e,t){const r=e.spannedRowRenderer?.getCellByPosition(t);if(r)return r;const n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function Fi(e,t){const{rowIndex:r,rowPinned:n}=t,{pageBounds:i,pinnedRowModel:s,rowModel:o}=e;if(0===r)return"top"===n?null:"bottom"===n&&o.isRowsToRender()?{rowIndex:i.getLastRow(),rowPinned:null}:s?.isRowsToRender("top")?{rowIndex:s.getPinnedTopRowCount()-1,rowPinned:"top"}:null;return Ii(e,n?void 0:o.getRow(r),!0)??{rowIndex:r-1,rowPinned:n}}function Di(e,t){const{rowIndex:r,rowPinned:n}=t,{pageBounds:i,pinnedRowModel:s,rowModel:o}=e;if(function(e,t){const{rowPinned:r,rowIndex:n}=t,{pinnedRowModel:i,pageBounds:s}=e;if("top"===r){return(i?.getPinnedTopRowCount()??0)-1<=n}if("bottom"===r){return(i?.getPinnedBottomRowCount()??0)-1<=n}const o=s.getLastRow();return o<=n}(e,t))return"bottom"===n?null:"top"===n&&o.isRowsToRender()?{rowIndex:i.getFirstRow(),rowPinned:null}:s?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;return Ii(e,n?void 0:o.getRow(r))??{rowIndex:r+1,rowPinned:n}}function Ii(e,t,r){const{gos:n,rowRenderer:i}=e;if(!t?.sticky||!Rt(n))return;const s=r?i.getStickyTopRowCtrls():i.getStickyBottomRowCtrls();let o;for(let a=0;a<s.length;a++)if(s[a].rowNode.rowIndex===t.rowIndex){o=s[a+(r?-1:1)];break}return o?{rowIndex:o.rowNode.rowIndex,rowPinned:null}:void 0}function Mi(e,t,r){if(0===r)return!1;const n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(n,i)<=r}function Oi(e,t){return e+"_"+t}function Li(e){return e instanceof Ni}var Ni=class extends rr{constructor(e,t,r,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=r,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return Oi(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every((e=>e.isMoving()))}checkLeft(){if(this.displayedChildren.forEach((e=>{Li(e)&&e.checkLeft()})),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const e=br(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren?.forEach((t=>{e+=t.getActualWidth()})),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach((t=>{t.isResizable()&&(e=!0)})),e}getMinWidth(){let e=0;return this.displayedChildren.forEach((t=>{e+=t.getMinWidth()})),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach((t=>{pr(t)?e.push(t):Li(t)&&t.addDisplayedLeafColumns(e)}))}addLeafColumns(e){this.children.forEach((t=>{pr(t)?e.push(t):Li(t)&&t.addLeafColumns(e)}))}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;null!=e&&e.isPadding();)e=e.getParent();if(!(!!e&&e.getProvidedColumnGroup().isExpandable()))return this.displayedChildren=this.children,void this.dispatchLocalEvent({type:"displayedChildrenChanged"});this.children.forEach((t=>{if(Li(t)&&(!t.displayedChildren||!t.displayedChildren.length))return;switch(t.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(t);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(t);break;default:this.displayedChildren.push(t)}})),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},_i="row-group-",Gi=0,Bi=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=Gi++,this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.__selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const{valueCache:r,selectionSvc:n,eventSvc:i}=this.beans,s=this.data;this.data=e,r?.onDataChanged(),this.updateDataOnDetailNode(),n?.updateRowSelectable(this),this.resetQuickFilterAggregateText();const o=this.createDataChangedEvent(e,s,t);this.__localEventService?.dispatchEvent(o),i.dispatchEvent({type:"rowNodeDataChanged",node:this})}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,r){return{type:"dataChanged",node:this,oldData:t,newData:e,update:r}}getRowIndexString(){return null==this.rowIndex?(tt(13),null):"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){const{selectionSvc:r}=this.beans,n=r?.createDaemonNode?.(this),i=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),r&&(r.updateRowSelectable(this),r.syncInRowNode(this,n));const s=this.createDataChangedEvent(e,i,!1);this.__localEventService?.dispatchEvent(s)}setId(e){const t=Dt(this.beans.gos);if(t)if(this.data){const e=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:e.length>0?e:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(_i)&&tt(14,{groupPrefix:_i})}else this.id=void 0;else this.id=e}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,r){this.beans.expansionSvc?.setExpanded(this,e,t,r)}setDataValue(e,t,r){const{colModel:n,valueSvc:i,gos:s,selectionSvc:o}=this.beans,a="string"!==typeof e?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;const l=i.getValueForDisplay(a,this);if(s.get("readOnlyEdit")){const{beans:{eventSvc:e},data:n,rowIndex:i,rowPinned:s}=this;return e.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:i,rowPinned:s,column:a,colDef:a.colDef,data:n,node:this,oldValue:l,newValue:t,value:t,source:r}),!1}const c=i.setValue(this,a,t,r);return this.dispatchCellChangedEvent(a,t,l),o?.updateRowSelectable(this),c}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,r){const n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:r};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){return this.footer?this.sibling.isSelected():this.__selected}depthFirstSearch(e){this.childrenAfterGroup?.forEach((t=>t.depthFirstSearch(e))),e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:r})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){this.__localEventService||(this.__localEventService=new p),this.__localEventService.addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e),this.__localEventService||(this.__localEventService=new p),this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.__localEventService);const r=this.frameworkEventListenerService?.wrap(t)??t;this.__localEventService.addEventListener(e,r)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(t)??t;this.removeLocalListener(e,r)}removeLocalListener(e,t){this.__localEventService?.removeEventListener(e,t),this.__localEventService?.noRegisteredListenersExist()&&(this.__localEventService=null)}isFullWidthCell(){if(et(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(-1===this.level)return[];if(null==this.key)return;const e=[];let t=this;for(;t&&null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};function Hi(e,t,r){return Ut(t,{type:r,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var zi={tag:"div",cls:"ag-filter"},Vi=class extends un{constructor(e,t){super(zi),this.column=e,this.source=t,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then((()=>{}))??dn.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then((t=>{t?.afterGuiAttached?.(e)}))}afterGuiDetached(){this.filterWrapper?.filterPromise?.then((e=>{e?.afterGuiDetached?.()}))}createFilter(e){const{column:t,source:r}=this;this.filterWrapper=this.beans.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then((n=>{const i=n.getGui();xe(i)||et(69,{guiFromFilter:i}),this.appendChild(i),e&&this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:r,eGui:this.getGui()})}))}onFilterDestroyed(e){"api"!==e.source&&"paramsUpdated"!==e.source||e.column.getId()!==this.column.getId()||!this.beans.colModel.getColDefCol(this.column)||(le(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},Wi="ag-resizer-wrapper",Ui=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),ji={tag:"div",cls:Wi,children:[Ui("eTopLeft","topLeft"),Ui("eTop","top"),Ui("eTopRight","topRight"),Ui("eRight","right"),Ui("eBottomRight","bottomRight"),Ui("eBottom","bottom"),Ui("eBottomLeft","bottomLeft"),Ui("eLeft","left")]},$i=class extends rr{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,r=t/2-this.getWidth()/2,n=e/2-this.getHeight()/2;this.offsetElement(r,n)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:r,width:n,minHeight:i,height:s,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=de(this.element);if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const r=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-r}if(null!=t.minHeight){const r=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-r}}if(this.minHeight=i||l,this.minWidth=r||c,n&&this.setWidth(n),s&&this.setHeight(s),n&&s||this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const r=parseFloat(e.style.top),n=parseFloat(e.style.left);t?this.offsetElement(isNaN(n)?0:n,isNaN(r)?0:r):this.setPosition(n,r)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(r),this.moveElementDragListener=r):(this.dragSvc?.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach((t=>{const r=!!e[t],n=this.getResizerElement(t),i={dragStartPixels:0,eElement:n,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(r||!this.isAlive()&&!r)&&(r?(this.dragSvc?.addDragSource(i),this.resizeListeners.push(i),n.style.pointerEvents="all"):n.style.pointerEvents="none",this.resizable[t]=r)}))}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=`${t}px`),-1!==e&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let n=!1;if("string"===typeof e&&-1!==e.indexOf("%"))fe(r,e),e=ne(r),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(n?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?fe(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const n=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:n.top,o=e?0:i.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-n.bottom}}return r+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let n=!1;if("string"===typeof e&&-1!==e.indexOf("%"))ge(t,e),e=ie(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,n=r?this.position.x:this.element.getBoundingClientRect().left;t&&e+n>t&&(e=t-n)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?ge(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))}offsetElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{forcePopupParentAsOffsetParent:r}=this.config,n=r?this.boundaryEl:this.element;n&&(this.popupSvc?.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height",`${e}px`)};e&&this.popupSvc?this.resizeObserverSubscriber=we(this.beans,this.popupSvc?.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:n,anywhereWithin:i,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!r,!!i,o)?0:o,movementY:this.shouldSkipY(t,!!n,s,a)?0:a}}shouldSkipX(e,t,r,n){const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:i.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return!!l||(l=t?n<0&&e.clientX>a+s.left||n>0&&e.clientX<a+s.left:r?n<0&&e.clientX>o.right||n>0&&e.clientX<a+s.left:n<0&&e.clientX>o.right||n>0&&e.clientX<o.right,l)}shouldSkipY(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:i.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return!!l||(l=t?n<0&&e.clientY>a+s.top+r||n>0&&e.clientY<a+s.top:n<0&&e.clientY>o.bottom||n>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=e=>({element:this.element.querySelector(`[data-ref=${e}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(Re(ji)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${Wi}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:n}=this.config;r||n||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter((e=>!e.classList.contains("ag-hidden"))):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(let n=0;n<e.length;n++){const i=e[n],s=!!i.style.flex&&"0 0 auto"!==i.style.flex;if(i===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(s){const e=window.getComputedStyle(i);e.minHeight&&(o=parseInt(e.minHeight,10)),e.minWidth&&(a=parseInt(e.minWidth,10))}else o=i.offsetHeight,a=i.offsetWidth;t+=o,r+=a}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let n=0;n<r.length;n++){const i=r[n];i!==t&&(e?i.style.height=`${i.offsetHeight}px`:i.style.width=`${i.offsetWidth}px`,i.style.flex="0 0 auto",i===this.element&&(t=r[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some((e=>e))}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:n,isRight:i,isBottom:s,isLeft:o}=this.currentResizer,a=i||o,l=s||n,{movementX:c,movementY:u}=this.calculateMouseMovement({e:e,isLeft:o,isTop:n}),d=this.position.x,h=this.position.y;let p=0,g=0;if(a&&c){const e=o?-1:1,t=this.getWidth(),r=t+c*e;let n=!1;o&&(p=t-r,(d+p<=0||r<=this.minWidth)&&(n=!0,p=0)),n||this.setWidth(r)}if(l&&u){const e=n?-1:1,t=this.getHeight(),r=t+u*e;let i=!1;n?(g=t-r,(h+g<=0||r<=this.minHeight)&&(i=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&t<r&&this.getMinSizeOfSiblings().height+r>this.element.parentElement.offsetHeight&&(i=!0),i||this.setHeight(r)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&p||g)&&this.offsetElement(d+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());const{movementX:i,movementY:s}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+i,r+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},Ki="ag-focus-managed",Yi=class extends rr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.eFocusable=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=ai(this.beans,this.eFocusable,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())},...t}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:r}}=this;e.classList.add(Ki),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),r&&this.addManagedElementListeners(e,{focusout:r})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:e=>{if(e.defaultPrevented||Jt(e))return;const{callbacks:t}=this;t.shouldStopEventPropagation(e)?Xt(e):e.key===Qn.TAB?t.onTabKeyDown(e):t.handleKeyDown&&t.handleKeyDown(e)}})}},qi={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function Xi(e,t){const{debounceMs:r}=e;return Ji(e)?(null!=r&&et(71),0):r??t}function Ji(e){return(e.buttons?.indexOf("apply")??-1)>=0}var Qi=class extends un{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=cn,this.buttonListeners=[],this.defaultDebounceMs=0}postConstruct(){this.resetTemplate(),this.createManagedBean(new Yi(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new $i(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t?.removeEventListener("submit",this.onFormSubmit);const r={tag:"form",cls:"ag-filter-wrapper",children:[{tag:"div",ref:"eFilterBody",cls:`ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper`,children:[this.createBodyTemplate()]}]};this.setTemplate(r,this.getAgComponents(),e),t=this.getGui(),t?.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.params.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then((()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}setParams(e){this.params=e,this.applyActive=Ji(e),this.resetButtonsPanel(e)}updateParams(e){this.params=e,this.applyActive=Ji(e),this.resetUiToActiveModel(this.getModel(),(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}resetButtonsPanel(e,t){const{buttons:r,readOnly:n}=t??{},{buttons:i,readOnly:s}=e;if(n===s&&Ae(r,i))return;const o=i&&i.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(le(this.eButtonsPanel),this.buttonListeners.forEach((e=>e())),this.buttonListeners=[]):o&&(this.eButtonsPanel=Re({tag:"div",cls:"ag-filter-apply-panel"})),!o)return void(this.eButtonsPanel&&ce(this.eButtonsPanel));const a=document.createDocumentFragment(),l=e=>{let t;const r=e?this.translate(`${e}Filter`):void 0;switch(e){case"apply":t=e=>this.onBtApply(!1,!1,e);break;case"clear":t=()=>this.onBtClear();break;case"reset":t=()=>this.onBtReset();break;case"cancel":t=e=>{this.onBtCancel(e)};break;default:return void et(75)}const n=he(`<button\n                    type="${"apply"===e?"submit":"button"}"\n                    data-ref="${e}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${r}\n                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(n,{click:t})),a.append(n)};i.forEach((e=>l(e))),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}setupOnBtApplyDebounce(){const e=Xi(this.params,this.defaultDebounceMs),t=He(this,this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel??null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then((()=>{this.updateUiVisibility(),this.applyModel("api")}))}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),(()=>{this.handleCancelEnd(e)}))}handleCancelEnd(e){this.params.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const r=()=>{this.onUiChanged(!1,"prevent"),t?.()};null!=e?this.setModelIntoUi(e).then(r):this.resetUiToDefaults().then(r)}onBtClear(){this.resetUiToDefaults().then((()=>this.onUiChanged()))}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(){const e=this.getModelFromUi();if(!this.isModelValid(e))return!1;const t=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(t,e)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;if(r&&r.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")){const r="columnFilter";this.params.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:r})}const{closeOnApply:n}=this.params;n&&this.applyActive&&!e&&!t&&this.close(r)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,r=t&&t.key;let n;"Enter"!==r&&"Space"!==r||(n={keyboardEvent:t}),this.hidePopup(n),this.hidePopup=null}onUiChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.updateUiVisibility(),this.params.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi()),t=this.queryForHtmlElement('[data-ref="applyFilterButton"]');t&&Q(t,!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:r}=this;if(!t||"toolPanel"===e)return;"floatingFilter"===e||"columnFilter"===e?(t.restoreLastSize(),t.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.params;return this.params=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.getLocaleTextFunc()(e,qi[e])}getCellValue(e){return this.params.getValue(e)}getPositionableElement(){return this.eFilterBody}};function Zi(e,t,r){if(null==t)return null;let n=null;const{compName:i,jsComp:s,fwComp:o}=function(e,t){return hn(e,t,Rn)}(e,t);if(i){n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[i]}else{null==s&&null==o&&!0===t.filter&&(n=r())}return n}var es={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},ts=class extends rr{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},r=t.autoHeight?es.AUTO_HEIGHT:t.print?es.PRINT:es.NORMAL;this.view.updateLayoutClasses(r,t)}},rs="Viewport",ns="fakeVScrollComp",is=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],ss=class extends rr{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=He(this,(()=>this.lastScrollSource[1]=null),150),this.resetLastVScrollDebounced=He(this,(()=>this.lastScrollSource[0]=null),150)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),gridSizeChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()}))}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,rs)});for(const e of is){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?He(this,this.onVScroll.bind(this,rs),100):this.onVScroll.bind(this,rs),n=t?He(this,this.onVScroll.bind(this,ns),100):this.onVScroll.bind(this,ns);this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){null==this.centerRowsCtrl||(void 0===e&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...is,rs]){if(this.lastScrollSource[1]===t)continue;ae(this.getViewportForSource(t),e,this.enableRtl)}}getViewportForSource(e){return e===rs?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(0===t?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const n=oe(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(t=e===rs?this.eBodyViewport.scrollTop:this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:r}=this;r?.setScrollTop(t),this.nextScrollTop=t,e===rs?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,r?.active?r.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:1===e?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout((()=>{this.scrollTimer=0,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})}),150)}shouldBlockScrollUpdate(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&!W())&&(0===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=te(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll(rs)}scrollGridIfNeeded(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(e=this.enableRtl?e>0?0:r:Math.min(Math.max(e,0),r)),ae(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:e,lastScrollTop:t}=this;return{top:t,bottom:t+e}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{rowModel:r}=this.beans,n=r.getRowCount();let i=-1;for(let s=0;s<n;s++){const t=r.getRow(s);if("function"===typeof e){if(t&&e(t)){i=s;break}}else if(e===t||e===t.data){i=s;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(lt(this.gos,"print"))return;const{rowModel:r}=this.beans,n=r.getRowCount();if("number"!==typeof e||e<0||e>=n)return void et(88,{index:e});const{frameworkOverrides:i,pageBounds:s,rowContainerHeight:o,rowRenderer:a}=this.beans;i.wrapIncoming((()=>{const n=this.ctrlsSvc.getGridBodyCtrl(),i=r.getRow(e);let l,c,u=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:e,stickyBottomHeight:r}=n,d=i.rowTop,h=i.rowHeight,p=s.getPixelOffset(),g=i.rowTop-p,f=g+i.rowHeight,m=this.getVScrollPosition(),v=o.divStretchOffset,C=m.top+v,w=m.bottom+v,b=w-C,y=o.getScrollPositionForPixel(g),S=o.getScrollPositionForPixel(f-b),E=Math.min((y+S)/2,g);let R=null;"top"===t?R=y-e:"bottom"===t?R=S+r:"middle"===t?R=E:C+e>g?R=y-e:w-r<f&&(R=S+r),null!==R&&(this.setVerticalScrollPosition(R),a.redraw({afterScroll:!0})),l=d!==i.rowTop||h!==i.rowHeight,c=e!==n.stickyTopHeight||r!==n.stickyBottomHeight,u++}while((l||c)&&u<10);this.animationFrameSvc?.flushAllFrames()}))}ensureColumnVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{colModel:r,frameworkOverrides:n}=this.beans,i=r.getCol(e);if(!i)return;if(i.isPinned())return;if(!this.visibleCols.isColDisplayed(i))return;const s=this.getPositionedHorizontalScroll(i,t);n.wrapIncoming((()=>{null!==s&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()}))}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:n}=this.isColumnOutsideViewport(e),i=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:n)||i,l=o?n:r;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:r,colRight:n}=this.getColumnBounds(e);return c?r-s/2:a?o?n:t:o?t-s:n-s}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:n,colRight:i}=this.getColumnBounds(e),s=this.enableRtl;return{columnBeforeStart:s?t>i:r<i,columnAfterEnd:s?r<n:t>n}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleCols.bodyWidth,n=e.getActualWidth(),i=e.getLeft(),s=t?-1:1,o=t?r-i:i;return{colLeft:o,colMiddle:o+n/2*s,colRight:o+n*s}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}},os=class extends rr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=lt(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:r}=this.beans,n=t.bodyWidth,i=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth();let o;if(e)o=n+i+s;else if(o=n,this.addSpacer){0===(this.gos.get("enableRtl")?i:s)&&r.verticalScrollShowing&&(o+=r.getScrollbarWidth())}this.callback(o)}},as=class extends rr{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()})),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],(()=>{this.checkViewportAndScrolls()}))}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:r}=this,n=()=>{be(e,(()=>{this.onCenterViewportResized()}))};t.registerViewportResizeListener(n),r.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const r=this.centerContainerCtrl.getCenterWidth();r!==this.centerWidth&&(this.centerWidth=r,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=te(this.gridBodyCtrl.eBodyViewport);this.bodyHeight!==e&&(this.bodyHeight=e,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function ls(e,t,r,n,i,s){if(null==r&&null==t)return;const o={},a={},l=(e,t)=>{e.split(" ").forEach((e=>{""!=e.trim()&&t(e)}))};if(r){const t=Object.keys(r);for(let i=0;i<t.length;i++){const s=t[i],c=r[s];let u;"string"===typeof c?u=!e||e.evaluate(c,n):"function"===typeof c&&(u=c(n)),l(s,(e=>{u?o[e]=!0:a[e]=!0}))}}t&&s&&Object.keys(t).forEach((e=>l(e,(e=>{o[e]||(a[e]=!0)})))),s&&Object.keys(a).forEach(s),Object.keys(o).forEach(i)}function cs(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var us=0,ds="renderedRow",hs=class extends rr{constructor(e,t,r,n,i){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=i,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+us++,this.rowId=cr(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=cs(this.rowNode),this.setRowType(),this.setAnimateFlags(r),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!==typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=cr(e)}updateGui(e,t){"left"===e?this.leftGui=t:"right"===e?this.rightGui=t:"fullWidth"===e?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,r,n){const{context:i,focusSvc:s}=this.beans,o={rowComp:e,element:t,containerType:r,compBean:n=on(this,i,n)};this.allRowGuis.push(o),this.updateGui(r,o),this.initialiseRowComp(o);const a=this.rowNode,l="FullWidthLoading"===this.rowType||a.stub,c=!a.data&&"infinite"===this.beans.rowModel.getType();l||c||a.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const u=this.fullWidthGui?.element;u&&!this.editing&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout((()=>u.focus({preventScroll:!0})),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter((t=>t.containerType!==e)),this.updateGui(e,void 0)}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach((e=>e.element.style.display=t))}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),ct(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=e.rowComp;this.getInitialRowClasses(e.containerType).forEach((e=>r.addOrRemoveCssClass(e,!0))),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&x(e.element,1==this.rowNode.expanded),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),ft(t,e.element,ds,this),e.compBean.addDestroyFunc((()=>ft(t,e.element,ds,null))),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask((()=>{this.isAlive()&&e.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKey&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=cr(this.rowNode.id);this.rowId=t,null!=t&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Be((()=>{this.onTopChanged()})),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(Be((()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){const t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const r=this.createBean(t,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc((()=>{this.rowDragComps=this.rowDragComps.filter((e=>e!==r)),this.destroyBean(r,this.beans.context)}))}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),r=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(r)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map((e=>e?.rowComp?.getFullWidthCellRenderer())):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;e({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:r,beans:{visibleCols:n}}=this,i=!!e||!n.isPinningLeft(),s=!!t,o=!!r||!n.isPinningRight();return i&&s&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this.rowNode})}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),r=this.gos.get("masterDetail")&&this.rowNode.detail,n=this.beans.colModel.isPivotMode(),i=!!this.rowNode.group&&!this.rowNode.footer&&Ft(this.gos,n);this.rowType=e?"FullWidthLoading":r?"FullWidthDetail":t?"FullWidth":i?"FullWidthGroup":"Normal"}updateColumnLists(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isFullWidth())return;const{animationFrameSvc:r}=this.beans;!r?.active||e||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(r.createTask((()=>{this.active&&this.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){const t=this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode);if(!t)return new wi(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n={list:[],map:{}},i=(e,t,r)=>{null!=r?n.list.splice(r,0,t):n.list.push(t),n.map[e]=t},s=[];for(const c of t){const t=c.getInstanceId();let r=e.map[t];r&&!this.isCorrectCtrlForSpan(r)&&(r.destroy(),r=void 0),r||(r=this.getNewCellCtrl(c)),r&&i(t,r)}for(const c of e.list){const e=c.column.getInstanceId();if(null!=n.map[e])continue;!this.isCellEligibleToBeRemoved(c,r)?s.push([e,c]):c.destroy()}if(s.length)for(const[c,u]of s){const e=n.list.findIndex((e=>e.column.getLeft()>u.column.getLeft())),t=-1===e?void 0:Math.max(e-1,0);i(c,u,t)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==r){const e=l.column.getInstanceId();if(!n.map[e]&&a.allCols.includes(l.column)){const t=this.createFocusedCellCtrl();if(t){const r=n.list.findIndex((e=>e.column.getLeft()>t.column.getLeft())),s=-1===r?void 0:Math.max(r-1,0);i(e,t,s)}}}return n}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,r=e.getFocusedCell();if(!r)return;const n=t?.getCellSpan(r.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(r))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(r.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach((t=>{const r=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(r,e)}))}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const r=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);const n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");const i=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}}isCellEligibleToBeRemoved(e,t){const r=!0,{column:n}=e;if(n.getPinned()!=t)return r;if(!this.isCorrectCtrlForSpan(e))return r;const{editing:i}=e,{visibleCols:s}=this.beans,o=e.isCellFocused();if(i||o){return!(s.allCols.indexOf(n)>=0)&&r}return r}getDomOrder(){return this.gos.get("ensureDomOrder")||lt(this.gos,"print")}listenOnDomOrder(e){e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],(()=>{e.rowComp.setDomOrder(this.getDomOrder())}))}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=xe(this.rowNode.oldRowTop),{visibleCols:r}=this.beans,n=r.isPinningLeft(),i=r.isPinningRight();if(t){const{slideInAnimation:e}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(e.fullWidth=!0);e.center=!0,e.left=n,e.right=i}else{const{fadeInAnimation:e}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(e.fullWidth=!0);e.center=!0,e.left=n,e.right=i}}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const e=(e,t)=>!e||e.rowComp.refreshFullWidth((()=>this.createFullWidthCompDetails(e.element,t).params)),t=e(this.fullWidthGui,null),r=e(this.centerGui,null),n=e(this.leftGui,"left"),i=e(this.rightGui,"right");return t&&r&&n&&i}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...this.beans.expansionSvc?.getRowExpandedListeners(this)??{}}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventSvc,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.beans.rowSpanSvc&&this.addManagedListeners(this.beans.rowSpanSvc,{spannedCellsUpdated:e=>{let{pinned:t}=e;t&&!this.rowNode.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc((()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context)})),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",(()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach((e=>{this.addRowDraggerToRow(e)})):this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)})),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onRowIndexChanged()))},cellChanged:e=>{this.getAllCellCtrls().forEach((t=>t.onCellChanged(e)))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell())this.beans.rowRenderer.redrawRow(this.rowNode);else if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode)}else this.getAllCellCtrls().forEach((t=>t.refreshCell({suppressFlash:!e.update,newData:!e.update}))),this.allRowGuis.forEach((e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)})),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach((t=>{const r="Above"===e,n="Below"===e;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",r),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",n)}))}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e)))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Te(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:r,column:n}=t;if(!(r.element===e.target))return;const i=this.rowNode,{focusSvc:s,navigation:o}=this.beans,a=s.getFocusedCell(),l={rowIndex:i.rowIndex,rowPinned:i.rowPinned,column:a?.column??n};o?.navigateToNextCell(e,e.key,l,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||Jt(e))return;const t=this.allRowGuis.find((t=>t.element.contains(e.target))),r=t?t.element:null,n=r===e.target,i=wt(this.beans);let s=!1;r&&i&&(s=r.contains(i)&&i.classList.contains("ag-cell"));let o=null;n||s||(o=ai(this.beans,r,!1,e.shiftKey)),(this.isFullWidth()&&n||!o)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find((e=>de(e.element)))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach((e=>{Ce(e.element,"tabindex",t)}))}onFullWidthRowFocused(e){const t=this.rowNode,r=!!e&&(this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned);let n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{const t=this.beans.colModel.getCol(e?.column),r=t?.pinned;n=r?"right"===r?this.rightGui?.element:this.leftGui?.element:this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",r),r&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const r={list:[],map:{}};return e.list.forEach((e=>{e!==t&&(r.list.push(e),r.map[e.column.getInstanceId()]=e)})),r}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){const{rowNode:r}=this;return Ut(this.gos,{type:e,node:r,data:r.data,rowIndex:r.rowIndex,rowPinned:r.rowPinned,event:t})}createRowEventWithSource(e,t){const r=this.createRowEvent(e,t);return r.source=this,r}onRowDblClick(e){Jt(e)||this.beans.eventSvc.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),r=this.getColumnForFullWidth(t);return t&&r?{rowGui:t,column:r}:void 0}findFullWidthRowGui(e){return this.allRowGuis.find((t=>t.element.contains(e)))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Z(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode,{rangeSvc:r,focusSvc:n}=this.beans;r?.removeAllCellRanges();const i=this.findFullWidthInfoForEvent(e);if(!i)return;const{rowGui:s,column:o}=i,a=s.element,l=e.target;let c=e.defaultPrevented||H();a&&a.contains(l)&&q(l)&&(c=!1),n.setFocusedCell({rowIndex:t.rowIndex,column:o,rowPinned:t.rowPinned,forceBrowserFocus:c})}onRowClick(e){if(Jt(e)||this.lastMouseDownOnDragger)return;const{eventSvc:t,selectionSvc:r}=this.beans;t.dispatchEvent(this.createRowEventWithSource("rowClicked",e)),r?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){"FullWidthDetail"===this.rowType&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){const{gos:r,rowNode:n}=this,i=Ut(r,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,r,n)=>this.addFullWidthRowDragging(e,t,r,n),setTooltip:(e,t)=>{r.assertModuleRegistered("Tooltip",3),this.refreshRowTooltip(e,t)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return function(e,t){return e.getCompDetailsFromGridOptions(An,"agDetailCellRenderer",t,!0)}(s,i);case"FullWidthGroup":return i.value=n.groupValue,i.valueFormatted=n.rowGroupColumn?this.beans.valueSvc.formatValue(n.rowGroupColumn,n,i.value):i.value,function(e,t){return e.getCompDetailsFromGridOptions(Pn,"agGroupRowRenderer",t,!0)}(s,i);case"FullWidthLoading":return function(e,t){return e.getCompDetailsFromGridOptions(kn,"agLoadingCellRenderer",t,!0)}(s,i);default:return function(e,t){return e.getCompDetailsFromGridOptions(xn,void 0,t,!0)}(s,i)}}refreshRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.refreshRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3?arguments[3]:void 0;const{rowDragSvc:i,context:s}=this.beans;if(!i||!this.isFullWidth())return;const o=i.createRowDragComp((()=>r),this.rowNode,void 0,e,t,n);this.createBean(o,s),this.addDestroyFunc((()=>{this.destroyBean(o,s)}))}onUiLevelChanged(){const e=cs(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,r="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(r,!1)}))}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-first",e)))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-row-last",t))))}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=[];this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),e.length&&e.forEach((e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}))}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}),(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!1)))}))}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,(e=>e.rowComp.setUserStyles(this.rowStyles)))}getPinnedForContainer(e){return"left"===e||"right"===e?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),r=this.isFullWidth(),{rowNode:n,beans:i}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&s.push("ag-row-pinned"),n.isSelected()&&s.push("ag-row-selected"),n.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),n.stub&&s.push("ag-row-loading"),r&&s.push("ag-full-width-row"),i.expansionSvc?.addExpandedCss(s,n),n.dragging&&s.push("ag-row-dragging");const{rowStyleSvc:o}=i;return o&&(o.processClassesFromGridOptions(s,n),o.preProcessRowClassRules(s,n)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),r&&("left"===t&&s.push("ag-cell-last-left-pinned"),"right"===t&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,(e=>{e!==this.centerGui&&e!==this.fullWidthGui||this.announceDescription()}),e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:r}=e,{rowNode:n,beans:i,gos:s}=this;r.addManagedListeners(t,{mouseenter:()=>n.dispatchRowEvent("mouseEnter"),mouseleave:()=>n.dispatchRowEvent("mouseLeave")}),r.addManagedListeners(n,{mouseEnter:()=>{i.dragSvc?.dragging||s.get("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map((e=>e.element));for(const r of t)r.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),r=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(r,e),n)}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,r=this.beans.environment.getDefaultRowHeight(),n=ut(this.gos)?dt(this.beans,this.rowNode).height:void 0,i=n?Math.min(r,n)-2+"px":void 0;this.forEachGui(e,(e=>{e.element.style.height=`${t}px`,i&&e.element.style.setProperty("--ag-line-height",i)}))}destroyFirstPass(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.active=!1;const{rowNode:t}=this;if(!e&&Et(this.gos)&&!t.sticky){if(null!=t.rowTop){const e=this.roundRowTopToBounds(t.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)))}this.fullWidthGui?.element.contains(wt(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventSvc.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.beans.editSvc?.stopRowEditing(this);const e=e=>(e.list.forEach((e=>e.destroy())),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)}))}onCellFocusChanged(){const{focusSvc:e,editSvc:t}=this.beans,r=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);r!==this.rowFocused&&(this.rowFocused=r,this.setFocusedClasses()),!r&&this.editing&&t?.stopRowEditing(this,!1)}onPaginationChanged(){const e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.pageBounds.getPixelOffset()*(t?1:-1)}setRowTop(e){if(!this.printLayout&&xe(e)){const t=this.applyPaginationOffset(e),r=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(r)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let r;if(t.sticky)r=t.stickyRowTop;else{const n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,i=this.applyPaginationOffset(n);r=t.isRowPinned()?i:this.beans.rowContainerHeight.getRealPixelPosition(i)}return r+"px"}setRowTopStyle(e){this.allRowGuis.forEach((t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)))}getCellCtrl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null;return this.getAllCellCtrls().forEach((t=>{t.column==e&&(r=t)})),null!=r||t||this.getAllCellCtrls().forEach((t=>{t.getColSpanningList().indexOf(e)>=0&&(r=t)})),r}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(null===t)return;const r=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,i=r+this.rowNode.rowIndex+1;this.forEachGui(e,(e=>{e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",n),e.rowComp.addOrRemoveCssClass("ag-row-odd",!n),D(e.element,i)}))}};function ps(e){if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===e.key?.length}function gs(e,t,r,n,i){const s=n?n.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=Ut(e,{event:t,editing:i,column:n,node:r,data:r.data,colDef:n.getColDef()});if(s){if(s(o))return!0}return!1}function fs(e){const{pinnedRowModel:t,rowModel:r}=e,[n,i]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],s=n?null:"top";let o,a;i?(o=null,a=r.getRowCount()-1):(o="bottom",a=t?.getPinnedBottomRowCount()??-1);const{visibleCols:l,rangeSvc:c}=e,u=l.allCols;c&&u?.length&&c.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:o})}var ms=class extends rr{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this)}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Qt("touchstart")?"touchstart":"mousedown"].forEach((e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}))}processMouseEvent(e,t){if(!Si(this.gos,t)||Jt(t))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);"contextmenu"===e?(r?.column&&r.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,r)):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:vi(t,e),rowCtrl:Zt(t,e,ds)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):n&&n.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,r){const{rowNode:n,column:i,editing:s}=e;if(!gs(this.gos,r,n,i,s)&&"keydown"===t){!s&&this.beans.navigation?.handlePageScrollingKey(r)||e.onKeyDown(r),this.doGridOperations(r,e.editing),ps(r)&&e.processCharacter(r)}"keydown"===t&&this.eventSvc.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const{rowNode:n}=e,{focusSvc:i,navigation:s}=this.beans,o=i.getFocusedCell(),a=o&&o.column;if(!gs(this.gos,r,n,a,!1)){const n=r.key;if("keydown"===t)switch(n){case Qn.PAGE_HOME:case Qn.PAGE_END:case Qn.PAGE_UP:case Qn.PAGE_DOWN:s?.handlePageScrollingKey(r,!0);break;case Qn.LEFT:case Qn.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case Qn.UP:case Qn.DOWN:e.onKeyboardNavigate(r);break;case Qn.TAB:e.onTabKeyDown(r)}}"keydown"===t&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!Si(this.gos,e))return;const r=function(e){const{keyCode:t}=e;let r;switch(t){case 65:r=Qn.A;break;case 67:r=Qn.C;break;case 86:r=Qn.V;break;case 68:r=Qn.D;break;case 90:r=Qn.Z;break;case 89:r=Qn.Y;break;default:r=e.code}return r}(e),{clipboardSvc:n,undoRedo:i}=this.beans;return r===Qn.A?this.onCtrlAndA(e):r===Qn.C?this.onCtrlAndC(n,e):r===Qn.D?this.onCtrlAndD(n,e):r===Qn.V?this.onCtrlAndV(n,e):r===Qn.X?this.onCtrlAndX(n,e):r===Qn.Y?this.onCtrlAndY(i):r===Qn.Z?this.onCtrlAndZ(i,e):void 0}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:r,selectionSvc:n},gos:i}=this;r&&Lt(i)&&t.isRowsToRender()?fs(this.beans):n&&n?.selectAllRowNodes({source:"keyboardSelectAll",selectAll:Gt(i)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);r?.editing||n?.editing||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);r?.editing||n?.editing||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);r?.editing||n?.editing||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){this.gos.get("undoRedoCellEditing")&&e&&(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},vs=class extends rr{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,r=null!=t?`${t}px`:"";this.eContainer.style.height=r,this.eViewport&&(this.eViewport.style.height=r)}},Cs=e=>e.topRowCtrls,ws=e=>e.getStickyTopRowCtrls(),bs=e=>e.getStickyBottomRowCtrls(),ys=e=>e.bottomRowCtrls,Ss=e=>e.allRowCtrls,Es=e=>e.getCtrls("top"),Rs=e=>e.getCtrls("center"),Ts=e=>e.getCtrls("bottom"),xs={center:{type:"center",name:"center-cols",getRowCtrls:Ss,getSpannedRowCtrls:Rs},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:Ss,getSpannedRowCtrls:Rs},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:Ss,getSpannedRowCtrls:Rs},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:Ss},topCenter:{type:"center",name:"floating-top",getRowCtrls:Cs,getSpannedRowCtrls:Es},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Cs,getSpannedRowCtrls:Es},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Cs,getSpannedRowCtrls:Es},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:Cs},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:ws},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:ws},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:ws},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:ws},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:bs},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:bs},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:bs},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:bs},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:ys,getSpannedRowCtrls:Ts},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:ys,getSpannedRowCtrls:Ts},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:ys,getSpannedRowCtrls:Ts},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:ys}};function ks(e){return`ag-${Fs(e).name}-viewport`}function Ps(e){const t=Fs(e);return t.container??`ag-${t.name}-container`}function As(e){return`ag-${Fs(e).name}-spanned-cells-container`}function Fs(e){return xs[e]}var Ds=["center","left","right","fullWidth"],Is=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],Ms=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],Os=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],Ls=["stickyTopCenter","stickyTopLeft","stickyTopRight"],Ns=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],_s=[...Ls,"stickyTopFullWidth",...Ns,"stickyBottomFullWidth"],Gs=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right",...Ls,...Ns],Bs=class extends rr{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Fs(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],(()=>{this.viewportSizeFeature=this.createManagedBean(new as(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})}))}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,r,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=r,this.eViewport=n,this.createManagedBean(new ms(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:i,rangeSvc:s}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(Ms,(()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})})),this.forContainers(Os,(()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})})),this.forContainers(Ds,(()=>this.createManagedBean(new vs(this.eContainer,"center"===this.name?n:void 0)))),s&&this.forContainers(Gs,(()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer)))),this.forContainers(Is,(()=>this.createManagedBean(new os((e=>this.comp.setContainerWidth(`${e}px`)))))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans;this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const t=this.options.getSpannedRowCtrls(e);t&&this.comp.setSpannedRowCtrls(t,!1)}})}listenOnDomOrder(){if(_s.indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gos.get("ensureDomOrder"),t=lt(this.gos,"print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}onDisplayedColumnsChanged(){this.forContainers(["center"],(()=>this.onHorizontalViewportChanged()))}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=t=>{e.dragging&&t.cancelable&&t.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc((()=>this.eContainer.removeEventListener("touchmove",t)))}onHorizontalViewportChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return re(this.eViewport)}getCenterViewportScrollLeft(){return oe(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=we(this.beans,this.eViewport,e);this.addDestroyFunc((()=>t()))}isViewportInTheDOMTree(){return ue(this.eViewport)}getViewportScrollLeft(){return oe(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||(e=this.eViewport).clientWidth<e.scrollWidth;var e}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){ae(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(null!=this.options.pinnedType)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||0===t.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const r=lt(this.gos,"print"),n=this.gos.get("embedFullWidthRows")||r,i=t.filter((e=>{const t=e.isFullWidth();return this.options.fullWidth?!n&&t:n||!t}));this.comp.setRowCtrls({rowCtrls:i,useFlushSync:e})}},Hs="ag-force-vertical-scroll",zs=class extends rr{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,r,n,i,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=n,this.eBottom=i,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${ks("center")}`),this.eFullWidthContainer=r.querySelector(`.${Ps("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${Ps("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${Ps("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",(e=>this.setCellTextSelection(e.currentValue))),this.createManagedBean(new ts(this.comp)),this.scrollFeature=this.createManagedBean(new ss(this.eBodyViewport)),this.beans.rowDragSvc?.setupRowDrag(this.eBodyViewport,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,r,i,s,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t}),this.addManagedPropertyListener("treeData",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const r=`calc(100% + ${(t&&e.getScrollbarWidth()||0)+(K()?16:0)}px)`;be(this.beans,(()=>this.comp.setBodyViewportWidth(r))),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t}=this;let r=this.gos.get("treeData");if(!r){const n=t.isPivotMode();r=(e?e.columns.length:0)>=(n?2:1)}this.comp.setGridRootRole(r?"treegrid":"grid")}addFocusListeners(e){e.forEach((e=>{this.addManagedElementListeners(e,{focusin:t=>{const{target:r}=t,n=Z(r,"ag-root",e);e.classList.toggle("ag-has-focus",!n)},focusout:t=>{const{target:r,relatedTarget:n}=t,i=e.contains(n),s=Z(n,"ag-root",e);Z(r,"ag-root",e)||i&&!s||e.classList.remove("ag-has-focus")}})}))}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.comp.setCellSelectableCss("ag-selectable",e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){const e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,r=t.isLastRowIndexKnown()?t.getRowCount():-1,n=-1===r?-1:e+r;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?Hs:null,r=lt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&(n=this.eBodyViewport).clientHeight<n.scrollHeight;var n}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let r=t.sizesMeasured;const n=()=>{const t=r&&Et(this.gos)&&!e.stretching,n=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(n,t)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({gridStylesChanged:()=>{!r&&t.sizesMeasured&&(r=!0,n())}})}addBodyViewportListener(){const{popupSvc:e,touchSvc:t}=this.beans,r=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:r}),t?.mockBodyContextMenu(this,r),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this,e)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&Si(this.gos,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e,i=n||Math.abs(t)>Math.abs(r),s=e.target;i?(this.eStickyTopFullWidthContainer.contains(s)||this.eStickyBottomFullWidthContainer.contains(s))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(r))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){if(!e&&!r)return;if(this.gos.get("preventDefaultOnContextMenu")){(e||r).preventDefault()}const{target:n}=e||t;n!==this.eBodyViewport&&n!==this.ctrlsSvc.get("center").eViewport||this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e?.getPinnedTopTotalHeight()??0,r=e?.getPinnedBottomTotalHeight()??0;this.comp.setTopHeight(t),this.comp.setBottomHeight(r),this.comp.setTopInvisible(t<=0),this.comp.setBottomInvisible(r<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(e){const e=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${e}px)`)}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}setStickyTopOffsetTop(){const e=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),t=this.pinnedRowModel?.getPinnedTopTotalHeight()??0;let r=0;e>0&&(r+=e),t>0&&(r+=t),r>0&&(r+=1),this.comp.setStickyTopTop(`${r}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:r}=this,n=(e?.getPinnedBottomTotalHeight()??0)+(t.horizontalScrollShowing&&t.getScrollbarWidth()||0);r.setStickyBottomBottom(`${n}px`)}},Vs=class extends un{constructor(e,t){super(),this.direction=t,this.eViewport=cn,this.eContainer=cn,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",V()||W())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=K(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),r=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),be(this.beans,(()=>this.setScrollVisible()))}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout((()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=0}),400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;Ve((()=>de(t)),(()=>this.setScrollPosition(e)),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},Ws={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},Us=class extends Vs{constructor(){super(Ws,"horizontal"),this.eLeftSpacer=cn,this.eRightSpacer=cn,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new os((e=>this.eContainer.style.width=`${e}px`))),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();r&&(t+=n),ge(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let i=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(i+=n),ge(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=n)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,i=r?0:0===n&&t?16:n,s=()=>{this.setScrollVisibleDebounce=0,this.addOrRemoveCssClass("ag-scrollbar-invisible",t),fe(this.getGui(),i),fe(this.eViewport,i),fe(this.eContainer,i),i||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(s,100):s()}getScrollPosition(){return oe(this.eViewport,this.enableRtl)}setScrollPosition(e){de(this.eViewport)||this.attemptSettingScrollPosition(e),ae(this.eViewport,e,this.enableRtl)}},js={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},$s=class extends Vs{constructor(){super(js,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new vs(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,r=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,i=0===n&&r?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",r),ge(this.getGui(),i),ge(this.eViewport,i),ge(this.eContainer,i),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const t=e.getGridBodyCtrl().eBodyViewport,r=this.getScrollPosition(),n=t.scrollTop;r!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){t||de(this.eViewport)||this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}};function Ks(e){return e.cols?e.cols.treeDepth+1:-1}function Ys(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function qs(e){const t=[],r=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const n of r){if(!n)continue;const r=n.getGroupRowCount()||0;for(let i=0;i<r;i++){const r=n.getGroupRowCtrlAtIndex(i),s=t[i];if(r){const n=Xs(e,r);(null==s||n>s)&&(t[i]=n)}}}return t}function Xs(e,t){let r=e.colModel.isPivotMode()?function(e){return e.gos.get("pivotGroupHeaderHeight")??eo(e)}(e):eo(e);const n=t.getHeaderCellCtrls();for(const i of n){const{column:e}=i,t=e.getAutoHeaderHeight();null!=t&&t>r&&e.isAutoHeaderHeight()&&(r=t)}return r}function Js(e){let t=e.colModel.isPivotMode()?function(e){return e.gos.get("pivotHeaderHeight")??Qs(e)}(e):Qs(e);return e.colModel.forAllCols((e=>{const r=e.getAutoHeaderHeight();null!=r&&r>t&&e.isAutoHeaderHeight()&&(t=r)})),t}function Qs(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function Zs(e){return e.gos.get("floatingFiltersHeight")??Qs(e)}function eo(e){return e.gos.get("groupHeaderHeight")??Qs(e)}var to=class extends rr{setComp(e,t,r){this.comp=e,this.eGui=t;const{beans:n}=this,{headerNavigation:i,touchSvc:s,ctrlsSvc:o}=n;i&&this.createManagedBean(new Yi(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>be(this.beans,(()=>e())),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){const{beans:e}=this;let t=0;const r=qs(e).reduce(((e,t)=>e+t),0),n=Js(e);if(e.filterManager?.hasFloatingFilters()&&(t+=Zs(e)),t+=r,t+=n,this.headerHeight===t)return;this.headerHeight=t;const i=`${t+1}px`;this.comp.setHeightAndMinHeight(i),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const t=e.visibleCols.allCols.some((e=>e.isSpanHeaderHeight()));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey,n=r!==t?"LEFT":"RIGHT",{beans:i}=this,{headerNavigation:s,focusSvc:o}=i;(s.navigateHorizontally(n,!0,e)||!r&&o.focusOverlay(!1)||hi(i,r,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:r}=this.beans;switch(e.key){case Qn.LEFT:t="LEFT";case Qn.RIGHT:xe(t)||(t="RIGHT"),r.navigateHorizontally(t,!1,e)&&e.preventDefault();break;case Qn.UP:t="UP";case Qn.DOWN:xe(t)||(t="DOWN"),r.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:r,beans:n}=this;!t&&r.contains(wt(n))||r.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,r){const{menuSvc:n,ctrlsSvc:i}=this.beans;if(!e&&!r||!n?.isHeaderContextMenuEnabled())return;const{target:s}=e??t;s!==this.eGui&&s!==i.getHeaderRowContainerCtrl()?.eViewport||n.showHeaderContextMenu(void 0,e,r)}},ro=class extends rr{constructor(e,t,r,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?br(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,r=e.get("suppressColumnMoveAnimation"),n=xe(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!r?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),r=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=r,this.beans.colAnimation.executeNextVMTurn((()=>{this.actualLeft===r&&this.setLeft(r)}))}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:r,visibleCols:n}=this.beans;if(!lt(r,"print"))return t;if("left"===e.getPinned())return t;const i=n.getColsLeftWidth();if("right"===e.getPinned()){return i+n.bodyWidth+t}return i+t}setLeft(e){if(xe(e)&&(this.eCell.style.left=`${e}px`),Li(this.columnOrGroup)){const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&O(this.ariaEl,e.length)}}},no=0,io="headerCtrl",so=class extends rr{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.instanceId=e.getUniqueId()+"-"+no++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:r}=this.beans.focusSvc.focusedHeader,n=r.getDefinition(),i=n&&n.suppressHeaderKeyboardEvent;if(!xe(i))return!1;return!!i(Ut(this.gos,{colDef:n,column:r,headerRowIndex:t,event:e}))}getWrapperHasFocus(){return wt(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let r;if("function"===typeof t){r=t(this.getHeaderClassParams())}else r=t;r&&this.comp.setUserStyles(r)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:r,compBean:n}=e,{beans:i}=this,s=e=>{if(!this.isAlive()||!n.isAlive())return;const{paddingTop:r,paddingBottom:o,borderBottomWidth:a,borderTopWidth:l}=ee(this.eGui),c=r+o+a+l,u=t.offsetHeight+c;if(e<5){const r=mt(i);if(!r||!r.contains(t)||0==u)return void Be((()=>s(e+1)),"raf",i)}this.setColHeaderHeight(this.column,u)};let o,a=!1;const l=()=>{const e=this.column.isAutoHeaderHeight();e&&!a&&c(),!e&&a&&u()},c=()=>{a=!0,s(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),o=we(this.beans,t,(()=>s(0)))},u=()=>{a=!1,o&&o(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),o=void 0};l(),n.addDestroyFunc((()=>u())),n.addManagedListeners(this.column,{widthChanged:()=>a&&s(0)}),n.addManagedEventListeners({sortChanged:()=>{a&&window.setTimeout((()=>s(0)))}}),r&&r(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:r,eGui:n}=this;e&&t&&n&&(Xn(e,t,r.visibleCols),M(n,r.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=ui(this.beans);this.eGui&&Ce(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=wt(this.beans),r=e.key===Qn.LEFT||e.key===Qn.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey)return;if((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),!r)return;const n=e.key===Qn.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const t=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(t,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(n)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:r}=this.beans;return r?r.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:r}=this;let n=e.key===Qn.LEFT!==t.get("enableRtl");const i=r.getPinned(),s=t.get("enableRtl");return i&&s!==("right"===i)&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout((()=>{this.resizeFeature?.toggleColumnResizing(!1)}),150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case Qn.PAGE_DOWN:case Qn.PAGE_UP:case Qn.PAGE_HOME:case Qn.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=io,{eGui:r,gos:n}=this;ft(n,r,t,this),e.addDestroyFunc((()=>ft(n,r,t,null)))}focus(e){const{eGui:t}=this;return!!t&&(this.lastFocusEvent=e||null,t.focus(),!0)}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,r){const n=e??t,{menuSvc:i,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&n.preventDefault(),i?.isHeaderContextMenuEnabled(r)&&i.showHeaderContextMenu(r,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",r)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:r}=this;e.isColumn?r.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):r.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},oo=class extends so{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}setComp(e,t,r,n,i){this.comp=e;const{rowCtrl:s,column:o,beans:a}=this,{colResize:l,context:c,colHover:u,rangeSvc:d}=a,h=on(this,c,i);this.setGui(t,h),this.updateState(),this.setupWidth(h),this.setupMovingCss(h),this.setupMenuClass(h),this.setupSortableClass(h),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:e=>this.setRefreshFunction("measuring",e),compBean:h}),this.addColumnHoverListener(h),this.setupFilterClass(h),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(h),this.setupSelectAll(h),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=h.createManagedBean(l.createResizeFeature(s.pinned,o,r,e,this)):X(r,!1),u?.createHoverFeature(h,[o],t),d?.createRangeHighlightFeature(h,o,e),h.createManagedBean(new ro(o,t,a)),h.createManagedBean(new Yi(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(h),h.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],(()=>this.refresh())),h.addManagedListeners(o,{colDefChanged:()=>this.refresh()}),h.addManagedListeners(o,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const p=()=>this.checkDisplayName();h.addManagedEventListeners({columnValueChanged:p,columnRowGroupChanged:p,columnPivotChanged:p,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),h.addDestroyFunc((()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()}))}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return Ut(t.gos,{colDef:r,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return function(e,t,r){return e.getCompDetails(t,gn,"agColumnHeader",r)}(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:r,gos:n}=this.beans;return Ut(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!r&&(!this.openFilterEnabled||zt(this.gos)),showColumnMenu:(t,r)=>{e?.showColumnMenu({column:this.column,buttonElement:t,positionBy:"button",onClosedCallback:r})},showColumnMenuAfterMouseClick:(t,r)=>{e?.showColumnMenu({column:this.column,mouseEvent:t,positionBy:"mouse",onClosedCallback:r})},showFilter:t=>{e?.showFilterMenu({column:this.column,buttonElement:t,containerType:"columnFilter",positionBy:"button"})},progressSort:e=>{t?.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,r)=>{t?.setSortForColumn(this.column,e,!!r,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(e,t)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(e,t)}})}setupSelectAll(e){const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature.setComp(this))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===Qn.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===Qn.ENTER&&this.onEnterKeyDown(e),e.key===Qn.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();ao(r)&&r.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),ni()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const e=qn(this.column.getColDef(),this.gos,this.column,null),t=this.userHeaderClasses;this.userHeaderClasses=new Set(e),e.forEach((e=>{t.has(e)?t.delete(e):this.comp.addOrRemoveCssClass(e,!0)})),t.forEach((e=>this.comp.addOrRemoveCssClass(e,!1)))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),e&&this.draggable&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),Object.values(this.refreshFunctions).forEach((e=>e()))}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==e.componentClass)&&this.attemptHeaderCompRefresh(e.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const e=this.column.getActualWidth();this.comp.setWidth(`${e}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp?.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const e=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",e),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=0===e,r=1===e;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:r,beans:n}=this,i=qs(this.beans),s=0===i.reduce(((e,t)=>e+t),0);if(r.addOrRemoveCssClass("ag-header-parent-hidden",s),!t.isSpanHeaderHeight())return e.style.removeProperty("top"),e.style.removeProperty("height"),r.addOrRemoveCssClass("ag-header-span-height",!1),void r.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();r.addOrRemoveCssClass("ag-header-span-height",o>0);const l=Js(n);if(0===o)return r.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",`${l}px`);r.addOrRemoveCssClass("ag-header-span-total",a);let c=0;for(let u=0;u<o;u++)c+=i[i.length-1-u];e.style.setProperty("top",-c+"px"),e.style.setProperty("height",`${l+c}px`)}refreshAriaSort(){if(this.sortable){const e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(function(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!zt(this.gos)){const e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(wt(this.beans)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort(((e,t)=>"filter"===e?-1:t.charCodeAt(0)-e.charCodeAt(0))).map((e=>this.ariaDescriptionProperties.get(e))).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column)})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return ao(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function ao(e){return"function"===typeof e.getAnchorElementForMenu&&"function"===typeof e.onMenuKeyboardShortcut}var lo=0,co=class extends rr{constructor(e,t,r){super(),this.rowIndex=e,this.pinned=t,this.type=r,this.instanceId=lo++,this.allCtrls=[];const n="group"==r?"ag-header-row-column-group":"filter"==r?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${n}`}postConstruct(){this.isPrintLayout=lt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return!!this.comp&&this.allCtrls.every((e=>null!=e.eGui))}setComp(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.comp=e,t=on(this,this.beans.context,t),r&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),r=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:r,virtualColumnsChanged:e=>this.onVirtualColumnsChanged(e.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",r),e.addManagedPropertyListener("ensureDomOrder",(e=>this.isEnsureDomOrder=e.currentValue)),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=lt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;if(this.isPrintLayout){return null!=this.pinned?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null)}return e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{filterManager:e}=this.beans,t=[],r=qs(this.beans),n=Js(this.beans);t.push(...r),t.push(n),e?.hasFloatingFilters()&&t.push(Zs(this.beans));let i=0;for(let s=0;s<this.rowIndex;s++)i+=t[s];return{topOffset:i,rowHeight:t[this.rowIndex]}}onVirtualColumnsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getUpdatedHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);const r=e=>{const{focusSvc:t,visibleCols:r}=this.beans;if(!t.isHeaderWrapperFocused(e))return!1;return r.isVisible(e.column)};if(e)for(const[n,i]of e){r(i)?this.ctrlsById.set(n,i):this.destroyBean(i)}return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,r){if(e.isEmptyGroup())return;const n=e.getUniqueId();let i;r&&(i=r.get(n),r.delete(n));if(i&&i.column!=e&&(this.destroyBean(i),i=void 0),null==i)switch(this.type){case"filter":i=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break;case"group":i=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:i=this.createBean(new oo(e,this))}t.set(n,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let e=[];const t=this.getActualDepth(),{colViewport:r}=this.beans;return["left",null,"right"].forEach((n=>{const i=r.getHeadersToRender(n,t);e=e.concat(i)})),e}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.colViewport.getHeadersToRender(this.pinned,this.getActualDepth())}focusHeader(e,t){const r=this.allCtrls.find((t=>t.column==e));if(!r)return!1;return r.focus(t)}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,super.destroy()}},uo=class extends rr{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:r,ctrlsSvc:n,colModel:i,colMoves:s,filterManager:o}=this.beans;this.setupCenterWidth(),r?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);const a=this.onDisplayedColumnsChanged.bind(this,o);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:a,advancedFilterEnabledChanged:a});const l=`${"string"===typeof this.pinned?this.pinned:"center"}Header`;n.register(l,this),i.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{focusSvc:t,colModel:r,filterManager:n}=this.beans;let i=0;const s=t.getFocusHeaderToUseAfterRefresh();(()=>{const e=Ks(r)-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let t=0;t<e;t++){const e=this.createBean(new co(i++,this.pinned,"group"));this.groupsRowCtrls.push(e)}})(),(()=>{const t=i++,r=!this.hidden&&(null==this.columnsRowCtrl||!e||this.columnsRowCtrl.rowIndex!==t);(r||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),r&&(this.columnsRowCtrl=this.createBean(new co(t,this.pinned,"column")))})(),(()=>{this.includeFloatingFilter=!!n?.hasFloatingFilters()&&!this.hidden;const t=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void t();const r=i++;if(this.filtersRowCtrl){const n=this.filtersRowCtrl.rowIndex!==r;e&&!n||t()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new co(r,this.pinned,"filter")))})();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(t,s)}getHeaderCtrlForColumn(e){const t=t=>t?.getHeaderCellCtrls().find((t=>t.column===e));if(pr(e))return t(this.columnsRowCtrl);if(0!==this.groupsRowCtrls.length)for(let r=0;r<this.groupsRowCtrls.length;r++){const e=t(this.groupsRowCtrls[r]);if(e)return e}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,r){const n=this.getAllCtrls()[e];return!!n&&n.focusHeader(t,r)}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const r=e?.createBodyDropTarget(this.pinned,t);r&&this.createManagedBean(r)}restoreFocusOnHeader(e,t){if(!t)return;const{column:r}=t;r.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(e){const t=!!e?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new os((e=>this.comp.setCenterWidth(`${e}px`)),!0))}};function ho(e,t,r){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",r))}var po=class extends un{constructor(){super()}},go={tag:"span",cls:"ag-overlay-loading-center",attrs:{"aria-live":"polite","aria-atomic":"true"}},fo={tag:"span",cls:"ag-overlay-no-rows-center"};function mo(e,t,r){const n=vo(e,t,r);if(n){const{className:e}=n;if("string"===typeof e&&e.indexOf("ag-icon")>-1||"object"===typeof e&&e["ag-icon"])return n}const i=Re({tag:"span"});return i.appendChild(n),i}function vo(e,t,r){let n=null;"smallDown"===e?et(262):"smallLeft"===e?et(263):"smallRight"===e&&et(264);const i=r&&r.getColDef().icons;if(i&&(n=i[e]),t.gos&&!n){const r=t.gos.get("icons");r&&(n=r[e])}if(n){let t;if("function"===typeof n)t=n();else{if("string"!==typeof n)return void et(38,{iconName:e});t=n}return"string"===typeof t?he(t):ve(t)?t:void et(133,{iconName:e})}{const r=t.registry.getIcon(e);return r||t.validation?.validateIcon(e),Re({tag:"span",cls:`ag-icon ag-icon-${r??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var Co={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},wo=class extends un{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}")}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:n,disabled:i}=this.config;null!=i&&this.setDisabled(i),null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=r&&this.setLabelWidth(r),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;le(t),"string"===typeof e?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),""===e?(X(t,!1),b(t,"presentation")):(X(t,!0),b(t,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||pe(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return Q(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},bo=class extends wo{constructor(e,t,r,n){super(e,t,r),this.className=n}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),null!=r&&this.onValueChange(r),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();null==r||""==r||null!==e.getAttribute("aria-label")?S(e,""):S(e,t??"")}setAriaLabel(e){return y(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return ge(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}};var yo=class extends bo{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";super(e,e?.template??function(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}(n),[],t),this.inputType=r,this.displayFieldTag=n,this.eLabel=cn,this.eWrapper=cn,this.eInput=cn}postConstruct(){super.postConstruct(),this.setInputType();const{eLabel:e,eWrapper:t,eInput:r,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),r.classList.add(`${n}-input`),this.addCssClass("ag-input-field"),r.id=r.id||`ag-${this.getCompId()}-input`;const{inputName:i,inputWidth:s}=this.config;null!=i&&this.setInputName(i),null!=s&&this.setInputWidth(s),this.addInputListeners(),this.activateTabIndex([r])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return pe(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return Ce(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return y(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Q(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(!0===e)Ce(this.eInput,"autocomplete",null);else{const t="string"===typeof e?e:"off";Ce(this.eInput,"autocomplete",t)}return this}},So=class extends yo{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-checkbox",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox"),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;"boolean"===typeof e&&this.setReadOnly(e),"boolean"===typeof t&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0;const r=this.eInput;r.checked=e,r.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",!0===e),t.toggle("ag-indeterminate",null==e)}},Eo={selector:"AG-CHECKBOX",component:So},Ro={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},To=class extends rr{constructor(){super(...arguments),this.nextId=0,this.allNodesMap={},this.rootNode=null}get treeData(){return!1}getRowNode(e){return this.allNodesMap[e]}extractRowData(){return this.rootNode?.allLeafChildren?.map((e=>e.data))}activate(e){this.rootNode=e,e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e.allLeafChildren=[],e.childrenAfterGroup=[],e.childrenAfterSort=[],e.childrenAfterAggFilter=[],e.childrenAfterFilter=[],this.updateRootSiblingArrays(e)}deactivate(){this.rootNode&&(this.allNodesMap={},this.rootNode=null)}destroy(){super.destroy(),this.allNodesMap={},this.rootNode=null}setNewRowData(e){const t=this.rootNode;t&&(this.dispatchRowDataUpdateStartedEvent(e),t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.allNodesMap={},this.nextId=0,this.loadNewRowData(e),this.updateRootSiblingArrays(t))}updateRootSiblingArrays(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenAfterAggFilter=e.childrenAfterAggFilter,t.childrenAfterSort=e.childrenAfterSort,t.childrenMapped=e.childrenMapped,t.allLeafChildren=e.allLeafChildren)}loadNewRowData(e){this.rootNode.allLeafChildren=e?.map(((e,t)=>this.createRowNode(e,t)))??[]}setImmutableRowData(e,t){const r=Dt(this.gos),n=!this.gos.get("suppressMaintainUnsortedOrder"),i=e.changedRowNodes,s=new Set,o=this.rootNode,a=o.allLeafChildren,l=a.length;let c=!1,u=!1,d=!1,h=!1;for(let g=0,f=-1,m=t.length;g<m;g++){const e=t[g];let o=this.getRowNode(r({data:e,level:0}));if(o){if(n){const e=o.sourceRowIndex;h||(h=e<=f||c),f=e}o.data!==e&&(d=!0,o.updateData(e),i.update(o))}else c=!0,o=this.createRowNode(e,-1),i.add(o);s.add(o)}const p=[];for(let g=0;g<l;g++){const e=a[g];s.has(e)||(u=!0,e.isSelected()&&p.push(e),this.rowNodeDeleted(e),i.remove(e))}if(c||u||h){const t=new Array(s.size);let r=0;if(!n)for(let e=0;e<l;++e){const n=a[e];s.delete(n)&&(n.sourceRowIndex=r,t[r++]=n)}for(const e of s)e.sourceRowIndex=r,t[r++]=e;o.allLeafChildren=t;const i=o.sibling;i&&(i.allLeafChildren=t),e.rowNodesOrderChanged||(e.rowNodesOrderChanged=h)}(c||u||h||d)&&(this.deselectNodes(p),e.rowDataUpdated=!0)}rowNodeDeleted(e){e.clearRowTopAndRowIndex();const t=e.id,r=this.allNodesMap;r[t]===e&&delete r[t]}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);const r={changedRowNodes:t,rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},n=[],i=Dt(this.gos);return this.executeRemove(i,e,r,n),this.executeUpdate(i,e,r,n),this.executeAdd(e,r),this.deselectNodes(n),r}executeAdd(e,t){const r=e.add;if(!r?.length)return;let n=this.rootNode.allLeafChildren,i=n.length;if("number"===typeof e.addIndex&&(i=this.sanitizeAddIndex(e.addIndex),i>0)){if(this.gos.get("treeData")&&this.gos.get("getDataPath"))for(let e=0;e<n.length;e++){const t=n[e];if(t?.rowIndex==i-1){i=e+1;break}}}const s=r.length,o=t.changedRowNodes,a=new Array(s);for(let u=0;u<s;u++){const e=this.createRowNode(r[u],i+u);o.add(e),a[u]=e}const l=this.rootNode;if(i<n.length){const e=n.slice(0,i),r=n.slice(i,n.length),s=e.length+a.length;for(let t=0,n=r.length;t<n;++t)r[t].sourceRowIndex=s+t;n=[...e,...a,...r],t.rowsInserted=!0}else n=n.concat(a);l.allLeafChildren=n;const c=l.sibling;c&&(c.allLeafChildren=n),t.rowNodeTransaction.add=a}executeRemove(e,t,r,n){let{changedRowNodes:i,rowNodeTransaction:s}=r;const{remove:o}=t;if(!o?.length)return;const a={};o.forEach((t=>{const r=this.lookupRowNode(e,t);r&&(r.isSelected()&&n.push(r),r.clearRowTopAndRowIndex(),a[r.id]=!0,delete this.allNodesMap[r.id],s.remove.push(r),i.remove(r))}));const l=this.rootNode;l.allLeafChildren=l.allLeafChildren?.filter((e=>!a[e.id]))??null,l.allLeafChildren?.forEach(((e,t)=>{e.sourceRowIndex=t}));const c=l.sibling;c&&(c.allLeafChildren=l.allLeafChildren)}executeUpdate(e,t,r,n){let{changedRowNodes:i,rowNodeTransaction:s}=r;const{update:o}=t;o?.length&&o.forEach((t=>{const r=this.lookupRowNode(e,t);r&&(r.updateData(t),!r.selectable&&r.isSelected()&&n.push(r),s.update.push(r),i.update(r))}))}dispatchRowDataUpdateStartedEvent(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselectNodes(e){const t="rowDataChanged",r=this.beans.selectionSvc,n=e.length>0;n&&r?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),r?.updateGroupsFromChildrenSelections?.(t),n&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:r?.getSelectedNodes()??null,serverSideState:null})}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}createRowNode(e,t){const r=new Bi(this.beans);return r.parent=this.rootNode,r.level=0,r.group=!1,r.expanded=!1,r.sourceRowIndex=t,r.setDataAndId(e,String(this.nextId)),this.allNodesMap[r.id]&&et(2,{nodeId:r.id}),this.allNodesMap[r.id]=r,this.nextId++,r}lookupRowNode(e,t){let r;if(e){const n=e({data:t,level:0});if(r=this.allNodesMap[n],!r)return tt(4,{id:n}),null}else if(r=this.rootNode?.allLeafChildren?.find((e=>e.data===t)),!r)return tt(5,{data:t}),null;return r||null}},xo=class extends So{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},ko=class extends yo{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-text-field",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text")}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const r=this.eInput;return r.value!==e&&(r.value=xe(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListeners(this.eInput,{keydown:t=>{ps(t)&&t.key&&!e.test(t.key)&&t.preventDefault()},paste:t=>{const r=t.clipboardData?.getData("text");r&&r.split("").some((t=>!e.test(t)))&&t.preventDefault()}})}},Po={selector:"AG-INPUT-TEXT-FIELD",component:ko},Ao=class extends ko{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const t=parseFloat(e.value),r=isNaN(t)?"":this.normalizeValue(t.toString());this.value!==r&&this.setValue(r)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:r,max:n,step:i}=this.config;"number"===typeof t&&this.setPrecision(t),"number"===typeof r&&this.setMin(r),"number"===typeof n&&this.setMax(n),"number"===typeof i&&this.setStep(i)}onWheel(e){wt(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e),{min:r,max:n}=this;return null!=r&&t<r?e=r.toString():null!=n&&t>n&&(e=n.toString()),e}adjustPrecision(e,t){const r=this.precision;if(null==r)return e;if(t){const t=parseFloat(e).toFixed(r);return parseFloat(t).toString()}const n=String(e).split(".");if(n.length>1){if(n[1].length<=r)return e;if(r>0)return`${n[0]}.${n[1].slice(0,r)}`}return n[0]}setMin(e){return this.min===e||(this.min=e,Ce(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,Ce(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,Ce(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue((e=>super.setValue(e,t)),(()=>this),e)}setStartValue(e){return this.setValueOrInputValue((e=>super.setValue(e,!0)),(e=>{this.eInput.value=e}),e)}setValueOrInputValue(e,t,r){if(xe(r)){let n=this.isScientificNotation(r);if(n&&this.eInput.validity.valid)return e(r);if(!n){n=(r=this.adjustPrecision(r))!=this.normalizeValue(r)}if(n)return t(r)}return e(r)}getValue(){const e=this.eInput;if(!e.validity.valid)return;const t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return"string"===typeof e&&e.includes("e")}};function Fo(e,t){return e.toString().padStart(t,"0")}function Do(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map((e=>Fo(e,2))).join(r);return t&&(n+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map((e=>Fo(e,2))).join(":")),n}function Io(e){if(!e)return null;const[t,r]=e.split(" ");if(!t)return null;const n=t.split("-").map((e=>parseInt(e,10)));if(3!==n.filter((e=>!isNaN(e))).length)return null;const[i,s,o]=n,a=new Date(i,s-1,o);if(a.getFullYear()!==i||a.getMonth()!==s-1||a.getDate()!==o)return null;if(!r||"00:00:00"===r)return a;const[l,c,u]=r.split(":").map((e=>parseInt(e,10)));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}function Mo(e){return()=>{const t=e();return!t||t.scrollWidth>t.clientWidth}}var Oo=class extends un{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),this.unFocusable||this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case Qn.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case Qn.DOWN:case Qn.UP:e.preventDefault(),this.navigate(t);break;case Qn.PAGE_DOWN:case Qn.PAGE_UP:case Qn.PAGE_HOME:case Qn.PAGE_END:e.preventDefault(),this.navigateToPage(t)}}navigate(e){const t=e===Qn.DOWN;let r;const{itemEls:n,highlightedEl:i}=this;if(i){let e=n.indexOf(i)+(t?1:-1);e=Math.min(Math.max(e,0),n.length-1),r=n[e]}else r=n[t?0:n.length-1];this.highlightItem(r)}navigateToPage(e){const{itemEls:t,highlightedEl:r}=this;if(!r||0===t.length)return;const n=t.indexOf(r),i=this.options.length-1,s=t[0].clientHeight,o=Math.floor(this.getGui().clientHeight/s);let a=-1;e===Qn.PAGE_HOME?a=0:e===Qn.PAGE_END?a=i:e===Qn.PAGE_DOWN?a=Math.min(n+o,i):e===Qn.PAGE_UP&&(a=Math.max(n-o,0)),-1!==a&&this.highlightItem(t[a])}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){const{value:t,text:r}=e,n=r||t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach((e=>{ce(e)})),this.itemEls=[],this.refreshAriaRole()}refreshAriaRole(){b(this.getGui(),0===this.options.length?"presentation":"listbox")}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");this.refreshAriaRole(),e.forEach(((t,r)=>{A(t,r+1),P(t,e.length)}))}renderOption(e,t){const r=mt(this.beans),n=r.createElement("div");b(n,"option"),n.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const i=r.createElement("span");n.appendChild(i),i.textContent=t,this.unFocusable||(n.tabIndex=-1),this.itemEls.push(n),this.addManagedListeners(n,{mouseover:()=>this.highlightItem(n),mousedown:t=>{t.preventDefault(),t.stopPropagation(),this.setValue(e)}}),this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getTooltipValue:()=>t,getGui:()=>n,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>i.scrollWidth>i.clientWidth})),this.getGui().appendChild(n)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(t),this;const r=this.options.findIndex((t=>t.value===e));if(-1!==r){const e=this.options[r];this.value=e.value,this.displayValue=e.text,this.highlightItem(this.itemEls[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex((e=>e.value===this.value));-1!==e&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!de(e))return;this.clearHighlighted(),this.highlightedEl=e,e.classList.add(this.activeClass),_(e,!0);const t=this.getGui(),{scrollTop:r,clientHeight:n}=t,{offsetTop:i,offsetHeight:s}=e;(i+s>r+n||i<r)&&e.scrollIntoView({block:"nearest"}),this.unFocusable||e.focus()}clearHighlighted(){const e=this.highlightedEl;e&&de(e)&&(e.classList.remove(this.activeClass),_(e,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},Lo={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},No=class extends bo{constructor(e){if(super(e,e?.template||Lo,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=cn,this.eWrapper=cn,this.eDisplayField=cn,this.eIcon=cn,this.registerCSS(".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:disabled{opacity:.5}&.ag-picker-has-focus,&:focus-within{background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow)}}"),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:n,minPickerWidth:i,maxPickerWidth:s}=e;null!=t&&(this.pickerGap=t),this.variableWidth=!!n,null!=r&&this.setPickerMaxHeight(r),null!=i&&this.setPickerMinWidth(i),null!=s&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:n}=this.config;if(r){const e=vo(r,this.beans);e&&this.eIcon.appendChild(e)}null!=n&&this.setInputWidth(n)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),x(e,!1),this.ariaRole&&b(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case Qn.UP:case Qn.DOWN:case Qn.ENTER:case Qn.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case Qn.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:r,pickerAriaLabelValue:n,modalPicker:i=!0},maxPickerHeight:s,minPickerWidth:o,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:u}=this,d={modal:i,eChild:e,closeOnEsc:!0,closedCallback:()=>{const e=St(c);this.beforeHidePicker(),e&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(r,n),anchorToElement:u};e.style.position="absolute";const h=c.popupSvc,p=h.addPopup(d);l?(o&&(e.style.minWidth=o),e.style.width=me(ie(u)),a&&(e.style.maxWidth=a)):pe(e,a??ie(u));const g=s??`${te(h.getPopupParent())}px`;return e.style.setProperty("max-height",g),this.alignPickerToComponent(),p.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:r,gos:n},eWrapper:i,pickerComponent:s}=this,o=n.get("enableRtl")?"right":"left";r.positionPopupByComponent({type:t,eventSource:i,ePopup:s.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;x(this.getAriaElement(),e);const t=this.eWrapper.classList;t.toggle("ag-picker-expanded",e),t.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker?.()}setInputWidth(e){return pe(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return"number"===typeof e&&(e=`${e}px`),this.minPickerWidth=null==e?void 0:e,this}setPickerMaxWidth(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerWidth=null==e?void 0:e,this}setPickerMaxHeight(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerHeight=null==e?void 0:e,this}destroy(){this.hidePicker(),super.destroy()}},_o=class extends No{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}")}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Mo((()=>this.eDisplayField)),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;null!=e&&this.addOptions(e),null!=t&&this.setValue(t,!0),r&&null==t&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new Oo("select",!0));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),r=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",r),G(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:e=>{e?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===Qn.TAB&&this.hidePicker(),t){case Qn.ENTER:case Qn.UP:case Qn.DOWN:case Qn.PAGE_UP:case Qn.PAGE_DOWN:case Qn.PAGE_HOME:case Qn.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case Qn.ESCAPE:super.onKeyDown(e);break;case Qn.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e)}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,r){const{listComponent:n,config:{placeholder:i},eDisplayField:s,tooltipFeature:o}=this;if(this.value===e||!n)return this;r||n.setValue(e,!0);if(n.getValue()===this.getValue())return this;let a=n.getDisplayValue();return null==a&&i&&(a=i),s.textContent=a,o?.setTooltipAndRefresh(a??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},Go={selector:"AG-SELECT",component:_o},Bo="ag-tab-guard",Ho="ag-tab-guard-top",zo="ag-tab-guard-bottom",Vo=class extends rr{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:r,eBottomGuard:n,focusTrapActive:i,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:d,handleKeyDown:h,isEmpty:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=r,this.eBottomGuard=n,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!i,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h,this.providedIsEmpty=p}postConstruct(){this.createManagedBean(new Yi(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty){if(this.providedIsEmpty?this.providedIsEmpty():0===si(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){const t=si(mt(this.beans).body,null,!0),r=t.indexOf(e?this.eTopGuard:this.eBottomGuard);if(-1===r)return;let n,i;e?(n=0,i=r):(n=r+1,i=t.length);const s=t.slice(n,i),o=this.gos.get("tabIndex");s.sort(((e,t)=>{const r=parseInt(e.getAttribute("tabindex")||"0"),n=parseInt(t.getAttribute("tabindex")||"0");return n===o?1:r===o?-1:0===r?1:0===n?-1:r-n})),s[e?s.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive)return;if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout((()=>this.activateTabGuards()),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=si(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),!!t.length&&(t[e?t.length-1:0].focus({preventScroll:!0}),!0)}getNextFocusableElement(e){return ai(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout((()=>{this.forcingFocusOut=!1,this.activateTabGuards()}))}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},Wo=class extends rr{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:n}=this,i=[t,r],s={setTabIndex:e=>{i.forEach((t=>null!=e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")))}};this.addTabGuards(t,r);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}=e;this.tabGuardCtrl=this.createManagedBean(new Vo({comp:s,focusTrapActive:o,eTopGuard:t,eBottomGuard:r,eFocusableElement:n,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,isEmpty:p,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:f}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=mt(this.beans).createElement("div"),r="top"===e?Ho:zo;return t.classList.add(Bo,r),b(t,"presentation"),t}addTabGuards(e,t){const r=this.eFocusableElement;r.insertAdjacentElement("afterbegin",e),r.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];le(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){ve(t)||(t=t.getGui());const{eBottomGuard:n}=this;n?n.insertAdjacentElement("beforebegin",t):e(t,r)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;ce(e),ce(t),super.destroy()}},Uo=class extends un{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new Wo(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},jo=class extends un{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},$o=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new p,this.preventMouseClick=t;const r=this.onTouchStart.bind(this),n=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this);e.addEventListener("touchstart",r,{passive:!0}),e.addEventListener("touchmove",n,{passive:!0}),e.addEventListener("touchend",i,{passive:!1}),this.destroyFuncs.push((()=>{e.removeEventListener("touchstart",r,{passive:!0}),e.removeEventListener("touchmove",n,{passive:!0}),e.removeEventListener("touchend",i,{passive:!1})}))}getActiveTouch(e){for(let t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout((()=>{const r=this.touchStart===t;if(this.touching&&r&&!this.moved){this.moved=!0;const t={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(t)}}),500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!Mi(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=Date.now();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const e={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach((e=>e()))}},Ko=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"javascript";var t;this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e(),this.baseDocLink=`${De}/${this.frameworkName}-data-grid`,t=this.baseDocLink,$e=t}setInterval(e,t){return new dn((r=>{r(window.setInterval(e,t))}))}addEventListener(e,t,r,n){let i={};if("object"===typeof n?i=n:"boolean"===typeof n&&(i={capture:n}),null==i.passive){const e=tr(t);null!=e&&(i.passive=e)}e.addEventListener(t,r,i)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`${this.baseDocLink}${e?`/${e}`:""}`}};function Yo(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var qo=Object.fromEntries(["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","funcColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"].map(((e,t)=>[e,t])));function Xo(e,t){return((e.beanName?qo[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER)-((t.beanName?qo[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER)}function Jo(e,t){return"gridDestroySvc"===e?.beanName?-1:0}var Qo=class extends rr{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDrop:n,ctrlsSvc:i}=this.beans;n?.registerGridDropTarget((()=>this.eGui),this),yi(this.gos,t),this.createManagedBean(new ts(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const s=we(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((()=>s())),i.register("gridCtrl",this)}isDetailGrid(){const e=li(this.getGui());return e?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(0===n){if(r>0){const{visibleCols:e,focusSvc:t}=this.beans,r=br(e.allCols);if(t.focusGridView({column:r,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),{focusSvc:n,visibleCols:i}=this.beans,s=i.allCols;if(e){if(r.length>1)return this.focusContainer(br(r),e);const t=br(s);if(n.focusGridView({column:t,backwards:e}))return!0}if(0===this.gos.get("headerHeight")||ui(this.beans)){if(n.focusGridView({column:s[0],backwards:e}))return!0;for(let t=1;t<r.length;t++)if(oi(r[t].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:r,indexWithFocus:n}=this.getNextFocusableIndex(t,e);if(-1===n||r<0||r>=t.length)return;const i=t[r];i.setAllowFocus?.(!0),setTimeout((()=>{i.setAllowFocus?.(!1)}))}isFocusable(){const e=this.beans;return!di(e)||!ui(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){const r=wt(this.beans),n=e.findIndex((e=>e.getGui().contains(r)));return{indexWithFocus:n,nextIndex:n+(t?-1:1)}}focusContainer(e,t){e.setAllowFocus?.(!0);const r=oi(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},Zo=(e,t)=>{for(const r of Object.keys(t))t[r]=e;return t},ea={dispatchEvent:"CommunityCore",...Zo("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0}),...Zo("GridState",{getState:0}),...Zo("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...Zo("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...Zo("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...Zo("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...Zo("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...Zo("ValueCache",{expireValueCache:0}),...Zo("CellApi",{getCellValue:0}),...Zo("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...Zo("Sort",{onSortChanged:0}),...Zo("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0}),...Zo("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...Zo("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...Zo("HighlightChanges",{flashCells:0}),...Zo("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0}),...Zo("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...Zo("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...Zo("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...Zo("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...Zo("ColumnResize",{setColumnWidths:0}),...Zo("ColumnHover",{isColumnHovered:0}),...Zo("EditCore",{getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0}),...Zo("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...Zo("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...Zo("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0}),...Zo("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...Zo("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...Zo("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...Zo("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0,onRowHeightChanged:0}),...Zo("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...Zo("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...Zo("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...Zo("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...Zo("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...Zo("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...Zo("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...Zo("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...Zo("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...Zo("ContextMenu",{showContextMenu:0}),...Zo("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...Zo("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...Zo("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...Zo("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...Zo("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...Zo("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...Zo("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...Zo("StatusBar",{getStatusPanel:0})},ta={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},ra=(e,t)=>e.eventSvc.dispatchEvent(t),na=class{};Reflect.defineProperty(na,"name",{value:"GridApi"});function ia(e,t){e.gos.updateGridOptions({options:t})}var sa={moduleName:"Drag",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="dragSvc",this.dragEndFunctions=[],this.dragSources=[]}destroy(){const{dragSources:e}=this;e.forEach(this.removeListener.bind(this)),e.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,r=e.mouseDownListener;if(t.removeEventListener("mousedown",r),e.touchEnabled){const r=e.touchStartListener;t.removeEventListener("touchstart",r,{passive:!0})}}removeDragSource(e){const{dragSources:t}=this,r=t.find((t=>t.dragSource===e));r&&(this.removeListener(r),Er(t,r))}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:r,includeTouch:n,stopPropagationForTouch:i}=e;r.addEventListener("mousedown",t);let s=null;const o=this.gos.get("suppressTouch");n&&!o&&(s=t=>{q(t.target)||(i&&t.stopPropagation(),this.onTouchStart(e,t))},r.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:s,touchEnabled:!!n})}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const r=t.touches[0];this.touchLastTime=r,this.touchStart=r;const n=t=>this.onTouchUp(t,e.eElement),i=t.target,s=[{target:Ct(this.beans),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:i,type:"touchmove",listener:t=>this.onTouchMove(t,e.eElement),options:{passive:!0}},{target:i,type:"touchend",listener:n,options:{passive:!0}},{target:i,type:"touchcancel",listener:n,options:{passive:!0}}];this.addTemporaryEvents(s),0===e.dragStartPixels&&this.onCommonMove(r,this.touchStart,e.eElement)}onMouseDown(e,t){const r=t;if(e.skipMouseEvent&&e.skipMouseEvent(t))return;if(r._alreadyProcessedByDragService)return;if(r._alreadyProcessedByDragService=!0,0!==t.button)return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const n=Ct(this.beans),i=[{target:n,type:"mousemove",listener:t=>this.onMouseMove(t,e.eElement)},{target:n,type:"mouseup",listener:t=>this.onMouseUp(t,e.eElement)},{target:n,type:"contextmenu",listener:e=>e.preventDefault()},{target:n,type:"keydown",listener:t=>{t.key===Qn.ESCAPE&&this.cancelDrag(e.eElement)}}];this.addTemporaryEvents(i),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach((e=>{const{target:t,type:r,listener:n,options:i}=e;t.addEventListener(r,n,i)})),this.dragEndFunctions.push((()=>{e.forEach((e=>{const{target:t,type:r,listener:n,options:i}=e;t.removeEventListener(r,n,i)}))}))}isEventNearStartEvent(e,t){const{dragStartPixels:r}=this.currentDragParams;return Mi(e,t,xe(r)?r:4)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,r){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventSvc.dispatchEvent({type:"dragStarted",target:r}),this.currentDragParams.onDragStart(t),!this.currentDragParams)return void(this.dragging=!1);this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){const r=this.getFirstActiveTouch(e.touches);r&&this.onCommonMove(r,this.touchStart,t)}onMouseMove(e,t){if(H()){const e=mt(this.beans);e.getSelection()?.removeAllRanges()}this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const{gos:t}=this,r=t.get("enableCellTextSelection"),n="mousemove"===e.type;return r&&n&&e.cancelable&&Si(t,e)&&!(e=>{const t=e.target,r=t?.tagName.toLocaleLowerCase();return!!r?.match("^a$|textarea|input|select|button")})(e)}onTouchUp(e,t){let r=this.getFirstActiveTouch(e.changedTouches);r||(r=this.touchLastTime),this.onUpCommon(r,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null;const{dragEndFunctions:e}=this;e.forEach((e=>e())),e.length=0}}]},oa={moduleName:"SharedDragAndDrop",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.dragSvc=e.dragSvc,this.environment=e.environment,this.userCompFactory=e.userCompFactory}addDragSource(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:r,dragSource:e}),this.dragSvc.addDragSource(r)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return e&&e.comp?e.comp:null}removeDragSource(e){const{dragSourceAndParamsList:t,dragSvc:r}=this,n=t.find((t=>t.dragSource===e));n&&(r.removeDragSource(n.params),Er(t,n))}destroy(){const{dragSourceAndParamsList:e,dragSvc:t,dropTargets:r}=this;e.forEach((e=>t.removeDragSource(e.params))),e.length=0,r.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=e.getDragItem(),e.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){this.dragSource?.onDragStopped?.();const{lastDropTarget:t}=this;if(t?.onDragStop){const r=this.createDropTargetEvent(t,e,null,null,!1);t.onDragStop(r)}this.clearDragAndDropProperties()}onDragCancel(){const{dragSource:e,lastDropTarget:t}=this;e?.onDragCancelled?.(),t?.onDragCancel&&t.onDragCancel(this.createDropTargetEvent(t,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.getHorizontalDirection(e),n=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const i=this.dropTargets.filter((t=>this.isMouseOnDropTarget(e,t))),s=this.findCurrentDropTarget(e,i),{lastDropTarget:o,dragSource:a,dragAndDropImageComp:l,dragItem:c}=this;if(s!==o){if(this.leaveLastTargetIfExists(e,r,n,t),null!==o&&null===s&&a?.onGridExit?.(c),null===o&&null!==s&&a?.onGridEnter?.(c),this.enterDragTargetIfExists(s,e,r,n,t),s&&l){const{comp:e,promise:t}=l;e?e.setIcon(s.getIconName?s.getIconName():null,!1):t.then((e=>{e&&e.setIcon(s.getIconName?s.getIconName():null,!1)}))}this.lastDropTarget=s}else if(s&&s.onDragging){const i=this.createDropTargetEvent(s,e,r,n,t);s.onDragging(i)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,r=[[e.getContainer()]];return t?r.concat(t):r}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let n=!1;const i=(e,t)=>{for(const r of t){const{width:t,height:n,left:i,right:s,top:o,bottom:a}=r.getBoundingClientRect();if(0===t||0===n)return!1;const l=e.clientX>=i&&e.clientX<s,c=e.clientY>=o&&e.clientY<a;if(!l||!c)return!1}return!0};for(const a of r)if(i(e,a)){n=!0;break}const{eElement:s,type:o}=this.dragSource;return!(t.targetContainsSource&&!t.getContainer().contains(s))&&(n&&t.isInterestedIn(o,s))}findCurrentDropTarget(e,t){const r=t.length;if(0===r)return null;if(1===r)return t[0];const n=Ct(this.beans).elementsFromPoint(e.clientX,e.clientY);for(const i of n)for(const e of t){if(-1!==this.getAllContainersFromDropTarget(e).flatMap((e=>e)).indexOf(i))return e}return null}enterDragTargetIfExists(e,t,r,n,i){if(e&&e.onDragEnter){const s=this.createDropTargetEvent(e,t,r,n,i);e.onDragEnter(s)}}leaveLastTargetIfExists(e,t,r,n){const{lastDropTarget:i}=this;if(!i)return;if(i.onDragLeave){const s=this.createDropTargetEvent(i,e,t,r,n);i.onDragLeave(s)}const s=this.getDragAndDropImageComponent();s&&s.setIcon(null,!1)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter((t=>t.getContainer()!==e.getContainer()))}hasExternalDropZones(){return this.dropTargets.some((e=>e.external))}findExternalZone(e){return this.dropTargets.filter((e=>e.external)).find((t=>t.getContainer()===e.getContainer()))||null}isDropZoneWithinThisGrid(e){const t=this.ctrlsSvc.getGridBodyCtrl().eGridBody,{dropZoneTarget:r}=e;return t.contains(r)}getHorizontalDirection(e){const t=this.eventLastTime?.clientX,r=e.clientX;return t===r?null:t>r?"left":"right"}getVerticalDirection(e){const t=this.eventLastTime?.clientY,r=e.clientY;return t===r?null:t>r?"up":"down"}createDropTargetEvent(e,t,r,n,i){const s=e.getContainer(),o=s.getBoundingClientRect(),{dragItem:a,dragSource:l,gos:c}=this;return Ut(c,{event:t,x:t.clientX-o.left,y:t.clientY-o.top,vDirection:n,hDirection:r,dragSource:l,fromNudge:i,dragItem:a,dropZoneTarget:s})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();t&&yt(t.getGui(),e,this.beans)}removeDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;if(e){const{comp:t}=e;if(t){const e=t.getGui();this.dragAndDropImageParent?.removeChild(e),this.destroyBean(t)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e,gos:t,userCompFactory:r}=this;if(!e)return;const n=function(e,t){return e.getCompDetailsFromGridOptions(pn,"agDragAndDropImage",t,!0)}(r,Ut(t,{dragSource:e}));if(!n)return;const i=n.newAgStackInstance();this.dragAndDropImageComp={promise:i},i.then((e=>{e&&this.isAlive()&&(this.processDragAndDropImageComponent(e),this.dragAndDropImageComp.comp=e)}))}processDragAndDropImageComponent(e){const{dragSource:t,environment:r}=this;if(!t)return;const n=e.getGui();n.style.setProperty("position","absolute"),n.style.setProperty("z-index","9999"),yi(this.gos,n),r.applyThemeClasses(n),e.setIcon(null,!1);let{dragItemName:i}=t;"function"===typeof i&&(i=i()),e.setLabel(i||""),n.style.top="20px",n.style.left="20px";const s=bt(this.beans);this.dragAndDropImageParent=s,s?s.appendChild(n):et(54)}registerGridDropTarget(e,t){const r={getContainer:e,isInterestedIn:e=>1===e||0===e,getIconName:()=>"notAllowed"};this.addDropTarget(r),t.addDestroyFunc((()=>this.removeDropTarget(r)))}}],dependsOn:[sa],userComponents:{agDragAndDropImage:class extends un{constructor(){super(),this.dragSource=null,this.eIcon=cn,this.eLabel=cn,this.eGhost=cn,this.registerCSS(".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}")}postConstruct(){const e=e=>mo(e,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(Co),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eIcon:r,dragSource:n,dropIconMap:i,gos:s}=this;le(r);let o=null;e||(e=n?.getDefaultIconName?n.getDefaultIconName():"notAllowed"),o=i[e],r.classList.toggle("ag-shake-left-to-right",t),o===i.hide&&s.get("suppressDragLeaveHidesColumns")||o&&r.appendChild(o)}setLabel(e){this.eLabel.textContent=e}}},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},aa={moduleName:"HorizontalResize",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:r}=this.beans;r.addDragSource(t);return()=>r.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(r)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}}],dependsOn:[sa]};var la=class extends rr{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach((e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))}))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:r,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&r?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function ca(e){const{isFromHeader:t,fromLeft:r,xPosition:n,fromEnter:i,fakeEvent:s,pinned:o,gos:a,colModel:l,colMoves:c,visibleCols:u}=e;let{allMovingColumns:d}=e;if(t){const e=[];d.forEach((t=>{let r=null,n=t.getParent();for(;null!=n&&1===n.getDisplayedLeafColumns().length;)r=n,n=n.getParent();if(null!=r){(!!r.getColGroupDef()?.marryChildren?r.getProvidedColumnGroup().getLeafColumns():r.getLeafColumns()).forEach((t=>{e.includes(t)||e.push(t)}))}else e.includes(t)||e.push(t)})),d=e}const h=d.slice();!function(e,t){if(!t||t.length<=1)return;t.filter((t=>e.indexOf(t)<0)).length>0||t.sort(((t,r)=>e.indexOf(t)-e.indexOf(r)))}(l.getCols(),h);const p=function(e){const{movingCols:t,draggingRight:r,xPosition:n,pinned:i,gos:s,colModel:o,visibleCols:a}=e,l=s.get("suppressMovableColumns")||t.some((e=>e.getColDef().suppressMovable));if(l)return[];const c=function(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}(a,i),u=o.getCols(),d=c.filter((e=>t.includes(e))),h=c.filter((e=>!t.includes(e))),p=u.filter((e=>!t.includes(e)));let g,f=0,m=n;if(r){let e=0;d.forEach((t=>e+=t.getActualWidth())),m-=e}if(m>0){for(let e=0;e<h.length;e++){if(m-=h[e].getActualWidth(),m<0)break;f++}r&&f++}if(f>0){const e=h[f-1];g=p.indexOf(e)+1}else g=p.indexOf(h[0]),-1===g&&(g=0);const v=[g],C=(e,t)=>e-t;if(r){let e=g+1;const t=u.length-1;for(;e<=t;)v.push(e),e++;v.sort(C)}else{let e=g;const t=u.length-1;let r=u[e];for(;e<=t&&c.indexOf(r)<0;)e++,v.push(e),r=u[e];e=g-1;const n=0;for(;e>=n;)v.push(e),e--;v.sort(C).reverse()}return v}({movingCols:h,draggingRight:r,xPosition:n,pinned:o,gos:a,colModel:l,visibleCols:u}),g=function(e,t){const r=t.getCols(),n=e.map((e=>r.indexOf(e))).sort(((e,t)=>e-t)),i=n[0],s=br(n);return s-i!==n.length-1?null:i}(h,l);if(0===p.length)return;const f=p[0];let m=null!==g&&!i;if(t&&(m=null!==g),m&&!s){if(!r&&f>=g)return;if(r&&f<=g)return}const v=u.allCols,C=[];let w=null;for(let y=0;y<p.length;y++){const e=p[y],t=c.getProposedColumnOrder(h,e);if(!c.doesOrderPassRules(t))continue;const r=t.filter((e=>v.includes(e)));if(null===w)w=r;else if(!yr(r,w))break;const n=da(t);C.push({move:e,fragCount:n})}if(0===C.length)return;C.sort(((e,t)=>e.fragCount-t.fragCount));const b=C[0].move;return b>l.getCols().length-d.length?void 0:{columns:d,toIndex:b}}function ua(e){const{columns:t,toIndex:r}=ca(e)||{},{finished:n,colMoves:i}=e;return t&&null!=r?(i.moveColumns(t,r,"uiColumnMoved",n),n?null:{columns:t,toIndex:r}):null}function da(e){function t(e){const t=[];let r=e.getOriginalParent();for(;null!=r;)t.push(r),r=r.getOriginalParent();return t}let r=0;for(let n=0;n<e.length-1;n++){let i=t(e[n]),s=t(e[n+1]);[i,s]=i.length>s.length?[i,s]:[s,i],i.forEach((e=>{-1===s.indexOf(e)&&r++}))}return r}function ha(e){const{pinned:t,fromKeyboard:r,gos:n,ctrlsSvc:i,useHeaderRow:s,skipScrollPadding:o}=e;let a=i.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(r&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),null!=t||o||(l+=i.get("center").getCenterViewportScrollLeft()),l):0}function pa(e,t){for(const r of e)r.moving=t,r.dispatchColEvent("movingChanged","uiColumnMoved")}var ga=class extends rr{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!xe(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,r=t?.dragItem.columns??[];for(const n of r){const t=n.getPinned();if(n.getColDef().lockPinned){if(t==e)return"move"}else{if(t===e||!e)return"move";if(!t&&e)return"pinned"}}return"notAllowed"}onDragEnter(e){const t=e.dragItem,r=t.columns;if(0===e.dragSource.type)this.setColumnsVisible(r,!0,"uiColumnDragged");else{const e=t.visibleState,n=(r||[]).filter((t=>e[t.getId()]));this.setColumnsVisible(n,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(r,this.pinned),this.onDragging(e,!0,!0)}onDragging(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastDraggingEvent,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{gos:i,ctrlsSvc:s}=this.beans,o=i.get("suppressMoveWhenColumnDragging");if(n&&!o)return void this.finishColumnMoving();if(this.lastDraggingEvent=e,!e||!n&&ke(e.hDirection))return;const a=ha({x:e.x,pinned:this.pinned,gos:i,ctrlsSvc:s});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,r,a,n):this.handleColumnDragWhileAllowingMovement(e,t,r,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!e)return;const n=e.filter((e=>!e.getColDef().lockVisible));this.beans.colModel.setColsVisible(n,t,r)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:r}=e;this.beans.colMoves.moveColumns(t,r,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e,!0);if(i){const e=this.isAttemptingToPin(s);e&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:n,xPosition:i}=this.getNormalisedXPositionInfo(s,e)||{};if(null==n||null==i)return void this.finishColumnMoving();this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:i,fromEnter:t,fakeEvent:r,fromLeft:n})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,n)}}handleColumnDragWhileAllowingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e),o="right"===this.normaliseDirection(e.hDirection),a=1===e.dragSource.type,l=ua({...this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:n,fromLeft:o,fromEnter:t,fakeEvent:r}),finished:i});l&&(this.lastMovedInfo=l)}getAllMovingColumns(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.dragSource.getDragItem();let n=null;t?(n=r.columnsInSplit,n||(n=r.columns)):n=r.columns;return n?n.filter((e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned)):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:n,fromLeft:i,fromEnter:s,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:c,visibleCols:u}=this.beans;return{allMovingColumns:t,isFromHeader:r,fromLeft:i,xPosition:n,pinned:this.pinned,fromEnter:s,fakeEvent:o,gos:a,colModel:l,colMoves:c,visibleCols:u}}highlightHoveredColumn(e,t){const{gos:r,colModel:n}=this.beans,i=r.get("enableRtl"),s=n.getCols().filter((e=>e.isVisible()&&e.getPinned()===this.pinned));let o,a=null,l=null,c=null;for(const u of s){if(l=u.getActualWidth(),a=this.getNormalisedColumnLeft(u,0,i),null!=a){if(a<=t&&a+l>=t){c=u;break}}a=null,l=null}if(c)-1!==e.indexOf(c)&&(c=null);else{for(let e=s.length-1;e>=0;e--){const t=s[e],r=s[e].getParent();if(!r){c=t;break}const n=r?.getDisplayedLeafColumns();if(n.length){c=br(n);break}}if(!c)return;a=this.getNormalisedColumnLeft(c,0,i),l=c.getActualWidth()}this.lastHighlightedColumn?.column!==c&&this.clearHighlighted(),null!=c&&null!=a&&null!=l&&(o=t-a<l/2!==i?0:1,fa(c,o),this.lastHighlightedColumn={column:c,position:o})}getNormalisedXPositionInfo(e,t){const{gos:r,visibleCols:n}=this.beans,i=r.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,i);if(!s||!o||null==a)return;const l=n.allCols,c=l.indexOf(s),u=l.indexOf(o),d=0===a!==i,h=c<u||c===u&&!d;let p=0;if(d?h&&(p-=1):h||(p+=1),u+p===c)return;const g=l[u+p];if(!g)return;return{fromLeft:h,xPosition:this.getNormalisedColumnLeft(g,20,i)}}getColumnMoveAndTargetInfo(e,t,r){const n=this.lastHighlightedColumn||{},{firstMovingCol:i,lastMovingCol:s}=function(e){const t=e.length;let r,n;for(let i=0;i<t;i++){if(!r){const t=e[i];null!=t.getLeft()&&(r=t)}if(!n){const r=e[t-1-i];null!=r.getLeft()&&(n=r)}if(r&&n)break}return{firstMovingCol:r,lastMovingCol:n}}(e);if(!i||!s||n.column||!t)return{firstMovingCol:i,...n};const o="left"===this.getPinDirection();return{firstMovingCol:i,position:o?1:0,column:o!==r?i:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,r){const{gos:n,ctrlsSvc:i}=this.beans,s=e.getLeft();if(null==s)return null;const o=e.getActualWidth();return ha({x:r?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:n,ctrlsSvc:i})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,r=this.failedMoveAttempts>7;return t&&r||e.some((e=>e.getPinned()!==this.pinned))}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:n,fakeEvent:i,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:s,fromEnter:n,fakeEvent:i}),{columns:a,toIndex:l}=ca(o)||{};a&&null!=l&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(fa(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),r=t.getCenterViewportScrollLeft(),n=r+t.getCenterWidth();let i,s;this.gos.get("enableRtl")?(i=e<r+50,s=e>n-50):(s=e<r+50,i=e>n-50),this.needToMoveRight=i,this.needToMoveLeft=s,s||i?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.getDragAndDropImageComponent()?.setIcon(this.getIconName(),!1))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const r=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:e,dragAndDrop:t,gos:r}=this.beans;if(this.failedMoveAttempts<=8||!e)return;if(t.getDragAndDropImageComponent()?.setIcon("pinned",!1),!r.get("suppressMoveWhenColumnDragging")){const e=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(e,void 0,!0)}}}getPinDirection(){return this.needToMoveLeft||"left"===this.pinned?"left":this.needToMoveRight||"right"===this.pinned?"right":void 0}attemptToPinColumns(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=(e||[]).filter((e=>!e.getColDef().lockPinned));if(!n.length)return 0;r&&(t=this.getPinDirection());const{pinnedCols:i,dragAndDrop:s}=this.beans;return i?.setColsPinned(n,t,"uiColumnDragged"),r&&s.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function fa(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}var ma=class extends rr{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,r=this.pinned;e.whenReady(this,(e=>{let t;const n=e.gridBodyCtrl.eBodyViewport;switch(r){case"left":t=[[n,e.left.eContainer],[e.bottomLeft.eContainer],[e.topLeft.eContainer]];break;case"right":t=[[n,e.right.eContainer],[e.bottomRight.eContainer],[e.topRight.eContainer]];break;default:t=[[n,e.center.eViewport],[e.bottomCenter.eViewport],[e.topCenter.eViewport]]}this.eSecondaryContainers=t})),this.moveColumnFeature=this.createManagedBean(new ga(r)),this.bodyDropPivotTarget=this.createManagedBean(new la(r)),t.addDropTarget(this),this.addDestroyFunc((()=>t.removeDropTarget(this)))}isInterestedIn(e){return 1===e||0===e&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&0===e.dragSource.type}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}};var va={moduleName:"ColumnMove",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,r){const n=this.beans.colModel.getCols();if(!n)return;const i=n[e];this.moveColumns([i],t,r)}moveColumns(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{colModel:i,colAnimation:s,visibleCols:o,eventSvc:a}=this.beans,l=i.getCols();if(!l)return;if(t>l.length-e.length)return void et(30,{toIndex:t});s?.start();const c=i.getColsForKeys(e);this.doesMovePassRules(c,t)&&(Rr(i.getCols(),c,t),o.refresh(r),a.dispatchEvent({type:"columnMoved",columns:c,column:1===c.length?c[0]:null,toIndex:t,finished:n,source:r})),s?.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){const{colModel:t,gos:r}=this.beans;if(!$r(e,t.getColTree()))return!1;return!!(e=>{const t=r.get("enableRtl");let n=t?1:-1,i=!0;return e.forEach((e=>{const r=(s=e.getColDef().lockPosition)?"left"===s||!0===s?-1:1:0;var s;t?r>n&&(i=!1):r<n&&(i=!1),n=r})),i})(e)}getProposedColumnOrder(e,t){const r=this.beans.colModel.getCols().slice();return Rr(r,e,t),r}createBodyDropTarget(e,t){return new ma(e,t)}moveHeader(e,t,r,n,i){const{ctrlsSvc:s,gos:o,colModel:a,visibleCols:l,focusSvc:c}=this.beans,u=t.getBoundingClientRect(),d=u.left,h=Li(r),p=h?u.width:r.getActualWidth(),g="left"===e!==o.get("enableRtl"),f=ha({x:g?d-20:d+p+20,pinned:n,fromKeyboard:!0,gos:o,ctrlsSvc:s}),m=c.focusedHeader;let v;if(ua({allMovingColumns:h?r.getLeafColumns():[r],isFromHeader:!0,fromLeft:"right"===e,xPosition:f,pinned:n,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0}),h){const e=r.getDisplayedLeafColumns();v=g?e[0]:br(e)}else v=r;if(s.getScrollFeature().ensureColumnVisible(v,"auto"),(!i.isAlive()||o.get("ensureDomOrder"))&&m){let e;if(h){const t=r.getGroupId(),n=r.getLeafColumns();if(!n.length)return;const i=n[0].getParent();if(!i)return;e=function(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return}(i,t)}else e=r;e&&c.focusHeaderPosition({headerPosition:{...m,column:e}})}}setDragSourceForHeader(e,t,r){const{gos:n,colModel:i,dragAndDrop:s,visibleCols:o}=this.beans;let a=!n.get("suppressDragLeaveHidesColumns");const l=Li(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],u=l?()=>function(e,t){const r=e.getProvidedColumnGroup().getLeafColumns(),n={};r.forEach((e=>n[e.getId()]=e.isVisible()));const i=[];t.forEach((e=>{r.indexOf(e)>=0&&(i.push(e),Er(r,e))})),r.forEach((e=>i.push(e)));const s=[],o=e.getLeafColumns();for(const a of i)-1!==o.indexOf(a)&&s.push(a);return{columns:i,columnsInSplit:s,visibleState:n}}(t,o.allCols):()=>function(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}(t),d={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:u,dragItemName:r,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),pa(c,!0)},onDragStopped:()=>pa(c,!1),onDragCancelled:()=>pa(c,!1),onGridEnter:e=>{if(a){const{columns:t=[],visibleState:r}=e??{},n=l?e=>!r||r[e.getColId()]:()=>!0,s=t.filter((e=>!e.getColDef().lockVisible&&n(e)));i.setColsVisible(s,!0,"uiColumnMoved")}},onGridExit:e=>{if(a){const t=e?.columns?.filter((e=>!e.getColDef().lockVisible))||[];i.setColsVisible(t,!1,"uiColumnMoved")}}};return s.addDragSource(d,!0),d}},class extends rr{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>this.gridBodyCtrl=e.gridBodyCtrl))}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush((()=>this.activeNext=!1),(()=>this.active=!1))}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push((()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)}))}flush(e,t){const{executeNextFuncs:r,executeLaterFuncs:n}=this;if(0===r.length&&0===n.length)return e(),void t();const i=e=>{for(;e.length;){const t=e.pop();t&&t()}};this.beans.frameworkOverrides.wrapIncoming((()=>{window.setTimeout((()=>{e(),i(r)}),0),window.setTimeout((()=>{t(),i(n)}),200)}))}}],apiFunctions:{moveColumnByIndex:function(e,t,r){e.colMoves?.moveColumnByIndex(t,r,"api")},moveColumns:function(e,t,r){e.colMoves?.moveColumns(t,r,"api")}},dependsOn:[oa],css:[":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}"]},Ca={moduleName:"AutoWidth",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.centerRowContainerCtrl=e.center}))}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(r),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const r=document.createElement("form");r.style.position="fixed";const n=this.centerRowContainerCtrl.eContainer;e.forEach((e=>this.cloneItemIntoDummy(e,r))),n.appendChild(r);const i=r.offsetWidth;return n.removeChild(r),i+(t=t??this.gos.get("autoSizePadding"))}getHeaderCellForColumn(e){let t=null;return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().forEach((r=>{const n=r.getHtmlElementForColumnHeader(e);null!=n&&(t=n)})),t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const n=document.createElement("div"),i=n.classList;["ag-header-cell","ag-header-group-cell"].some((e=>r.classList.contains(e)))?(i.add("ag-header","ag-header-row"),n.style.position="static"):i.add("ag-row");let s=e.parentElement;for(;s;){if(["ag-header-row","ag-row"].some((e=>s.classList.contains(e)))){for(let e=0;e<s.classList.length;e++){const t=s.classList[e];"ag-row-position-absolute"!=t&&i.add(t)}break}s=s.parentElement}n.appendChild(r),t.appendChild(n)}}]};var wa=class extends rr{constructor(e,t,r,n){super(),this.comp=e,this.eResize=t,this.pinned=r,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const{horizontalResizeSvc:e,gos:t,colAutosize:r}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&r&&this.addDestroyFunc(r.addColumnGroupResize(this.eResize,this.columnGroup,(()=>this.resizeLeafColumnsToFit("uiColumnResized"))))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:n,groupAfterColumns:i,groupAfterStartWidth:s,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=n,this.resizeTakeFromCols=i,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uiColumnResized";const n=this.normaliseDragChange(t),i=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(i,r,e)}getInitialValues(e){const t=e=>e.reduce(((e,t)=>e+t.getActualWidth()),0),r=(e,t)=>e.map((e=>e.getActualWidth()/t)),n=this.getColumnsToResize(),i=t(n),s={columnsToResize:n,resizeStartWidth:i,resizeRatios:r(n,i)};let o=null;if(e&&(o=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),o){const e=o.getDisplayedLeafColumns(),n=s.groupAfterColumns=e.filter((e=>e.isResizable())),i=s.groupAfterStartWidth=t(n);s.groupAfterRatios=r(n,i)}else s.groupAfterColumns=void 0,s.groupAfterStartWidth=void 0,s.groupAfterRatios=void 0;return s}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.resizeCols||!this.resizeRatios)return;const n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,r)}resizeColumns(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{columnsToResize:i,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:i,ratios:o,width:t}),a){const e=t-s;u.push({columns:a,ratios:c,width:l-e})}this.beans.colResize?.resizeColumnSets({resizeSets:u,finished:n,source:r}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter((e=>e.isResizable()))}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},ba=class extends rr{constructor(e,t,r,n,i){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=n,this.ctrl=i}postConstruct(){const e=[];let t,r;const n=()=>{if(X(this.eResize,t),!t)return;const{horizontalResizeSvc:n,colAutosize:i}=this.beans,s=n.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(s),r&&i&&e.push(i.addColumnAutosize(this.eResize,this.column))},i=()=>{e.forEach((e=>e())),e.length=0},s=()=>{const e=this.column.isResizable(),s=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(e!==t||s!==r)&&(t=e,r=s,i(),n())};s(),this.addDestroyFunc(i),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:r,lastResizeAmount:n,resizeStartWidth:i,beans:s}=this,o=this.normaliseResizeAmount(t),a=[{key:r,newWidth:i+o}],{pinnedCols:l,ctrlsSvc:c,colResize:u}=s;if(this.column.getPinned()){if((l?.leftWidth??0)+(l?.rightWidth??0)+(o-n)>re(c.getGridBodyCtrl().eBodyViewport)-50)return}this.lastResizeAmount=o,u?.setColumnWidths(a,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r="left"!==this.pinned,n="right"===this.pinned;return this.gos.get("enableRtl")?r&&(t*=-1):n&&(t*=-1),t}};var ya={moduleName:"ColumnResize",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,r,n){const i=[],{colModel:s,gos:o,visibleCols:a}=this.beans;e.forEach((e=>{const r=s.getColDefCol(e.key)||s.getCol(e.key);if(!r)return;i.push({width:e.newWidth,ratios:[1],columns:[r]});if("shift"===o.get("colResizeDefault")&&(t=!t),t){const t=a.getColAfter(r);if(!t)return;const n=r.getActualWidth()-e.newWidth,s=t.getActualWidth()+n;i.push({width:s,ratios:[1],columns:[t]})}})),0!==i.length&&this.resizeColumnSets({resizeSets:i,finished:r,source:n})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:n}=e;if(!(!t||t.every((e=>function(e){const{columns:t,width:r}=e;let n=0,i=0,s=!0;t.forEach((e=>{const t=e.getMinWidth();n+=t||0;const r=e.getMaxWidth();r>0?i+=r:s=!1}));const o=!s||r<=i;return r>=n&&o}(e))))){if(r){const e=t&&t.length>0?t[0].columns:null;Xr(this.eventSvc,e,r,n)}return}const i=[],s=[];t.forEach((e=>{const{width:t,columns:r,ratios:o}=e,a={},l={};r.forEach((e=>s.push(e)));let c=!0,u=0;for(;c;){if(u++,u>1e3){tt(31);break}c=!1;const e=[];let n=0,i=t;r.forEach(((t,r)=>{if(l[t.getId()])i-=a[t.getId()];else{e.push(t);const i=o[r];n+=i}}));const s=1/n;e.forEach(((r,n)=>{let u;n===e.length-1?u=i:(u=Math.round(o[n]*t*s),i-=u);const d=r.getMinWidth(),h=r.getMaxWidth();u<d?(u=d,l[r.getId()]=!0,c=!0):h>0&&u>h&&(u=h,l[r.getId()]=!0,c=!0),a[r.getId()]=u}))}r.forEach((e=>{const t=a[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,n),i.push(e))}))}));const o=i.length>0;let a=[];if(o){const{colFlex:e,visibleCols:t,colViewport:r}=this.beans;a=e?.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0})??[],t.setLeftValues(n),t.updateBodyWidths(),r.checkViewportColumns()}const l=s.concat(a);(o||r)&&Xr(this.eventSvc,l,r,n,a)}resizeHeader(e,t,r){if(!e.isResizable())return;const n=e.getActualWidth(),i=e.getMinWidth(),s=e.getMaxWidth(),o=Math.min(Math.max(n+t,i),s);this.setColumnWidths([{key:e,newWidth:o}],r,!0,"uiColumnResized")}createResizeFeature(e,t,r,n,i){return new ba(e,t,r,n,i)}createGroupResizeFeature(e,t,r,n){return new wa(e,t,r,n)}}],apiFunctions:{setColumnWidths:function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api";e.colResize?.setColumnWidths(t,!1,r,n)}},dependsOn:[aa,Ca]},Sa=class extends rr{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((t=>{t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push((()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)}))}))}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach((e=>e())),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}};function Ea(e,t,r){if(e)for(let n=0;n<e.length;n++){const i=e[n];if(Li(i)){Ea(t?i.getDisplayedChildren():i.getChildren(),t,r)}r(i)}}function Ra(e){const t=[];return Ea(e,!0,(e=>{pr(e)&&t.push(e)})),t}var Ta={moduleName:"ColumnGroup",version:We,dynamicBeans:{headerGroupCellCtrl:class extends so{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}setComp(e,t,r,n,i){const{column:s,beans:o}=this,{context:a,colNames:l,colHover:c,rangeSvc:u,colResize:d}=o;this.comp=e,i=on(this,a,i),this.setGui(t,i),this.displayName=l.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(i),this.setupExpandable(i),this.setupTooltip(),this.setupAutoHeight({wrapperElement:n,compBean:i}),this.setupUserComp(),this.addHeaderMouseListeners(i),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const h=this.rowCtrl.pinned,p=s.getProvidedColumnGroup().getLeafColumns();c?.createHoverFeature(i,p,t),u?.createRangeHighlightFeature(i,s,e),i.createManagedBean(new ro(s,t,o)),i.createManagedBean(new Sa(e,s)),d?this.resizeFeature=i.createManagedBean(d.createGroupResizeFeature(e,r,h,s)):e.setResizableDisplayed(!1),i.createManagedBean(new Yi(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(i,p),i.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(i),i.addDestroyFunc((()=>this.clearComponent()))}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.getDefinition();return Ut(t.gos,{colDef:r,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,r=e.get("groupHeaderHeight");null!=r?0===r?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(r):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,n=br(t)===e;if(!r&&!n)return;const i=e.getHighlighted();let s=!1,o=!1;if(!!this.rowCtrl.getHeaderCellCtrls().find((e=>e.column.isMoving()))){const e=this.beans.gos.get("enableRtl"),t=1===i,a=0===i;r&&(e?o=t:s=a),n&&(e?s=a:o=t)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",s),this.comp.addOrRemoveCssClass("ag-header-highlight-after",o)}resizeHeader(e,t){const{resizeFeature:r}=this;if(!r)return;const n=r.getInitialValues(t);r.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:r}=this.beans,n=function(e,t){const r=t.columnGroup.getColGroupDef();return e.getCompDetails(r,vn,"agColumnGroupHeader",t)}(t,Ut(r,{displayName:this.displayName,columnGroup:this.column,setExpanded:t=>{e.setColumnGroupOpened(this.column.getProvidedColumnGroup(),t,"gridInitializing")},setTooltip:(e,t)=>{r.assertModuleRegistered("Tooltip",3),this.setupTooltip(e,t)}}));n&&this.comp.setUserCompDetails(n)}addHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column.getProvidedColumnGroup())})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),r=qn(t,this.gos,null,e);if(e.isPadding()){r.push("ag-header-group-cell-no-group");e.getLeafColumns().every((e=>e.isSpanHeaderHeight()))&&r.push("ag-header-span-height")}else r.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&r.push("ag-header-cell-wrap-text");r.forEach((e=>this.comp.addOrRemoveCssClass(e,!0)))}setupMovingCss(e){const{column:t}=this,r=t.getProvidedColumnGroup().getLeafColumns(),n=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",t.isMoving());r.forEach((t=>{e.addManagedListeners(t,{movingChanged:n})})),n()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===Qn.ENTER){const e=this.column,t=!e.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){this.isAlive()&&!this.isSuppressMoving()&&(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some((e=>e.getColDef().suppressMovable||e.getColDef().lockPosition))}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}}},beans:[class extends rr{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[];return Ur(null,this.beans.colModel.getColTree(),(t=>{fr(t)&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})})),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const r=[];Ur(null,t,(e=>{if(fr(e)){const t=e.getColGroupDef(),n={groupId:e.getGroupId(),open:t?t.openByDefault:void 0};r.push(n)}})),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){const{colModel:r,colAnimation:n,visibleCols:i,eventSvc:s}=this.beans;if(!r.getColTree().length)return;n?.start();const o=[];e.forEach((e=>{const t=e.groupId,r=e.open,n=this.getProvidedColGroup(t);n&&n.isExpanded()!==r&&(n.setExpanded(r),o.push(n))})),i.refresh(t,!0),o.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:1===o.length?o[0]:void 0,columnGroups:o}),n?.finish()}setColumnGroupOpened(e,t,r){let n;n=fr(e)?e.getId():e||"",this.setColumnGroupState([{groupId:n,open:t}],r)}getProvidedColGroup(e){let t=null;return Ur(null,this.beans.colModel.getColTree(),(r=>{fr(r)&&r.getId()===e&&(t=r)})),t}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),i="After"===t?br(n):n[0],s=`getCol${t}`;for(;;){const t=this.beans.visibleCols[s](i);if(!t)return null;const n=this.getColGroupAtLevel(t,r);if(n!==e)return n}}getColGroupAtLevel(e,t){let r,n,i=e.getParent();for(;;){if(r=i.getProvidedColumnGroup().getLevel(),n=i.getPaddingLevel(),r+n<=t)break;i=i.getParent()}return i}updateOpenClosedVisibility(){Ea(this.beans.visibleCols.getAllTrees(),!1,(e=>{Li(e)&&e.calculateDisplayedColumns()}))}getColumnGroup(e,t){if(!e)return null;if(Li(e))return e;const r=this.beans.visibleCols.getAllTrees(),n="number"===typeof t;let i=null;return Ea(r,!1,(r=>{if(Li(r)){const s=r;let o;o=n?e===s.getGroupId()&&t===s.getPartId():e===s.getGroupId(),o&&(i=s)}})),i}createColumnGroups(e){const{columns:t,idCreator:r,pinned:n,oldDisplayedGroups:i,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(i),a=[];let l=t;for(;l.length;){const e=l;l=[];let t=0;const i=i=>{const c=t;t=i;const u=e[c],d=(Li(u)?u.getProvidedColumnGroup():u).getOriginalParent();if(null==d){for(let t=c;t<i;t++)a.push(e[t]);return}const h=this.createColumnGroup(d,r,o,n,s);for(let t=c;t<i;t++)h.addChild(e[t]);l.push(h)};for(let r=1;r<e.length;r++){const n=e[r],s=(Li(n)?n.getProvidedColumnGroup():n).getOriginalParent(),o=e[t];s!==(Li(o)?o.getProvidedColumnGroup():o).getOriginalParent()&&i(r)}t<e.length&&i(e.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,r,n,i,s,o){const a=i.getUniqueKey(t.groupId||null,null),l=this.createMergedColGroupDef(t,a),c=new mr(l,a,!1,r);this.createBean(c);const u=this.findExistingGroup(t,s);u&&s.splice(u.idx,1);const d=u?.group;d&&c.setExpanded(d.isExpanded());const h=Hr(this.beans,l.children,r+1,e,n,i,s,o);return c.setChildren(h),c}balanceColumnTree(e,t,r,n){const i=[];for(let s=0;s<e.length;s++){const o=e[s];if(fr(o)){const e=o,s=this.balanceColumnTree(e.getChildren(),t+1,r,n);e.setChildren(s),i.push(e)}else{let s,a;for(let e=r-1;e>=t;e--){const e=n.getUniqueKey(null,null),r=this.createMergedColGroupDef(null,e),i=new mr(r,e,!0,t);this.createBean(i),a&&a.setChildren([i]),a=i,s||(s=a)}if(s&&a){i.push(s);if(e.some((e=>fr(e)))){a.setChildren([o]);continue}a.setChildren(e);break}i.push(o)}}return i}findDepth(e){let t=0,r=e;for(;r&&r[0]&&fr(r[0]);)t++,r=r[0].getChildren();return t}findMaxDepth(e,t){let r=t;for(let n=0;n<e.length;n++){const i=e[n];if(fr(i)){const e=i,n=this.findMaxDepth(e.getChildren(),t+1);r<n&&(r=n)}}return r}balanceTreeForAutoCols(e,t){const r=[];return e.forEach((e=>{let n=e;for(let r=t-1;r>=0;r--){const t=new mr(null,`FAKE_PATH_${e.getId()}}_${r}`,!0,r);this.createBean(t),t.setChildren([n]),n.originalParent=t,n=t}0===t&&(e.originalParent=null),r.push(n)})),r}createMergedColGroupDef(e,t){const r={},{gos:n,validation:i}=this.beans;return Object.assign(r,n.get("defaultColGroupDef")),Object.assign(r,e),i?.validateColDef(r,t),r}findExistingGroup(e,t){if(null!=e.groupId)for(let r=0;r<t.length;r++){const n=t[r];if(n.getColGroupDef()&&n.getId()===e.groupId)return{idx:r,group:n}}}createColumnGroup(e,t,r,n,i){const s=e.getGroupId(),o=t.getInstanceIdForKey(s);let a=r[Oi(s,o)];return a&&a.getProvidedColumnGroup()!==e&&(a=null),xe(a)?a.reset():(a=new Ni(e,s,o,n),i||this.createBean(a)),a}mapOldGroupsById(e){const t={},r=e=>{e.forEach((e=>{if(Li(e)){const n=e;t[e.getUniqueId()]=n,r(n.getChildren())}}))};return e&&r(e),t}setupParentsIntoCols(e,t){e.forEach((e=>{if(e.parent=t,Li(e)){const t=e;this.setupParentsIntoCols(t.getChildren(),t)}}))}}],apiFunctions:{getAllDisplayedColumnGroups:function(e){return e.visibleCols.getAllTrees()},getCenterDisplayedColumnGroups:function(e){return e.visibleCols.treeCenter},getColumnGroup:function(e,t,r){return e.colGroupSvc?.getColumnGroup(t,r)??null},getColumnGroupState:function(e){return e.colGroupSvc?.getColumnGroupState()??[]},getDisplayNameForColumnGroup:function(e,t,r){return e.colNames.getDisplayNameForColumnGroup(t,r)||""},getLeftDisplayedColumnGroups:function(e){return e.visibleCols.treeLeft},getProvidedColumnGroup:function(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null},getRightDisplayedColumnGroups:function(e){return e.visibleCols.treeRight},resetColumnGroupState:function(e){e.colGroupSvc?.resetColumnGroupState("api")},setColumnGroupOpened:function(e,t,r){e.colGroupSvc?.setColumnGroupOpened(t,r,"api")},setColumnGroupState:function(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}}},xa={moduleName:"CheckboxCellRenderer",version:We,userComponents:{agCheckboxCellRenderer:class extends un{constructor(){super(Ro,[Eo]),this.eCheckbox=cn,this.registerCSS(".ag-checkbox-cell{height:100%}")}init(e){this.refresh(e);const{eCheckbox:t,beans:r}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),E(n,"polite"),this.addManagedListeners(n,{click:e=>{if(Xt(e),t.isDisabled())return;const r=t.getValue();this.onCheckboxChanged(r)},dblclick:e=>{Xt(e)}}),this.addManagedElementListeners(e.eGridCell,{keydown:n=>{if(n.key===Qn.SPACE&&!t.isDisabled()){e.eGridCell===wt(r)&&t.toggle();const i=t.getValue();this.onCheckboxChanged(i),n.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,r=!0;const{value:n,column:i,node:s}=e;if(s.group&&i)if("boolean"===typeof n)t=n;else{const e=i.getColId();e.startsWith(Tr)?t=null==n||""===n?void 0:"true"===n:s.aggData&&void 0!==s.aggData[e]?t=n??void 0:r=!1}else t=n??void 0;const{eCheckbox:o}=this;if(!r)return void o.setDisplayed(!1);o.setValue(t);const a=e.disabled??!i?.isCellEditable(s);o.setDisabled(a);const l=this.getLocaleTextFunc(),c=B(l,t),u=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;o.setInputAriaLabel(u)}onCheckboxChanged(e){const{eventSvc:t,params:r}=this,{column:n,node:i,value:s}=r,o={column:n,colDef:n.getColDef(),data:i.data,node:i,rowIndex:i.rowIndex,rowPinned:i.rowPinned,value:s};t.dispatchEvent({type:"cellEditingStarted",...o});const a=i.setDataValue(n,e,"edit");t.dispatchEvent({type:"cellEditingStopped",...o,oldValue:s,newValue:e,valueChanged:a}),a||this.updateCheckbox(r)}}}};function ka(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...Or(e.columnTypes),...Or(t.columnTypes)]),r}function Pa(e,t,r){return t?t.baseDataType===e.baseDataType||(et(46),!1):(et(45,{parentCellDataType:r}),!1)}function Aa(e,t){if(e.valueFormatter)return r=>{if(r.node?.group){const n=(r.colDef.pivotValueColumn??r.column).getAggFunc();if(n){if("first"===n||"last"===n)return e.valueFormatter(r);if("number"===e.baseDataType&&"count"!==n){if("number"===typeof r.value)return e.valueFormatter(r);if("object"===typeof r.value){if(!r.value)return;if("toNumber"in r.value)return e.valueFormatter({...r,value:r.value.toNumber()});if("value"in r.value)return e.valueFormatter({...r,value:r.value.value})}}return}if("groupRows"===t.get("groupDisplayType")&&!t.get("treeData"))return}else if(t.get("groupHideOpenParents")&&r.column.isRowGroupActive()&&"string"===typeof r.value&&!e.dataTypeMatcher?.(r.value))return;return e.valueFormatter(r)}}function Fa(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((r=>{let[n,i]=r;return function(e,t,r,n){if(!t[r])return!1;const i=e[r];return null===i?(t[r]=!1,!1):void 0===n?!!i:i===n}(e,t,n,i)}))}function Da(e,t){const r=en(e);return t.forEach((e=>{delete r[e],"rowGroup"===e?delete r.rowGroupIndex:"pivot"===e&&delete r.pivotIndex})),r}var Ia={moduleName:"DataType",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)}))}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={};this.dataTypeDefinitions=t;const r={};this.formatValueFuncs=r;const n=e=>t=>{const{column:r,node:n,value:i}=t;let s=r.getColDef().valueFormatter;return s===e.groupSafeValueFormatter&&(s=e.valueFormatter),this.beans.valueSvc.formatValue(r,n,i,s)};for(const o of Object.keys(e)){const i=e[o],s={...i,groupSafeValueFormatter:Aa(i,this.gos)};t[o]=s,r[o]=n(s)}const i=this.gos.get("dataTypeDefinitions")??{},s={};this.dataTypeMatchers=s;for(const o of Object.keys(i)){const a=i[o],l=this.processDataTypeDefinition(a,i,[o],e);l&&(t[o]=l,a.dataTypeMatcher&&(s[o]=a.dataTypeMatcher),r[o]=n(l))}this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach((t=>{const r=s[t];r&&delete s[t],s[t]=r??e[t].dataTypeMatcher}))}processDataTypeDefinition(e,t,r,n){let i;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let r=n[s];const o=t[s];if(r&&o&&(r=o),!Pa(e,r,s))return;i=ka(r,e)}else{if(r.includes(s))return void et(44);const o=t[s];if(!Pa(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...r,s],n);if(!a)return;i=ka(a,e)}return{...i,groupSafeValueFormatter:Aa(i,this.gos)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:n}=t;const{field:i}=t;if(void 0===n&&(n=e.cellDataType),null!=n&&!0!==n||(n=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(i,r)),!n)return void(e.cellDataType=!1);const s=this.dataTypeDefinitions[n];if(s)return e.cellDataType=n,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s,r),s.columnTypes;et(47,{cellDataType:n})}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=e=>{t.add(e.key)};e.__addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push((()=>e.__removeEventListener("columnStateUpdated",r)))}canInferCellDataType(e,t){const{gos:r}=this;if(!ot(r))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(Fa(t,n))return!1;const i=null===t.type?e.type:t.type;if(i){const e=r.get("columnTypes")??{};if(Or(i).some((t=>{const r=e[t.trim()];return r&&Fa(r,n)})))return!1}return!Fa(e,n)}inferCellDataType(e,t){if(!e)return;let r;const n=this.getInitialData();if(n){const t=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");r=sr(n,e,t)}else this.initWaitForRowData(t);return null!=r?Object.keys(this.dataTypeMatchers).find((e=>this.dataTypeMatchers[e](r)))??"object":void 0}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const e=this.beans.rowModel.rootNode?.allLeafChildren;if(e?.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:r,eventSvc:n}=this.beans;t&&r&&(r.shouldQueueResizeOperations=!0);const[i]=this.addManagedEventListeners({rowDataUpdateStarted:e=>{const{firstRowData:s}=e;s&&(i?.(),this.isPendingInference=!1,this.processColumnsPendingInference(s,t),this.columnStateUpdatesPendingInference={},t&&r?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const n={},i={};for(const s of Object.keys(this.columnStateUpdatesPendingInference)){const e=this.columnStateUpdatesPendingInference[s],o=this.colModel.getCol(s);if(!o)return;const a=o.getColDef();if(!this.resetColDefIntoCol(o,"cellDataTypeInferred"))return;const l=o.getColDef();if(t&&l.type&&l.type!==a.type){const t=Da(o,e);t.rowGroup&&null==t.rowGroupIndex&&(n[s]=t),t.pivot&&null==t.pivotIndex&&(i[s]=t),r.push(t)}}t&&r.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,i)),r.length&&Jr(this.beans,{state:r},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},{rowGroupColsSvc:n,pivotColsSvc:i}=this.beans;return n?.restoreColumnOrder(r,e),i?.restoreColumnOrder(r,t),Object.values(r)}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const n=Wr(this.beans,r,e.getColId());return e.setColDef(n,r,t),!0}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,r=e.object;this.hasObjectValueParser=t.valueParser!==r.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==r.valueFormatter}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(null==t)return!0;const r=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!r||r(t)}validateColDef(e){const t=e=>et(48,{property:e});if("object"===e.cellDataType){const{object:r}=this.dataTypeDefinitions;e.valueFormatter!==r.groupSafeValueFormatter||this.hasObjectValueFormatter||t("Formatter"),e.editable&&e.valueParser===r.valueParser&&!this.hasObjectValueParser&&t("Parser")}}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,r,n){const i=this.formatValueFuncs[t];switch(r.baseDataType){case"number":e.cellEditor="agNumberCellEditor";break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.getFindText=()=>null,e.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===Qn.SPACE;break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=i;break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=i;break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=(e,t)=>{const r=this.colModel.getColDefCol(n),s=r?.getColDef();if(!r||!s)return 0;const o=null==e?"":i({column:r,node:null,value:e}),a=null==t?"":i({column:r,node:null,value:t});return o===a?0:o>a?1:-1},e.keyCreator=i}this.beans.filterManager?.setColDefPropertiesForDataType(e,r,i)}getDefaultDataTypes(){const e=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>""===e.newValue?.trim?.()?null:Number(e.newValue),valueFormatter:e=>null==e.value?"":"number"!==typeof e.value||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"===typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:Pe(e.newValue),dataTypeMatcher:e=>"string"===typeof e},boolean:{baseDataType:"boolean",valueParser:e=>null==e.newValue?e.newValue:""===e.newValue?.trim?.()?null:"true"===String(e.newValue).toLowerCase(),valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"===typeof e},date:{baseDataType:"date",valueParser:e=>Io(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?Do(e.value,!1)??"":t("invalidDate","Invalid Date"),dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>Io(e)??void 0,dateFormatter:e=>Do(e??null,!1)??void 0,valueParser:t=>e(String(t.newValue))?t.newValue:null,valueFormatter:t=>e(String(t.value))?t.value:"",dataTypeMatcher:t=>"string"===typeof t&&e(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>Pe(e.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach((e=>e())),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}}],dependsOn:[xa]},Ma={moduleName:"ColumnFlex",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="colFlex"}refreshFlexedColumns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.source??"flex";null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth);const r=this.flexViewportWidth;if(!r)return[];const{visibleCols:n}=this.beans,i=n.centerCols;let s=-1;if(e.resizingCols){const t=new Set(e.resizingCols);for(let e=i.length-1;e>=0;e--)if(t.has(i[e])){s=e;break}}let o=!1;const a=i.map(((e,t)=>{const r=e.getFlex(),n=null!=r&&r>0&&t>s;return o||(o=n),{col:e,isFlex:n,flex:Math.max(0,r??0),initialSize:e.getActualWidth(),min:e.getMinWidth(),max:e.getMaxWidth(),targetSize:0}}));if(!o)return[];let l=a.length,c=a.reduce(((e,t)=>e+t.flex),0),u=r;const d=(e,r)=>{e.frozenSize=r,e.col.setActualWidth(r,t),u-=r,c-=e.flex,l-=1},h=e=>null!=e.frozenSize;for(const g of a)g.isFlex||d(g,g.initialSize);for(;l>0;){const e=Math.round(c<1?u*c:u);let t,r=0,n=0;for(const o of a){if(h(o))continue;t=o,n+=e*(o.flex/c);const i=n-r,s=Math.round(i);o.targetSize=s,r+=s}t&&(t.targetSize+=e-r);let i=0;for(const o of a){if(h(o))continue;const e=o.targetSize,t=Math.min(Math.max(e,o.min),o.max);i+=t-e,o.violationType=t===e?void 0:t<e?"max":"min",o.targetSize=t}const s=0===i?"all":i>0?"min":"max";for(const o of a)h(o)||"all"!==s&&o.violationType!==s||d(o,o.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();const p=a.filter((e=>e.isFlex&&!e.violationType)).map((e=>e.col));if(e.fireResizedEvent){const e=a.filter((e=>e.initialSize!==e.frozenSize)).map((e=>e.col)),r=a.filter((e=>e.flex)).map((e=>e.col));Xr(this.eventSvc,e,!0,t,r)}return p}initCol(e){const{flex:t,initialFlex:r}=e.colDef;void 0!==t?e.flex=t:void 0!==r&&(e.flex=r)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}}]};var Oa,La={moduleName:"CellRendererFunction",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;return class{refresh(){return!1}getGui(){return this.eGui}init(e){const r=t(e),n=typeof r;this.eGui="string"!==n&&"number"!==n&&"boolean"!==n?null!=r?r:Re({tag:"span"}):he("<span>"+r+"</span>")}}}}]},Na="object"!==typeof window||!window?.document?.fonts?.forEach,_a=new WeakMap,Ga=(e,t,r,n,i,s)=>{if(Na)return;if(vl)return;n&&(e=`@layer ${CSS.escape(n)} { ${e} }`);let o=_a.get(t);if(o||(o=[],_a.set(t,o)),o.find((t=>t.css===e)))return;const a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=r,a.textContent=e;const l={css:e,el:a,priority:i};let c;for(const u of o){if(u.priority>i)break;c=u}if(c){c.el.insertAdjacentElement("afterend",a);const e=o.indexOf(c);o.splice(e+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},Ba=(e,t,r)=>{Ga(':where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none}}:where(.ag-root-wrapper,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value,.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom,.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}.ag-floating-bottom{border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-large-text-input{display:block}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{opacity:1}50%{opacity:.4}to{opacity:1}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-chart,.ag-dnd-ghost,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab}.ag-list-item,.ag-virtual-list-item{height:var(--ag-list-item-height)}.ag-virtual-list-item{position:absolute;width:100%}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-list-item{align-items:center;display:flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-column-select-column-group-readonly,.ag-column-select-column-readonly,.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-column-select-column-readonly{&.ag-icon-grip,.ag-icon-grip{opacity:.35}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-accent-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto}.ag-menu,.ag-resizer{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-resizer{pointer-events:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',e,"core",t,0,r),Array.from(new Set(_n)).sort(((e,t)=>e.moduleName.localeCompare(t.moduleName))).forEach((n=>n.css?.forEach((i=>Ga(i,e,`module-${n.moduleName}`,t,0,r)))))},Ha=new Set,za=e=>new Ua(e),Va="$default",Wa=0,Ua=class{constructor(e){let{feature:t,params:r,modeParams:n={},css:i,cssImports:s}=e;this.feature=t,this.css=i,this.cssImports=s,this.modeParams={[Va]:{...n[Va]??{},...r??{}},...n}}use(e,t,r){let n=this._inject;if(null==n){let{css:e}=this;if(e){const t=`ag-theme-${this.feature??"part"}-${++Wa}`;"function"===typeof e&&(e=e()),e=`:where(.${t}) {\n${e}\n}\n`;for(const r of this.cssImports??[])e=`@import url(${JSON.stringify(r)});\n${e}`;n={css:e,class:t}}else n=!1;this._inject=n}return n&&e&&Ga(n.css,e,n.class,t,1,r),!!n&&n.class}},ja=e=>{return`--ag-${t=e,t.replace(/[A-Z]/g,(e=>`-${e}`)).toLowerCase()}`;var t},$a=e=>`var(${ja(e)})`,Ka=e=>({ref:"accentColor",mix:e}),Ya=e=>({ref:"foregroundColor",mix:e}),qa=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),Xa={ref:"backgroundColor"},Ja={ref:"foregroundColor"},Qa={ref:"accentColor"},Za={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Ya(.15),chromeBackgroundColor:qa(.02),browserColorScheme:"light"},el={...Za,textColor:Ja,accentColor:"#2196f3",invalidColor:"#e02525",wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Xa,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},subtleTextColor:{ref:"textColor",mix:.5},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Qa,rangeSelectionBackgroundColor:Ka(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:Ka(.5),rangeHeaderHighlightColor:(Oa=.08,{ref:"foregroundColor",mix:Oa,onto:"headerBackgroundColor"}),rowNumbersSelectedColor:Ka(.5),rowHoverColor:Ka(.08),columnHoverColor:Ka(.05),selectedRowBackgroundColor:Ka(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},oddRowBackgroundColor:Xa,borderRadius:4,wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",spacing:8,fontSize:14,rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},dragAndDropImageBackgroundColor:Xa,dragAndDropImageBorder:!0,dragAndDropImageShadow:{ref:"popupShadow"},dragHandleColor:Ya(.7),focusShadow:{spread:3,color:Ka(.5)},headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},iconSize:16,iconColor:"inherit",iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Ya(.1),iconButtonActiveColor:Qa,iconButtonActiveBackgroundColor:Ka(.28),iconButtonActiveIndicatorColor:Qa,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Qa,toggleButtonOffBackgroundColor:qa(.3),toggleButtonSwitchBackgroundColor:Xa,toggleButtonSwitchInset:2,menuBorder:{color:Ya(.2)},menuBackgroundColor:qa(.03),menuTextColor:qa(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Ya(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Qa},cellEditingShadow:{ref:"cardShadow"},dialogBorder:{color:Ya(.2)},panelBackgroundColor:Xa,panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipTextColor:{ref:"textColor"},tooltipBorder:!0,columnDropCellBackgroundColor:Ya(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Ya(.13)},selectCellBackgroundColor:Ya(.07),selectCellBorder:{color:Ya(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",findMatchColor:Ja,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Ja,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Ya(.15),statusBarLabelColor:Ja,statusBarLabelFontWeight:500,statusBarValueColor:Ja,statusBarValueFontWeight:500},tl=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",rl={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},nl=(()=>za({feature:"buttonStyle",params:{...rl,buttonBackgroundColor:Xa,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Qa}},css:tl}))(),il=(()=>za({feature:"columnDropStyle",css:".ag-column-drop-vertical-empty-message{align-items:center;border:1px dashed;border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}"}))(),sl=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],ol=(e=>{const t=new Map;return r=>{const n=r;return t.has(n)||t.set(n,e(r)),t.get(n)}})((e=>(e=e.toLowerCase(),sl.find((t=>e.endsWith(t.toLowerCase())))??"length"))),al=e=>"object"===typeof e&&e?.ref?$a(e.ref):"string"===typeof e?e:"number"===typeof e&&String(e),ll=e=>{if("string"===typeof e)return e;if(e&&"ref"in e){const t=$a(e.ref);if(null==e.mix)return t;return`color-mix(in srgb, ${e.onto?$a(e.onto):"transparent"}, ${t} ${((e,t,r)=>Math.max(t,Math.min(r,e)))(100*e.mix,0,100)}%)`}return!1},cl=e=>{if("string"===typeof e)return e;if("number"===typeof e)return`${e}px`;if(e&&"calc"in e){return`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,(e=>"-"===e[0]?e:` ${$a(e)} `))})`}return!(!e||!("ref"in e))&&$a(e.ref)},ul=al,dl=e=>"string"===typeof e?e.includes(",")?e:hl(e):e&&"googleFont"in e?dl(e.googleFont):e&&"ref"in e?$a(e.ref):!!Array.isArray(e)&&e.map((e=>("object"===typeof e&&"googleFont"in e&&(e=e.googleFont),hl(e)))).join(", "),hl=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),pl=al,gl=e=>"string"===typeof e?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?gl({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):!(!e||!("ref"in e))&&$a(e.ref),fl={color:ll,colorScheme:al,length:cl,scale:al,border:(e,t)=>"string"===typeof e?e:!0===e?"solid 1px var(--ag-border-color)":!1===e?"columnBorder"===t?"solid 1px transparent":"none":e&&"ref"in e?$a(e.ref):ul(e.style??"solid")+" "+cl(e.width??1)+" "+ll(e.color??{ref:"borderColor"}),borderStyle:ul,shadow:e=>"string"===typeof e?e:!1===e?"none":e&&"ref"in e?$a(e.ref):[cl(e.offsetX??0),cl(e.offsetY??0),cl(e.radius??0),cl(e.spread??0),ll(e.color??{ref:"foregroundColor"})].join(" "),image:gl,fontFamily:dl,fontWeight:pl,duration:(e,t)=>"string"===typeof e?e:"number"===typeof e?(e>=10&&tt(104,{value:e,param:t}),`${e}s`):!(!e||!("ref"in e))&&$a(e.ref)},ml=(e,t)=>{const r=ol(e);return fl[r](t,e)},vl=!1,Cl=()=>(new wl).withPart(nl).withPart(il),wl=class e{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.parts=e}withPart(t){return"function"===typeof t&&(t=t()),t instanceof Ua?new e([...this.parts,t]):(rt(259,{part:t},"Invalid part"),this)}withoutPart(e){return this.withPart(za({feature:e}))}withParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Va;return this.withPart(za({modeParams:{[t]:e}}))}_startUse(e){let{styleContainer:t,cssLayer:r,nonce:n,loadThemeGoogleFonts:i}=e;if(Na)return;if(vl)return;El(),Ba(t,r,n);const s=yl(this);if(s.length>0)for(const o of s)i&&Tl(o,n);for(const o of this.parts)o.use(t,r,n)}_getCssClass(){return vl?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=bl(this.parts).map((e=>e.use(void 0,void 0,void 0))).filter(Boolean).join(" "))}_getModeParams(){let e=this._paramsCache;if(!e){const t={[Va]:{...el}};for(const e of bl(this.parts))for(const r of Object.keys(e.modeParams)){const n=e.modeParams[r];if(n){const e=t[r]??(t[r]={}),i=new Set;for(const t of Object.keys(n)){const r=n[t];void 0!==r&&(e[t]=r,i.add(t))}if(r===Va)for(const r of Object.keys(t)){const e=t[r];if(r!==Va)for(const t of i)delete e[t]}}}this._paramsCache=e=t}return e}_getPerGridCss(e){const t="##SELECTOR##";let r=this._paramsCssCache;if(!r){let e="",n="";const i=this._getModeParams();for(const t of Object.keys(i)){const r=i[t];if(t!==Va){const r=`:where([data-ag-theme-mode="${"object"===typeof CSS?CSS.escape(t):t}"]) & {\n`;e+=r,n+=r}for(const t of Object.keys(r).sort()){const i=r[t],s=ml(t,i);if(!1===s)tt(107,{key:t,value:i});else{const r=ja(t),i=r.replace("--ag-","--ag-inherited-");e+=`\t${r}: var(${i}, ${s});\n`,n+=`\t${i}: var(${r});\n`}}t!==Va&&(e+="}\n",n+="}\n")}let s=`${t} {\n${e}}\n`;s+=`:has(> ${t}):not(${t}) {\n${n}}\n`,this._paramsCssCache=r=s}return r.replaceAll(t,`:where(.${e})`)}},bl=e=>{const t=new Map;for(const n of e)t.set(n.feature,n);const r=[];for(const n of e)n.feature&&t.get(n.feature)!==n||r.push(n);return r},yl=e=>{const t=new Set,r=e=>{if(Array.isArray(e))e.forEach(r);else{const r=e?.googleFont;"string"===typeof r&&t.add(r)}};return Object.values(e._getModeParams()).flatMap((e=>Object.values(e))).forEach(r),Array.from(t).sort()},Sl=!1,El=()=>{if(!Sl){Sl=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},Rl=new Set,Tl=async(e,t)=>{Rl.add(e);const r=`@import url('https://${xl}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');\n`;Ga(r,document.head,`googleFont:${e}`,void 0,0,t)},xl="fonts.googleapis.com",kl=(()=>za({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Xa,checkboxUncheckedBorderColor:qa(.3),checkboxCheckedBackgroundColor:Qa,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Xa,checkboxIndeterminateBackgroundColor:qa(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Xa,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:'.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}'}))(),Pl=()=>({...Za,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:qa(.05),rowHoverColor:Ka(.15),selectedRowBackgroundColor:Ka(.2),menuBackgroundColor:qa(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",findMatchColor:Xa,findActiveMatchColor:Xa,checkboxUncheckedBorderColor:qa(.4),toggleButtonOffBackgroundColor:qa(.4)}),Al=()=>({...Pl(),backgroundColor:"#1f2836"}),Fl=(()=>za({feature:"colorScheme",params:Za,modeParams:{light:Za,dark:Pl(),"dark-blue":Al()}}))(),Dl={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},Il={"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>'},Ml=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5;const r=Il[e];if(r)return r;const n=Dl[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},Ol=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return za({feature:"iconSet",css:()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";for(const r of[...Object.keys(Dl),...Object.keys(Il)]){const n=Ml(r,e.strokeWidth);t+=`.ag-icon-${r}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }\n`}return t}(e)})},Ll=Ol(),Nl=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}:where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) :where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',_l={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"}},Gl=(()=>za({feature:"inputStyle",params:{..._l,inputBackgroundColor:Xa,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Qa},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:qa(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>Nl+":where(input.ag-input-field-input:not([type]),input.ag-input-field-input[type=text],input.ag-input-field-input[type=number],input.ag-input-field-input[type=tel],input.ag-input-field-input[type=date],input.ag-input-field-input[type=datetime-local],textarea.ag-input-field-input){&:focus{box-shadow:var(--ag-focus-shadow)}}"}))(),Bl='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:1px solid var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',Hl={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:1,tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},zl=(()=>za({feature:"tabStyle",params:{...Hl,tabBarBorder:!0,tabBarBackgroundColor:Ya(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Xa},css:Bl}))(),Vl=(()=>Cl().withPart(kl).withPart(Fl).withPart(Ll).withPart(zl).withPart(Gl).withPart(il).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}))(),Wl={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},Ul={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},jl={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},$l={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},Kl={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},Yl={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},ql={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},Xl=0,Jl=15538;function Ql(e){return!!e&&e.getLeafColumns().some((e=>e.isSpanHeaderHeight()))}function Zl(e,t){let r;if(Li(e)&&Ql(e)&&e.isPadding()){const n=e;r=n.getLeafColumns()[0];let i=r;for(;i!==n;)t++,i=i.getParent()}return{column:r||e,headerRowIndex:t}}var ec=new Set(["gridPreDestroyed","fillStart","pasteStart"]),tc={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1},rc=0,nc=0;function ic(e){const t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var sc=ic(!0),oc=ic(!1),ac={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},lc={moduleName:"ColumnHeaderComp",version:We,userComponents:{agColumnHeader:class extends un{constructor(){super(...arguments),this.eFilter=cn,this.eFilterButton=cn,this.eSortIndicator=cn,this.eMenu=cn,this.eLabel=cn,this.eText=cn,this.eSortOrder=cn,this.eSortAsc=cn,this.eSortDesc=cn,this.eSortMixed=cn,this.eSortNone=cn,this.isLoadingInnerComponent=!1}refresh(e){const t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||null!=this.currentSuppressMenuHide&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const t={...e};ir(t,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(t)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const r=e.template;return r?r?.trim?r.trim():r:t?sc:oc}init(e){this.params=e;const{sortSvc:t,touchSvc:r,rowNumbersSvc:n,userCompFactory:i}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),r?.setupForHeader(this),this.setMenu(),this.setupSort(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(i,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const r=function(e,t,r){return e.getCompDetails(t,fn,void 0,r)}(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then((e=>{this.isLoadingInnerComponent=!1,e&&(this.isAlive()?(this.innerHeaderComponent=e,this.eText.appendChild(e.getGui())):this.destroyBean(e))})))}setDisplayName(e){const{displayName:t}=e,r=this.currentDisplayName;if(this.currentDisplayName=t,r===t||this.innerHeaderComponent||this.isLoadingInnerComponent)return;const n=cr(t,!0);this.eText.textContent=n}addInIcon(e,t,r){if(null==t)return;const n=vo(e,this.beans,r);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return ce(this.eMenu),void(this.eMenu=void 0);const{gos:e,eMenu:t,params:r}=this,n=zt(e);this.addInIcon(n?"menu":"menuAlt",t,r.column),t.classList.toggle("ag-header-menu-icon",!n);const i=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=i,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(i)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:r}=this;t||this.toggleMenuAlwaysShow(!0),r.showColumnMenu(e,(()=>{t||this.toggleMenuAlwaysShow(!1)}))}onMenuKeyboardShortcut(e){const{params:t,gos:r,beans:n,eMenu:i,eFilterButton:s}=this,o=t.column,a=zt(r);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(o))return t.showFilter(s??i??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(i??s??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:r}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:t,eSortOrder:r,eSortAsc:n,eSortDesc:i,eSortMixed:s,eSortNone:o}=this;t.attachCustomElements(r,n,i,s,o)}this.eSortIndicator.setupSort(r),this.currentSort&&e.setupHeader(this,r,this.eLabel)}setupFilterIcon(){const{eFilter:e,params:t}=this;e&&this.configureFilter(t.enableFilterIcon,e,this.onFilterChangedIcon.bind(this),"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,r,n){if(!e)return ce(t),!1;const i=this.params.column;return this.addInIcon(n,t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();X(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:r}=this;return e?t??r??this.getGui():r??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}}},icons:{menu:"menu",menuAlt:"menu-alt"}},cc={moduleName:"ColumnGroupHeaderComp",version:We,userComponents:{agColumnGroupHeader:class extends un{constructor(){super(ac),this.agOpened=cn,this.agClosed=cn,this.agLabel=cn,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons()}checkWarnings(){this.params.template&&et(89)}workOutInnerHeaderGroupComponent(e,t){const r=function(e,t,r){return e.getCompDetails(t,mn,void 0,r)}(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then((e=>{this.isLoadingInnerComponent=!1,e&&(this.isAlive()?(this.innerHeaderGroupComponent=e,this.agLabel.appendChild(e.getGui())):this.destroyBean(e))})))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:r},beans:n}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const i=e=>{if(Jt(e))return;const t=!r.isExpanded();n.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(n,t,i),this.addTouchAndClickListeners(n,e,i);const s=e=>{Xt(e)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:i}),this.updateIconVisibility();const o=r.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t,r){e.touchSvc?.setupForHeaderGroup(this,t,r),this.addManagedElementListeners(t,{click:r})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:r}}=this;if(r.isExpandable()){const n=r.isExpanded();X(e,n),X(t,!n)}else X(e,!1),X(t,!1)}addInIcon(e,t){const r=vo(e,this.beans,null);r&&t.appendChild(r)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:e,agClosed:t}=this;return X(e,!1),void X(t,!1)}}setupLabel(e){const{displayName:t,columnGroup:r}=e,n=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;if(xe(t)&&!n){const e=cr(t,!0);this.agLabel.textContent=e}this.addOrRemoveCssClass("ag-sticky-label",!r.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}}},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},uc={moduleName:"AnimationFrame",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,0===e&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){!1===this.active&&et(92)}createTask(e,t,r,n){this.verify();let i=r;n&&this.batchFrameworkComps&&(i="f1");const s={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[i],s),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort(((e,r)=>e.index!==r.index?t*(r.index-e.index):r.createOrder-e.createOrder)),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:r,f1:n,destroyTasks:i,beans:s}=this,{ctrlsSvc:o,frameworkOverrides:a}=s,l=t.list,c=r.list,u=n.list,d=Date.now();let h=0;const p=e<=0,g=o.getScrollFeature();for(;p||h<e;){if(!g.scrollGridIfNeeded()){let s;if(l.length)this.sortTaskList(t),s=l.pop().task;else if(c.length)this.sortTaskList(r),s=c.pop().task;else if(u.length)a.wrapOutgoing((()=>{for(;p||h<e;){if(g.scrollGridIfNeeded())break;if(!u.length)break;this.sortTaskList(n),s=u.pop().task,s(),h=Date.now()-d}})),s=()=>{};else{if(!i.length)break;s=i.pop()}s()}h=Date.now()-d}l.length||c.length||u.length||i.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);be(this.beans,e)}isQueueEmpty(){return!this.ticking}}]},dc={moduleName:"Touch",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!W())return;this.mockContextMenu(e,e.element,((t,r,n)=>{const{rowCtrl:i,cellCtrl:s}=e.getControlsForEventTarget(n?.target??null);s?.column&&s.dispatchCellContextMenuEvent(n??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,n,i,s)}))}handleCellDoubleClick(e,t){return!!(()=>{if(!W()||Qt("dblclick"))return!1;const t=Date.now(),r=t-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=t,r})()&&(e.onCellDoubleClicked(t),t.preventDefault(),!0)}setupForHeader(e){const{gos:t,sortSvc:r}=this.beans;if(t.get("suppressTouch"))return;const{params:n,eMenu:i,eFilterButton:s}=e,o=new $o(e.getGui(),!0),a=e.shouldSuppressMenuHide(),l=a&&xe(i),c=l?new $o(i,!0):o;if(n.enableMenu){const t=l?"tap":"longTap",r=e=>n.showColumnMenuAfterMouseClick(e.touchStart);e.addManagedListeners(c,{[t]:r})}if(n.enableSorting){const t=e=>{const t=e.touchStart.target;a&&(i?.contains(t)||s?.contains(t))||r?.progressSort(n.column,!1,"uiColumnSorted")};e.addManagedListeners(o,{tap:t})}if(n.enableFilterButton&&s){const t=new $o(s,!0);e.addManagedListeners(t,{tap:()=>n.showFilter(s)}),e.addDestroyFunc((()=>t.destroy()))}e.addDestroyFunc((()=>o.destroy())),l&&e.addDestroyFunc((()=>c.destroy()))}setupForHeaderGroup(e,t,r){const n=new $o(t,!0);e.addManagedListeners(n,{tap:r}),e.addDestroyFunc((()=>n.destroy()))}mockContextMenu(e,t,r){if(!W())return;const n=new $o(t);e.addManagedListeners(n,{longTap:e=>{Si(this.gos,e.touchEvent)&&r(void 0,e.touchStart,e.touchEvent)}}),e.addDestroyFunc((()=>n.destroy()))}}]};function hc(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var pc={moduleName:"KeyboardNavigation",version:We,beans:[class extends rr{constructor(){super(),this.beanName="navigation",this.onPageDown=ze(this.onPageDown,100),this.onPageUp=ze(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}handlePageScrollingKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.key,n=e.altKey,i=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,o=Ri(this.gos,e);let a=!1;switch(r){case Qn.PAGE_HOME:case Qn.PAGE_END:i||n||(this.onHomeOrEndKey(r),a=!0);break;case Qn.LEFT:case Qn.RIGHT:case Qn.UP:case Qn.DOWN:if(!o)return!1;!i||n||s||(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case Qn.PAGE_DOWN:case Qn.PAGE_UP:i||n||(a=this.handlePageUpDown(r,o,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.beans.focusSvc.getFocusedCell()),!!t&&(e===Qn.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:r,scrollColumn:n,focusIndex:i,focusColumn:s}=e,{scrollFeature:o}=this.gridBodyCon;xe(n)&&!n.isPinned()&&o.ensureColumnVisible(n),xe(t)&&o.ensureIndexVisible(t,r),e.isAsync||o.ensureIndexVisible(i);const{focusSvc:a,rangeSvc:l}=this.beans;a.setFocusedCell({rowIndex:i,column:s,rowPinned:null,forceBrowserFocus:!0}),l?.setRangeToCell({rowIndex:i,rowPinned:null,column:s})}onPageDown(e){const t=this.beans,r=hc(t),n=this.getViewportHeight(),{pageBounds:i,rowModel:s,rowAutoHeight:o}=t,a=i.getPixelOffset(),l=r.top+n,c=s.getRowIndexAtPixel(l+a);o?.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){const t=this.beans,r=hc(t),{pageBounds:n,rowModel:i,rowAutoHeight:s}=t,o=n.getPixelOffset(),a=r.top,l=i.getRowIndexAtPixel(a+o);s?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{pageBounds:n,rowModel:i}=this.beans,s=this.getViewportHeight(),o=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=i.getRow(e.rowIndex),u=r?c?.rowHeight-s-l:s-l,d=c?.rowTop+u;let h,p=i.getRowIndexAtPixel(d+l);if(p===e.rowIndex){const n=r?-1:1;t=p=e.rowIndex+n}r?(h="bottom",p<o&&(p=o),t<o&&(t=o)):(h="top",p>a&&(p=a),t>a&&(t=a)),this.isRowTallerThanView(i.getRow(p))&&(t=p,h="top"),this.navigateTo({scrollIndex:t,scrollType:h,scrollColumn:null,focusIndex:p,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout((()=>{const n=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})}),50)}getNextFocusIndexForAutoHeight(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?-1:1,r=this.getViewportHeight(),{pageBounds:n,rowModel:i}=this.beans,s=n.getLastRow();let o=0,a=e.rowIndex;for(;a>=0&&a<=s;){const e=i.getRow(a);if(e){const t=e.rowHeight??0;if(o+t>r)break;o+=t}a+=t}return Math.max(0,Math.min(a,s))}getViewportHeight(){const e=this.beans,t=hc(e),r=this.beans.scrollVisibleSvc.getScrollbarWidth();let n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=r),n}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return"number"===typeof t&&t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),{rowIndex:n}=r,i=r.column;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:i,focusIndex:n,focusColumn:i})}onHomeOrEndKey(e){const t=e===Qn.PAGE_HOME,{visibleCols:r,pageBounds:n,rowModel:i}=this.beans,s=r.allCols,o=t?n.getFirstRow():n.getLastRow(),a=i.getRow(o);if(!a)return;const l=(t?s:[...s].reverse()).find((e=>!e.isSuppressNavigable(a)));l&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const r=t.shiftKey,n=this.tabToNextCellCommon(e,r,t),i=this.beans,{ctrlsSvc:s,pageBounds:o,focusSvc:a,gos:l}=i;if(!1===n)if(r){const{rowIndex:r,rowPinned:n}=e.getRowPosition();(n?0===r:r===o.getFirstRow())&&(0===l.get("headerHeight")||ui(i)?hi(i,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof wi&&e.focusCell(!0),(!r&&a.focusOverlay(!1)||hi(i,r))&&t.preventDefault();else n?t.preventDefault():null===n&&s.get("gridCtrl").allowFocusForNextCoreContainer(r)}tabToNextCell(e,t){const r=this.beans,{focusSvc:n,rowRenderer:i}=r,s=n.getFocusedCell();if(!s)return!1;let o=Ai(r,s);return!!(o||(o=i.getRowByPosition(s),o&&o.isFullWidth()))&&!!this.tabToNextCellCommon(o,e,t)}tabToNextCellCommon(e,t,r){let n,i=e.editing;if(!i&&e instanceof wi){const t=e.rowCtrl;t&&(i=t.editing)}return n=i?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(e,t,r):this.moveToNextEditingCell(e,t,r):this.moveToNextCellNotEditing(e,t,r),null===n?n:n||!!this.beans.focusSvc.focusedHeader}moveToNextEditingCell(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=e.cellPosition;e.eGui.focus(),e.stopEditing();const i=this.findNextCellToFocusOn(n,t,!0);return!1===i?null:null!=i&&(this.beans.editSvc?.startEditing(i,null,!0,r),i.focusCell(!1),!0)}moveToNextEditingRow(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=e.cellPosition,i=this.findNextCellToFocusOn(n,t,!0);if(!1===i)return null;if(null==i)return!1;const s=i.cellPosition,o=this.isCellEditable(n),a=this.isCellEditable(s),l=s&&n.rowIndex===s.rowIndex&&n.rowPinned===s.rowPinned,{editSvc:c,rowEditSvc:u}=this.beans;if(o&&c?.setFocusOutOnEditor(e),!l){const t=e.rowCtrl;c?.stopRowEditing(t);const n=i.rowCtrl;u?.startEditing(n,void 0,void 0,r)}return a?(c?.setFocusInOnEditor(i),i.focusCell()):i.focusCell(!0),!0}moveToNextCellNotEditing(e,t,r){const n=this.beans.visibleCols.allCols;let i;if(e instanceof hs){if(i={...e.getRowPosition(),column:t?n[0]:br(n)},this.gos.get("embedFullWidthRows")&&r){const t=e.findFullWidthInfoForEvent(r);t&&(i.column=t.column)}}else i=e.getFocusedCellPosition();const s=this.findNextCellToFocusOn(i,t,!1);if(!1===s)return null;if(s instanceof wi)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return xe(s)}findNextCellToFocusOn(e,t,r){let n=e;const i=this.beans,{cellNavigation:s,gos:o,focusSvc:a,rowRenderer:l,rangeSvc:c}=i;for(;;){e!==n&&(e=n),t||(n=this.getLastCellOfColSpan(n)),n=s.getNextTabbedCell(n,t);const u=o.getCallback("tabToNextCell");if(xe(u)){const i=u({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:n||null});if(!0===i)n=e;else{if(!1===i)return!1;n={rowIndex:i.rowIndex,column:i.column,rowPinned:i.rowPinned}}}if(!n)return null;if(n.rowIndex<0){const e=Ys(i);return a.focusHeaderPosition({headerPosition:{headerRowIndex:e+n.rowIndex,column:n.column},fromCell:!0}),null}const d="fullRow"===o.get("editType");if(r&&!d){if(!this.isCellEditable(n))continue}this.ensureCellVisible(n);const h=Ai(i,n);if(!h){const e=l.getRowByPosition(n);if(!e||!e.isFullWidth()||r)continue;return{...e.getRowPosition(),column:n?.column}}if(!s.isSuppressNavigable(h.column,h.rowNode))return h.setFocusedCellPosition(n),c?.setRangeToCell(n),h}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}lookupRowNodeForCell(e){let{rowIndex:t,rowPinned:r}=e;const{pinnedRowModel:n,rowModel:i}=this.beans;return"top"===r?n?.getPinnedTopRow(t):"bottom"===r?n?.getPinnedBottomRow(t):i.getRow(t)}navigateToNextCell(e,t,r,n){let i=r,s=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=o;for(;i&&(i===r||!this.isValidNavigateCell(i));)c.get("enableRtl")?t===Qn.LEFT&&(i=this.getLastCellOfColSpan(i)):t===Qn.RIGHT&&(i=this.getLastCellOfColSpan(i)),i=a.getNextCellToFocus(t,i),s=ke(i);if(s&&e&&e.key===Qn.UP&&(i={rowIndex:-1,rowPinned:null,column:r.column}),n){const n=c.getCallback("navigateToNextCell");if(xe(n)){const s=n({key:t,previousCellPosition:r,nextCellPosition:i||null,event:e});i=xe(s)?{rowPinned:s.rowPinned,rowIndex:s.rowIndex,column:s.column}:null}}if(!i)return;if(i.rowIndex<0){const t=Ys(o);return void l.focusHeaderPosition({headerPosition:{headerRowIndex:t+i.rowIndex,column:r.column},event:e||void 0,fromCell:!0})}const u=this.getNormalisedPosition(i);u?this.focusPosition(u):this.tryToFocusFullWidthRow(i)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);const t=Ai(this.beans,e);return t?(e=t.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:r,rowRenderer:n,focusSvc:i,eventSvc:s}=this.beans,o=r.allCols,a=n.getRowByPosition(e);if(!a||!a.isFullWidth())return!1;const l=i.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?br(o):o[0])};this.focusPosition(c);const u=null==t?null!=l&&ki(c,l):t;return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:u}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:r}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),r?.setRangeToCell(e)}isValidNavigateCell(e){return!!Pi(this.beans,e)}getLastCellOfColSpan(e){const t=Ai(this.beans,e);if(!t)return e;const r=t.getColSpanningList();return 1===r.length?e:{rowIndex:e.rowIndex,column:br(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=Rt(this.gos),r=this.beans.rowModel.getRow(e.rowIndex),n=t&&r?.sticky,{scrollFeature:i}=this.gridBodyCon;!n&&ke(e.rowPinned)&&i.ensureIndexVisible(e.rowIndex),e.column.isPinned()||i.ensureColumnVisible(e.column)}},class extends rr{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===Qn.UP,n=e===Qn.DOWN,i=e===Qn.LEFT;let s,o;const{pageBounds:a,gos:l,visibleCols:c}=this.beans;if(r||n)o=r?a.getFirstRow():a.getLastRow(),s=t.column;else{const e=l.get("enableRtl");o=t.rowIndex;s=(i!==e?c.allCols:[...c.allCols].reverse()).find((e=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:e})))}return s?{rowIndex:o,rowPinned:null,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,n=!1;for(;!n;){switch(e){case Qn.UP:r=this.getCellAbove(r);break;case Qn.DOWN:r=this.getCellBelow(r);break;case Qn.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case Qn.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,et(8,{key:e})}n=!r||this.isCellGoodToFocusOn(r)}return r}isCellGoodToFocusOn(e){const t=e.column;let r;const{pinnedRowModel:n,rowModel:i}=this.beans;switch(e.rowPinned){case"top":r=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":r=n?.getPinnedBottomRow(e.rowIndex);break;default:r=i.getRow(e.rowIndex)}if(!r)return!1;return!this.isSuppressNavigable(t,r)}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;const t=this.rowSpanSvc?.getCellEnd(e)??e,r=Di(this.beans,t);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getCellAbove(e){if(!e)return null;const t=this.rowSpanSvc?.getCellStart(e)??e,r=Fi(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned});return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:r}=this.beans,n=t.allCols;let i=e.rowIndex,s=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=n[0];const t=Di(this.beans,e);if(ke(t))return null;if(!t.rowPinned&&!(r?.isRowInPage(t.rowIndex)??1))return null;i=t?t.rowIndex:null,s=t?t.rowPinned:null}return{rowIndex:i,column:o,rowPinned:s}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:r,pagination:n}=t,i=r.allCols;let s=e.rowIndex,o=e.rowPinned,a=r.getColBefore(e.column);if(!a){a=br(i);const r=Fi(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(ke(r))return null;if(!r.rowPinned&&!(n?.isRowInPage(r.rowIndex)??1))return null;s=r?r.rowIndex:null,o=r?r.rowPinned:null}return{rowIndex:s,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:r}=e.colDef;if("boolean"===typeof r)return r;if("function"===typeof r){return r(e.createColumnFunctionCallbackParams(t))}return!1}},class extends rr{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}));const t=mt(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let r;const{colModel:n,colGroupSvc:i,ctrlsSvc:s}=this.beans;if("string"===typeof e?(r=n.getCol(e),r||(r=i?.getColumnGroup(e)??null)):r=e,!r)return null;const o=s.getHeaderRowContainerCtrl(),a=o?.getAllCtrls(),l="filter"===br(a||[]).type,c=Ys(this.beans)-1;let u=-1,d=r;for(;d;)u++,d=d.getParent();let h=u;return t&&l&&h===c-1&&h++,-1===h?null:{headerRowIndex:h,column:r}}navigateVertically(e,t,r){const n=this.beans.focusSvc;if(t||(t=n.focusedHeader),!t)return!1;const{headerRowIndex:i}=t,s=t.column,o=Ys(this.beans),a="UP"===e,l=this.getHeaderRowType(i);let{headerRowIndex:c,column:u,headerRowIndexWithoutSpan:d}=a?function(e,t,r){const n="filter"===e,i="column"===e;let s=n?t:t.getParent(),o=r-1,a=o;if(i&&Ql(t.getParent())){for(;s&&s.isPadding();)s=s.getParent(),o--;a=o,o<0&&(s=t,o=r,a=void 0)}return{column:s,headerRowIndex:o,headerRowIndexWithoutSpan:a}}(l,s,i):function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"After",i=t,s=r+1;const o=s;if("group"===e){const e=t.getDisplayedLeafColumns(),r="After"===n?e[0]:br(e),o=[];let a=r;for(;a.getParent()!==t;)a=a.getParent(),o.push(a);if(i=r,r.isSpanHeaderHeight())for(let t=o.length-1;t>=0;t--){const e=o[t];if(!e.isPadding()){i=e;break}s++}else i=br(o),i||(i=r)}return{column:i,headerRowIndex:s,headerRowIndexWithoutSpan:o}}(l,s,i),h=!1;return c<0&&(c=0,u=s,h=!0),c>=o?(c=-1,this.currentHeaderRowWithoutSpan=-1):void 0!==d&&(this.currentHeaderRowWithoutSpan=d),!(!h&&!u)&&n.focusHeaderPosition({headerPosition:{headerRowIndex:c,column:u},allowUserOverride:!0,event:r})}navigateHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;const{focusSvc:n,gos:i}=this.beans,s=n.focusedHeader;let o,a;-1!==this.currentHeaderRowWithoutSpan?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,"LEFT"===e!==i.get("enableRtl")?(a="Before",o=this.findHeader(s,a)):(a="After",o=this.findHeader(s,a));const l=i.getCallback("tabToNextHeader");if(t&&l){const e=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(e){const{headerRowIndex:e}=n.focusedHeader||{};null!=e&&e!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=e)}return e}return o||!t?n.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r}):this.focusNextHeaderRow(s,a,r)}focusNextHeaderRow(e,t,r){const n=e.headerRowIndex;let i,s=null;const o=this.beans;if("Before"===t?n>0&&(i=n-1,this.currentHeaderRowWithoutSpan-=1,s=this.findColAtEdgeForHeaderRow(i,"end")):(i=n+1,this.currentHeaderRowWithoutSpan<Ys(o)?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1,s=this.findColAtEdgeForHeaderRow(i,"start")),!s)return!1;const{column:a,headerRowIndex:l}=Zl(s.column,s?.headerRowIndex);return o.focusSvc.focusHeaderPosition({headerPosition:{column:a,headerRowIndex:l},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"After";if(!e.getPinned()){if(Li(e)){const n=e.getDisplayedLeafColumns();t="Before"===r?br(n):n[0]}else t=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(t)}}findHeader(e,t){let r,n;const{colGroupSvc:i,visibleCols:s}=this.beans;if(Li(e.column)?r=i?.getGroupAtDirection(e.column,t)??void 0:(n=`getCol${t}`,r=s[n](e.column)),!r)return;const{headerRowIndex:o}=e;if("filter"!==this.getHeaderRowType(o)){const e=[r];for(;r.getParent();)r=r.getParent(),e.push(r);r=e[Math.max(0,e.length-1-o)]}const{column:a,headerRowIndex:l}=Zl(r,o);return{column:a,headerRowIndex:l}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const{visibleCols:r,ctrlsSvc:n,colGroupSvc:i}=this.beans,s=r.allCols,o=s["start"===t?0:s.length-1];if(!o)return;const a=n.getHeaderRowContainerCtrl(o.getPinned()),l=a?.getRowType(e);if("group"==l){const t=i?.getColGroupAtLevel(o,e);return{headerRowIndex:e,column:t}}return{headerRowIndex:null==l?-1:e,column:o}}}],apiFunctions:{getFocusedCell:function(e){return e.focusSvc.getFocusedCell()},clearFocusedCell:function(e){return e.focusSvc.clearFocusedCell()},setFocusedCell:function(e,t,r,n){e.focusSvc.setFocusedCell({rowIndex:t,column:r,rowPinned:n,forceBrowserFocus:!0})},setFocusedHeader:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.headerNavigation?.getHeaderPositionForColumn(t,r);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})},tabToNextCell:function(e,t){return e.navigation?.tabToNextCell(!1,t)??!1},tabToPreviousCell:function(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}}},gc=class extends rr{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[(this.isLeft?"left":"right")+"PinnedWidthChanged"]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const r of this.elements)r&&(X(r,t),ge(r,e))}},fc={moduleName:"PinnedColumn",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl}));const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:r}=this.beans,n=lt(e,"print"),i=n?0:t.getColsLeftWidth(),s=n?0:t.getDisplayedColumnsRightWidth();i!=this.leftWidth&&(this.leftWidth=i,r.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,r.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=re(this.gridBodyCtrl.eBodyViewport);if(e<=50)return;const t=this.getPinnedColumnsOverflowingViewport(e-50),r=this.gos.getCallback("processUnpinnedColumns"),{columns:n,hasLockedPinned:i}=t;let s=n;if(s.length||i){if(r){s=r({columns:s,viewportWidth:e})}s&&s.length&&(s=s.filter((e=>!Mr(e))),this.setColsPinned(s,null,"viewportSizeFeature"))}}createPinnedWidthFeature(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new gc(e,r)}setColsPinned(e,t,r){const{colModel:n,colAnimation:i,visibleCols:s,gos:o}=this.beans;if(!n.cols)return;if(!e?.length)return;if(lt(o,"print"))return void et(37);let a;i?.start(),a=!0===t||"left"===t?"left":"right"===t?"right":null;const l=[];e.forEach((e=>{if(!e)return;const t=n.getCol(e);t&&t.getPinned()!==a&&(this.setColPinned(t,a),l.push(t))})),l.length&&(s.refresh(r),Yr(this.eventSvc,l,r)),i?.finish()}initCol(e){const{pinned:t,initialPinned:r}=e.colDef;void 0!==t?this.setColPinned(e,t):this.setColPinned(e,r)}setColPinned(e,t){e.pinned=!0===t||"left"===t?"left":"right"===t?"right":null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(null==e.pinned)return;const r="left"===e.pinned,n="right"===e.pinned;e.hidden=!0;const i=()=>{const i=r?this.leftWidth:this.rightWidth;if(null==i)return;const s=0==i,o=e.hidden!==s,a=this.gos.get("enableRtl"),l=t.getScrollbarWidth(),c=t.verticalScrollShowing&&(a&&r||!a&&n)?i+l:i;e.comp.setPinnedContainerWidth(`${c}px`),e.comp.setDisplayed(!s),o&&(e.hidden=s,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:i,rightPinnedWidthChanged:i,scrollVisibilityChanged:i,scrollbarWidthChanged:i})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:t,rightWidth:r}=this,n=re(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(t+r+e>n){if(!(n>t+r))return 0;e=n-t-r}}return e}getPinnedColumnsOverflowingViewport(e){const t=(this.rightWidth??0)+(this.leftWidth??0);let r=!1;if(t<e)return{columns:[],hasLockedPinned:r};const{visibleCols:n}=this.beans,i=[...n.leftCols],s=[...n.rightCols];let o=0,a=0;const l=[];let c=t-0-e;for(;(a<i.length||o<s.length)&&c>0;){if(o<s.length){const e=s[o++];if(e.colDef.lockPinned){r=!0;continue}c-=e.getActualWidth(),l.push(e)}if(a<i.length&&c>0){const e=i[a++];if(e.colDef.lockPinned){r=!0;continue}c-=e.getActualWidth(),l.push(e)}}return{columns:l,hasLockedPinned:r}}}],css:[".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}"]},mc={moduleName:"Aria",version:We,beans:[class extends rr{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=He(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=mt(e),r=this.descriptionContainer=t.createElement("div");r.classList.add("ag-aria-description-container"),E(r,"polite"),m(r,"relevant","additions text"),function(e,t){m(e,"atomic",t)}(r,!0),e.eGridDiv.appendChild(r)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout((()=>{if(this.isAlive()&&this.descriptionContainer){let t=e;this.lastAnnouncement===t&&(t=`${t}.`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}}),50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(le(e),e.parentElement?.removeChild(e)),this.descriptionContainer=null,this.pendingAnnouncements.clear()}}]};var vc={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},Cc=class extends un{constructor(){super(vc),this.eOverlayWrapper=cn,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}")}handleKeyDown(e){if(e.key!==Qn.TAB||e.defaultPrevented||Jt(e))return;const t=this.beans;if(ai(t,this.eOverlayWrapper,!1,e.shiftKey))return;let r=!1;r=e.shiftKey?t.focusSvc.focusGridView({column:br(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):hi(t,!1),r&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper.classList,{AUTO_HEIGHT:n,NORMAL:i,PRINT:s}=es;r.toggle(n,t.autoHeight),r.toggle(i,t.normal),r.toggle(s,t.print)}postConstruct(){this.createManagedBean(new ts(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r,n){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),r&&this.isGridFocused()){const e=wt(this.beans);e&&!St(this.beans)&&(this.elToFocusAfter=e)}e.then((t=>{if(this.activePromise===e){if(this.activePromise=null,t){if(this.activeOverlay!==t&&(this.eOverlayWrapper.appendChild(t.getGui()),this.activeOverlay=t,n)){const e=t;this.updateListenerDestroyFunc=this.addManagedPropertyListener(n,(t=>{let{currentValue:r}=t;e.refresh?.(Ut(this.gos,{...r??{}}))}))}r&&this.isGridFocused()&&oi(this.eOverlayWrapper)}}else this.activeOverlay!==t&&(this.destroyBean(t),t=null)}))}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);const r=this.updateListenerDestroyFunc;r&&(r(),this.updateListenerDestroyFunc=null),this.destroyBean(e),le(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=wt(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},wc={selector:"AG-OVERLAY-WRAPPER",component:Cc},bc={moduleName:"Overlay",version:We,userComponents:{agLoadingOverlay:class extends po{init(){const e=Te(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??go),!e){const e=this.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("loadingOoo","Loading...")}))}}},agNoRowsOverlay:class extends po{init(){const e=Te(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??fo),!e){const e=this.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("noRowsToShow","No Rows To Show")}))}}}},apiFunctions:{showLoadingOverlay:function(e){e.overlays?.showLoadingOverlay()},showNoRowsOverlay:function(e){e.overlays?.showNoRowsOverlay()},hideOverlay:function(e){e.overlays?.hideOverlay()}},beans:[class extends rr{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=ot(this.gos),this.isServerSide=!this.isClientSide&&at(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return 0!==this.state&&!!this.eWrapper}isExclusive(){return 1===this.state&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos,t=e.get("loading");(t||void 0===t&&!e.get("suppressLoadingOverlay"))&&this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")?et(99):this.doHideOverlay()}getOverlayWrapperSelector(){return wc}getOverlayWrapperCompClass(){return Cc}updateOverlayVisibility(){if(!this.eWrapper)return void(this.state=0);const{state:e,isClientSide:t,isServerSide:r,beans:{gos:n,colModel:i,rowModel:s}}=this;let o=this.gos.get("loading");void 0!==o&&(this.showInitialOverlay=!1),this.showInitialOverlay&&void 0===o&&!n.get("suppressLoadingOverlay")&&(o=!n.get("columnDefs")||!i.ready||!n.get("rowData")&&t),o?1!==e&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&s.isEmpty()&&!n.get("suppressNoRowsOverlay")?2!==e&&this.doShowNoRowsOverlay():(1===e||!r&&0!==e)&&this.doHideOverlay())}doShowLoadingOverlay(){var e,t;this.eWrapper&&(this.state=1,this.showOverlay((e=this.beans.userCompFactory,t=Ut(this.gos,{}),e.getCompDetailsFromGridOptions(Sn,"agLoadingOverlay",t,!0)),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){var e,t;this.eWrapper&&(this.state=2,this.showOverlay((e=this.beans.userCompFactory,t=Ut(this.gos,{}),e.getCompDetailsFromGridOptions(En,"agNoRowsOverlay",t,!0)),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,r){const n=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(n,t,this.isExclusive(),r),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){const e=this.eWrapper;if(!e)return;let t=0;if(2===this.state){const e=this.beans.ctrlsSvc.get("gridHeaderCtrl");t=e?.headerHeight||0}else 0!==this.wrapperPadding&&(t=0);this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}}]},yc=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.rowNode!=e?null:t}has(e){return null!=this.entriesMap[e.id]}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],Er(this.entriesList,r)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Er(this.entriesList,e)}getEntries(){return this.entriesList}};function Sc(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach((e=>{const r=e.id;switch(e.rowPinned){case"top":t.top[r]=e;break;case"bottom":t.bottom[r]=e;break;default:t.normal[r]=e}})),t}function Ec(e,t){const r=e.id;switch(e.rowPinned){case"top":return null!=t.top[r];case"bottom":return null!=t.bottom[r];default:return null!=t.normal[r]}}var Rc=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),Tc={tag:"span",cls:"ag-sort-indicator-container",children:[Rc("Order","order"),Rc("Asc","ascending-icon"),Rc("Desc","descending-icon"),Rc("Mixed","mixed-icon"),Rc("None","none-icon")]},xc=class extends un{constructor(e){super(),this.eSortOrder=cn,this.eSortAsc=cn,this.eSortDesc=cn,this.eSortMixed=cn,this.eSortNone=cn,e||this.setTemplate(Tc)}attachCustomElements(e,t,r,n,i){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=n,this.eSortNone=i}setupSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const r=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,r){if(null==t)return;const n=vo(e,this.beans,r);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortNone:r,column:n,gos:i,beans:s}=this,o=s.sortSvc.getDisplaySortForColumn(n);if(e){X(e,"asc"===o,{skipAriaHidden:!0})}if(t){X(t,"desc"===o,{skipAriaHidden:!0})}if(r){X(r,!(!n.getColDef().unSortIcon&&!i.get("unSortIcon"))&&(null===o||void 0===o),{skipAriaHidden:!0})}}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:r}=this;this.addInIcon("sortUnSort",e,t);const n=t.getColDef().showRowGroup;Tt(r)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:r}=this;if(e){X(e,"mixed"===t.sortSvc.getDisplaySortForColumn(r),{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:r}}=this;if(!e)return;const n=r.getColumnsWithSortingOrdered(),i=r.getDisplaySortIndexForColumn(t)??-1,s=n.some((e=>r.getDisplaySortIndexForColumn(e)??!1));X(e,i>=0&&s,{skipAriaHidden:!0}),i>=0?e.textContent=(i+1).toString():le(e)}},kc={selector:"AG-SORT-INDICATOR",component:xc},Pc=["asc","desc",null],Ac={moduleName:"Sort",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,r){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,r)}progressSortFromEvent(e,t){const r="ctrl"===this.gos.get("multiSortKey")?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,r,"uiColumnSorted")}setSortForColumn(e,t,r,n){"asc"!==t&&"desc"!==t&&(t=null);const{gos:i,showRowGroupCols:s}=this.beans;let o=[e];if(Tt(i)&&e.getColDef().showRowGroup){const t=s?.getSourceColumnsForGroupColumn?.(e),r=t?.filter((e=>e.isSortable()));r&&(o=[e,...r])}o.forEach((e=>this.setColSort(e,t,n)));const a=[];if(!((r||i.get("alwaysMultiSort"))&&!i.get("suppressMultiSort"))){const e=this.clearSortBarTheseColumns(o,n);a.push(...e)}this.updateSortIndex(e),a.push(...o),this.dispatchSortChangedEvents(n,a)}updateSortIndex(e){const{gos:t,colModel:r,showRowGroupCols:n}=this.beans,i=Tt(t),s=n?.getShowRowGroupCol(e.getId()),o=i&&s||e,a=this.getColumnsWithSortingOrdered();r.forAllCols((e=>this.setColSortIndex(e,null)));const l=a.filter((e=>(!i||!e.getColDef().showRowGroup)&&e!==o));(o.getSort()?[...l,o]:l).forEach(((e,t)=>this.setColSortIndex(e,t)))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols((t=>{t.getSort()&&(e=!0)})),e}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventSvc.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.beans.colModel.forAllCols((n=>{e.includes(n)||(n.getSort()&&r.push(n),this.setColSort(n,void 0,t))})),r}getNextSortDirection(e){const t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??Pc,r=t.indexOf(e.getSort()),n=r<0,i=r==t.length-1;return n||i?t[0]:t[r+1]}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:r,rowGroupColsSvc:n}=this.beans;let i=[];if(t.forAllCols((e=>{e.getSort()&&i.push(e)})),t.isPivotMode()){const t=Tt(e);i=i.filter((e=>{const n=!!e.getAggFunc(),i=!e.isPrimary(),s=t?r?.getShowRowGroupCol(e.getId()):e.getColDef().showRowGroup;return n||i||s}))}const s=n?.columns.filter((e=>!!e.getSort()))??[],o={};i.forEach(((e,t)=>o[e.getId()]=t)),i.sort(((e,t)=>{const r=e.getSortIndex(),n=t.getSortIndex();if(null!=r&&null!=n)return r-n;if(null==r&&null==n){return o[e.getId()]>o[t.getId()]?1:-1}return null==n?-1:1}));const a=Tt(e)&&!!s.length;a&&(i=[...new Set(i.map((e=>r?.getShowRowGroupCol(e.getId())??e)))]);const l=new Map;return i.forEach(((e,t)=>l.set(e,t))),a&&s.forEach((e=>{const t=r.getShowRowGroupCol(e.getId());l.set(e,l.get(t))})),l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(((e,t)=>{let[,r]=e,[,n]=t;return r-n})).map((e=>{let[t]=e;return t}))}getSortModel(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),colId:e.getId()})))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),column:e})))}canColumnDisplayMixedSort(e){const t=Tt(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){const t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const r=null!=e.getColDef().field||!!e.getColDef().valueGetter?[e,...t]:t,n=r[0].getSort();return r.every((e=>e.getSort()==n))?n:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,r){let n=0;e.addManagedListeners(t,{movingChanged:()=>{n=Date.now()}}),r&&e.addManagedElementListeners(r,{click:e=>{const r=t.isMoving(),i=Date.now();r||i-n<50||this.progressSortFromEvent(t,e)}});const i=()=>{const r=t.getSort();if(e.addOrRemoveCssClass("ag-header-cell-sorted-asc","asc"===r),e.addOrRemoveCssClass("ag-header-cell-sorted-desc","desc"===r),e.addOrRemoveCssClass("ag-header-cell-sorted-none",!r),t.getColDef().showRowGroup){const r=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t),n=r?.every((e=>t.getSort()==e.getSort())),i=!n;e.addOrRemoveCssClass("ag-header-cell-sorted-mixed",i)}};e.addManagedEventListeners({sortChanged:i,columnRowGroupChanged:i})}initCol(e){const{sort:t,initialSort:r,sortIndex:n,initialSortIndex:i}=e.colDef;void 0!==t?"asc"!==t&&"desc"!==t||(e.sort=t):"asc"!==r&&"desc"!==r||(e.sort=r),void 0!==n?null!==n&&(e.sortIndex=n):null!==i&&(e.sortIndex=i)}updateColSort(e,t,r){void 0!==t&&("desc"===t||"asc"===t?this.setColSort(e,t,r):this.setColSort(e,void 0,r))}setColSort(e,t,r){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",r)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new xc(e)}getSortIndicatorSelector(){return kc}},class extends rr{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){const{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=Tt(e),this.addManagedPropertyListener("accentedSort",(e=>this.isAccentedSort=e.currentValue)),this.addManagedPropertyListener("autoGroupColumnDef",(()=>this.primaryColumnsSortGroups=Tt(e)))}doFullSort(e,t){const r=e.map(((e,t)=>({currentPos:t,rowNode:e})));return r.sort(this.compareRowNodes.bind(this,t)),r.map((e=>e.rowNode))}compareRowNodes(e,t,r){const n=t.rowNode,i=r.rowNode;for(let s=0,o=e.length;s<o;s++){const t=e[s],r="desc"===t.sort,o=this.getValue(n,t.column),a=this.getValue(i,t.column);let l;const c=this.getComparator(t,n);l=c?c(o,a,n,i,r):Fe(o,a,this.isAccentedSort);if(!isNaN(l)&&0!==l)return"asc"===t.sort?l:-1*l}return t.currentPos-r.currentPos}getComparator(e,t){const r=e.column,n=r.getColDef().comparator;if(null!=n)return n;if(!r.getColDef().showRowGroup)return;const i=!t.group&&r.getColDef().field;if(!i)return;const s=this.beans.colModel.getColDefCol(i);return s?s.getColDef().comparator:void 0}getValue(e,t){const{valueSvc:r,colModel:n,showRowGroupCols:i,gos:s}=this.beans;if(!this.primaryColumnsSortGroups)return r.getValue(t,e,!1);if(e.rowGroupColumn===t){if(Ft(s,n.isPivotActive())){const n=e.allLeafChildren?.[0];return n?r.getValue(t,n,!1):void 0}const o=i?.getShowRowGroupCol(t.getId());if(!o)return;return e.groupData?.[o.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:r.getValue(t,e,!1)}}],apiFunctions:{onSortChanged:function(e){e.sortSvc?.onSortChanged("api")}},userComponents:{agSortIndicator:xc},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}};var Fc=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:r,children:n}=e;if(n)for(let i=0;i<n.length;++i)this.depthFirstSearchChangedPath(n[i],t);t(r)}depthFirstSearchEverything(e,t,r){const n=e.childrenAfterGroup;if(n)for(let i=0,s=n.length;i<s;++i){const e=n[i];e.childrenAfterGroup?this.depthFirstSearchEverything(e,t,r):r&&t(e)}t(e)}forEachChangedNodeDepthFirst(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;)this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={}),t.forEach((e=>this.nodeIdsToColumns[r.id][e.getId()]=!0)),r=r.parent}linkPathItems(e,t){let r=e;for(let n=0;n<t;n++){const e=this.mapToItems[r.id],t=this.mapToItems[r.parent.id];t.children||(t.children=[]),t.children.push(e),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter((e=>r[e.getId()]))}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter((e=>!r[e.getId()]))}},Dc={moduleName:"Expression",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);tt(15,{expression:e})}evaluateExpression(e,t){try{const r=this.createExpressionFunction(e);return r(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return tt(16,{expression:e,params:t,e:r}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const r=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",r);return t[e]=n,n}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}}]},Ic={moduleName:"ChangeDetection",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;ot(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:r}=this.beans;if("paste"===e.source||t.get("suppressChangeDetection"))return;const n=e.node,i=[n],s=this.clientSideRowModel,o=s?.rootNode;if(o&&!n.isRowPinned()){const r=t.get("aggregateOnlyChangedColumns"),a=new Fc(r,o);a.addParentNode(n.parent,[e.column]),s.doAggregate(a),a.forEachChangedNodeDepthFirst((e=>{i.push(e),e.sibling&&i.push(e.sibling)}))}r.refreshCells({rowNodes:i})}}]},Mc={moduleName:"CommunityCore",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:r}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),r.destroy(),super.destroy()}},class extends rr{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new na,this.fns={...ta,dispatchEvent:ra},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(ea))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:r,beans:n}=this;r!==ta&&(r[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){var t=this;return{[e]:function(){const{beans:r,fns:{[e]:n}}=t;for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n?n(r,...s):t.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:n}=this;if(t){const t=ea[e];r.assertModuleRegistered(t,`api.${e}`)&&et(27,{fnName:e,module:t})}else et(26,{fnName:e,preDestroyLink:n})}destroy(){super.destroy(),this.fns=ta,this.beans=null}},class extends rr{constructor(){super(...arguments),this.beanName="registry",this.agGridDefaults={},this.agGridDefaultParams={},this.jsComps={},this.dynamicBeans={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(null!=e)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:r,dynamicBeans:n,selectors:i}=e;if(r){const e=(e,t,r)=>{this.agGridDefaults[e]=t,r&&(this.agGridDefaultParams[e]=r)};for(const t of Object.keys(r)){const n=r[t];"object"===typeof n?e(t,n.classImp,n.params):e(t,n)}}if(n)for(const s of Object.keys(n))this.dynamicBeans[s]=n[s];if(i?.forEach((e=>{this.selectors[e.selector]=e})),t)for(const s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){const r=(e,t,r)=>({componentFromFramework:t,component:e,params:r}),{frameworkOverrides:n}=this.beans,i=n.frameworkComponent(t,this.gos.get("components"));if(null!=i)return r(i,!0);const s=this.jsComps[t];if(s){return r(s,n.isFrameworkComponent(s))}const o=this.agGridDefaults[t];return o?r(o,!1,this.agGridDefaultParams[t]):(this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null)}createDynamicBean(e,t){const r=this.dynamicBeans[e];if(null!=r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return new r(...i)}if(t)throw new Error(it(256))}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}},class extends rr{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.getCompDetails(this.gridOptions,e,t,r,n)}getCompDetails(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{name:s,cellRenderer:o}=t;let a,{compName:l,jsComp:c,fwComp:u,paramsFromSelector:d,popupFromSelector:h,popupPositionFromSelector:p}=hn(this.beans.frameworkOverrides,e,t,n);const g=e=>{const t=this.registry.getUserComponent(s,e);t&&(c=t.componentFromFramework?void 0:t.component,u=t.componentFromFramework?t.component:void 0,a=t.params)};var f;if(null!=l&&g(l),null==c&&null==u&&null!=r&&g(r),!c||!o||(f=c)&&f.prototype&&"getGui"in f.prototype||(c=this.agCompUtils?.adaptFunction(t,c)),!c&&!u){const{validation:e}=this.beans;return void(!i||l===r&&r?r&&!e&&tt(146,{comp:r}):l?e?.isProvidedUserComp(l)||tt(50,{compName:l}):r?e||tt(260,{...this.gos.getModuleErrorParams(),propName:s,compName:r}):tt(216,{name:s}))}const m=this.mergeParams(e,t,n,d,a),v=null==c,C=c??u;return{componentFromFramework:v,componentClass:C,params:m,type:t,popupFromSelector:h,popupPositionFromSelector:p,newAgStackInstance:()=>this.newAgStackInstance(C,v,m,t)}}newAgStackInstance(e,t,r,n){let i;i=!t?new e:this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(i);const s=i.init?.(r);return null==s?dn.resolve(i):s.then((()=>i))}mergeParams(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4?arguments[4]:void 0;const s={...r,...i},o=e&&e[t.name+"Params"];if("function"===typeof o){ir(s,o(r))}else"object"===typeof o&&ir(s,o);return ir(s,n),s}},class extends rr{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=function(){if(void 0!==c)return c;if(!document.body)return-1;let e=1e6;const t=z()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const n=2*e;if(r.style.height=n+"px",n>t||r.clientHeight!==n)break;e=n}return document.body.removeChild(r),c=e,e}(),Oe(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;Oe(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}},class extends rr{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{colModel:r,colGroupSvc:n,colViewport:i}=this.beans;t||this.buildTrees(r,n),n?.updateOpenClosedVisibility();const s=Ra(this.treeLeft);this.leftCols=s,this.centerCols=Ra(this.treeCenter);const o=Ra(this.treeRight);this.rightCols=o,this.joinColsAriaOrder(r),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter((e=>e.isAutoHeight())),this.beans.colFlex?.refreshFlexedColumns(),this.updateBodyWidths(),i.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(r,s,o,e),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}updateBodyWidths(){const e=Ar(this.centerCols),t=Ar(this.leftCols),r=Ar(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e;(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,r,n){let i,s;this.gos.get("enableRtl")?(i=t?t[0]:null,s=r?br(r):null):(i=t?br(t):null,s=r?r[0]:null),e.getCols().forEach((e=>{e.setLastLeftPinned(e===i,n),e.setFirstRightPinned(e===s,n)}))}buildTrees(e,t){const r=e.getColsToShow(),n=r.filter((e=>"left"==e.getPinned())),i=r.filter((e=>"right"==e.getPinned())),s=r.filter((e=>"left"!=e.getPinned()&&"right"!=e.getPinned())),o=new nn,a=e=>t?t.createColumnGroups(e):e.columns;this.treeLeft=a({columns:n,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:i,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),r=[],n=[],i=[];for(const s of t){const e=s.getPinned();e?!0===e||"left"===e?r.push(s):i.push(s):n.push(s)}this.ariaOrderColumns=r.concat(n).concat(i)}getAriaColIndex(e){let t;return t=Li(e)?e.getLeafColumns()[0]:e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach((e=>{e.forEach((e=>{if(Li(e)){e.checkLeft()}}))}))}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const r=t.getCols().slice(0),n=this.gos.get("enableRtl");[this.leftCols,this.rightCols,this.centerCols].forEach((t=>{if(n){let r=Ar(t);t.forEach((t=>{r-=t.getActualWidth(),t.setLeft(r,e)}))}else{let r=0;t.forEach((t=>{t.setLeft(r,e),r+=t.getActualWidth()}))}!function(e,t){for(let r=0;r<t.length;r++){const n=e.indexOf(t[r]);n>=0&&(e[n]=e[e.length-1],e.pop())}}(r,t)})),r.forEach((t=>{t.setLeft(null,e)}))}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,r,n){const i=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const e=c-1;for(let r=1;r<=e;r++)u.push(t[o+r]);o+=e}let d;if(r?(d=!1,u.forEach((e=>{r(e)&&(d=!0)}))):d=!0,d){if(0===i.length&&s){!!n&&n(a)&&i.push(s)}i.push(a)}s=a}return i}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,r=t.indexOf(e);return r>0?t[r-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=e=>{this.colsAndGroupsMap[e.getUniqueId()]=e};Ea(this.treeCenter,!1,e),Ea(this.treeLeft,!1,e),Ea(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const n=this[t[r]];if(n.length)return e?br(n):n[0]}return null}getColAfter(e){const t=this.allCols,r=t.indexOf(e);return r<t.length-1?t[r+1]:null}getColsLeftWidth(){return Ar(this.leftCols)}getDisplayedColumnsRightWidth(){return Ar(this.rightCols)}isColAtEdge(e,t){const r=this.allCols;if(!r.length)return!1;const n="first"===t;let i;if(Li(e)){const t=e.getDisplayedLeafColumns();if(!t.length)return!1;i=n?t[0]:br(t)}else i=e;return(n?r[0]:br(r))===i}},class extends rr{constructor(){super(...arguments),this.beanName="eventSvc",this.globalEventService=new p}postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}addEventListener(e,t,r){this.globalEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.globalEventService.removeEventListener(e,t,r)}addGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(Ut(this.gos,e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(Ut(this.gos,e))}},class extends rr{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.gridInstanceId=nc++,this.propEventSvc=new p,this.globalEventHandlerFactory=e=>(t,r)=>{if(!this.isAlive())return;const n=ec.has(t);if(n&&!e||!n&&e)return;const i=Wt(t),s=this.gridOptions[i];"function"===typeof s&&this.beans.frameworkOverrides.wrapOutgoing((()=>{s(r)}))}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:e=>{let{options:t}=e;this.updateGridOptions({options:t,force:!0,source:"gridOptionsUpdated"})}})}get(e){return this.gridOptions[e]??tc[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return xe(this.gridOptions[e])}mergeGridCommonParams(e){if(e){return t=>e(this.addGridCommonParams(t))}return e}updateGridOptions(e){let{options:t,force:r,source:n="api"}=e;const i={id:rc++,properties:[]},s=[],{gridOptions:o,validation:a}=this;for(const l of Object.keys(t)){const e=t[l];a?.warnOnInitialPropertyUpdate(n,l);const c=r||"object"===typeof e&&"api"===n,u=o[l];if(c||u!==e){o[l]=e;const t={type:l,currentValue:e,previousValue:u,changeSet:i,source:n};s.push(t)}}a?.processGridOptions(this.gridOptions),i.properties=s.map((e=>e.type)),s.forEach((e=>{Oe(this,`Updated property ${e.type} from`,e.previousValue," to ",e.currentValue),this.propEventSvc.dispatchEvent(e)}))}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addGridCommonParams(e){return e.api=this.api,e.context=this.gridOptionsContext,e}assertModuleRegistered(e,t){const r=Array.isArray(e)?e.some((e=>this.isModuleRegistered(e))):this.isModuleRegistered(e);return r||tt(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),r}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:jn(),rowModelType:this.get("rowModelType"),isUmd:zn}}isModuleRegistered(e){return Un(e,this.gridId,this.get("rowModelType"))}},class extends rr{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],(e=>this.refreshAll(_r(e.source)))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",(e=>this.setPivotMode(this.gos.get("pivotMode"),_r(e.source))))}createColsFromColDefs(e){const{beans:t}=this,{valueCache:r,colAutosize:n,rowGroupColsSvc:i,pivotColsSvc:s,valueColsSvc:o,visibleCols:a,colViewport:l,eventSvc:c}=t,u=this.colDefs?Qr(t,e):void 0;r?.expire();const d=this.colDefCols?.list,h=this.colDefCols?.tree,p=Br(t,this.colDefs,!0,h,e);Fr(t,this.colDefCols?.tree,p.columnTree);const g=p.columnTree,f=p.treeDept,m=Pr(g),v={};m.forEach((e=>v[e.getId()]=e)),this.colDefCols={tree:g,treeDepth:f,list:m,map:v},i?.extractCols(e,d),s?.extractCols(e,d),o?.extractCols(e,d),this.ready=!0,this.refreshCols(!0),a.refresh(e),l.checkViewportColumns(),c.dispatchEvent({type:"columnEverythingChanged",source:e}),u&&(this.changeEventsDispatching=!0,u(),this.changeEventsDispatching=!1),c.dispatchEvent({type:"newColumnsLoaded",source:e}),"gridInitializing"===e&&n?.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder();const{autoColSvc:r,selectionColSvc:n,rowNumbersSvc:i,quickFilter:s,pivotResultCols:o,showRowGroupCols:a,rowAutoHeight:l,visibleCols:c,colViewport:u,eventSvc:d}=this.beans,h=this.selectCols(o,this.colDefCols);this.createColumnsForService([r,n,i],h);const p=(g=this.gos,this.showingPivotResult?!g.get("enableStrictPivotColumnOrder"):g.get("maintainColumnOrder"));var g;e&&!p||this.restoreColOrder(h),this.positionLockedCols(h),a?.refresh(),s?.refreshCols(),this.setColSpanActive(),l?.setAutoHeightActive(h),c.clear(),u.clear();!yr(t,this.cols.tree)&&d.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t){for(const r of e)r&&(r.createColumns(t,(e=>{this.lastOrder=e(this.lastOrder),this.lastPivotOrder=e(this.lastPivotOrder)})),r.addColumns(t))}selectCols(e,t){const r=e?.getPivotResultCols()??null;this.showingPivotResult=null!=r;const{map:n,list:i,tree:s,treeDepth:o}=r??t;if(this.cols={list:i.slice(),map:{...n},tree:s.slice(),treeDepth:o},r){r.list.some((e=>void 0!==this.cols?.map[e.getColId()]))||(this.lastPivotOrder=null)}return this.cols}getColsToShow(){if(!this.cols)return[];const e=this.isPivotMode()&&!this.showingPivotResult,t=this.beans.valueColsSvc?.columns;return this.cols.list.filter((r=>{const n=Dr(r);if(e){const e=t?.includes(r);return n||e}return n||r.isVisible()}))}refreshAll(e){this.ready&&(this.refreshCols(!1),this.beans.visibleCols.refresh(e))}setColsVisible(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;Jr(this.beans,{state:e.map((e=>({colId:"string"===typeof e?e:e.getColId(),hide:!t})))},r)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const r=new Map(t.map(((e,t)=>[e,t])));if(!e.list.some((e=>r.has(e))))return;const n=new Map(e.list.map((e=>[e,!0]))),i=t.filter((e=>n.has(e))),s=new Map(i.map((e=>[e,!0]))),o=e.list.filter((e=>!s.has(e))),a=i.slice();o.forEach((e=>{let t=e.getOriginalParent();if(!t)return void a.push(e);const r=[];for(;!r.length&&t;){t.getLeafColumns().forEach((e=>{const t=a.indexOf(e)>=0,n=r.indexOf(e)<0;t&&n&&r.push(e)})),t=t.getOriginalParent()}if(!r.length)return void a.push(e);const n=r.map((e=>a.indexOf(e))),i=Math.max(...n);a.splice(i+1,0,e)})),e.list=a}positionLockedCols(e){e.list=jr(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(){return this.colDefCols?this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[]):void 0}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some((e=>null!=e.getColDef().colSpan))}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode)return;if(this.pivotMode=e,!this.ready)return;this.refreshCols(!1);const{visibleCols:r,eventSvc:n}=this.beans;r.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){const e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);const t=_r(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Fr(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){const{pivotResultCols:t,autoColSvc:r,selectionColSvc:n}=this.beans;Sr(this.colDefCols?.list,e),Sr(r?.columns?.list,e),Sr(n?.columns?.list,e),Sr(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map((e=>this.getCol(e))).filter((e=>null!=e)):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return null==e?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(null==t)return null;const{map:r,list:n}=t;if("string"==typeof e&&r[e])return r[e];for(let i=0;i<n.length;i++)if(Gr(n[i],e))return n[i];return this.beans.autoColSvc?.getColumn(e)??this.beans.selectionColSvc?.getColumn(e)??null}},class extends rr{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return e&&t?Math.max(t.rowTop+t.rowHeight-e.rowTop,0):0}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this;return{pageFirstPixel:e?.rowTop??0,pageLastPixel:t?t.rowTop+t.rowHeight:0}}calculateBounds(e,t){const{rowModel:r}=this.beans,n=r.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;const i=r.getRowBounds(t);i&&(i.rowIndex=t),this.bottomRowBounds=i,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},class extends rr{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:r}=this.beans;t?t.calculatePages():e.calculateBounds(0,r.getRowCount()-1)}},class extends rr{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach((e=>e.onCellSelectionChanged()))},t=()=>{this.getAllCellCtrls().forEach((e=>e.updateRangeBordersIfRangeCount()))},r=()=>{this.eventSvc.addEventListener("cellSelectionChanged",e),this.eventSvc.addEventListener("columnMoved",t),this.eventSvc.addEventListener("columnPinned",t),this.eventSvc.addEventListener("columnVisible",t)},n=()=>{this.eventSvc.removeEventListener("cellSelectionChanged",e),this.eventSvc.removeEventListener("columnMoved",t),this.eventSvc.removeEventListener("columnPinned",t),this.eventSvc.removeEventListener("columnVisible",t)};this.addDestroyFunc((()=>n())),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],(()=>{Lt(this.gos)?r():n()}));Lt(this.gos)&&r()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc}postConstruct(){this.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()}))}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],(()=>this.onDomLayoutChanged())),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],(()=>this.redraw())),this.addManagedPropertyListener("suppressCellFocus",(e=>this.onSuppressCellFocusChanged(e.currentValue))),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],(()=>this.redrawRows())),this.addManagedPropertyListener("cellSelection",(e=>{let{currentValue:t,previousValue:r}=e;(!r&&t||r&&!t)&&this.redrawRows()}));const{stickyRowSvc:e,gos:t,showRowGroupCols:r}=this.beans;if(r&&this.addManagedPropertyListener("showOpenedGroup",(()=>{const e=r.getShowRowGroupCols();e.length&&this.refreshCells({columns:e,force:!0})})),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const e=this.gridBodyCtrl;e.setStickyTopHeight(0),e.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=lt(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new yc(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),r=this.cachedRowCtrls?.getEntries()??[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}isCellBeingRendered(e,t){const r=this.rowCtrlsByRowIndex[e];if(!t||!r)return!!r;if(r.isFullWidth())return!0;const n=this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null});return!!n||!!r.getCellCtrl(t)||!r.isRowRendered()}updateCellFocus(e){this.getAllCellCtrls().forEach((t=>t.onCellFocused(e))),this.getFullWidthRowCtrls().forEach((t=>t.onFullWidthRowFocused(e)))}onCellFocusChanged(e){if(e&&null!=e.rowIndex&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach((t=>t.onSuppressCellFocusChanged(e))),this.getFullWidthRowCtrls().forEach((t=>t.onSuppressCellFocusChanged(e)))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;t&&this.getAllCellCtrls().forEach((r=>t.onFlashCells(r,e)))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onColumnHover()))},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onDisplayedColumnsChanged()))},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach((e=>e.onLeftChanged()))}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach((e=>e())),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();this.colModel.getCols().forEach((e=>{const t=t=>{this.getAllCellCtrls().forEach((r=>{r.column===e&&t(r)}))},r=()=>{t((e=>e.onLeftChanged()))},n=()=>{t((e=>e.onWidthChanged()))},i=()=>{t((e=>e.onFirstRightPinnedChanged()))},s=()=>{t((e=>e.onLastLeftPinnedChanged()))},o=()=>{t((e=>e.onColDefChanged()))};e.__addEventListener("leftChanged",r),e.__addEventListener("widthChanged",n),e.__addEventListener("firstRightPinnedChanged",i),e.__addEventListener("lastLeftPinnedChanged",s),e.__addEventListener("colDefChanged",o),this.destroyFuncsForColumnListeners.push((()=>{e.__removeEventListener("leftChanged",r),e.__removeEventListener("widthChanged",n),e.__removeEventListener("firstRightPinnedChanged",i),e.__removeEventListener("lastLeftPinnedChanged",s),e.__removeEventListener("colDefChanged",o)}))}))}onDomLayoutChanged(){const e=lt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){const t=[];return this.getAllRowCtrls().forEach((r=>{const n=r.getCellCtrl(e,!0)?.eGui;n&&t.push(n)})),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}refreshFloatingRows(e,t){const{pinnedRowModel:r,beans:n,printLayout:i}=this,s=Object.fromEntries(e.map((e=>[e.rowNode.id,e])));r?.forEachPinnedRow(t,((o,a)=>{const l=e[a];l&&void 0===r.getPinnedRowById(l.rowNode.id,t)&&(l.destroyFirstPass(),l.destroySecondPass()),o.id in s?(e[a]=s[o.id],delete s[o.id]):e[a]=new hs(o,n,!1,!1,i)}));const o=("top"===t?r?.getPinnedTopRowCount():r?.getPinnedBottomRowCount())??0;e.length=o}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else{if(this.cachedRowCtrls?.has(e))return void this.cachedRowCtrls.removeRow(e);{const t=t=>{const r=t[e.rowIndex];r&&r.rowNode===e&&(r.destroyFirstPass(),r.destroySecondPass(),t[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":t(this.topRowCtrls);break;case"bottom":t(this.bottomRowCtrls);break;default:t(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(null!=e)return e?.forEach((e=>this.redrawRow(e,!0))),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}redrawAfterModelUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getLockOnRefresh();const t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Et(this.gos),i=r?this.getRowsToRecycle():null;r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:s}=this;if(s){s.checkStickyRows();const e=s.extraTopHeight+s.extraBottomHeight;e&&this.updateContainerHeights(e)}this.recycleRows(i,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{rowContainerHeight:t}=this;if(this.printLayout)return void t.setModelHeight(null);let r=this.pageBounds.getCurrentPageHeight();0===r&&(r=1),t.setModelHeight(r+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(it(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,r=this.findPositionToFocus(e);r?e.rowIndex===r.rowIndex&&e.rowPinned==r.rowPinned?t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(Ut(this.gos,{...r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})):t.setFocusedCell({...r,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}):t.focusHeaderPosition({headerPosition:{headerRowIndex:Ys(this.beans)-1,column:e.column}})}findPositionToFocus(e){const{pagination:t,pageBounds:r}=this.beans;let n=e;for(null==n.rowPinned&&t&&r&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:r.getFirstRow()});n;){if(null==n.rowPinned&&r)if(n.rowIndex<r.getFirstRow()){if(n=Fi(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>r.getLastRow()&&(n={rowPinned:null,rowIndex:r.getLastRow()});const t=this.getRowByPosition(n);if(t?.isAlive())return{...t.getRowPosition(),column:e.column};n=Fi(this.beans,n)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let n=0;n<r;n++){const r=t[n].getAllCellCtrls(),i=r.length;for(let t=0;t<i;t++)e.push(r[t])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),r=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...r,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,r){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,r)}refreshCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const r of this.getCellCtrls(e.rowNodes,e.columns))r.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||(t=!0,this.redrawRow(r.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=Sc(e),r=this.getAllRowCtrls();return e&&t?r.filter((e=>Ec(e.rowNode,t))):r}getCellCtrls(e,t){let r;xe(t)&&(r={},t.forEach((e=>{const t=this.colModel.getCol(e);xe(t)&&(r[t.getId()]=!0)})));const n=[];return this.getRowCtrls(e).forEach((e=>{e.getAllCellCtrls().forEach((e=>{const t=e.column.getId();r&&!r[t]||n.push(e)}))})),n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const r of Object.keys(this.rowCtrlsByRowIndex)){null==this.rowCtrlsByRowIndex[r].rowNode.id&&e.push(r)}this.removeRowCtrls(e);const t={};for(const r of Object.values(this.rowCtrlsByRowIndex)){t[r.rowNode.id]=r}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((e=>{const r=this.rowCtrlsByRowIndex[e];r&&(r.destroyFirstPass(t),r.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]}))}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{focusSvc:t,animationFrameSvc:r}=this.beans,{afterScroll:n}=e;let i;const s=this.stickyRowFeature;s&&(i=t?.getFocusCellToUseAfterRefresh()||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(s){l=s.checkStickyRows();const e=s.extraTopHeight+s.extraBottomHeight;e&&this.updateContainerHeights(e)}const c=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if((!n||l||c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),null!=i)){const e=t?.getFocusCellToUseAfterRefresh();null!=i&&null==e&&(r?.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(e,t){const r={};e.forEach((e=>r[e]=!0));const n=Object.keys(this.rowCtrlsByRowIndex).filter((e=>!r[e]));this.removeRowCtrls(n,t)}calculateIndexesToDraw(e){const t=[];for(let o=this.firstRenderedRow;o<=this.lastRenderedRow;o++)t.push(o);const r=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;null==n||!(n<this.firstRenderedRow||n>this.lastRenderedRow)||r&&!r.isRowInPage(n)||t.push(n);const i=e=>{const r=e.rowNode.rowIndex;null!=r&&r!==n&&(r<this.firstRenderedRow||r>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(e)&&t.push(r)};for(const o of Object.values(this.rowCtrlsByRowIndex))i(o);if(e)for(const o of Object.values(e))i(o);t.sort(((e,t)=>e-t));const s=[];for(let o=0;o<t.length;o++){const e=t[o],r=this.rowModel.getRow(e);r&&!r.sticky&&s.push(e)}return s}recycleRows(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);const i=[];if(n.forEach((n=>{const s=this.createOrUpdateRowCtrl(n,e,t,r);xe(s)&&i.push(s)})),e){const{animationFrameSvc:n}=this.beans;n?.active&&r&&!this.printLayout?n.addDestroyTask((()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),r=e.isPinningRight();(this.pinningLeft!==t||r!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach((t=>{const r=t.rowNode.rowIndex;e.push(r.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=Sc(e);return this.getAllRowCtrls().filter((e=>{if(!e.isFullWidth())return!1;const r=e.rowNode;return!(null!=t&&!Ec(r,t))}))}createOrUpdateRowCtrl(e,t,r,n){let i,s=this.rowCtrlsByRowIndex[e];s||(i=this.rowModel.getRow(e),xe(i)&&xe(t)&&t[i.id]&&i.alreadyRendered&&(s=t[i.id],t[i.id]=null));if(!s){if(i||(i=this.rowModel.getRow(e)),!xe(i))return;s=this.createRowCon(i,r,n)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s,s}destroyRowCtrls(e,t){const r=[];if(e)for(const n of Object.values(e))if(n)if(this.cachedRowCtrls&&n.isCacheable())this.cachedRowCtrls.addRow(n);else if(n.destroyFirstPass(!t),t){const e=n.instanceId;this.zombieRowCtrls[e]=n,r.push((()=>{n.destroySecondPass(),delete this.zombieRowCtrls[e]}))}else n.destroySecondPass();t&&(r.push((()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})),window.setTimeout((()=>r.forEach((e=>e()))),400))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*ht(this.beans)}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:r}=this;let n,i;if(e.updateOffset(),r.isRowsToRender())if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),i=t.getLastRow();else{const s=this.getRowBufferInPixels(),o=this.ctrlsSvc.getScrollFeature(),a=this.gos.get("suppressRowVirtualisation");let l,c,u=!1;do{const r=t.getPixelOffset(),{pageFirstPixel:n,pageLastPixel:i}=t.getCurrentPagePixelRange(),d=e.divStretchOffset,h=o.getVScrollPosition(),p=h.top,g=h.bottom;a?(l=n+d,c=i+d):(l=Math.max(p+r-s,n)+d,c=Math.min(g+r+s,i)+d),this.firstVisibleVPixel=Math.max(p+r,n)+d,this.lastVisibleVPixel=Math.min(g+r,i)+d,u=this.ensureAllRowsInRangeHaveHeightsCalculated(l,c)}while(u);let d=r.getRowIndexAtPixel(l),h=r.getRowIndexAtPixel(c);const p=t.getFirstRow(),g=t.getLastRow();d<p&&(d=p),h>g&&(h=g),n=d,i=h}else n=0,i=-1;const s=lt(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!o&&i-n>a&&(i=n+a);const l=n!==this.firstRenderedRow,c=i!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=i,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:i}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,be(this.beans,(()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})})))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const r=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:i,rowModel:s}=this,o=s.ensureRowHeightsValid(e,t,i.getFirstRow(),i.getLastRow());return(o||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),!!(n||o||r)&&(this.updateContainerHeights(),!0)}doNotUnVirtualiseRow(e){const t=!1,r=e.rowNode,n=this.focusSvc.isRowFocused(r.rowIndex,r.rowPinned),i=e.editing,s=r.detail;if(!(n||i||s))return t;return!!this.isRowPresent(r)||t}isRowPresent(e){return!!this.rowModel.isRowPresent(e)&&(this.beans.pagination?.isRowInPage(e.rowIndex)??!0)}createRowCon(e,t,r){const n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;const i=r&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new hs(e,this.beans,t,i,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map((e=>e.rowNode));return[...this.getStickyTopRowCtrls().map((e=>e.rowNode)),...e,...this.getStickyBottomRowCtrls().map((e=>e.rowNode))]}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find((e=>e.rowNode.rowIndex===r))||null,t||(t=this.getStickyBottomRowCtrls().find((e=>e.rowNode.rowIndex===r))||null))}return t}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const r=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!r}},class extends rr{constructor(){super(...arguments),this.beanName="valueSvc",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=at(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=e=>this.callColumnCellValueChangedHandler(e);this.eventSvc.addEventListener("cellValueChanged",e,!0),this.addDestroyFunc((()=>this.eventSvc.removeEventListener("cellValueChanged",e,!0))),this.addManagedPropertyListener("treeData",(e=>this.isTreeData=e.currentValue))}getValueForDisplay(e,t){const r=e.getColDef().showRowGroup;if(null!=r){if("string"===typeof r){const r=this.getDisplayedNode(t,e,!0);if(r)return this.getValue(e,r)}const n=this.getValue(e,t);if(null==n){const r=this.getDisplayedNode(t,e);if(r)return this.getValue(e,r)}return n}const n=t.leafGroup&&this.colModel.isPivotMode(),i=t.group&&t.expanded&&!t.footer&&!n,s=this.gos.get("groupSuppressBlankHeader")||!t.sibling,o=i&&!s;return this.getValue(e,t,o)}getValue(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.initialised||this.init(),!t)return;const n=e.getColDef(),i=n.field,s=e.getColId(),o=t.data;let a;const l=n.showRowGroup;if("string"===typeof l){if((this.beans.rowGroupColsSvc?.getColumnIndex(l)??-1)>t.level)return null}const c=t.groupData&&void 0!==t.groupData[s],u=!r&&t.aggData&&void 0!==t.aggData[s],d=this.isSsrm&&r&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(this.isTreeData&&u?a=t.aggData[s]:this.isTreeData&&n.valueGetter?a=this.executeValueGetter(n.valueGetter,o,e,t):this.isTreeData&&i&&o?a=sr(o,i,e.isFieldContainsDots()):c?a=t.groupData[s]:u?a=t.aggData[s]:n.valueGetter?a=this.executeValueGetter(n.valueGetter,o,e,t):h?a=sr(o,t.field,e.isFieldContainsDots()):i&&o&&!d&&(a=sr(o,i,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof a&&0===a.indexOf("=")){const r=a.substring(1);a=this.executeValueGetter(r,o,e,t)}return a}parseValue(e,t,r,n){const i=e.getColDef(),s=i.valueParser;if(xe(s)){const o=Ut(this.gos,{node:t,data:t?.data,oldValue:n,newValue:r,colDef:i,column:e});return"function"===typeof s?s(o):this.expressionSvc?.evaluate(s,o)}return r}getDeleteValue(e,t){return xe(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,r,n){let i,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=null;const a=e.getColDef();if(n?i=n:s&&(i=a.valueFormatter),i){const n=Ut(this.gos,{value:r,node:t,data:t?t.data:null,colDef:a,column:e});o="function"===typeof i?i(n):this.expressionSvc?this.expressionSvc.evaluate(i,n):null}else if(a.refData)return a.refData[r]||"";return null==o&&Array.isArray(r)&&(o=r.join(", ")),o}getDisplayedNode(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.gos,i=n.get("groupHideOpenParents"),s=n.get("showOpenedGroup")&&!r;if(!i&&!s)return;const o=t.colDef.showRowGroup;if(!0===o){if(e.group)return;return e.parent??void 0}let a=e;for(;a&&a.rowGroupColumn?.getId()!=o;){const e=a===a.parent?.childrenAfterSort?.[0];if(!s&&!e)return;a=a.parent}return a!==e?a??void 0:void 0}setValue(e,t,r,n){const i=this.colModel.getColDefCol(t);if(!e||!i)return!1;ke(e.data)&&(e.data={});const{field:s,valueSetter:o}=i.getColDef();if(ke(s)&&ke(o))return et(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(i,r))return et(135),!1;const a=Ut(this.gos,{node:e,data:e.data,oldValue:this.getValue(i,e),newValue:r,colDef:i.getColDef(),column:i});let l;if(a.newValue=r,l=xe(o)?"function"===typeof o?o(a):this.expressionSvc?.evaluate(o,a):this.setValueUsingField(e.data,s,r,i.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();const c=this.getValue(i,e);return this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:c,value:c,source:n}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"===typeof t&&this.beans.frameworkOverrides.wrapOutgoing((()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})}))}setValueUsingField(e,t,r,n){if(!t)return!1;let i=!1;if(n){const n=t.split(".");let s=e;for(;n.length>0&&s;){const e=n.shift();0===n.length?(i=s[e]===r,i||(s[e]=r)):s=s[e]}}else i=e[t]===r,i||(e[t]=r);return!i}executeValueGetterWithValueCache(e,t,r,n){const i=r.getColId(),s=this.valueCache.getValue(n,i);if(void 0!==s)return s;const o=this.executeValueGetterWithoutValueCache(e,t,r,n);return this.valueCache.setValue(n,i,o),o}executeValueGetterWithoutValueCache(e,t,r,n){const i=Ut(this.gos,{data:t,node:n,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,n)});let s;return s="function"===typeof e?e(i):this.expressionSvc?.evaluate(e,i),s}getValueCallback(e,t){const r=this.colModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),n=e.getColDef().keyCreator;let i=r;if(n){i=n(Ut(this.gos,{value:r,colDef:e.getColDef(),column:e,node:t,data:t.data}))}return"string"===typeof i||null==i||(i=String(i),"[object Object]"===i&&et(121)),i}},class extends rr{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(ri(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,null!=this.focusFallbackTimeout&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,null!=this.focusFallbackTimeout&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t?null:this.doesRowOrCellHaveBrowserFocus()?t:null}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader?null:this.isDomDataPresentInHierarchy(wt(this.beans),io)?this.focusedHeader:null}doesRowOrCellHaveBrowserFocus(){const e=wt(this.beans);return!!this.isDomDataPresentInHierarchy(e,mi)||this.isDomDataPresentInHierarchy(e,ds)}isDomDataPresentInHierarchy(e,t){let r=e;for(;r;){if(gt(this.gos,r,t))return!0;r=r.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:r,column:n}=e,i={rowIndex:t,rowPinned:r,column:n,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return s&&(i.isFullWidthCell=s.isFullWidth()),i}clearFocusedCell(){if(null==this.focusedCell)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:r,rowPinned:n,forceBrowserFocus:i=!1,preventScrollOnBrowserFocus:s=!1}=e,o=this.colModel.getCol(t);o?(this.focusedCell={rowIndex:r,rowPinned:Te(n),column:o},this.eventSvc.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCell),forceBrowserFocus:i,preventScrollOnBrowserFocus:s})):this.focusedCell=null}isCellFocused(e){return null!=this.focusedCell&&xi(e,this.focusedCell)}isHeaderWrapperFocused(e){if(null==this.focusedHeader)return!1;const{column:t,rowCtrl:{rowIndex:r,pinned:n}}=e,{column:i,headerRowIndex:s}=this.focusedHeader;return t===i&&r===s&&n==i.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),ui(this.beans))return!1;const{direction:t,fromTab:r,allowUserOverride:n,event:i,fromCell:s,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(a);if(n){const e=this.focusedHeader,n=Ys(this.beans);if(r){const r=this.gos.getCallback("tabToNextHeader");r&&(a=this.getHeaderPositionFromUserFunc({userFunc:r,direction:t,currentPosition:e,headerPosition:a,headerRowCount:n}))}else{const t=this.gos.getCallback("navigateToNextHeader");if(t&&i){a=t({key:i.key,previousHeaderPosition:e,nextHeaderPosition:a,headerRowCount:n,event:i})}}}return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:i,fromCell:s,rowWithoutSpanValue:o})}focusHeaderPositionFromUserFunc(e){if(ui(this.beans))return!1;const{userFunc:t,headerPosition:r,direction:n,event:i}=e,s=this.focusedHeader,o=Ys(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:s,headerPosition:r,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:i})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:r,currentPosition:n,headerPosition:i,headerRowCount:s}=e,o=t({backwards:"Before"===r,previousHeaderPosition:n,nextHeaderPosition:i,headerRowCount:s});return!0===o?n:!1===o?null:o}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:r,fromCell:n,rowWithoutSpanValue:i,event:s}=e,{column:o,headerRowIndex:a}=t,{filterManager:l,ctrlsSvc:c,headerNavigation:u}=this.beans;if(-1===a)return l?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:o,event:s});u?.scrollToColumn(o,r);const d=c.getHeaderRowContainerCtrl(o.getPinned()),h=d?.focusHeader(t.headerRowIndex,o,s)||!1;return u&&h&&(null!=i||n)&&(u.currentHeaderRowWithoutSpan=i??-1),h}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;const{colGroupSvc:t}=this.beans;t&&e.getParent()&&(e=t.getColGroupAtLevel(e,0));const r=Zl(e,0);return this.focusHeaderPosition({headerPosition:r,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;const t=Ys(this.beans)-1,r=br(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:r},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return null!=this.focusedCell&&(this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Te(t))}focusOverlay(e){const t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&oi(t,e)}focusGridView(e){const{backwards:t=!1,canFocusOverlay:r=!0,event:n}=e;if(this.overlays?.isExclusive())return r&&this.focusOverlay(t);if(di(this.beans))return t&&!ui(this.beans)?this.focusLastHeader():!(!r||!this.focusOverlay(t))||!t&&hi(this.beans,t);const i=t?function(e){let t,r=null;const{pinnedRowModel:n,pageBounds:i}=e,s=n?.getPinnedBottomRowCount(),o=n?.getPinnedTopRowCount();return s?(r="bottom",t=s-1):e.rowModel.getRowCount()?(r=null,t=i.getLastRow()):o&&(r="top",t=o-1),void 0===t?null:{rowIndex:t,rowPinned:r}}(this.beans):function(e){let t,r=0;const{pinnedRowModel:n,rowModel:i,pageBounds:s}=e;return n?.getPinnedTopRowCount()?t="top":i.getRowCount()?(t=null,r=s.getFirstRow()):n?.getPinnedBottomRowCount()&&(t="bottom"),void 0===t?null:{rowIndex:r,rowPinned:t}}(this.beans);if(i){const r=e.column??this.focusedHeader?.column,{rowIndex:s,rowPinned:o}=i,a=Pi(this.beans,i);if(!r||!a||null==s)return!1;if(r.isSuppressNavigable(a)){const e=this.gos.get("enableRtl");let t;return t=n&&n.key!==Qn.TAB?n.key:e?Qn.LEFT:Qn.RIGHT,this.beans.navigation?.navigateToNextCell(null,t,{rowIndex:s,column:r,rowPinned:o||null},!0),!0}if(this.navigation?.ensureCellVisible({rowIndex:s,column:r,rowPinned:o}),t){const e=this.rowRenderer.getRowByPosition(i);if(e?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(i,t))return!0}return this.setFocusedCell({rowIndex:s,column:r,rowPinned:Te(o),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:s,rowPinned:o,column:r}),!0}return!(!r||!this.focusOverlay(t))||!(!t||!this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const r=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:Ys(this.beans)-1}}):this.focusGridView({column:r})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},class extends rr{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass="ag-theme-params-"+ ++Xl,this.globalCSS=[]}wireBeans(e){const{eGridDiv:t,gridOptions:r}=e;this.eGridDiv=t,this.eStyleContainer=r.themeStyleContainer??(t.getRootNode()===document?document.head:t),this.cssLayer=r.themeCssLayer,this.styleNonce=r.styleNonce}postConstruct(){this.addManagedPropertyListener("theme",(()=>this.handleThemeGridOptionChange())),this.handleThemeGridOptionChange(),this.addManagedPropertyListener("rowHeight",(()=>this.refreshRowHeightVariable())),this.getSizeEl($l),this.getSizeEl(Kl),this.getSizeEl(Yl),this.getSizeEl(ql),this.refreshRowBorderWidthVariable(),this.addDestroyFunc((()=>(e=>{if(Ha.delete(e),0===Ha.size){_a=new WeakMap;for(const e of document.head.querySelectorAll("style[data-ag-global-css]"))e.remove()}})(this))),this.mutationObserver=new MutationObserver((()=>{this.fireGridStylesChangedEvent("themeChanged")})),this.addDestroyFunc((()=>this.mutationObserver.disconnect()))}getDefaultRowHeight(){return this.getCSSVariablePixelValue($l)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(Kl)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(Wl)}getDefaultIndentation(){return this.getCSSVariablePixelValue(Ul)}getDefaultRowGroupIndentSize(){return this.getCSSVariablePixelValue(jl)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getDefaultIndentation();return e-1+this.getDefaultRowGroupIndentSize()*t}getCellPaddingRight(){return this.getDefaultCellHorizontalPadding()-1}getCellPadding(){return this.getCellPaddingLeft()+this.getCellPaddingRight()}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(Yl)}getRowBorderWidth(){return this.getCSSVariablePixelValue(ql)}applyThemeClasses(e){const{gridTheme:t}=this;let r="";if(t)r=`${this.paramsClass} ${t._getCssClass()}`;else{this.mutationObserver.disconnect();let e=this.eGridDiv;for(;e;){let t=!1;for(const n of Array.from(e.classList))n.startsWith("ag-theme-")&&(t=!0,r=r?`${r} ${n}`:n);t&&this.mutationObserver.observe(e,{attributes:!0,attributeFilter:["class"]}),e=e.parentElement}}for(const n of Array.from(e.classList))n.startsWith("ag-theme-")&&e.classList.remove(n);if(r){const t=e.className;e.className=t+(t?" ":"")+r}}refreshRowHeightVariable(){const{eGridDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),r=this.gos.get("rowHeight");if(null==r||isNaN(r)||!isFinite(r))return null!==t&&e.style.setProperty("--ag-line-height",null),-1;const n=`${r}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),r):""!=t?parseFloat(t):-1}addGlobalCSS(e,t){this.gridTheme?Ga(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(null!=t)return t;const r=this.measureSizeEl(e);return"detached"===r||"no-styles"===r?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(null==t.offsetParent)return"detached";const r=t.offsetWidth;return r===Jl?"no-styles":(this.sizesMeasured=!0,r)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=Re({tag:"div",cls:"ag-measurement-container"}),this.eGridDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const r=this.getMeasurementContainer();t=Re({tag:"div"});const{border:n,noWarn:i}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${Jl}px)`)):t.style.width=`var(${e.cssName}, ${Jl}px)`,r.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);"no-styles"!==s||i||et(9,{variable:e});const o=we(this.beans,t,(()=>{const t=this.measureSizeEl(e);"detached"!==t&&"no-styles"!==t&&(this.lastKnownValues.set(e,t),t!==s&&(s=t,this.fireGridStylesChangedEvent(e.changeKey)))}));return this.addDestroyFunc((()=>o())),t}fireGridStylesChangedEvent(e){"rowBorderWidthChanged"===e&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(ql);this.eGridDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}handleThemeGridOptionChange(){const{gos:e,eGridDiv:t,globalCSS:r,gridTheme:n}=this,i=e.get("theme");let s;if("legacy"===i)s=void 0;else{const e=i??Vl;e instanceof wl?s=e:tt(240,{theme:e})}if(s!==n){if(s){o=this,Ha.add(o),Ba(this.eStyleContainer,this.cssLayer,this.styleNonce);for(const[e,t]of r)Ga(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce);r.length=0}this.gridTheme=s,s?._startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce});let n=this.eParamsStyle;if(!n){n=this.eParamsStyle=Re({tag:"style"});const e=this.gos.get("styleNonce");e&&n.setAttribute("nonce",e),t.appendChild(n)}Na||(n.textContent=s?._getPerGridCss(this.paramsClass)||""),this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged")}var o;s&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&tt(i?106:239)}},class extends rr{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn((()=>{e.executeLaterVMTurn((()=>this.updateScrollVisibleImpl()))})):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(null==this.scrollbarWidth){const e=this.gos.get("scrollbarWidth"),t="number"===typeof e&&e>=0?e:(null==l&&j(),l);null!=t&&(this.scrollbarWidth=t,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},class extends rr{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",(()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach((e=>e(this.params))),this.readyCallbacks.length=0)}),this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){const e=Object.values(this.params);this.ready=23===e.length&&e.every((e=>e?.isAlive()??!1))}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc((()=>{const e=this.readyCallbacks.indexOf(t);e>=0&&this.readyCallbacks.splice(e,1)}))}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc((()=>{this.updateReady()}))}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},class extends rr{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",(e=>this.setColumnDefs(e)))}start(){this.beans.ctrlsSvc.whenReady(this,(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()}))}setColumnsAndData(e){const{colModel:t,rowModel:r}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),r.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),Oe(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t)return this.waitingForColumns?(this.waitingForColumns=!1,void this.setColumnsAndData(t)):void this.beans.colModel.setColumnDefs(t,_r(e.source))}},class extends rr{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:i}=this.beans;return r&&i?i.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,r){const n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,n,i){const s=e.headerValueGetter;if(s){const o=Ut(this.gos,{colDef:e,column:t,columnGroup:r,providedColumnGroup:n,location:i});return"function"===typeof s?s(o):"string"===typeof s?this.beans.expressionSvc?.evaluate(s,o)??null:""}return null!=e.headerName?e.headerName:e.field?(o=e.field)&&null!=o?o.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):""))).join(" "):null:"";var o}},class extends rr{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{visibleCols:n}=this,i=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const r=n.bodyWidth;this.viewportLeft=r-t-e,this.viewportRight=r-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(r)}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t]}return r||[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}clear(e){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},e||(this.colsWithinViewportHash="")}isColumnInHeaderViewport(e){return!(!e.isAutoHeaderHeight()&&!function(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}(e))||this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),n=this.viewportLeft-200,i=this.viewportRight+200;return!(t<n&&r<n)&&!(t>i&&r>i)}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:r}=this,n=r.centerCols;return r.getColsForRow(e,n,t,(e=>{const t=e.getLeft();return xe(t)&&t>this.viewportLeft}))}checkViewportColumns(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){this.clear(!0);const e={},{leftCols:t,rightCols:r,treeLeft:n,treeRight:i,treeCenter:s}=this.visibleCols;this.headerColsWithinViewport.concat(t).concat(r).forEach((t=>e[t.getId()]=!0));const o=(t,r,n)=>{let i=!1;for(let s=0;s<t.length;s++){const a=t[s];let l=!1;if(pr(a))l=!0===e[a.getId()];else{const e=a.getDisplayedChildren();e&&(l=o(e,r,n+1))}l&&(i=!0,r[n]||(r[n]=[]),r[n].push(a))}return i};o(n,this.rowsOfHeadersToRenderLeft,0),o(i,this.rowsOfHeadersToRenderRight,0),o(s,this.rowsOfHeadersToRenderCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.getViewportColumns().map((e=>`${e.getId()}-${e.getPinned()||"normal"}`)).join("#"),t=this.colsWithinViewportHash!==e;return t&&(this.colsWithinViewportHash=e,this.calculateHeaderRows()),t}}],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:function(e){return e.context.getGridId()},destroy:function(e){e.gridDestroySvc.destroy()},isDestroyed:function(e){return e.gridDestroySvc.destroyCalled},getGridOption:function(e,t){return e.gos.get(t)},setGridOption:function(e,t,r){ia(e,{[t]:r})},updateGridOptions:ia},dependsOn:[Ia,va,ya,Ac,lc,Ta,cc,bc,Ic,uc,pc,fc,mc,dc,La,Ma,Dc]},Oc=class e{static applyGlobalGridOptions(t){if(!e.gridOptions)return{...t};let r={};return ir(r,e.gridOptions,!0,!0),"deep"===e.mergeStrategy?ir(r,t,!0,!0):r={...r,...t},e.gridOptions.context&&(r.context=e.gridOptions.context),t.context&&("deep"===e.mergeStrategy&&r.context&&ir(t.context,r.context,!0,!0),r.context=t.context),r}};Oc.gridOptions=void 0,Oc.mergeStrategy="shallow";var Lc=Oc;var Nc=1,_c=class{create(e,t,r,n,i,s){const o=Lc.applyGlobalGridOptions(t),a=o.gridId??String(Nc++),l=o.rowModelType??"clientSide",c=this.getRegisteredModules(i,a,l),u=this.createBeansList(l,c,a),d=this.createProvidedBeans(e,o,i);if(!u)return;const h=new Yn({providedBeanInstances:d,beanClasses:u,gridId:a,beanInitComparator:Xo,beanDestroyComparator:Jo,derivedBeans:[Yo],destroyCallback:s});return this.registerModuleFeatures(h,c),r(h),h.getBean("syncSvc").start(),n&&n(h),h.getBean("gridApi")}getRegisteredModules(e,t,r){return Wn(Mc,void 0),e?.modules?.forEach((e=>Wn(e,t))),function(e,t){const r=Bn[e]??{};return[...Object.values(Gn.all??{}),...Object.values(r.all??{}),...Object.values(Gn[t]??{}),...Object.values(r[t]??{})]}(t,r)}registerModuleFeatures(e,t){const r=e.getBean("registry"),n=e.getBean("apiFunctionSvc");t.forEach((e=>{r.registerModule(e);const t=e.apiFunctions;if(t){Object.keys(t).forEach((e=>{n?.addFunction(e,t[e])}))}}))}createProvidedBeans(e,t,r){let n=r?r.frameworkOverrides:null;ke(n)&&(n=new Ko);const i={gridOptions:t,eGridDiv:e,globalListener:r?r.globalListener:null,globalSyncListener:r?r.globalSyncListener:null,frameworkOverrides:n};return r&&r.providedBeanInstances&&Object.assign(i,r.providedBeanInstances),i}createBeansList(e,t,r){const n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"}[e];if(!n)return void rt(201,{rowModelType:e},`Unknown rowModelType ${e}.`);if(!Un(n,r,e))return void rt(200,{reasonOrId:`rowModelType = '${e}'`,moduleName:n,gridScoped:jn(),gridId:r,rowModelType:e},`Missing module ${n}Module for rowModelType ${e}. \nIf upgrading from before v33, see ${$e}/upgrading-to-ag-grid-33/#changes-to-modules/`);const i=new Set;return t.forEach((e=>e.beans?.forEach((e=>i.add(e))))),Array.from(i)}};var Gc=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged","beforeRefreshModel","rowNodeDataChanged"],Bc=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],Hc=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],zc=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector","components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce",...Bc,"doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter",...Hc,"cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","theme","rowSelection"],Vc=class{wrap(e,t,r,n){const i=this.createWrapper(e,n);return t?.forEach((e=>{this.createMethod(i,e,!0)})),r?.forEach((e=>{this.createMethod(i,e,!1)})),i}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&et(49,{methodName:t}),null)}}};function Wc(e){const{inputValue:t,allSuggestions:r,hideIrrelevant:n,filterByPercentageOfBestMatch:i}=e;let s=r.map(((e,r)=>({value:e,relevance:Uc(t,e),idx:r})));if(s.sort(((e,t)=>t.relevance-e.relevance)),n&&(s=s.filter((e=>0!==e.relevance))),s.length>0&&i&&i>0){const e=s[0].relevance*i;s=s.filter((t=>e-t.relevance<0))}const o=[],a=[];for(const l of s)o.push(l.value),a.push(l.idx);return{values:o,indices:a}}function Uc(e,t){if(e===t)return 1e3;const r=e.length,n=t.length;if(0===r||0===n)return 0;const i=e.toLocaleLowerCase(),s=t.toLocaleLowerCase(),o=s.indexOf(i);if(-1!==o)return 980-2*o;if(0===[...i].filter((e=>s.includes(e))).length)return 0;let a=Array.from({length:n+1},((e,t)=>t));for(let u=0;u<r;u++){const r=[u+1];for(let i=0;i<n;i++){const s=a[i+1]+1,o=r[i]+1;let l=a[i]+(e[u]!==t[i]?1:0);n>10&&i>n/2&&(l+=1),u>0&&i>0&&e[u-1]===t[i-1]&&(l-=4),r.push(Math.min(s,o,l))}a=r}const l=Math.round(a[n]),c=Math.max(1,1e3-30*l);return Math.max(1,c)}function jc(e,t){if("number"!==typeof e)return"";const r=t(),n=r("thousandSeparator",","),i=r("decimalSeparator",".");return e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var $c={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0},Kc="clientSide",Yc="serverSide",qc="infinite",Xc={onGroupExpandedOrCollapsed:[Kc],refreshClientSideRowModel:[Kc],isRowDataEmpty:[Kc],forEachLeafNode:[Kc],forEachNodeAfterFilter:[Kc],forEachNodeAfterFilterAndSort:[Kc],resetRowHeights:[Kc],applyTransaction:[Kc],applyTransactionAsync:[Kc],flushAsyncTransactions:[Kc],getBestCostNodeSelection:[Kc],getServerSideSelectionState:[Yc],setServerSideSelectionState:[Yc],applyServerSideTransaction:[Yc],applyServerSideTransactionAsync:[Yc],applyServerSideRowData:[Yc],retryServerSideLoads:[Yc],flushServerSideAsyncTransactions:[Yc],refreshServerSide:[Yc],getServerSideGroupLevelState:[Yc],refreshInfiniteCache:[qc],purgeInfiniteCache:[qc],getInfiniteRowCount:[qc],isLastRowIndexKnown:[qc,Yc],expandAll:[Kc,Yc],collapseAll:[Kc,Yc],onRowHeightChanged:[Kc,Yc],setRowCount:[qc,Yc],getCacheBlockState:[qc,Yc]},Jc={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};var Qc={AdvancedFilter:1,AllEnterprise:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},Zc=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],eu={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:Zc,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...Zc,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...Zc,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},tu={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};var ru={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function nu(e){return!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||"IntegratedCharts"!==e&&"Sparklines"!==e?`${e}Module`:`${e}Module.with(AgChartsEnterpriseModule)`}var iu=e=>{let{reasonOrId:t,moduleName:r,gridScoped:n,gridId:i,rowModelType:s,additionalText:o,isUmd:a}=e;const l=function(e,t){const r=[];return(Array.isArray(e)?e:[e]).forEach((e=>{const n=eu[e];n?n.forEach((e=>{const n=tu[e];n&&n!==t||r.push(e)})):r.push(e)})),r}(r,s),c="string"===typeof t?t:au[t];if(a)return function(e,t){const r=t.filter((e=>"IntegratedCharts"===e||"Sparklines"===e));let n="";const i=globalThis?.agCharts;return!i&&r.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.\n`:t.some((e=>Qc[e]))&&(n+=`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.\n`),n}(c,l);const u=l.filter((e=>"IntegratedCharts"===e||"Sparklines"===e)),d=u.length>0?`${u.map((e=>nu(e))).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${c} as ${l.length>1?"one of "+l.map((e=>nu(e))).join(", "):nu(l[0])} is not registered${n?" for gridId: "+i:""}. ${d} Check if you have registered the module:\n`}\n${(e=>{const t=e.map((e=>`import { ${nu(e)} } from '${Qc[e]?"ag-grid-enterprise":"ag-grid-community"}';`));if(e.some((e=>"IntegratedCharts"===e||"Sparklines"===e))){const e="import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';";t.push(e)}return`import { ModuleRegistry } from 'ag-grid-community'; \n${t.join(" \n")} \n\nModuleRegistry.registerModules([ ${e.map((e=>nu(e,!0))).join(", ")} ]); \n\nFor more info see: ${$e}/modules/`})(l)}`+(o?` \n\n${o}`:"")},su=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.\n\nimport { AgChartsEnterpriseModule } from 'ag-charts-enterprise';\nimport { ModuleRegistry } from 'ag-grid-community';\nimport { ${e} } from 'ag-grid-enterprise';\n    \nModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);\n    `,ou={1:()=>"`rowData` must be an array",2:e=>{let{nodeId:t}=e;return`Duplicate node id '${t}' detected from getRowId callback, this could cause issues in your grid.`},3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:e=>{let{id:t}=e;return`Could not find row id=${t}, data item was not found for this id`},5:e=>{let{data:t}=e;return["Could not find data item as object was not found.",t," Consider using getRowId to help the Grid find matching row data"]},6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:e=>{let{key:t}=e;return`Unknown key for navigation ${t}`},9:e=>{let{variable:t}=e;return`No value for ${t?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${t?.defaultValue} will be used and updated when styles load.`},10:e=>{let{eventType:t}=e;return`As of v33, the '${t}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`},11:()=>"No gridOptions provided to createGrid",12:e=>{let{colKey:t}=e;return["column ",t," not found"]},13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:e=>{let{groupPrefix:t}=e;return`Row IDs cannot start with ${t}, this is a reserved prefix for AG Grid's row grouping feature.`},15:e=>{let{expression:t}=e;return["value should be either a string or a function",t]},16:e=>{let{expression:t,params:r,e:n}=e;return["Processing of the expression failed","Expression = ",t,"Params = ",r,"Exception = ",n]},17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>'You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"',21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:e=>{let{key:t}=e;return`${t} is an initial property and cannot be updated.`},23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:e=>{let{id:t}=e;return["The getRowId callback must return a string. The ID ",t," is being cast to a string."]},26:e=>{let{fnName:t,preDestroyLink:r}=e;return`Grid API function ${t}() cannot be called as the grid has been destroyed.\n Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\n To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${r}`},27:e=>{let{fnName:t,module:r}=e;return`API function '${t}' not registered to module '${r}'`},28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:e=>{let{toIndex:t}=e;return["tried to insert columns in invalid location, toIndex = ",t,"remember that you should not count the moving columns when calculating the new index"]},31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:e=>{let{key:t}=e;return`the column type '${t}' is a default column type and cannot be overridden.`},35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:e=>{let{t:t}=e;return"colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes"},37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:e=>{let{iconName:t}=e;return`provided icon '${t}' needs to be a string or a function`},39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:e=>{let{e:t,method:r}=e;return`${t}\n${(e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`)(r)}`},41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:e=>{let{iconName:t}=e;return`As of v33, icon '${t}' is deprecated. Use the icon CSS name instead.`},44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:e=>{let{parentCellDataType:t}=e;return`The data type definition ${t} does not exist.`},46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:e=>{let{cellDataType:t}=e;return`Missing data type definition - "${t}"`},48:e=>{let{property:t}=e;return`Cell data type is "object" but no Value ${t} has been provided. Please either provide an object data type definition with a Value ${t}, or set "colDef.value${t}"`},49:e=>{let{methodName:t}=e;return`Framework component is missing the method ${t}()`},50:e=>{let{compName:t}=e;return`Could not find component ${t}, did you forget to configure this component?`},51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:e=>{let{colId:t}=e;return`setFilterModel() - no column found for colId: ${t}`},63:e=>{let{colId:t}=e;return`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${t}`},64:e=>{let{colId:t}=e;return`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${t}`},65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:e=>{let{guiFromFilter:t}=e;return`getGui method from filter returned ${t}; it should be a DOM element.`},70:e=>{let{newFilter:t}=e;return"Grid option quickFilterText only supports string inputs, received: "+typeof t},71:()=>"debounceMs is ignored when apply button is present",72:e=>{let{keys:t}=e;return["ignoring FilterOptionDef as it doesn't contain one of ",t]},73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:e=>{let{filterModelType:t}=e;return['Unexpected type of filter "',t,'", it looks like the filter was configured with incorrect Filter Options']},77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:e=>{let{param:t}=e;return`DateFilter ${t} is not a number`},83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:e=>{let{index:t}=e;return`Invalid row index for ensureIndexVisible: ${t}`},89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:e=>{let{paginationPageSizeOption:t,pageSizeSet:r,pageSizesSet:n,pageSizeOptions:i}=e;return`'paginationPageSize=${t}'${r?"":" (default value)"}, but ${t} is not included in${n?"":" the default"} paginationPageSizeSelector=[${i?.join(", ")}].`},95:e=>{let{paginationPageSizeOption:t,paginationPageSizeSelector:r}=e;return`Either set '${r}' to an array that includes ${t} or to 'false' to disable the page size selector.`},96:e=>{let{id:t,data:r}=e;return["Duplicate ID",t,"found for pinned row with data",r,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."]},97:e=>{let{colId:t}=e;return`cellEditor for column ${t} is missing getGui() method`},98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",100:e=>{let{rowModelType:t}=e;return`selectAll only available when rowModelType='clientSide', ie not ${t}`},101:e=>{let{propertyName:t,componentName:r,agGridDefaults:n,jsComps:i}=e;const s=[],o=Wc({inputValue:r,allSuggestions:[...Object.keys(n??[]).filter((e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e))),...Object.keys(i??[])],hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return s.push(`Could not find '${r}' component. It was configured as "${t}: '${r}'" but it wasn't found in the list of registered components.\n`),o.length>0&&s.push(`         Did you mean: [${o.slice(0,3)}]?\n`),s.push("If using a custom component check it has been registered correctly."),s},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:e=>{let{value:t,param:r}=e;return`Numeric value ${t} passed to ${r} param will be interpreted as ${t} seconds. If this is intentional use "${t}s" to silence this warning.`},105:e=>{let{e:t}=e;return["chart rendering failed",t]},106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${$e}/theming-migration/`,107:e=>{let{key:t,value:r}=e;return`Invalid value for theme param ${t} - ${r}`},108:e=>{let{e:t}=e;return["chart update failed",t]},109:e=>{let{aggFuncOrString:t}=e;return`unrecognised aggregation function ${t}`},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:e=>{let{component:t}=e;return`Could not find component with name of ${t}. Is it in Vue.components?`},116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:e=>{let{chartId:t}=e;return`Unable to update chart. No active chart found with ID: ${t}.`},126:()=>"unable to restore chart as no chart model is provided",127:e=>{let{allRange:t}=e;return`unable to create chart as ${t?"there are no columns in the grid":"no range is selected"}.`},128:e=>{let{feature:t}=e;return`${t} is only available if using 'multiRow' selection mode.`},129:e=>{let{feature:t,rowModel:r}=e;return`${t} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${r}.`},130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:e=>{let{iconName:t}=e;return`icon '${t}' function should return back a string or a dom object`},134:e=>{let{iconName:t}=e;return`Did not find icon '${t}'`},135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:e=>{let{type:t,currentChartType:r}=e;return`Unable to update chart as a '${t}' update type is not permitted on a ${r}.`},138:e=>{let{chartType:t}=e;return`invalid chart type supplied: ${t}`},139:e=>{let{customThemeName:t}=e;return`a custom chart theme with the name ${t} has been supplied but not added to the 'chartThemes' list`},140:e=>{let{name:t}=e;return`no stock theme exists with the name '${t}' and no custom chart theme with that name was supplied to 'customChartThemes'`},141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:e=>{let{panel:t}=e;return`'${t}' is not a valid Chart Tool Panel name`},144:e=>{let{type:t}=e;return`Invalid charts data panel group name supplied: '${t}'`},145:e=>{let{group:t}=e;return`As of v32, only one charts customize panel group can be expanded at a time. '${t}' will not be expanded.`},146:e=>{let{comp:t}=e;return`Unable to instantiate component '${t}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`},147:e=>{let{group:t}=e;return`Invalid charts customize panel group name supplied: '${t}'`},148:e=>{let{group:t}=e;return`invalid chartGroupsDef config '${t}'`},149:e=>{let{group:t,chartType:r}=e;return`invalid chartGroupsDef config '${t}.${r}'`},150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:e=>{let{chartType:t}=e;return`invalid chartType '${t}' supplied in 'seriesChartTypes', converting to 'line' instead.`},152:e=>{let{colId:t}=e;return`no 'seriesChartType' found for colId = '${t}', defaulting to 'line'.`},153:e=>{let{chartDataType:t}=e;return`unexpected chartDataType value '${t}' supplied, instead use 'category', 'series' or 'excluded'`},154:e=>{let{colId:t}=e;return`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${t}`},155:e=>{let{option:t}=e;return`'${t}' is not a valid Chart Toolbar Option`},156:e=>{let{panel:t}=e;return`Invalid panel in chartToolPanelsDef.panels: '${t}'`},157:e=>{let{unrecognisedGroupIds:t}=e;return["unable to find group(s) for supplied groupIds:",t]},158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:e=>{let{id:t,dataType:r}=e;return`Unrecognized data type for excel export [${t}.dataType=${r}]`},163:e=>{let{featureName:t}=e;return`Excel table export does not work with ${t}. The exported Excel file will not contain any Excel tables.\n Please turn off ${t} to enable Excel table exports.`},164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:e=>{let{unrecognisedGroupIds:t}=e;return["unable to find groups for these supplied groupIds:",t]},167:e=>{let{unrecognisedColIds:t}=e;return["unable to find columns for these supplied colIds:",t]},168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:e=>{let{providedStrategy:t}=e;return`invalid cellRendererParams.refreshStrategy = ${t} supplied, defaulting to refreshStrategy = 'rows'.`},171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:e=>{let{group:t}=e;return`invalid chartGroupsDef config '${t}'`},174:e=>{let{group:t,chartType:r}=e;return`invalid chartGroupsDef config '${t}.${r}'`},175:e=>{let{menuTabName:t,itemsToConsider:r}=e;return[`Trying to render an invalid menu item '${t}'. Check that your 'menuTabs' contains one of `,r]},176:e=>{let{key:t}=e;return`unknown menu item type ${t}`},177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:e=>{let{colId:t}=e;return`column ${t} is not visible`},179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:e=>{let{parentGroupData:t,childNodeData:r}=e;return["duplicate group keys for row data, keys should be unique",[t,r]]},185:e=>{let{data:t}=e;return["getDataPath() should not return an empty path",[t]]},186:e=>{let{rowId:t,rowData:r,duplicateRowsData:n}=e;return["duplicate group keys for row data, keys should be unique",t,r,...n??[]]},187:e=>{let{rowId:t,firstData:r,secondData:n}=e;return[`Duplicate node id ${t}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",r,"second instance",n]},188:()=>"getRowId callback must be provided for Server Side Row Model selection to work correctly.",189:e=>{let{startRow:t}=e;return`invalid value ${t} for startRow, the value should be >= 0`},190:e=>{let{rowGroupId:t,data:r}=e;return["null and undefined values are not allowed for server side row model keys",t?`column = ${t}`:"","data is ",r]},194:e=>{let{method:t}=e;return`calling gridApi.${t}() is only possible when using rowModelType=\`clientSide\`.`},195:e=>{let{justCurrentPage:t}=e;return`selecting just ${t?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`},196:e=>{let{key:t}=e;return`Provided ids must be of string type. Invalid id provided: ${t}`},197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:iu,201:e=>{let{rowModelType:t}=e;return`Could not find row model for rowModelType = ${t}`},202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:e=>{let{duplicateIdText:t}=e;return`Unable to display rows as duplicate row ids (${t}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`},206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${$e}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:e=>{let{key:t}=e;return`unable to lookup Tool Panel as invalid key supplied: ${t}`},215:e=>{let{key:t,defaultByKey:r}=e;return`the key ${t} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(r??{}).join(",")}`},216:e=>{let{name:t}=e;return`Missing component for '${t}'`},217:e=>{let{invalidColIds:t}=e;return["unable to find grid columns for the supplied colDef(s):",t]},218:e=>{let{property:t,defaultOffset:r}=e;return`${t} must be a number, the value you provided is not a valid number. Using the default of ${r}px.`},219:e=>{let{property:t}=e;return`Property ${t} does not exist on the target object.`},220:e=>{let{lineDash:t}=e;return`'${t}' is not a valid 'lineDash' option.`},221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:e=>{let{menuItemOrString:t}=e;return`unrecognised menu item ${t}`},229:e=>{let{index:t}=e;return["invalid row index for ensureIndexVisible: ",t]},230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:e=>{let{methodName:t}=e;return`Framework component is missing the method ${t}()`},234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:e=>{let{theme:t}=e;return`theme grid option must be a Theming API theme object or the string "legacy", received: ${t}`},243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>"Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. \nPlease rebuild the selection state and reapply it.",248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:e=>{let{chartType:t}=e;return`AG Grid: Unable to create chart as an invalid chartType = '${t}' was supplied.`},252:()=>"cannot get grid to draw rows when it is in the middle of drawing rows. \nYour code probably called a grid API method while the grid was in the render stage. \nTo overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). \nTo see what part of your code that caused the refresh check this stacktrace.",253:e=>{let{version:t}=e;return["Illegal version string: ",t]},254:()=>"Cannot create chart: no chart themes available.",255:e=>{let{point:t}=e;return`Lone surrogate U+${t?.toString(16).toUpperCase()} is not a scalar value`},256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>su("IntegratedChartsModule"),258:()=>su("SparklinesModule"),259:e=>{let{part:t}=e;return`the argument to theme.withPart must be a Theming API part object, received: ${t}`},260:e=>{let{propName:t,compName:r,gridScoped:n,gridId:i,rowModelType:s}=e;return iu({reasonOrId:`AG Grid '${t}' component: ${r}`,moduleName:ru[r],gridId:i,gridScoped:n,rowModelType:s})},261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:e=>{let{colId:t}=e;return`Unable to infer chart data type for column '${t}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${$e}/integrated-charts-range-chart#coldefchartdatatype .`},266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:e=>{let{id:t,parentId:r}=e;return`Cycle detected for row with id='${t}' and parent id='${r}'. Resetting the parent for row with id='${t}' and showing it as a root-level node.`},271:e=>{let{id:t,parentId:r}=e;return`Parent row not found for row with id='${t}' and parent id='${r}'. Showing row with id='${t}' as a root-level node.`}};var au={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},lu={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0},cu=()=>({objectName:"colDef",allProperties:Object.keys(lu),docsUrl:"column-properties/",deprecations:{checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}},validations:{aggFunc:{module:"SharedAggregation"},autoHeight:{supportedRowModels:["clientSide","serverSide"],module:"RowAutoHeight"},cellClass:{module:"CellStyle"},cellClassRules:{module:"CellStyle"},cellEditor:e=>{let{cellEditor:t,editable:r}=e;if(!r)return null;if("string"===typeof t){const e=ru[t];if(e)return{module:e}}return{module:"CustomEditor"}},cellRenderer:e=>{let{cellRenderer:t}=e;if("string"!==typeof t)return null;const r=ru[t];return r?{module:r}:null},cellRendererParams:{validate:e=>null==e.rowGroup&&null==e.rowGroupIndex&&"agGroupCellRenderer"!==e.cellRenderer||!("checkbox"in e.cellRendererParams)?null:'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.'},cellStyle:{module:"CellStyle"},children:()=>cu(),columnChooserParams:{module:"ColumnMenu"},contextMenuItems:{module:"ContextMenu"},dndSource:{module:"DragAndDrop"},dndSourceOnRowDrag:{module:"DragAndDrop"},editable:e=>{let{editable:t,cellEditor:r}=e;return t&&!r?{module:"TextEditor"}:null},enableCellChangeFlash:{module:"HighlightChanges"},enablePivot:{module:"SharedPivot"},enableRowGroup:{module:"SharedRowGrouping"},enableValue:{module:"SharedAggregation"},filter:e=>{let{filter:t}=e;if(t&&"string"!==typeof t&&"boolean"!==typeof t)return{module:"CustomFilter"};if("string"===typeof t){const e=ru[t];if(e)return{module:e}}return{module:"ColumnFilter"}},floatingFilter:{module:"ColumnFilter"},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,t)=>{let{rowSelection:r}=t;return"multiple"===r?null:"headerCheckboxSelection is only supported with rowSelection=multiple"}},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:r}=t;return"multiple"===r?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"}},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:r}=t;return"multiple"===r?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"}},headerTooltip:{module:"Tooltip"},headerValueGetter:{validate:e=>{const t=e.headerValueGetter;return"function"===typeof t||"string"===typeof t?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:e=>{let{icons:t}=e;if(t){if(t.smallDown)return it(262);if(t.smallLeft)return it(263);if(t.smallRight)return it(264)}return null}},mainMenuItems:{module:"ColumnMenu"},menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some((e=>t.includes(e)))?{module:"ColumnMenu"}:null},pivot:{module:"SharedPivot"},pivotIndex:{module:"SharedPivot"},rowDrag:{module:"RowDrag"},rowGroup:{module:"SharedRowGrouping"},rowGroupIndex:{module:"SharedRowGrouping"},sortingOrder:{validate:e=>{const t=e.sortingOrder;if(Array.isArray(t)&&t.length>0){const e=t.filter((e=>!Pc.includes(e)));if(e.length>0)return`sortingOrder must be an array with elements from [${Pc.map(Xe).join()}], currently it includes [${e.map(Xe).join()}]`}else if(!Array.isArray(t)||t.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${t}`;return null}},tooltipField:{module:"Tooltip"},tooltipValueGetter:{module:"Tooltip"},type:{validate:e=>{const t=e.type;return t instanceof Array?t.some((e=>"string"!==typeof e))?"if colDef.type is supplied an array it should be of type 'string[]'":null:"string"===typeof t?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(e,t)=>{let{suppressRowTransform:r}=t;return r?null:"colDef.rowSpan requires suppressRowTransform to be enabled."}},spanRows:{module:"CellSpan",dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[!1,void 0]},rowSpan:{required:[!1,void 0]}},validate:(e,t)=>{let{rowSelection:r,cellSelection:n,suppressRowTransform:i,enableCellSpan:s,rowDragEntireRow:o,enableCellTextSelection:a}=t;return"object"===typeof r&&"singleRow"===r?.mode&&r?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":s?o?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."}}}});function uu(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.MAX_VALUE;return"number"===typeof t||null==t?null==t||t>=r&&t<=n?null:n===Number.MAX_VALUE?`${e}: value should be greater than or equal to ${r}`:`${e}: value should be between ${r} and ${n}`:`${e}: value should be a number`}var du=()=>{const e={alignedGrids:{module:"AlignedGrids"},allowContextMenuWithControlKey:{module:"ContextMenu"},autoSizePadding:{validate(e){let{autoSizePadding:t}=e;return uu("autoSizePadding",t,0)}},autoSizeStrategy:{module:"ColumnAutoSize"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate(e){let{cacheBlockSize:t}=e;return uu("cacheBlockSize",t,1)}},cacheOverflowSize:{validate(e){let{cacheOverflowSize:t}=e;return uu("cacheOverflowSize",t,1)}},cellSelection:{module:"CellSelection"},columnHoverHighlight:{module:"ColumnHover"},datasource:{supportedRowModels:["infinite"],module:"InfiniteRowModel"},doesExternalFilterPass:{module:"ExternalFilter"},domLayout:{validate:e=>{const t=e.domLayout,r=["autoHeight","normal","print"];return t&&!r.includes(t)?`domLayout must be one of [${r.join()}], currently it's ${t}`:null}},editType:{module:"EditCore"},enableAdvancedFilter:{module:"AdvancedFilter"},enableCharts:{module:"IntegratedCharts"},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{module:"CellSelection",dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},findSearchValue:{module:"Find"},rowNumbers:{module:"RowNumbers"},getContextMenuItems:{module:"ContextMenu"},getLocaleText:{module:"Locale"},getMainMenuItems:{module:"ColumnMenu"},getRowClass:{module:"RowStyle"},getRowStyle:{module:"RowStyle"},grandTotalRow:{module:"SharedRowGrouping"},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},icons:{validate:e=>{let{icons:t}=e;if(t){if(t.smallDown)return it(262);if(t.smallLeft)return it(263);if(t.smallRight)return it(264)}return null}},infiniteInitialRowCount:{validate(e){let{infiniteInitialRowCount:t}=e;return uu("infiniteInitialRowCount",t,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},initialState:{module:"GridState"},isExternalFilterPresent:{module:"ExternalFilter"},keepDetailRowsCount:{validate(e){let{keepDetailRowsCount:t}=e;return uu("keepDetailRowsCount",t,1)}},localeText:{module:"Locale"},masterDetail:{module:"SharedMasterDetail"},pagination:{module:"Pagination"},paginationPageSize:{validate(e){let{paginationPageSize:t}=e;return uu("paginationPageSize",t,1)}},paginationPageSizeSelector:{validate:e=>{const t=e.paginationPageSizeSelector;return"boolean"===typeof t||null==t||t.length?null:"'paginationPageSizeSelector' cannot be an empty array.\n                    If you want to hide the page size selector, set paginationPageSizeSelector to false."}},pinnedTopRowData:{module:"PinnedRow"},pinnedBottomRowData:{module:"PinnedRow"},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}},module:"SharedPivot"},pivotPanelShow:{module:"RowGroupingPanel"},quickFilterText:{supportedRowModels:["clientSide"],module:"QuickFilter"},rowBuffer:{validate(e){let{rowBuffer:t}=e;return uu("rowBuffer",t,0)}},rowClass:{validate:e=>"function"===typeof e.rowClass?"rowClass should not be a function, please use getRowClass instead":null,module:"RowStyle"},rowClassRules:{module:"RowStyle"},rowData:{supportedRowModels:["clientSide"],module:"ClientSideRowModel"},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{treeData:{required:[!1,void 0]},pagination:{required:[!1,void 0]}},module:"RowDrag"},rowGroupPanelShow:{module:"RowGroupingPanel"},rowSelection:{validate(e){let{rowSelection:t}=e;return t&&"string"===typeof t?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':t&&"object"!==typeof t?"Expected `RowSelectionOptions` object for the `rowSelection` property.":t&&"multiRow"!==t.mode&&"singleRow"!==t.mode?`Selection mode "${t.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null},module:"SharedRowSelection"},rowStyle:{validate:e=>{const t=e.rowStyle;return t&&"function"===typeof t?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null},module:"RowStyle"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"ServerSideRowModel"},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate(e){let{serverSideInitialRowCount:t}=e;return uu("serverSideInitialRowCount",t,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sideBar:{module:"SideBar"},sortingOrder:{validate:e=>{const t=e.sortingOrder;if(Array.isArray(t)&&t.length>0){const e=t.filter((e=>!Pc.includes(e)));if(e.length>0)return`sortingOrder must be an array with elements from [${Pc.map(Xe).join()}], currently it includes [${e.map(Xe).join()}]`}else if(!Array.isArray(t)||t.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${t}`;return null}},statusBar:{module:"StatusBar"},tooltipHideDelay:{validate:e=>e.tooltipHideDelay&&e.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:e=>e.tooltipShowDelay&&e.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],module:"SharedTreeData",validate:e=>{const t=e.rowModelType??"clientSide";switch(t){case"clientSide":{const{treeDataChildrenField:t,treeDataParentIdField:r,getDataPath:n,getRowId:i}=e;if(!t&&!r&&!n)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(t){if(n)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(r)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(r){if(!i)return"getRowId callback not provided, tree data with parent id cannot be built.";if(n)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${t} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:r}}return null}},treeDataChildrenField:{module:"SharedTreeData"},treeDataParentIdField:{module:"SharedTreeData"},undoRedoCellEditing:{module:"UndoRedoEdit"},valueCache:{module:"ValueCache"},viewportDatasource:{supportedRowModels:["viewport"],module:"ViewportRowModel"},viewportRowModelBufferSize:{validate(e){let{viewportRowModelBufferSize:t}=e;return uu("viewportRowModelBufferSize",t,0)}},viewportRowModelPageSize:{validate(e){let{viewportRowModelPageSize:t}=e;return uu("viewportRowModelPageSize",t,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},enableCellSpan:{module:"CellSpan"},autoGroupColumnDef:{validate(e){let{autoGroupColumnDef:t,showOpenedGroup:r}=e;return t?.field&&r?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":t?.valueGetter&&r?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}}},t={};return Hc.forEach((e=>{t[e]={expectedType:"boolean"}})),Bc.forEach((e=>{t[e]={expectedType:"number"}})),ir(t,e),t},hu={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1},pu={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore"},gu=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),fu={pinSubMenu:"PinnedColumn",pinLeft:"PinnedColumn",pinRight:"PinnedColumn",clearPinned:"PinnedColumn",valueAggSubMenu:"SharedAggregation",autoSizeThis:"ColumnAutoSize",autoSizeAll:"ColumnAutoSize",rowGroup:"SharedRowGrouping",rowUnGroup:"SharedRowGrouping",resetColumns:"CommunityCore",expandAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],contractAll:["ClientSideRowModelHierarchy","ServerSideRowModel"],copy:"Clipboard",copyWithHeaders:"Clipboard",copyWithGroupHeaders:"Clipboard",cut:"Clipboard",paste:"Clipboard",export:["CsvExport","ExcelExport"],csvExport:"CsvExport",excelExport:"ExcelExport",separator:"CommunityCore",pivotChart:"IntegratedCharts",chartRange:"IntegratedCharts",columnFilter:"ColumnFilter",columnChooser:"ColumnMenu",sortAscending:"Sort",sortDescending:"Sort",sortUnSort:"Sort"};var mu=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),vu={moduleName:"Validation",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,je=this}postConstruct(){this.processGridOptions(this.gridOptions)}warnOnInitialPropertyUpdate(e,t){"api"===e&&$c[t]&&et(22,{key:t})}processGridOptions(e){this.processOptions(e,{objectName:"gridOptions",allProperties:[...zc,...Gc.map((e=>Wt(e)))],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:{suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."}},validations:du()})}validateApiFunction(e,t){return function(e,t,r){const n=Jc[e];if(n){const{version:r,new:i,old:s,message:o}=n,a=s??e;return function(){Le(`Since ${r} api.${a} is deprecated. ${i?`Please use ${i} instead. `:""}${o??""}`);for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t.apply(t,n)}}const i=Xc[e];return i?function(){const n=r.rowModel.getType();if(i.includes(n)){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(t,o)}Ne(`api.${e} can only be called when gridOptions.rowModelType is ${i.join(" or ")}`)}:t}(e,t,this.beans)}missingUserComponent(e,t,r,n){const i=ru[t];i?this.gos.assertModuleRegistered(i,`AG Grid '${e}' component: ${t}`):et(101,{propertyName:e,componentName:t,agGridDefaults:r,jsComps:n})}checkRowEvents(e){mu.has(e)&&et(10,{eventType:e})}validateIcon(e){if(gu.has(e)&&et(43,{iconName:e}),hu[e])return;const t=pu[e];t?tt(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:jn(),gridId:this.beans.context.getGridId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."}):et(134,{iconName:e})}validateMenuItem(e){const t=fu[e];t&&this.gos.assertModuleRegistered(t,`menu item '${e}'`)}isProvidedUserComp(e){return!!ru[e]}validateColDef(e,t,r){!r&&this.beans.dataTypeSvc?.isColPendingInference(t)||this.processOptions(e,cu())}processOptions(e,t){const{validations:r,deprecations:n,allProperties:i,propertyExceptions:s,objectName:o,docsUrl:a}=t;i&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(e,[...s??[],...Object.keys(n)],i,o,a);const l=new Set,c=t=>{const n=r[t];if(n){if("function"===typeof n){const r=n(e,this.gridOptions,this.beans);if(!r)return;if("objectName"in r){const n=e[t];return Array.isArray(n)?void n.forEach((e=>{this.processOptions(e,r)})):void this.processOptions(e[t],r)}return r}return n}};Object.keys(e).forEach((t=>{const r=n[t];if(r){const{message:e,version:n}=r;l.add(`As of v${n}, ${String(t)} is deprecated. ${e??""}`)}const i=e[t];if(null==i||!1===i)return;const s=c(t);if(!s)return;const{module:o,dependencies:a,validate:u,supportedRowModels:d,expectedType:h}=s;if(h){const e=typeof i;if(e!==h)return void l.add(`${String(t)} should be of type '${h}' but received '${e}' (${i}).`)}if(d){const e=this.gridOptions.rowModelType??"clientSide";if(!d.includes(e))return void l.add(`${String(t)} is not supported with the '${e}' row model. It is only valid with: ${d.join(", ")}.`)}if(o){const e=Array.isArray(o)?o:[o];let r=!0;if(e.forEach((e=>{this.gos.assertModuleRegistered(e,String(t))||(r=!1)})),!r)return}if(a){const r=this.checkForRequiredDependencies(t,a,e);if(r)return void l.add(r)}if(u){const t=u(e,this.gridOptions,this.beans);if(t)return void l.add(t)}})),l.size>0&&l.forEach((e=>{Le(e)}))}checkForRequiredDependencies(e,t,r){const n=Object.entries(t).filter((e=>{let[t,n]=e;const i=r[t];return!n.required.includes(i)}));return 0===n.length?null:n.map((t=>{let[r,n]=t;return`'${String(e)}' requires '${r}' to be one of [${n.required.map((e=>null===e?"null":void 0===e?"undefined":e)).join(", ")}]. ${n.reason??""}`})).join("\n           ")}checkProperties(e,t,r,n,i){const s=function(e,t,r){const n={},i=e.filter((e=>!t.some((t=>t===e))));i.length>0&&i.forEach((e=>n[e]=Wc({inputValue:e,allSuggestions:r}).values));return n}(Object.getOwnPropertyNames(e),["__ob__","__v_skip","__metadata__",...t,...r],r),o=Object.keys(s);for(const a of o){let e=`invalid ${n} property '${a}' did you mean any of these: ${s[a].slice(0,8).join(", ")}.`;r.includes("context")&&(e+=`\nIf you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Le(e)}if(o.length>0&&i){Le(`to see all the valid ${n} properties please check: ${this.beans.frameworkOverrides.getDocLink(i)}`)}}getConsoleMessage(e,t){return function(e,t){const r=ou[e];if(!r)return[`Missing error text for error id ${e}!`];const n=r(t),i=`\nSee ${Qe(e,t)}`;return Array.isArray(n)?n.concat(i):[n,i]}(e,t)}}]};function Cu(e){e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)}var wu={moduleName:"SharedMenu",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const{enterpriseMenuFactory:t,filterMenuFactory:r}=this.beans,n=t&&zt(this.gos)?t:r;this.showColumnMenuCommon(n,e,e.containerType,!0)}showHeaderContextMenu(e,t,r){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,r)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(zt(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){const t=e&&pr(e)?e.getColDef():e?.getColGroupDef();return!t?.suppressHeaderContextMenu&&"new"===this.gos.get("columnMenu")}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(W()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!zt(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!zt(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return zt(e)?!!e.exists("suppressMenuHide")&&t:t}showColumnMenuCommon(e,t,r,n){const{positionBy:i,onClosedCallback:s}=t,o=t.column;if("button"===i){const{buttonElement:i}=t;e?.showMenuAfterButtonClick(o,i,r,s,n)}else if("mouse"===i){const{mouseEvent:i}=t;e?.showMenuAfterMouseEvent(o,i,r,s,n)}else if(o){const t=this.beans,i=t.ctrlsSvc;i.getScrollFeature().ensureColumnVisible(o,"auto"),be(t,(()=>{const t=i.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);t&&e?.showMenuAfterButtonClick(o,t.getAnchorElementForMenu(n),r,s,!0)}))}}}],apiFunctions:{showColumnMenu:function(e,t){const r=e.colModel.getCol(t);r?e.menuSvc?.showColumnMenu({column:r,positionBy:"auto"}):tt(12,{colKey:t})},hidePopupMenu:function(e){e.menuSvc?.hidePopupMenu()}}},bu=0,yu={moduleName:"Popup",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridCtrl=e.gridCtrl})),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:r,column:n,node:i,event:s}=e,o=t.getBoundingClientRect(),a=this.getParentRect();this.setAlignedTo(t,r);let l=!1;this.positionPopup({ePopup:r,keepWithinBounds:!0,updatePosition:()=>{const e=this.keepXYWithinBounds(r,o.top-a.top,0),t=r.clientWidth>0?r.clientWidth:200;l||(r.style.minWidth=`${t}px`,l=!0);const n=a.right-a.left-t;let i;return this.gos.get("enableRtl")?(i=c(),i<0&&(i=s(),this.setAlignedStyles(r,"left")),i>n&&(i=0,this.setAlignedStyles(r,"right"))):(i=s(),i>n&&(i=c(),this.setAlignedStyles(r,"right")),i<0&&(i=0,this.setAlignedStyles(r,"left"))),{x:i,y:e};function s(){return o.right-a.left-2}function c(){return o.left-a.left-t}},postProcessCallback:()=>this.callPostProcessPopup("subMenu",r,t,s instanceof MouseEvent?s:void 0,n,i)})}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:n,skipObserver:i}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:!0,skipObserver:i,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,eventSource:s,alignSide:o="left",position:a="over",column:l,rowNode:c,type:u}=e,d=s.getBoundingClientRect(),h=this.getParentRect();this.setAlignedTo(s,t);this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,updatePosition:()=>{let r,i=d.left-h.left;if("right"===o&&(i-=t.offsetWidth-d.width),"over"===a)r=d.top-h.top,this.setAlignedStyles(t,"over");else{this.setAlignedStyles(t,"under");r="under"===this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)?d.top-h.top+d.height:d.top-t.offsetHeight-2*(n||0)-h.top}return{x:i,y:r}},postProcessCallback:()=>this.callPostProcessPopup(u,t,s,null,l,c)})}shouldRenderUnderOrAbove(e,t,r,n){const i=r.bottom-t.bottom,s=t.top-r.top,o=e.offsetHeight+n;return i>o?"under":s>o||s>i?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(-1===r)return;const n=this.popupList[r],{alignedToElement:i}=n;if(!i)return;["right","left","over","above","under"].forEach((t=>{i.classList.remove(`ag-has-popup-positioned-${t}`),e.classList.remove(`ag-popup-positioned-${t}`)})),t&&(i.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const r=this.getPopupIndex(t);if(-1!==r){this.popupList[r].alignedToElement=e}}callPostProcessPopup(e,t,r,n,i,s){const o=this.gos.getCallback("postProcessPopup");if(o){o({column:i,rowNode:s,ePopup:t,type:e,eventSource:r,mouseEvent:n})}}positionPopup(e){var t=this;const{ePopup:r,keepWithinBounds:n,nudgeX:i,nudgeY:s,skipObserver:o,updatePosition:a}=e,l={width:0,height:0},c=function(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{x:c,y:u}=a();o&&r.clientWidth===l.width&&r.clientHeight===l.height||(l.width=r.clientWidth,l.height=r.clientHeight,i&&(c+=i),s&&(u+=s),n&&(c=t.keepXYWithinBounds(r,c,1),u=t.keepXYWithinBounds(r,u,0)),r.style.left=`${c}px`,r.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(c(),!o){const e=we(this.beans,r,(()=>c(!0)));setTimeout((()=>e()),200)}}getActivePopups(){return this.popupList.map((e=>e.element))}getParentRect(){const e=mt(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),se(t)}keepXYWithinBounds(e,t,r){const n=0===r,i=n?"clientHeight":"clientWidth",s=n?"top":"left",o=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=mt(this.beans),c=l.documentElement,u=this.getPopupParent(),d=e.getBoundingClientRect(),h=u.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=u===l.body,f=Math.ceil(d[o]);let m=g?(n?ne:ie)(c)+c[a]:u[i];g&&(m-=Math.abs(p[s]-h[s]));const v=m-f;return Math.min(Math.max(t,0),Math.abs(v))}addPopup(e){const t=mt(this.beans),{eChild:r,ariaLabel:n,alwaysOnTop:i,positionCallback:s,anchorToElement:o}=e;if(!t)return et(122),{hideFunc:()=>{}};const a=this.getPopupIndex(r);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(r);const l=this.createPopupWrapper(r,n,!!i),c=this.addEventListenersToPopup({...e,wrapperEl:l});return s&&s(),this.addPopupToPopupList(r,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();xe(e.style.top)||(e.style.top=-1*t.top+"px"),xe(e.style.left)||(e.style.left=-1*t.left+"px")}createPopupWrapper(e,t,r){const n=this.getPopupParent(),{environment:i,gos:s}=this.beans,o=Re({tag:"div"});return i.applyThemeClasses(o),o.classList.add("ag-popup"),e.classList.add(s.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||b(e,"dialog"),y(e,t),o.appendChild(e),n.appendChild(o),r?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),o}handleThemeChange(e){if(e.themeChanged){const e=this.beans.environment;for(const t of this.popupList)e.applyThemeClasses(t.wrapper)}}addEventListenersToPopup(e){var t=this;const r=this.beans,n=mt(r),i=this.getPopupParent(),{wrapperEl:s,eChild:o,closedCallback:a,afterGuiAttached:l,closeOnEsc:c,modal:u}=e;let d=!1;const h=e=>{if(!s.contains(wt(r)))return;e.key!==Qn.ESCAPE||Jt(e)||f({keyboardEvent:e})},p=e=>f({mouseEvent:e}),g=e=>f({touchEvent:e}),f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mouseEvent:r,touchEvent:l,keyboardEvent:c,forceHide:u}=e;(u||!t.isEventFromCurrentPopup({mouseEvent:r,touchEvent:l},o)&&!d)&&(d=!0,i.removeChild(s),n.removeEventListener("keydown",h),n.removeEventListener("mousedown",p),n.removeEventListener("touchstart",g),n.removeEventListener("contextmenu",p),t.eventSvc.removeEventListener("dragStarted",p),a&&a(r||l||c),t.removePopupFromPopupList(o))};return l&&l({hidePopup:f}),window.setTimeout((()=>{c&&n.addEventListener("keydown",h),u&&(n.addEventListener("mousedown",p),this.eventSvc.addEventListener("dragStarted",p),n.addEventListener("touchstart",g),n.addEventListener("contextmenu",p))}),0),f}addPopupToPopupList(e,t,r,n){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:bu++,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n)}getPopupIndex(e){return this.popupList.findIndex((t=>t.element===e))}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(-1===r)return;const n=this.popupList[r];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then((e=>e&&e())),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;const i=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=i,n.isAnchored=!0,i}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter((t=>t.element!==e))}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:n,ePopup:i}=e,s=n.getBoundingClientRect(),o=e=>parseInt(e.substring(0,e.length-1),10),a=(e,t)=>{const n=r[e]-s[e],a=o(i.style[e]);return{initialDiff:n,lastDiff:n,initial:a,last:a,direction:t}},l=a("top",0),c=a("left",1),u=this.beans.frameworkOverrides;return new dn((r=>{u.wrapIncoming((()=>{u.setInterval((()=>{const r=t.getBoundingClientRect(),s=n.getBoundingClientRect();if(0==s.top&&0==s.left&&0==s.height&&0==s.width)return void e.hidePopup();const a=(e,t)=>{const n=o(i.style[t]);e.last!==n&&(e.initial=n,e.last=n);const a=r[t]-s[t];if(a!=e.lastDiff){const r=this.keepXYWithinBounds(i,e.initial+e.initialDiff-a,e.direction);i.style[t]=`${r}px`,e.last=r}e.lastDiff=a};a(l,"top"),a(c,"left")}),200).then((e=>{r((()=>{null!=e&&window.clearInterval(e)}))}))}),"popupPositioning")}))}hasAnchoredPopup(){return this.popupList.some((e=>e.isAnchored))}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:n}=e,i=r||n;if(!i)return!1;const s=this.getPopupIndex(t);if(-1===s)return!1;for(let o=s;o<this.popupList.length;o++){if(er(this.popupList[o].element,i))return!0}return this.isElementWithinCustomPopup(i.target)}isElementWithinCustomPopup(e){const t=mt(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=r.length,i=this.getWrapper(e);if(!i||n<=1||!t.contains(e))return;const s=[],o=[];for(const u of r)u!==i&&(u.classList.contains("ag-always-on-top")?o.push(u):s.push(u));const a=[],l=o.length,c=i.classList.contains("ag-always-on-top")||!l?[...s,...o,i]:[...s,i,...o];for(let u=0;u<=n;u++){const e=c[u];if(r[u]===c[u]||e===i)continue;e.querySelectorAll("div").forEach((e=>{0!==e.scrollTop&&a.push([e,e.scrollTop])})),0===u?t.insertAdjacentElement("afterbegin",e):c[u-1].insertAdjacentElement("afterend",e)}for(;a.length;){const e=a.pop();e[0].scrollTop=e[1]}}}]};var Su={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},Eu=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ru(e,t){return null==e?-1:null==t?1:parseFloat(e)-parseFloat(t)}function Tu(e,t){return e?new dn((r=>{e.then((e=>{"function"!==typeof e.setModel&&(et(65),r()),(e.setModel(t)||dn.resolve()).then((()=>r()))}))})):dn.resolve()}function xu(e){return"agGroupColumnFilter"===e.getColDef().filter}function ku(e){return e instanceof Date&&!isNaN(e.getTime())}var Pu=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}mapCustomOptions(){const{filterOptions:e}=this;e&&e.forEach((t=>{if("string"===typeof t)return;[["displayKey"],["displayName"],["predicate","test"]].every((e=>!!e.some((e=>null!=t[e]))||(et(72,{keys:e}),!1)))?this.customFilterOptions[t.displayKey]=t:this.filterOptions=e.filter((e=>e===t))||[]}))}selectDefaultItem(e){const{filterOptions:t}=this;if(e.defaultOption)this.defaultOption=e.defaultOption;else if(t.length>=1){const e=t[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:et(73)}else et(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Au(e,t,r){return null==r?e.splice(t):e.splice(t,r)}function Fu(e){return null==e||"string"===typeof e&&0===e.trim().length}var Du=class extends Qi{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:"inRange"===e?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach(((t,r)=>{const n=0===r?e:this.optionsFactory.defaultOption;t.setValue(n,!0)}))}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map((e=>e.getValue()))}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOperatorsOr:e,defaultJoinOperator:t}=this;return 0===e.length?t:!0===e[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const r=!e.operator,n=!t.operator;if(!r&&n||r&&!n)return!1;let i;if(r){const r=e,n=t;i=this.areSimpleModelsEqual(r,n)}else{const r=e,n=t;i=r.operator===n.operator&&yr(r.conditions,n.conditions,((e,t)=>this.areSimpleModelsEqual(e,t)))}return i}shouldRefresh(e){const t=this.getModel(),r=t?t.conditions??[t]:null,n=e.filterOptions?.map((e=>"string"===typeof e?e:e.displayKey))??this.getDefaultFilterOptions();return!(r&&!r.every((e=>void 0!==n.find((t=>t===e.type)))))&&!("number"===typeof e.maxNumConditions&&r&&r.length>e.maxNumConditions)}refresh(e){if(!this.shouldRefresh(e))return!1;return!!super.refresh(e)&&(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const t=e;let r=t.conditions;null==r&&(r=[],et(77));const n=function(e,t){let r=e.length;return r>t&&(e.splice(t),et(78),r=t),r}(r,this.maxNumConditions),i=this.getNumConditions();if(n<i)this.removeConditionsAndOperators(n);else if(n>i)for(let e=i;e<n;e++)this.createJoinOperatorPanel(),this.createOption();const s="OR"===t.operator;this.eJoinOperatorsAnd.forEach((e=>e.setValue(!s,!0))),this.eJoinOperatorsOr.forEach((e=>e.setValue(s,!0))),r.forEach(((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)}))}else{const t=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(t.type,!0),this.setConditionIntoUi(t,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),dn.resolve()}doesFilterPass(e){const t=this.getModel();if(null==t)return!0;const{operator:r}=t,n=[];if(r){const e=t;n.push(...e.conditions??[])}else n.push(t);return n[r&&"OR"===r?"some":"every"]((t=>this.individualConditionPasses(e,t)))}setParams(e){var t;super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator="AND"===(t=e.defaultJoinOperator)||"OR"===t?t:"AND",this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Pu,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(et(79),t=1),this.maxNumConditions=t;let r=e.numAlwaysVisibleConditions??1;r<1&&(et(80),r=1),r>t&&(et(81),r=t),this.numAlwaysVisibleConditions=r}createOption(){const e=this.createManagedBean(new _o);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const r=this.getNumConditions()-1;this.forEachPositionInput(r,(e=>this.resetInput(e))),this.addChangedListeners(e,r)}createJoinOperatorPanel(){const e=Re({tag:"div",cls:"ag-filter-condition"});this.eJoinOperatorPanels.push(e);const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),r=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const n=this.eJoinOperatorPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,i),this.resetJoinOperatorOr(r,n,i),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const n=this.createManagedBean(new xo);e.push(n);const i="ag-filter-condition-operator";return n.addCssClass(i),n.addCssClass(`${i}-${r}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map((e=>"string"===typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e)))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;t.forEach((t=>{e.addOption(t)})),e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const t=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<t){this.removeConditionsAndOperators(t+1);const r=e+1,n=t-r;n>0&&this.removeConditionsAndOperators(r,n),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach(((t,r)=>{const n=this.isConditionDisabled(r,e);t.setDisabled(n||this.filterListOptions.length<=1),1===r&&(Q(this.eJoinOperatorPanels[0],n),this.eJoinOperatorsAnd[0].setDisabled(n),this.eJoinOperatorsOr[0].setDisabled(n))})),this.eConditionBodies.forEach(((e,t)=>{X(e,this.isConditionBodyVisible(t))}));const r="OR"===(t??this.getJoinOperator());this.eJoinOperatorsAnd.forEach((e=>{e.setValue(!r,!0)})),this.eJoinOperatorsOr.forEach((e=>{e.setValue(r,!0)})),this.forEachInput(((t,r,n,i)=>{this.setElementDisplayed(t,r<i),this.setElementDisabled(t,this.isConditionDisabled(n,e))})),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:r,eConditionBodies:n,eJoinOperatorPanels:i,eJoinOperatorsAnd:s,eJoinOperatorsOr:o}=this;this.removeComponents(r,e,t),this.removeElements(n,e,t),this.removeValueElements(e,t);const a=Math.max(e-1,0);this.removeElements(i,a,t),this.removeComponents(s,a,t),this.removeComponents(o,a,t)}removeElements(e,t,r){Au(e,t,r).forEach((e=>ce(e)))}removeComponents(e,t,r){Au(e,t,r).forEach((e=>{ce(e.getGui()),this.destroyBean(e)}))}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){const{eFilterBody:e,eTypes:t}=this;let r;if(!this.isReadOnly()){const e=this.getInputs(0)[0];r=e instanceof yo&&this.isConditionBodyVisible(0)?e.getInputElement():t[0]?.getFocusableElement()}(r??e).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,r=-1,n=!1;const i=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))-1===t&&(t=o,r=o);else{const e=o<t;(o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1)||e)&&(this.removeConditionsAndOperators(o,1),n=!0,e&&r--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(r,i),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getPlaceholderText(e,t){let r=this.translate(e);if("function"===typeof this.filterPlaceholder){const e=this.eTypes[t].getValue(),n=this.translate(e);r=this.filterPlaceholder({filterOptionKey:e,filterOption:n,placeholder:r})}else"string"===typeof this.filterPlaceholder&&(r=this.filterPlaceholder);return r}resetPlaceholder(){const e=this.getLocaleTextFunc();this.forEachInput(((t,r,n,i)=>{if(!(t instanceof yo))return;const s=0===r&&i>1?"inRangeStart":0===r?"filterOoo":"inRangeEnd",o=0===r&&i>1?e("ariaFilterFromValue","Filter from value"):0===r?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,n)),t.setInputAriaLabel(o)}))}setElementValue(e,t,r){e instanceof yo&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof un&&X(e.getGui(),t)}setElementDisabled(e,t){e instanceof un&&Q(e.getGui(),t)}attachElementOnChange(e,t){e instanceof yo&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach(((t,r)=>{this.forEachPositionTypeInput(r,t,e)}))}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const n=this.getNumberOfInputs(t),i=this.getInputs(e);for(let s=0;s<i.length;s++){const t=i[s];null!=t&&r(t,s,e,n)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return"empty"!==this.getConditionType(e)&&!this.getValues(e).some((e=>null==e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((e=>this.resetType(e))),this.eJoinOperatorsAnd.forEach(((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t))),this.eJoinOperatorsOr.forEach(((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t))),this.joinOperatorId++,this.forEachInput((e=>this.resetInput(e))),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),dn.resolve()}resetType(e){const t=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,"AND"===this.defaultJoinOperator,this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,"OR"===this.defaultJoinOperator,this.translate("orCondition"),r)}resetJoinOperator(e,t,r,n,i){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${i}`).setLabel(n),t)}updateJoinOperatorsDisabled(){const e=(e,t)=>this.updateJoinOperatorDisabled(e,t);this.eJoinOperatorsAnd.forEach(e),this.eJoinOperatorsOr.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e);this.forEachInput(((e,n,i)=>{i===t&&this.setElementValue(e,null!=r[n]?r[n]:null)}))}setValueFromFloatingFilter(e){this.forEachInput(((t,r,n)=>{this.setElementValue(t,0===r&&0===n?e:null,!0)}))}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,(e=>{this.attachElementOnChange(e,this.listener)})))}individualConditionPasses(e,t){const r=this.getCellValue(e.node),n=this.mapValuesFromModel(t),i=function(e,t,r){if(null==e)return;const{predicate:n}=e;return null==n||t.some((e=>null==e))?void 0:n(t,r)}(this.optionsFactory.getCustomOption(t.type),n,r);return null!=i?i:null==r?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,r,t,e)}hasInvalidInputs(){return!1}},Iu=class extends Du{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:r,includeBlanksInGreaterThan:n,includeBlanksInLessThan:i,includeBlanksInRange:s}=this.scalarFilterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(r)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(i)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const n=r.type;if(!this.isValid(t))return"notEqual"===n||"notBlank"===n;const i=this.comparator(),s=null!=e[0]?i(e[0],t):0;switch(n){case"equals":return 0===s;case"notEqual":return 0!==s;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const r=i(e[1],t);return this.scalarFilterParams.inRangeInclusive?s>=0&&r<=0:s>0&&r<0}case"blank":return Fu(t);case"notBlank":return!Fu(t);default:return et(76,{filterModelType:n}),!0}}},Mu=class{constructor(e,t,r){this.getLocaleTextFunc=e,this.optionsFactory=t,this.valueFormatter=r}getModelAsString(e){if(!e)return null;const t=null!=e.operator,r=this.getLocaleTextFunc();if(t){const t=e,n=(t.conditions??[]).map((e=>this.getModelAsString(e))),i="AND"===t.operator?"andCondition":"orCondition";return n.join(` ${r(i,qi[i])} `)}if("blank"===e.type||"notBlank"===e.type)return r(e.type,e.type);{const t=e,n=this.optionsFactory.getCustomOption(t.type),{displayKey:i,displayName:s,numberOfInputs:o}=n||{};return i&&s&&0===o?(r(i,s),s):this.conditionToString(t,n)}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}};var Ou=class extends un{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.defaultOption);let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=new Pu;this.optionsFactory=r,r.init(e.filterParams,this.getDefaultOptions());const n=r.defaultOption;t||(this.lastType=n),this.readOnly=!!e.filterParams.readOnly;const i=this.isTypeEditable(n);this.setEditable(i)}refresh(e){this.setSimpleParams(e)}hasSingleInput(e){const t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return null==t||1==t}isTypeEditable(e){return!!e&&!this.readOnly&&this.hasSingleInput(e)&&["inRange","empty","blank","notBlank"].indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Lu=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],Nu=class extends Mu{conditionToString(e,t){const{numberOfInputs:r}=t||{},{filter:n,filterTo:i,type:s}=e,o="inRange"==s||2===r,a=this.formatValue.bind(this);return o?`${a(n)}-${a(i)}`:null!=n?a(n):`${s}`}};function _u(e){const{allowedCharPattern:t}=e??{};return t??null}var Gu=class extends rr{constructor(e){super(),this.params=e,this.eInput=cn,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new ko(this.params?.config));const t=this.eInput.getGui();e.appendChild(t);const r=e=>this.onValueChanged(e);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams(e){let{ariaLabel:t,autoComplete:r}=e;const{eInput:n}=this;n.setInputAriaLabel(t),void 0!==r&&n.setAutoComplete(r)}};function Bu(e){const t=e?.trim();return""===t?e:t}var Hu={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},zu=class extends Ou{constructor(){super(...arguments),this.eFloatingFilterInputContainer=cn,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(Hu)}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1,{inputSvc:r,defaultDebounceMs:n,readOnly:i}=this;if(r.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Ji(e.filterParams),!i){const t=Xi(e.filterParams,n),i=He(this,this.syncUpWithParentFilter.bind(this),t);r.setValueChangedListener(i)}}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,r=t.getValue();le(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(r,!0)}syncUpWithParentFilter(e){const t=e.key===Qn.ENTER;if(this.applyActive&&!t)return;const{inputSvc:r,params:n}=this;let i=r.getValue();n.filterParams.trimInput&&(i=Bu(i),r.setValue(i,!0)),n.parentFilterInstance((e=>{e?.onFloatingFilterChanged(this.lastType||null,i||null)}))}setEditable(e){this.inputSvc.setEditable(e)}},Vu=class extends rr{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new Ao),this.eTextInput=this.createManagedBean(new ko),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),r=this.eTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,(e=>this.onValueChanged(e))),this.setupListeners(r,(e=>this.onValueChanged(e)))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},Wu=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Uu=class extends Mu{conditionToString(e,t){const{numberOfInputs:r}=t||{},{filter:n,filterTo:i,type:s}=e;return"inRange"==s||2===r?`${n}-${i}`:null!=n?`${n}`:`${s}`}};var ju={moduleName:"ClientSideRowModelFilter",version:We,rowModels:["clientSide"],beans:[class extends rr{constructor(){super(...arguments),this.beanName="filterStage",this.refreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),this.step="filter"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const r=(t,r)=>{t.hasChildren()?t.childrenAfterFilter=e&&!r?t.childrenAfterGroup.filter((e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,r=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||r})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,Cu(t)};if(this.doingTreeDataFiltering()){const e=(t,n)=>{if(t.childrenAfterGroup)for(let i=0;i<t.childrenAfterGroup.length;i++){const s=t.childrenAfterGroup[i],o=n||this.filterManager.doesRowPassFilter({rowNode:s});s.childrenAfterGroup?e(t.childrenAfterGroup[i],o):r(s,o)}r(t,n)},n=t=>e(t,!1);t.executeFromRootNode(n)}else{const e=e=>r(e,!1);t.forEachChangedNodeDepthFirst(e,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}}]},$u={moduleName:"FilterCore",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:e=>{let{enabled:t}=e;return this.onAdvFilterEnabledChanged(t)},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],(()=>{this.onFilterChanged({source:"api"})})),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(()=>{this.updateAggFiltering(),this.onFilterChanged()})),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:r}=this;this.alwaysPassFilter=r.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",(()=>{this.alwaysPassFilter=r.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})}))}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return"function"===typeof t&&t(e)}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.isAdvFilterEnabled()?this.warnAdvFilters():this.colFilter?.setFilterModel(e,t)}getFilterModel(){return this.colFilter?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.colFilter?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggregateFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){xt(this.gos)&&this.onFilterChanged()}onFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{source:t,additionalEventAttributes:r,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):dn.resolve()).then((()=>{const e={source:t,type:"filterChanged",columns:n};r&&ir(e,r),this.eventSvc.dispatchEvent(e),this.colFilter?.updateAfterFilterChanged()}))}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!xt(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){const{rowNode:t}=e;return!!this.alwaysPassFilter?.(t)||!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t))&&!(this.isAggregateFilterPresent()&&!this.colFilter.doAggregateFiltersPass(t,e.filterInstanceToSkip))}doesRowPassFilter(e){const{rowNode:t}=e;return!!this.alwaysPassFilter?.(t)||!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t))&&(!(this.externalFilterPresent&&!this.doesExternalFilterPass(t))&&(!(this.isColumnFilterPresent()&&!this.colFilter.doColumnFiltersPass(t,e.filterInstanceToSkip))&&!(this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))))}isFilterActive(e){return!!this.colFilter?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.colFilter?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.colFilter.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.colFilter.createFilterParams(e,t)}isFilterAllowed(e){return!this.isAdvFilterEnabled()&&!!this.colFilter?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.colFilter?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.colFilter?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.colFilter?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.colFilter?.areFilterCompsDifferent(e,t)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.isAdvFilterEnabled()&&(this.beans.dataTypeSvc?.isPendingInference?this.advFilterModelUpdateQueue.push(e):(this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})))}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return!this.isAdvFilterEnabled()&&!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){et(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advFilterModelUpdateQueue.forEach((e=>this.setAdvFilterModel(e))),this.advFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.colFilter?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,r){this.colFilter?.setColDefPropertiesForDataType(e,t,r)}}],apiFunctions:{isAnyFilterPresent:function(e){return!!e.filterManager?.isAnyFilterPresent()},onFilterChanged:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e.filterManager?.onFilterChanged({source:t})}},css:[".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input [disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:1px solid var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}"],dependsOn:[ju]},Ku={moduleName:"FilterValue",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t){if(!t)return;const r=e.getColDef(),{filterValueGetter:n}=r;return n?this.executeFilterValueGetter(n,t.data,e,t,r):this.beans.valueSvc.getValue(e,t)}executeFilterValueGetter(e,t,r,n,i){const{expressionSvc:s,valueSvc:o}=this.beans,a=Ut(this.gos,{data:t,node:n,column:r,colDef:i,getValue:o.getValueCallback.bind(o,n)});return"function"===typeof e?e(a):s?.evaluate(e,a)}}]},Yu={moduleName:"ColumnFilter",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),beforeRefreshModel:e=>{let{params:t}=e;(t.rowDataUpdated||t.changedProps?.has("treeData"))&&this.onNewRowsLoaded("rowDataUpdated")},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const{colModel:r,dataTypeSvc:n,filterManager:i}=this.beans;if(n?.isPendingInference)return void this.filterModelUpdateQueue.push({model:e,source:t});const s=[],o=this.getFilterModel(!0);if(e){const t=new Set(Object.keys(e));this.allColumnFilters.forEach(((r,n)=>{const i=e[n];s.push(Tu(r.filterPromise,i)),t.delete(n)})),t.forEach((t=>{const n=r.getColDefCol(t)||r.getCol(t);if(!n)return void et(62,{colId:t});if(!n.isFilterAllowed())return void et(63,{colId:t});const i=this.getOrCreateFilterWrapper(n);i?s.push(Tu(i.filterPromise,e[t])):et(64,{colId:t})}))}else this.allColumnFilters.forEach((e=>{s.push(Tu(e.filterPromise,null))}));dn.all(s).then((()=>{const e=this.getFilterModel(!0),r=[];this.allColumnFilters.forEach(((t,n)=>{Ae(o?o[n]:null,e?e[n]:null)||r.push(t.column)})),r.length>0&&i?.onFilterChanged({columns:r,source:t})}))}getFilterModel(e){const t={},{allColumnFilters:r,initialFilterModel:n,beans:{colModel:i}}=this;if(r.forEach(((e,r)=>{const n=this.getModelFromFilterWrapper(e);xe(n)&&(t[r]=n)})),!e)for(const s of Object.keys(n)){const e=n[s];xe(e)&&!r.has(s)&&i.getCol(s)?.isFilterAllowed()&&(t[s]=e)}return t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?"function"!==typeof t.getModel?(et(66),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){this.initialFilterModel={};const{allColumnFilters:e}=this;return!!e.size&&(e.forEach((e=>this.disposeFilterWrapper(e,"advancedFilterEnabled"))),!0)}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const{colModel:e,gos:t}=this.beans,r=!!xt(t),n=[],i=[];return this.forEachColumnFilter(((t,s)=>{const o=(e=>!!e&&(e.isFilterActive?e.isFilterActive():(et(67),!1)))(t);o&&((t=>{if(!t.isPrimary())return!0;const n=!e.isPivotActive();return!(!t.isValueActive()||!n)&&(!!e.isPivotMode()||r)})(s.column)?n.push(t):i.push(t))})).then((()=>{this.activeAggregateFilters=n,this.activeColumnFilters=i}))}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter(((r,n)=>this.setColFilterActive(n.column,r.isFilterActive(),e,t)))}forEachColumnFilter(e){const t=[];return this.allColumnFilters.forEach((r=>{const n=r.filterPromise;n&&t.push(n.then((t=>e(t,r))))})),dn.all(t)}doColumnFiltersPass(e,t,r){const{data:n,aggData:i}=e,s=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?i:n;for(let a=0;a<s.length;a++){const r=s[a];if(null!=r&&r!==t)if("function"===typeof r.doesFilterPass){if(!r.doesFilterPass({node:e,data:o}))return!1}else tt(91)}return!0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:r}=this.beans,n=()=>{this.isAlive()&&r?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{filterInstance:t,additionalEventAttributes:r}=e;return this.updateDependentFilters(),this.updateActiveFilters().then((()=>this.updateFilterFlagInColumns("filterChanged",r).then((()=>{this.allColumnFilters.forEach((e=>{e.filterPromise&&e.filterPromise.then((e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()}))})),this.processingFilterChange=!0}))))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter((e=>{e.onNewRowsLoaded?.()})).then((()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0}))).then((()=>this.updateActiveFilters()))}createGetValue(e){const{filterValueSvc:t,colModel:r}=this.beans;return(n,i)=>{const s=i?r.getCol(i):e;return s?t.getValue(s,n):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():null!=this.getModelFromInitialState(e)}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;const{gos:r,dataTypeSvc:n}=this.beans;if(Ht(r))t="agSetColumnFilter";else{const r=n?.getBaseDataType(e);t="number"===r?"agNumberColumnFilter":"date"===r||"dateString"===r?"agDateColumnFilter":"agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;const{gos:r,dataTypeSvc:n}=this.beans;if(Ht(r))t="agSetColumnFloatingFilter";else{const r=n?.getBaseDataType(e);t="number"===r?"agNumberColumnFloatingFilter":"date"===r||"dateString"===r?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const r=this.getDefaultFilter(e),n=e.getColDef();let i;const s={...this.createFilterParams(e,n),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(i,e)(),filterChangedCallback:t=>this.filterChangedCallbackFactory(i,e)(t),doesRowPassOtherFilter:e=>this.beans.filterManager?.doesRowPassOtherFilters(i,e)??!0},o=Mn(this.beans.userCompFactory,n,s,r);return o?{filterPromise:()=>{const e=o.newAgStackInstance();return e.then((e=>{i=e,t&&(t.filter=e??void 0)})),e},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return Ut(this.gos,{column:e,colDef:t,rowModel:this.beans.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compDetails:null},{filterPromise:r,compDetails:n}=this.createFilterInstance(e,t);return t.filterPromise=r?.()??null,t.compDetails=n,t}onColumnsChanged(){const e=[],{colModel:t,filterManager:r}=this.beans;this.allColumnFilters.forEach(((r,n)=>{let i;i=r.column.isPrimary()?t.getColDefCol(n):t.getCol(n),i&&i===r.column||(e.push(r.column),this.disposeFilterWrapper(r,"columnChanged"),this.disposeColumnListener(n))}));const n=e.every(xu);e.length>0&&!n?r?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){this.beans.autoColSvc?.getColumns()?.forEach((e=>{xu(e)&&this.getOrCreateFilterWrapper(e)}))}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:t}=this.allColumnFilters.get(e.getColId())??{};return!t||("function"!==typeof t?.isFilterAllowed||t.isFilterAllowed())}getFloatingFilterCompDetails(e,t){const r=t=>{const r=this.getOrCreateFilterWrapper(e)?.filterPromise;null!=r&&r.then((e=>{t(Ln(e))}))},n=e.getColDef(),i={...this.createFilterParams(e,n),filterChangedCallback:()=>r((t=>this.filterChangedCallbackFactory(t,e)()))},{userCompFactory:s,frameworkOverrides:o}=this.beans,a=function(e,t,r){return e.mergeParams(t,Rn,r)}(s,n,i);let l=Zi(o,n,(()=>this.getDefaultFloatingFilter(e)));null==l&&(l="agReadOnlyFloatingFilter");return On(s,n,Ut(this.gos,{column:e,filterParams:a,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:r,showParentFilter:t}),l)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const r=e.getColId(),n=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialFilterModel[r],n&&this.disposeFilterWrapper(n,t).then((t=>{t&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){return e.filterPromise?.then((r=>{const n=!!r?.isFilterActive();return this.destroyBean(r),this.setColFilterActive(e.column,!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:e.column}),n}))??dn.resolve(!1)}filterModifiedCallbackFactory(e,t){return()=>{this.eventSvc.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return r=>{const n={filter:e,additionalEventAttributes:r,columns:[t],source:r?.source??"columnFilter"};this.callOnFilterChangedOutsideRenderCycle(n)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const r=t.column,{compDetails:n}=r.isFilterAllowed()?this.createFilterInstance(r):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,n))return void this.destroyFilter(r,"paramsUpdated");const i=r.getColDef().filterParams;t.filterPromise?t.filterPromise.then((e=>{!1===(!e?.refresh||e.refresh({...this.createFilterParams(r,r.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(e,r),filterChangedCallback:this.filterChangedCallbackFactory(e,r),doesRowPassOtherFilter:t=>this.beans.filterManager?.doesRowPassOtherFilters(e,t)??!0,...i}))&&this.destroyFilter(r,"paramsUpdated")})):this.destroyFilter(r,"paramsUpdated")}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:n}=t;return!(r===n||r?.render&&n?.render&&r.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some((e=>e.getColDef().floatingFilter))}getColumnFilterInstance(e){return new Promise((t=>{this.getFilterInstanceImpl(e).then((e=>{t(Ln(e))}))}))}getFilterInstanceImpl(e){const t=this.beans.colModel.getColDefCol(e);if(!t)return dn.resolve(void 0);const r=this.getOrCreateFilterWrapper(t)?.filterPromise;return r??dn.resolve(null)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach((e=>{let{model:t,source:r}=e;return this.setFilterModel(t,r)})),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach((e=>{let{key:t,model:r,resolve:n}=e;this.setColumnFilterModel(t,r).then((()=>n()))})),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){const{colModel:r,dataTypeSvc:n}=this.beans;if(n?.isPendingInference){let r=()=>{};const n=new Promise((e=>{r=e}));return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:r}),n}const i=r.getColDefCol(e),s=i?this.getOrCreateFilterWrapper(i):null;return s?(o=Tu(s.filterPromise,t),new Promise((e=>{o.then((t=>e(t)))}))):Promise.resolve();var o}getFilterWrapper(e){const t=this.beans.colModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,r){const n=Ht(this.gos),i=this.getLocaleTextFunc(),s=t=>{const{filterParams:r}=e;e.filterParams="object"===typeof r?{...r,...t}:t};switch(t.baseDataType){case"number":n&&s({comparator:Ru});break;case"boolean":s(n?{valueFormatter:e=>xe(e.value)?i(String(e.value),e.value?"True":"False"):i("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":s(n?{valueFormatter:e=>{const t=r(e);return xe(t)?t:i("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if("NaN"===e)return i("invalidDate","Invalid Date");if(1===t&&null!=e){const t=Eu[Number(e)-1];return i(t,Su[t])}return e??i("blanks","(Blanks)")}}:{isValidDate:ku});break;case"dateString":{const e=t.dateParser;s(n?{valueFormatter:e=>{const t=r(e);return xe(t)?t:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:t=>{const r=e(t??void 0);return r?[String(r.getFullYear()),String(r.getMonth()+1),String(r.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=Eu[Number(e)-1];return i(t,Su[t])}return e??i("blanks","(Blanks)")}}:{comparator:(t,r)=>{const n=e(r);return null==r||n<t?-1:n>t?1:0},isValidDate:t=>"string"===typeof t&&ku(e(t))});break}case"object":n?s({valueFormatter:e=>{const t=r(e);return xe(t)?t:i("blanks","(Blanks)")}}):e.filterValueGetter=e=>r({column:e.column,node:e.node,value:this.beans.valueSvc.getValue(e.column,e.node)})}}setColFilterActive(e,t,r,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",r)),e.dispatchColEvent("filterChanged",r,n)}destroy(){super.destroy(),this.allColumnFilters.forEach((e=>this.disposeFilterWrapper(e,"gridDestroyed"))),this.allColumnListeners.clear()}},class extends rr{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,r,n){this.showPopup(e,(n=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:r,mouseEvent:t,ePopup:n})}),r,t.target,zt(this.gos),n)}showMenuAfterButtonClick(e,t,r,n){let i=-1,s="left";const o=zt(this.gos);!o&&this.gos.get("enableRtl")&&(i=1,s="right");const a=o?void 0:4*i,l=o?void 0:4;this.showPopup(e,(n=>{this.popupSvc?.positionPopupByComponent({type:r,eventSource:t,ePopup:n,nudgeX:a,nudgeY:l,alignSide:s,keepWithinBounds:!0,position:"under",column:e})}),r,t,o,n)}showPopup(e,t,r,n,i,s){const o=e?this.createBean(new Vi(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e)return void tt(57);const a=Re({tag:"div",cls:"ag-menu"+(i?"":" ag-filter-menu"),role:"presentation"});let l;[this.tabListener]=this.addManagedElementListeners(a,{keydown:e=>this.trapFocusWithin(e,a)}),a.appendChild(o?.getGui());const c=Vt(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,u=this.getLocaleTextFunc(),d=i&&"columnFilter"!==r?u("ariaLabelColumnMenu","Column Menu"):u("ariaLabelColumnFilter","Column Filter"),h=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:t=>{ho(e,!1,"contextMenu");const i=t instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),i&&n&&de(n)){const e=li(n);e?.focus({preventScroll:!0})}o?.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e),s?.()},positionCallback:()=>t(a),anchorToElement:c,ariaLabel:d});h&&(this.hidePopup=l=h.hideFunc),o.afterInit().then((()=>{t(a),o.afterGuiAttached({container:r,hidePopup:l})})),ho(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==Qn.TAB||e.defaultPrevented||ai(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),oi(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}}],dynamicBeans:{headerFilterCellCtrl:class extends so{constructor(){super(...arguments),this.iconCreated=!1}setComp(e,t,r,n,i){this.comp=e;const s=on(this,this.beans.context,i);this.eButtonShowMainFilter=r,this.eFloatingFilterBody=n,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s),s.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(s)}),s.addDestroyFunc((()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()}))}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return Ut(t.gos,{colDef:r,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,r=!!e.floatingFilter;this.active=t&&r}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=vo("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Yi(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();y(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){const{beans:t}=this;if(wt(t)===this.eGui)return;const r=ai(t,this.eGui,null,e.shiftKey);if(r)return t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),void r.focus();const n=this.findNextColumnWithFloatingFilter(e.shiftKey);n&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:n},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let r=this.column;do{if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break}while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case Qn.UP:case Qn.DOWN:t||e.preventDefault();case Qn.LEFT:case Qn.RIGHT:if(t)return;e.stopPropagation();case Qn.ENTER:t&&oi(this.eGui)&&e.preventDefault();break;case Qn.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),r=!!e.relatedTarget&&Z(e.relatedTarget,"ag-floating-filter");if(t&&r&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==Qn.TAB);if(e&&t){const t=e.shiftKey;oi(this.eGui,t)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new ro(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!zt(this.gos)}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter()));e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,r=e=>{if("filterDestroyed"===e?.source&&!this.isAlive())return;const r=this.comp.getFloatingFilterComp();r&&r.then((r=>{if(r){const n=t?.getCurrentFloatingFilterParentModel(this.column),i=e?{...e,columns:e.columns??[],source:"api"===e.source?"api":"columnFilter"}:null;r.onParentModelChanged(n,i)}}))};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:r}),t?.isFilterActive(this.column)&&r(null)}setupWidth(e){const t=()=>{const e=`${this.column.getActualWidth()}px`;this.comp.setWidth(e)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const r=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const n=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter())):null,i=this.comp.getFloatingFilterComp();i&&n?i.then((t=>{!t||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,n)?this.updateCompDetails(e,n,r):this.updateFloatingFilterParams(n)})):this.updateCompDetails(e,n,r)}updateCompDetails(e,t,r){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),r&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then((e=>{e?.refresh&&"function"===typeof e.refresh&&e.refresh(t)}))}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}}},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:function(e){const t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()},getColumnFilterInstance:function(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)},destroyFilter:function(e,t){const r=e.colModel.getColDefCol(t);if(r)return e.filterManager?.destroyFilter(r,"api")},setFilterModel:function(e,t){e.frameworkOverrides.wrapIncoming((()=>e.filterManager?.setFilterModel(t)))},getFilterModel:function(e){return e.filterManager?.getFilterModel()??{}},getColumnFilterModel:function(e,t){return e.filterManager?.getColumnFilterModel(t)??null},setColumnFilterModel:function(e,t,r){return e.filterManager?.setColumnFilterModel(t,r)??Promise.resolve()},showColumnFilter:function(e,t){const r=e.colModel.getCol(t);r?e.menuSvc?.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"}):tt(12,{colKey:t})}},dependsOn:[$u,yu,Ku,wu]},qu={moduleName:"TextFilter",version:We,dependsOn:[Yu],userComponents:{agTextColumnFilter:class extends Du{constructor(){super("textFilter"),this.filterType="text",this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>null==e?null:e.toString().toLowerCase(),this.defaultMatcher=e=>{let{filterOption:t,value:r,filterText:n}=e;if(null==n)return!1;switch(t){case"contains":return r.indexOf(n)>=0;case"notContains":return r.indexOf(n)<0;case"equals":return r===n;case"notEqual":return r!=n;case"startsWith":return 0===r.indexOf(n);case"endsWith":{const e=r.lastIndexOf(n);return e>=0&&e===r.length-n.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=e.textMatcher||this.defaultMatcher,this.formatter=e.textFormatter||(e.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new Uu(this.getLocaleTextFunc.bind(this),this.optionsFactory)}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValuesWithSideEffects(e,!0);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const r=[];return this.forEachPositionInput(e,((e,n,i,s)=>{if(n<s){let n=Te(e.getValue());t&&this.textFilterParams.trimInput&&(n=Bu(n)??null,e.setValue(n,!0)),r.push(n)}})),r}getDefaultFilterOptions(){return Wu}createValueElement(){const e=Re({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,r){const n=this.createManagedBean(new ko);n.addCssClass(`ag-filter-${r}`),n.addCssClass("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeValueElements(e,t){const r=r=>this.removeComponents(r,e,t);r(this.eValuesFrom),r(this.eValuesTo)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:n}=e||{};return[t||null,r||null].slice(0,this.getNumberOfInputs(n))}evaluateNullValue(e){return!!e&&["notEqual","notContains","blank"].indexOf(e)>=0}evaluateNonNullValue(e,t,r,n){const i=e.map((e=>this.formatter(e)))||[],s=this.formatter(t),{api:o,colDef:a,column:l,context:c,textFormatter:u}=this.textFilterParams;if("blank"===r.type)return Fu(t);if("notBlank"===r.type)return!Fu(t);const d={api:o,colDef:a,column:l,context:c,node:n.node,data:n.data,filterOption:r.type,value:s,textFormatter:u};return i.some((e=>this.matcher({...d,filterText:e})))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}},agTextColumnFloatingFilter:class extends zu{init(e){super.init(e),this.filterModelFormatter=new Uu(this.getLocaleTextFunc.bind(this),this.optionsFactory)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return Wu}createFloatingFilterInputService(){return this.createManagedBean(new Gu)}}}},Xu={moduleName:"NumberFilter",version:We,dependsOn:[Yu],userComponents:{agNumberColumnFilter:class extends Iu{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}refresh(e){return this.numberFilterParams.allowedCharPattern===e.allowedCharPattern&&super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:r,type:n}=e||{};return[this.processValue(t),this.processValue(r)].slice(0,this.getNumberOfInputs(n))}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new Nu(this.getLocaleTextFunc.bind(this),this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return Lu}setElementValue(e,t,r){const{numberFormatter:n}=this.numberFilterParams,i=!r&&n?n(t??null):t;super.setElementValue(e,i)}createValueElement(){const e=_u(this.numberFilterParams),t=Re({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,r,n){const i=this.createManagedBean(n?new ko({allowedCharPattern:n}):new Ao);i.addCssClass(`ag-filter-${r}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){const r=r=>this.removeComponents(r,e,t);r(this.eValuesFrom),r(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,((e,r,n,i)=>{r<i&&t.push(this.processValue(this.stringToFloat(e.getValue())))})),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"===typeof e)return e;let t=Te(e);null!=t&&""===t.trim()&&(t=null);const r=this.numberFilterParams.numberParser;return r?r(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput((t=>{t.getInputElement().validity.valid||(e=!0)})),e}},agNumberColumnFloatingFilter:class extends zu{init(e){super.init(e),this.filterModelFormatter=new Nu(this.getLocaleTextFunc.bind(this),this.optionsFactory,e.filterParams?.numberFormatter)}refresh(e){_u(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultOptions(){return Lu}createFloatingFilterInputService(e){return this.allowedCharPattern=_u(e.filterParams),this.allowedCharPattern?this.createManagedBean(new Gu({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Vu)}}}},Ju=class extends jo{constructor(e){super({tag:"div",cls:"ag-cell-edit-wrapper",children:[e.getTemplate()]},e.getAgComponents()),this.cellEditorInput=e,this.eInput=cn}init(e){this.params=e;const{cellStartedEdit:t,eventKey:r,suppressPreventDefault:n}=e,i=this.eInput;let s;this.cellEditorInput.init(i,e);let o=!0;t?(this.focusAfterAttached=!0,r===Qn.BACKSPACE||r===Qn.DELETE?s="":r&&1===r.length?n?o=!1:s=r:(s=this.cellEditorInput.getStartValue(),r!==Qn.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue()),o&&null!=s&&i.setStartValue(s),this.addManagedElementListeners(i.getGui(),{keydown:e=>{const{key:t}=e;t!==Qn.PAGE_UP&&t!==Qn.PAGE_DOWN||e.preventDefault()}})}afterGuiAttached(){const e=this.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;H()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},Qu={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eSelect",cls:"ag-cell-editor"}]},Zu={tag:"ag-input-text-field",ref:"eInput",cls:"ag-cell-editor"},ed=class{getTemplate(){return Zu}getAgComponents(){return[Po]}init(e,t){this.eInput=e,this.params=t;const r=t.maxLength;null!=r&&e.setMaxLength(r)}getValue(){const{eInput:e,params:t}=this,r=e.getValue();return xe(r)||xe(t.value)?t.parseValue(r):t.value}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){const e=this.eInput,t=e.getValue(),r=xe(t)&&t.length||0;r&&e.getInputElement().setSelectionRange(r,r)}},td=class extends Ju{constructor(){super(new ed)}};function rd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";e.frameworkOverrides.wrapIncoming((()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,r)),"ensureVisible")}function nd(e,t,r){e.frameworkOverrides.wrapIncoming((()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,r)),"ensureVisible")}var id={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},sd=class extends jo{constructor(e){super(id),this.params=e}postConstruct(){ft(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedElementListeners(e,{keydown:e=>{gs(this.gos,e,t.node,t.column,!0)||t.onKeyDown(e)}})}};function od(e,t,r){e.editCompDetails=r,e.editing!==t&&(e.editing=t)}var ad={moduleName:"EditCore",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="editSvc"}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!e.isCellEditable()||e.editing)return!1;if(!e.comp)return e.onCompAttachedFuncs.push((()=>{this.startEditing(e,t,r,n)})),!0;const i=this.createCellEditorParams(e,t,r),s=e.column.getColDef(),o=In(this.beans.userCompFactory,s,i),a=null!=o?.popupFromSelector?o.popupFromSelector:!!s.cellEditorPopup,l=null!=o?.popupPositionFromSelector?o.popupPositionFromSelector:s.cellEditorPopupPosition;return od(e,!0,o),e.comp.setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents")),this.eventSvc.dispatchEvent(e.createEvent(n,"cellEditingStarted")),!o?.params?.suppressPreventDefault}stopEditing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.onEditorAttachedFuncs=[],!e.editing)return!1;const{comp:r,column:n,rowNode:i}=e,{newValue:s,newValueExists:o}=function(e,t){const r={newValueExists:!1};if(e)return r;const n=t.getCellEditor();if(!n)return r;if(n.isCancelAfterEnd&&n.isCancelAfterEnd())return r;const i=n.getValue();return{newValue:i,newValueExists:!0}}(t,r),a=this.beans.valueSvc.getValueForDisplay(n,i);let l=!1;return o&&(l=function(e,t,r,n,i){if(r===t)return!1;e.suppressRefreshCell=!0;const s=n.setDataValue(i,r,"edit");return e.suppressRefreshCell=!1,s}(e,a,s,i,n)),od(e,!1,void 0),r.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventSvc.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:s,valueChanged:l}),l}handleColDefChanged(e){const t=e.comp?.getCellEditor();if(t?.refresh){const{eventKey:r,cellStartedEdit:n}=e.editCompDetails.params,i=this.createCellEditorParams(e,r,n),s=e.column.getColDef(),o=In(this.beans.userCompFactory,s,i);t.refresh(o.params)}}setFocusOutOnEditor(e){if(!e.editing)return;const t=e.comp.getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){if(!e.editing)return;const t=e.comp,r=t.getCellEditor();r?.focusIn?r.focusIn():(e.focusCell(!0),e.onEditorAttachedFuncs.push((()=>t.getCellEditor()?.focusIn?.())))}createPopupEditorWrapper(e){return new sd(e)}stopAllEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.rowRenderer.getAllRowCtrls().forEach((t=>this.stopRowEditing(t,e)))}stopRowEditing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.stoppingRowEdit)return;const r=e.getAllCellCtrls(),n=e.editing;e.stoppingRowEdit=!0;let i=!1;for(const s of r){const e=s.stopEditing(t);n&&!t&&!i&&e&&(i=!0)}i&&this.eventSvc.dispatchEvent(e.createRowEvent("rowValueChanged")),n&&this.beans.rowEditSvc?.setEditing(e,!1),e.stoppingRowEdit=!1}addStopEditingWhenGridLosesFocus(e){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const t=t=>{const r=t.relatedTarget;if(null===U(r))return void this.stopAllEditing();let n=e.some((e=>e.contains(r)))&&Ei(this.gos,r);if(!n){const e=this.beans.popupSvc;n=!!e&&(e.getActivePopups().some((e=>e.contains(r)))||e.isElementWithinCustomPopup(r))}n||this.stopAllEditing()};e.forEach((e=>this.addManagedElementListeners(e,{focusout:t})))}setInlineEditingCss(e){const t=e.editing||e.getAllCellCtrls().some((e=>e.editing));e.forEachGui(void 0,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),e.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)}))}isCellEditable(e,t){if(t.group)if(this.gos.get("treeData")){if(!t.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1;return e.isColumnFunc(t,e.colDef.editable)}startRowOrCellEdit(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.comp?"fullRow"===this.gos.get("editType")?this.beans.rowEditSvc?.startEditing(e.rowCtrl,t,e)??!1:this.startEditing(e,t,!0,r):(e.onCompAttachedFuncs.push((()=>{this.startRowOrCellEdit(e,t,r)})),!0)}stopRowOrCellEdit(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"fullRow"===this.gos.get("editType")?this.stopRowEditing(e.rowCtrl,t):this.stopEditing(e,t),r||this.navigateAfterEdit(n,e.cellPosition)}createCellEditorParams(e,t,r){const{column:n,rowNode:i,cellPosition:{rowIndex:s}}=e,{valueSvc:o,gos:a}=this.beans;return Ut(a,{value:o.getValueForDisplay(n,i),eventKey:t,column:n,colDef:n.getColDef(),rowIndex:s,node:i,data:i.data,cellStartedEdit:r,onKeyDown:e.onKeyDown.bind(e),stopEditing:this.stopRowOrCellEdit.bind(this,e,!1),eGridCell:e.eGui,parseValue:t=>o.parseValue(n,i,t,e.value),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const r=e?Qn.UP:Qn.DOWN;this.beans.navigation?.navigateToNextCell(null,r,t,!1)}}},class extends rr{constructor(){super(...arguments),this.beanName="rowEditSvc"}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.editing)return!1;let i=!0,s=!1;const{editSvc:o}=this.beans;return e.getAllCellCtrls().forEach((e=>{const a=e===r;a?i=o?.startEditing(e,t,a,n)??!1:o?.startEditing(e,null,a,n),s||(s=e.editing)})),s&&this.setEditing(e,!0),i}setEditing(e,t){e.editing=t,e.forEachGui(void 0,(e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t)));const r=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventSvc.dispatchEvent(r)}}],apiFunctions:{getCellEditorInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];return e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach((e=>{const t=e.comp?.getCellEditor();t&&r.push(Ln(t))})),r},getEditingCells:function(e){const t=[];return e.rowRenderer.getAllCellCtrls().forEach((e=>{if(e.editing){const{cellPosition:r}=e;t.push(r)}})),t},stopEditing:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.editSvc?.stopAllEditing(t)},startEditingCell:function(e,t){const r=e.colModel.getCol(t.colKey);if(!r)return void et(12,{colKey:t.colKey});const n={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:r};null==t.rowPinned&&nd(e,t.rowIndex),rd(e,t.colKey);const i=Ai(e,n);if(!i)return;const{focusSvc:s,gos:o,editSvc:a}=e,l=o.get("stopEditingWhenCellsLoseFocus")&&(()=>{const t=wt(e),r=i.eGui;return t!==r&&!!r?.contains(t)})();!l&&s.isCellFocused(n)||s.setFocusedCell({...n,forceBrowserFocus:l,preventScrollOnBrowserFocus:!0}),a?.startRowOrCellEdit(i,t.key)}},dependsOn:[yu],css:[".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;width:100%}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}"]},ld={moduleName:"TextEditor",version:We,userComponents:{agCellEditor:td,agTextCellEditor:td},dependsOn:[ad]},cd={moduleName:"SelectEditor",version:We,userComponents:{agSelectCellEditor:class extends jo{constructor(){super(Qu,[Go]),this.eSelect=cn,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueSvc:r,gos:n}=this,{values:i,value:s,eventKey:o}=e;if(ke(i))return void et(58);this.startedByEnter=null!=o&&o===Qn.ENTER;let a=!1;i.forEach((n=>{const i={value:n},o=r.formatValue(e.column,null,n),l=null!==o&&void 0!==o;i.text=l?o:n,t.addOption(i),a=a||s===n})),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;null!=l&&t.setPickerGap(l),null!=u&&t.setPickerMaxHeight(u),null!=c&&t.setPickerMaxWidth(c),"fullRow"!==n.get("editType")&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout((()=>{this.isAlive()&&this.eSelect.showPicker()}))}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}},dependsOn:[ad]};var ud=class{constructor(){this.removals=new Set,this.updates=new Set,this.adds=new Set}remove(e){this.adds.delete(e)||(this.updates.delete(e),this.removals.add(e))}update(e){this.adds.has(e)||this.updates.add(e)}add(e){this.adds.add(e)}};function dd(e){e.sibling&&(e.sibling.childrenAfterSort=e.childrenAfterSort),function(e){if(ke(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let r=0;r<t.length;r++){const n=t[r],i=0===r,s=r===e.childrenAfterSort.length-1;n.setFirstChild(i),n.lastChild!==s&&(n.lastChild=s,n.dispatchRowEvent("lastChildChanged")),n.childIndex!==r&&(n.childIndex=r,n.dispatchRowEvent("childIndexChanged"))}}(e)}var hd={moduleName:"ClientSideRowModel",version:We,rowModels:["clientSide"],beans:[class extends To{constructor(){super(...arguments),this.beanName="csrmNodeSvc"}},class extends rr{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowsToDisplay=[],this.started=!1,this.isRefreshingModel=!1,this.rowNodesCountReady=!1,this.rowCountReady=!1,this.onRowHeightChanged_debounced=He(this,this.onRowHeightChanged.bind(this),100)}wireBeans(e){this.colModel=e.colModel,this.valueCache=e.valueCache,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggStage=e.aggStage,this.pivotStage=e.pivotStage,this.filterAggStage=e.filterAggStage}postConstruct(){this.orderedStages=[this.groupStage,this.filterStage,this.pivotStage,this.aggStage,this.sortStage,this.filterAggStage,this.flattenStage].filter((e=>!!e));const e=this.refreshModel.bind(this,{step:"group"}),t=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:t,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Bi(this.beans);const r=this.getNewNodeManager();this.nodeManager=r,r.activate(this.rootNode)}getNewNodeManager(){const{gos:e,beans:t}=this;switch(jt(e)){case"treeNested":return t.csrmChildrenTreeNodeSvc??t.csrmNodeSvc;case"treePath":return t.csrmPathTreeNodeSvc??t.csrmNodeSvc;default:return t.csrmNodeSvc}}addPropertyListeners(){const e=["treeData","treeDataChildrenField",...this.orderedStages.flatMap((e=>{let{refreshProps:t}=e;return[...t]}))];this.addManagedPropertyListeners(e,(e=>{const t=e.changeSet?.properties;t&&this.onPropChange(t)})),this.addManagedPropertyListener("rowData",(()=>this.onPropChange(["rowData"]))),this.addManagedPropertyListener("rowHeight",(()=>this.resetRowHeights()))}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,r,n){let i,s=!1;do{i=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,r),c=Math.min(a,n);for(let e=l;e<=c;e++){const t=this.getRow(e);if(t.rowHeightEstimated){const e=dt(this.beans,t);t.setRowHeight(e.height),i=!0,s=!0}}i&&this.setRowTopAndRowIndex()}while(i);return s}onPropChange(e){if(!this.rootNode)return;const t=this.gos,r=new Set(e),n={step:"nothing",changedProps:r},i=r.has("rowData"),s=this.nodeManager,o=this.getNewNodeManager(),a=s!==o||i&&r.has("treeData")&&t.get("treeData")||r.has("treeDataChildrenField")&&t.get("treeData");let l;if((a||i)&&(l=t.get("rowData"),null==l||Array.isArray(l)||(l=null,et(1))),a&&(i||(l=s?.extractRowData()??l),s!==o&&(s?.deactivate(),this.nodeManager=o),o.activate(this.rootNode)),l){!a&&!this.isEmpty()&&l.length>0&&t.exists("getRowId")&&!t.get("resetRowDataOnUpdate")?(n.keepRenderedRows=!0,n.animate=!this.gos.get("suppressAnimationFrame"),n.changedRowNodes=new ud,o.setImmutableRowData(n,l)):(n.rowDataUpdated=!0,n.newData=!0,this.beans.selectionSvc?.reset("rowDataChanged"),this.rowNodesCountReady=!0,o.setNewRowData(l))}if(n.rowDataUpdated)n.step="group";else if("nothing"===n.step)for(const{refreshProps:c,step:u}of this.orderedStages)if(e.some((e=>c.has(e)))){n.step=u;break}"nothing"!==n.step&&this.refreshModel(n)}setRowTopAndRowIndex(){const{beans:e}=this,t=e.environment.getDefaultRowHeight();let r=0;const n=new Set,i=lt(this.gos,"normal"),s=this.rowsToDisplay;for(let o=0,a=s.length;o<a;++o){const a=s[o];if(null!=a.id&&n.add(a.id),null==a.rowHeight){const r=dt(e,a,i,t);a.setRowHeight(r.height,r.estimated)}a.setRowTop(r),a.setRowIndex(o),r+=a.rowHeight}return n}clearRowTopAndRowIndex(e,t){const r=e.active,n=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},i=e=>{if(null!==e&&(n(e),n(e.detailNode),n(e.sibling),e.hasChildren()&&e.childrenAfterGroup)){const t=-1==e.level;r&&!t&&!e.expanded||e.childrenAfterGroup.forEach(i)}};i(this.rootNode)}ensureRowsAtPixel(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.getRowIndexAtPixel(t),i=this.getRow(n),s=!this.gos.get("suppressAnimationFrame");if(i===e[0])return!1;const o=this.rootNode?.allLeafChildren;return!!o&&(e.forEach((e=>{Er(o,e)})),e.forEach(((e,t)=>{o.splice(Math.max(n+r,0)+t,0,e)})),e.forEach(((e,t)=>{e.sourceRowIndex=t})),this.refreshModel({step:"group",keepRenderedRows:!0,animate:s,rowNodesOrderChanged:!0}),!0)}highlightRowAtPixel(e,t){const r=null!=t?this.getRowIndexAtPixel(t):null,n=null!=r?this.getRow(r):null;if(!n||!e||null==t)return void this.clearHighlightedRow();const i=this.getHighlightPosition(t,n),s=this.isHighlightingCurrentPosition(e,n,i),o=null!=this.lastHighlightedRow&&this.lastHighlightedRow!==n;(s||o)&&(this.clearHighlightedRow(),s)||(this.setRowNodeHighlighted(n,i),this.lastHighlightedRow=n)}setRowNodeHighlighted(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchRowEvent("rowHighlightChanged"))}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(!(t=this.getRow(r||0)))return"Below"}const{rowTop:r,rowHeight:n}=t;return e-r<n/2?"Above":"Below"}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,r){if(e===t)return!0;const n="Above"===r?-1:1;return this.getRow(t.rowIndex+n)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.setRowNodeHighlighted(this.lastHighlightedRow,null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){const e=this.rootNode;if(!e)return 0;if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===e)return 1;const t=e.childrenAfterAggFilter,r=e.sibling?1:0;return(t?t.length:0)+r}getTopLevelRowDisplayedIndex(e){const{rootNode:t,rowsToDisplay:r}=this;if(!t||!r.length||r[0]===t)return e;const{childrenAfterSort:n}=t,i=e=>{let t=n[e];if(this.gos.get("groupHideOpenParents"))for(;t.expanded&&t.childrenAfterSort&&t.childrenAfterSort.length>0;)t=t.childrenAfterSort[0];return t.rowIndex},{footerSvc:s}=this.beans;return s?s.getTopDisplayIndex(r,e,n,i):i(e)}getTopLevelIndexFromDisplayedIndex(e){const{rootNode:t,rowsToDisplay:r}=this;if(!t||!r.length||r[0]===t)return e;let n=this.getRow(e);for(n.footer&&(n=n.sibling);n.parent&&n.parent!==t;)n=n.parent;const i=t.childrenAfterSort?.findIndex((e=>e===n));return-1===i?e:i??e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=Et(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=Et(this.gos),r=0===e.columns.length||e.columns.some((e=>e.isPrimary()))?"filter":"filter_aggregates";this.refreshModel({step:r,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=Et(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new Fc(!1,this.rootNode);return e||(t.active=!1),t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:r,rowDataUpdated:n}=e;return!(!t||r||!n)&&(!t.removals.size&&!t.adds.size)}refreshModel(e){if(!this.rootNode)return;const t=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&!!e.rowDataUpdated));if(this.nodeManager.refreshModel?.(e,this.started),this.eventSvc.dispatchEvent({type:"beforeRefreshModel",params:e}),!this.started)return;if(e.rowDataUpdated&&this.eventSvc.dispatchEvent({type:"rowDataUpdated"}),this.isRefreshingModel||this.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e))return;switch(this.isRefreshingModel=!0,e.step){case"group":this.doRowGrouping(e.changedRowNodes,t,!!e.rowNodesOrderChanged,!!e.afterColumnsChanged);case"filter":this.doFilter(t);case"pivot":this.doPivot(t);case"aggregate":this.doAggregate(t);case"filter_aggregates":this.doFilterAggregates(t);case"sort":this.doSort(e.changedRowNodes,t);case"map":this.doRowsToDisplay()}const r=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(t,r),this.isRefreshingModel=!1,this.eventSvc.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?.allLeafChildren?.length||!this.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let r=!1,n=!1;const i=[],s=Bt(this.gos);return this.forEachNodeAfterFilterAndSort((o=>{if(n)return;if(r&&(o===t||o===e)&&(n=!0,o.group&&s))return void i.push(...o.allLeafChildren);if(!r){if(o!==t&&o!==e)return;r=!0}(!o.group||!s)&&i.push(o)})),i}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay;if(this.isEmpty()||0===t.length)return-1;let r=0,n=t.length-1;if(e<=0)return 0;if(br(t).rowTop<=e)return t.length-1;let i=-1,s=-1;for(;;){const o=Math.floor((r+n)/2),a=t[o];if(this.isRowInPixel(a,e))return o;a.rowTop<e?r=o+1:a.rowTop>e&&(n=o-1);if(i===r&&s===n)return o;i=r,s=n}}isRowInPixel(e,t){const r=e.rowTop,n=e.rowTop+e.rowHeight;return r<=t&&n>t}forEachLeafNode(e){this.rootNode?.allLeafChildren?.forEach(((t,r)=>e(t,r)))}forEachNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){this.rowsToDisplay.forEach(e)}forEachNodeAfterFilter(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.depthFirstSearchRowNodes(e,t,(e=>e.childrenAfterAggFilter))}forEachNodeAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.depthFirstSearchRowNodes(e,t,(e=>e.childrenAfterSort))}forEachPivotNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,(e=>e.leafGroup?null:e[r]))}depthFirstSearchRowNodes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e.childrenAfterGroup,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rootNode,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!n)return i;const s=n===this.rootNode;s||e(n,i++);const{footerSvc:o}=this.beans;if(n.hasChildren()&&!n.footer){const a=r(n);if(a){i=o?.addTotalRows(i,n,e,t,s,"top")??i;for(const n of a)i=this.depthFirstSearchRowNodes(e,t,r,n,i);return o?.addTotalRows(i,n,e,t,s,"bottom")??i}}return i}doAggregate(e){const t=this.rootNode;t&&this.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){const t=this.rootNode;this.filterAggStage?this.filterAggStage.execute({rowNode:t,changedPath:e}):t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){this.sortStage?this.sortStage.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t}):t.forEachChangedNodeDepthFirst((e=>{e.childrenAfterSort=e.childrenAfterAggFilter.slice(0),dd(e)}))}doRowGrouping(e,t,r,n){const i=this.rootNode,s=this.groupStage?.execute({rowNode:i,changedPath:t,changedRowNodes:e,rowNodesOrderChanged:r,afterColumnsChanged:n});if(!s&&!this.nodeManager.treeData){const e=i.sibling;i.childrenAfterGroup=i.allLeafChildren,e&&(e.childrenAfterGroup=i.childrenAfterGroup),i.updateHasChildren()}this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage?this.filterStage.execute({rowNode:this.rootNode,changedPath:e}):e.forEachChangedNodeDepthFirst((e=>{e.childrenAfterFilter=e.childrenAfterGroup,Cu(e)}),!0)}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){if("string"==typeof e&&0==e.indexOf(_i)){let t;return this.forEachNode((r=>{r.id===e&&(t=r)})),t}return this.nodeManager.getRowNode(e)}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout((()=>{this.isAlive()&&this.executeBatchUpdateRowData()}),e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache?.onDataChanged();const e=[],t=[],r=new ud;let n=!1;this.rowDataTransactionBatch?.forEach((i=>{this.rowNodesCountReady=!0;const{rowNodeTransaction:s,rowsInserted:o}=this.nodeManager.updateRowData(i.rowDataTransaction,r);o&&(n=!0),t.push(s),i.callback&&e.push(i.callback.bind(null,s))})),this.commitTransactions(n,r),e.length>0&&window.setTimeout((()=>{e.forEach((e=>e()))}),0),t.length>0&&this.eventSvc.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;const t=new ud,{rowNodeTransaction:r,rowsInserted:n}=this.nodeManager.updateRowData(e,t);return this.commitTransactions(n,t),r}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,rowNodesOrderChanged:e,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:t,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{flattenStage:e,rootNode:t}=this;let r;if(e)r=e.execute({rowNode:t});else{r=t?.childrenAfterSort??[];for(const e of r)e.setUiLevel(0)}this.rowsToDisplay=r}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode((t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r&&r.setRowHeight(r.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0})),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.beans.rowAutoHeight?.active)return;this.resetRowHeights()}}onGridReady(){this.started||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow(),this.started=!1,this.rootNode=null,this.nodeManager=null,this.rowDataTransactionBatch=null,this.lastHighlightedRow=null,this.orderedStages=wr,this.rowsToDisplay=wr}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},class extends rr{constructor(){super(...arguments),this.beanName="sortStage",this.refreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),this.step="sort"}execute(e){const t=this.beans,r=t.sortSvc.getSortOptions(),n=xe(r)&&r.length>0,i=n&&!!e.changedRowNodes&&this.gos.get("deltaSort"),s=r.some((e=>{let{column:r}=e;return Tt(t.gos)?r.isPrimary()&&r.isRowGroupActive():!!r.getColDef().showRowGroup}));this.sort(t,r,n,i,e.changedRowNodes,e.changedPath,s)}sort(e,t,r,n,i,s,o){const{gos:a,colModel:l,rowGroupColsSvc:c,rowNodeSorter:u,rowRenderer:d,showRowGroupCols:h}=e,p=a.get("groupMaintainOrder"),g=l.getCols().some((e=>e.isRowGroupActive())),f=l.isPivotMode(),m=a.getCallback("postSortRows");let v=!1;if(s?.forEachChangedNodeDepthFirst((e=>{const a=f&&e.leafGroup;let l;if(p&&g&&!e.leafGroup&&!o){const t=c?.columns?.[e.level+1],r=null===t?.getSort(),n=e.childrenAfterAggFilter.slice(0);if(e.childrenAfterSort&&!r){const t={};e.childrenAfterSort.forEach(((e,r)=>{t[e.id]=r})),n.sort(((e,r)=>(t[e.id]??0)-(t[r.id]??0)))}l=n}else l=!r||a?e.childrenAfterAggFilter.slice(0):n&&i?function(e,t,r,n,i){const s=t.childrenAfterAggFilter,o=t.childrenAfterSort;if(!o)return e.doFullSort(s,i);const a=new Set,l=[],{updates:c,adds:u}=r;for(let h=0,p=s.length;h<p;++h){const e=s[h];c.has(e)||u.has(e)||n&&!n.canSkip(e)?l.push({currentPos:l.length,rowNode:e}):a.add(e.id)}const d=o.filter((e=>a.has(e.id))).map(((e,t)=>({currentPos:t,rowNode:e})));return l.sort(((t,r)=>e.compareRowNodes(i,t,r))),function(e,t,r,n){const i=[];let s=0,o=0;const a=r.length,l=n.length;for(;s<a&&o<l;){const a=r[s],l=n[o];let c;e.compareRowNodes(t,a,l)<0?(c=a,++s):(c=l,++o),i.push(c.rowNode)}for(;s<a;)i.push(r[s++].rowNode);for(;o<l;)i.push(n[o++].rowNode);return i}(e,i,l,d)}(u,e,i,s,t):u.doFullSort(e.childrenAfterAggFilter,t);if(v||(v=e.childrenAfterSort?.[0]!==l[0]),e.childrenAfterSort=l,dd(e),m){const t={nodes:e.childrenAfterSort};m(t)}})),v&&this.gos.get("groupHideOpenParents")){const e=h?.getShowRowGroupCols();e?.length&&d.refreshCells({columns:e,force:!0})}}}],dependsOn:[Ac]};var pd="paginationPageSizeSelector",gd={tag:"span",cls:"ag-paging-page-size"},fd={selector:"AG-PAGE-SIZE-SELECTOR",component:class extends un{constructor(){super(gd),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(pd,(()=>{this.onPageSizeSelectorValuesChange()})),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){le(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get(pd)}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),r=!t||!e.includes(t);if(r){const r=this.gos.exists("paginationPageSize"),n=!0!==this.gos.get(pd);et(94,{pageSizeSet:r,pageSizesSet:n,pageSizeOptions:e,paginationPageSizeOption:t}),n||et(95,{paginationPageSizeOption:t,paginationPageSizeSelector:pd}),e.unshift("")}const n=String(r?"":t);this.selectPageSizeComp?(yr(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=r}createPageSizeSelectOptions(e){return e.map((e=>({value:String(e)})))}createPageSizeSelectorComp(e,t){const r=this.getLocaleTextFunc(),n=r("pageSizeSelectorLabel","Page Size:"),i=r("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new _o).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(i).setLabel(n).onValueChange((()=>this.handlePageSizeItemSelected())),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(pd);return Array.isArray(t)&&t?.length?[...t].sort(((e,t)=>e-t)):e}destroy(){this.toggleSelectDisplay(!1),super.destroy()}}},md={selector:"AG-PAGINATION",component:class extends Uo{constructor(){super(),this.btFirst=cn,this.btPrevious=cn,this.btNext=cn,this.btLast=cn,this.lbRecordCount=cn,this.lbFirstRowOnPage=cn,this.lbLastRowOnPage=cn,this.lbCurrent=cn,this.lbTotal=cn,this.pageSizeComp=cn,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:max(var(--ag-row-height),22px);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}")}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[fd]);const{btFirst:t,btPrevious:r,btNext:n,btLast:i}=this;this.activateTabIndex([t,r,n,i]),t.insertAdjacentElement("afterbegin",vo(e?"last":"first",this.beans)),r.insertAdjacentElement("afterbegin",vo(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",vo(e?"previous":"next",this.beans)),i.insertAdjacentElement("afterbegin",vo(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],(()=>this.onPageSizeRelatedOptionsChange())),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(e):ci(this.beans,e),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((e=>{const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:e=>{e.key!==Qn.ENTER&&e.key!==Qn.SPACE||(e.preventDefault(),r())}})})),ii(this.beans,this,this.getGui()),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t){return t({value:e})}return jc(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const n=this.isZeroPagesToDisplay(),i=e===r-1;this.nextButtonDisabled=i||n,this.lastButtonDisabled=!t||n||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){R(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&0===t}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),r=this.pagination.getMasterRowCount(),n=e?r:null,i=this.pagination.getCurrentPage(),s=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*i+1,a=o+s-1,e&&a>n&&(a=n));const l=!e&&r<o+s-1,c=this.formatNumber(o);let u;this.lbFirstRowOnPage.textContent=c;const d=this.getLocaleTextFunc();u=l?d("pageLastRowUnknown","?"):this.formatNumber(a),this.lbLastRowOnPage.textContent=u;const h=t>0?i+1:0,p=this.formatNumber(h);let g,f;if(this.lbCurrent.textContent=p,e)g=this.formatNumber(t),f=this.formatNumber(n);else{const e=d("more","more");g=e,f=e}this.lbTotal.textContent=g,this.lbRecordCount.textContent=f,this.announceAriaStatus(c,u,f,p,g)}announceAriaStatus(e,t,r,n,i){const s=this.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),l=s("of","of"),c=`${e} ${a} ${t} ${l} ${r}`,u=`${o} ${n} ${l} ${i}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnounce?.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,this.ariaAnnounce?.announceValue(u,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}}},vd={moduleName:"Pagination",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return md}isPaginateChildRows(){const e=this.gos;return!!(e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren"))||e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;this.active&&t!==e&&"number"===typeof t&&(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return!this.active||e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return xe(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:xe(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:xe(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:xe(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0)return void this.setZeroRows();const r=this.pageSize,n=t-1;this.totalPages=Math.floor(n/r)+1,this.adjustCurrentPageIfInvalid();const i=this.currentPage,s=r*i;let o=r*(i+1)-1;if(o>n&&(o=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),o===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const t=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=t-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,0===e)return void this.setZeroRows();const{pageSize:t,currentPage:r}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*r,this.bottomDisplayedRowIndex=t*(r+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:n,keepRenderedRows:t})}},class extends rr{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,(e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()}))}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,r=()=>{const r=Math.max(ht(t),1),n=Math.floor(e/r);t.pagination.setPageSize(n,"autoCalculated")};this.isBodyRendered?He(this,r,50)():(r(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:function(e){return e.rowModel.isLastRowIndexKnown()},paginationGetPageSize:function(e){return e.pagination?.getPageSize()??100},paginationGetCurrentPage:function(e){return e.pagination?.getCurrentPage()??0},paginationGetTotalPages:function(e){return e.pagination?.getTotalPages()??1},paginationGetRowCount:function(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()},paginationGoToNextPage:function(e){e.pagination?.goToNextPage()},paginationGoToPreviousPage:function(e){e.pagination?.goToPreviousPage()},paginationGoToFirstPage:function(e){e.pagination?.goToFirstPage()},paginationGoToLastPage:function(e){e.pagination?.goToLastPage()},paginationGoToPage:function(e,t){e.pagination?.goToPage(t)}},dependsOn:[yu]};var Cd={moduleName:"RowApi",version:We,apiFunctions:{redrawRows:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.redrawRows(r)))},setRowNodeExpanded:function e(t,r,n,i,s){r&&(i&&r.parent&&-1!==r.parent.level&&e(t,r.parent,n,i,s),r.setExpanded(n,void 0,s))},getRowNode:function(e,t){return e.rowModel.getRowNode(t)},addRenderedRowListener:function(e,t,r,n){e.rowRenderer.addRenderedRowListener(t,r,n)},getRenderedNodes:function(e){return e.rowRenderer.getRenderedNodes()},forEachNode:function(e,t,r){e.rowModel.forEachNode(t,r)},getFirstDisplayedRowIndex:function(e){return e.rowRenderer.firstRenderedRow},getLastDisplayedRowIndex:function(e){return e.rowRenderer.lastRenderedRow},getDisplayedRowAtIndex:function(e,t){return e.rowModel.getRow(t)},getDisplayedRowCount:function(e){return e.rowModel.getRowCount()}}};var wd=class extends rr{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,r=e.colDef,n=r.cellClassRules,i=this.getCellClassParams(e,r);ls(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,i,(e=>t.addOrRemoveCssClass(e,!0)),(e=>t.addOrRemoveCssClass(e,!1))),this.cellClassRules=n}applyUserStyles(){const e=this.column,t=e.colDef,r=t.cellStyle;if(!r)return;let n;if("function"===typeof r){n=r(this.getCellClassParams(e,t))}else n=r;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,r=e.colDef,n=this.getCellClassParams(e,r);this.staticClasses.forEach((e=>t.addOrRemoveCssClass(e,!1)));const i=this.beans.cellStyles.getStaticCellClasses(r,n);this.staticClasses=i,i.forEach((e=>t.addOrRemoveCssClass(e,!0)))}getCellClassParams(e,t){const{value:r,rowNode:n}=this.cellCtrl;return Ut(this.beans.gos,{value:r,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},bd={moduleName:"CellStyle",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,r,n){ls(this.beans.expressionSvc,void 0,e.cellClassRules,t,r,n),this.processStaticCellClasses(e,t,r)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let n;if("function"===typeof r){n=r(t)}else n=r;return"string"===typeof n&&(n=[n]),n||[]}createCellCustomStyleFeature(e,t){return new wd(e,t)}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach((e=>{r(e)}))}}]},yd={moduleName:"RowStyle",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const r=this.gos,n=t=>{"string"===typeof t?e.push(t):Array.isArray(t)&&t.forEach((t=>e.push(t)))},i=r.get("rowClass");i&&n(i);const s=r.getCallback("getRowClass");if(s){n(s({data:t.data,node:t,rowIndex:t.rowIndex}))}}preProcessRowClassRules(e,t){this.processRowClassRules(t,(t=>{e.push(t)}),(()=>{}))}processRowClassRules(e,t,r){const{gos:n,expressionSvc:i}=this.beans,s=Ut(n,{data:e.data,node:e,rowIndex:e.rowIndex});ls(i,void 0,n.get("rowClassRules"),s,t,r)}processStylesFromGridOptions(e){const t=this.gos,r=t.get("rowStyle"),n=t.getCallback("getRowStyle");let i;if(n){i=n({data:e.data,node:e,rowIndex:e.rowIndex})}if(i||r)return Object.assign({},r,i)}}]};var Sd={moduleName:"RowAutoHeight",version:We,beans:[class extends rr{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=He(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){const{visibleCols:e,rowModel:t,rowSpanSvc:r,pinnedRowModel:n}=this.beans,i=e.autoHeightCols;let s=!1;const o=e=>{const t=e.__autoHeights;let n=dt(this.beans,e).height;for(const s of i){let i=t?.[s.getColId()];const o=r?.getCellSpan(s,e);if(o){if(o.getLastNode()!==e)continue;if(i=r?.getCellSpan(s,e)?.getLastNodeAutoHeight(),!i)return}if(null==i){if(this.colSpanSkipCell(s,e))continue;return}n=Math.max(i,n)}n!==e.rowHeight&&(e.setRowHeight(n),s=!0)};n?.forEachPinnedRow?.("top",o),n?.forEachPinnedRow?.("bottom",o),t.forEachDisplayedNode?.(o),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,r){if(e.__autoHeights??(e.__autoHeights={}),void 0==t)return void delete e.__autoHeights[r.getId()];const n=e.__autoHeights[r.getId()];e.__autoHeights[r.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:r,colViewport:n,visibleCols:i}=this.beans;if(!r.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=i.getLeftColsForRow(t);break;case"right":s=i.getRightColsForRow(t);break;case null:s=n.getColsWithinViewport(t)}return!s.includes(e)}setupCellAutoHeight(e,t,r){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const n=t.parentElement,{rowNode:i,column:s}=e,o=this.beans,a=l=>{if(e.editing)return;if(!e.isAlive()||!r.isAlive())return;const{paddingTop:c,paddingBottom:u,borderBottomWidth:d,borderTopWidth:h}=ee(n),p=c+u+d+h,g=t.offsetHeight+p;if(l<5){const e=mt(o);if(!e||!e.contains(t)||0==g)return void window.setTimeout((()=>a(l+1)),0)}this.setRowAutoHeight(i,g,s)},l=()=>a(0);l();const c=we(o,t,l);return r.addDestroyFunc((()=>{c(),this.setRowAutoHeight(i,void 0,s)})),!0}setAutoHeightActive(e){this.active=e.list.some((e=>e.isVisible()&&e.isAutoHeight()))}}]},Ed=r(950),Rd=r.t(Ed,2),Td=u.createContext({}),xd=(e,t,r,n)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const i=e.newAgStackInstance();let s,o,a=!1;return i.then((e=>{a?t.destroyBean(e):(s=e,o=s.getGui(),r.appendChild(o),kd(n,s))})),()=>{a=!0,s&&(o?.parentElement?.removeChild(o),t.destroyBean(s),n&&kd(n,void 0))}},kd=(e,t)=>{if(e)if(e instanceof Function){e(t)}else{e.current=t}},Pd=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e=>null!=e&&""!==e)).join(" ")},Ad=class e{constructor(){this.classesMap={};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((e=>{this.classesMap[e]=!0}))}setClass(t,r){if(!!this.classesMap[t]==r)return this;const n=new e;return n.classesMap={...this.classesMap},n.classesMap[t]=r,n}toString(){return Object.keys(this.classesMap).filter((e=>this.classesMap[e])).join(" ")}},Fd=e=>"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115),Dd=u.version?.split(".")[0],Id="16"===Dd||"17"===Dd;var Md=!1;var Od=(e,t)=>{Id||!e||Md?t():Ed.flushSync(t)};function Ld(e,t,r){if(null==t||null==e)return t;if(e===t||0===t.length&&0===e.length)return e;if(r||0===e.length&&t.length>0||e.length>0&&0===t.length)return t;const n=[],i=[],s=new Map,o=new Map;for(let a=0;a<t.length;a++){const e=t[a];o.set(e.instanceId,e)}for(let a=0;a<e.length;a++){const t=e[a];s.set(t.instanceId,t),o.has(t.instanceId)&&n.push(t)}for(let a=0;a<t.length;a++){const e=t[a],r=e.instanceId;s.has(r)||i.push(e)}return n.length===e.length&&0===i.length?e:0===n.length&&i.length===t.length?t:0===n.length?i:0===i.length?n:[...n,...i]}var Nd=(0,u.forwardRef)(((e,t)=>{const{registry:r,context:n}=(0,u.useContext)(Td),i=(0,u.useRef)(null),s=(0,u.useRef)(null),o=(0,u.useRef)(null),a=(0,u.useRef)(null),l=(0,u.useRef)(null),c=(0,u.useRef)(),[d,h]=(0,u.useState)(),[p,g]=(0,u.useState)(),[f,m]=(0,u.useState)(),[v,C]=(0,u.useState)((()=>new Ad)),[w,b]=(0,u.useState)((()=>new Ad("ag-hidden"))),[y,S]=(0,u.useState)((()=>new Ad("ag-hidden"))),[E,R]=(0,u.useState)((()=>new Ad("ag-invisible")));(0,u.useImperativeHandle)(t,(()=>({refresh:()=>!1}))),(0,u.useLayoutEffect)((()=>xd(d,n,s.current)),[d]);const T=(0,u.useCallback)((t=>{if(i.current=t,!t)return void(c.current=n.destroyBean(c.current));const s={setInnerRenderer:(e,t)=>{h(e),m(t)},setChildCount:e=>g(e),addOrRemoveCssClass:(e,t)=>C((r=>r.setClass(e,t))),setContractedDisplayed:e=>S((t=>t.setClass("ag-hidden",!e))),setExpandedDisplayed:e=>b((t=>t.setClass("ag-hidden",!e))),setCheckboxVisible:e=>R((t=>t.setClass("ag-invisible",!e))),setCheckboxSpacing:e=>R((t=>t.setClass("ag-group-checkbox-spacing",e)))},u=r.createDynamicBean("groupCellRendererCtrl",!0);u&&(c.current=n.createBean(u),c.current.init(s,t,o.current,a.current,l.current,Nd,e))}),[]),x=(0,u.useMemo)((()=>`ag-cell-wrapper ${v.toString()}`),[v]),k=(0,u.useMemo)((()=>`ag-group-expanded ${w.toString()}`),[w]),P=(0,u.useMemo)((()=>`ag-group-contracted ${y.toString()}`),[y]),A=(0,u.useMemo)((()=>`ag-group-checkbox ${E.toString()}`),[E]),F=d&&d.componentFromFramework,D=F?d.componentClass:void 0,I=null==d&&null!=f,M=cr(f,!0);return u.createElement("span",{className:x,ref:T,...e.colDef?{}:{role:c.current?.getCellAriaRole()}},u.createElement("span",{className:k,ref:a}),u.createElement("span",{className:P,ref:l}),u.createElement("span",{className:A,ref:o}),u.createElement("span",{className:"ag-group-value",ref:s},I&&u.createElement(u.Fragment,null,M),F&&u.createElement(D,{...d.params})),u.createElement("span",{className:"ag-group-child-count"},p))})),_d=Nd,Gd=(0,u.createContext)({setMethods:()=>{}}),Bd=(0,u.memo)((e=>{const{initialProps:t,addUpdateCallback:r,CustomComponentClass:n,setMethods:i}=e,[{key:s,...o},a]=(0,u.useState)(t);return(0,u.useEffect)((()=>{r((e=>a(e)))}),[]),u.createElement(Gd.Provider,{value:{setMethods:i}},u.createElement(n,{key:s,...o}))})),Hd=0;function zd(){return"agPortalKey_"+ ++Hd}var Vd=class{constructor(e,t,r,n){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=r,this.suppressFallbackMethods=!!n,this.statelessComponent=this.isStateless(this.reactComponent),this.key=zd(),this.portalKey=zd(),this.instanceCreated=this.isStatelessComponent()?dn.resolve(!1):new dn((e=>{this.resolveInstanceCreated=e}))}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),r=document.createElement(t||"div");return r.classList.add("ag-react-container"),e.reactContainer=r,r}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return"function"===typeof Symbol&&Symbol.for}isStateless(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&null!=t[e]||this.fallbackMethodAvailable(e)}callMethod(e,t){const r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!r)return void setTimeout((()=>this.callMethod(e,t)));const n=r[e];return n?n.apply(r,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new dn((e=>this.createReactComponent(e)))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=e=>{this.componentInstance=e,this.resolveInstanceCreated?.(!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=(0,Ed.createPortal)(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return(0,u.createElement)(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const r=this[`${e}Component`];if(!this.suppressFallbackMethods&&r)return r.bind(this)(t)}fallbackMethodAvailable(e){if(this.suppressFallbackMethods)return!1;return!!this[`${e}Component`]}};function Wd(e,t,r){e.forEach((e=>{const n=t[e];n&&(r[e]=n)}))}var Ud=class extends Vd{constructor(){super(...arguments),this.awaitUpdateCallback=new dn((e=>{this.resolveUpdateCallback=e})),this.wrapperComponent=Bd}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:e=>this.setMethods(e),addUpdateCallback:e=>{this.updateCallback=()=>(e(this.getProps()),new dn((e=>{setTimeout((()=>{e()}))}))),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,Wd(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new dn((e=>this.awaitUpdateCallback.then((()=>{this.updateCallback().then((()=>e()))}))))}},jd=class extends Ud{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},$d=class extends Ud{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},Kd=class extends Ud{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:r,shake:n}=this;return e.label=t,e.icon=r,e.shake=n,e}},Yd=class extends Ud{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new dn((e=>{this.resolveSetMethodsCallback=e}))}isFilterActive(){return null!=this.model}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){const t=this.providedMethods;t?t.afterGuiAttached?.(e):this.awaitSetMethodsCallback.then((()=>this.providedMethods?.afterGuiAttached?.(e)))}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){!1===this.expectingNewMethods&&this.hasBeenActive&&this.providedMethods?.doesFilterPass!==e?.doesFilterPass&&setTimeout((()=>{this.sourceParams.filterChangedCallback()})),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback()}updateModel(e){this.setModel(e).then((()=>this.sourceParams.filterChangedCallback()))}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,e}};function qd(e,t){e.parentFilterInstance((r=>{(r.setModel(t)||dn.resolve()).then((()=>{e.filterParams.filterChangedCallback()}))}))}var Xd=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=e=>this.updateModel(e)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){Wd(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),qd(this.floatingFilterParams,e)}},Jd=class extends Ud{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),qd(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},Qd=class extends Ud{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Zd=class extends Ud{refresh(e){this.sourceParams=e,this.refreshProps()}},eh=class extends Ud{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then((()=>this.sourceParams.onItemActivated()))}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},th=class extends Ud{refresh(e){this.sourceParams=e,this.refreshProps()}},rh=class extends Ud{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},nh=class extends Ud{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function ih(){et(231)}var sh=class{constructor(e,t,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||1e3}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter((t=>t!==e)),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,r){this.portals=[...this.portals,e],this.waitForInstance(t,r),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout((()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return;window.setTimeout((()=>{this.waitForInstance(e,t,r)}))}}},oh=(0,u.memo)((e=>{let{ctrl:t}=e;const r=t.isAlive(),{context:n}=(0,u.useContext)(Td),i=r?t.column.getColId():void 0,[s,o]=(0,u.useState)(),[a,l]=(0,u.useState)(),c=(0,u.useRef)(),d=(0,u.useRef)(null),h=(0,u.useRef)(null),p=(0,u.useRef)(null),g=(0,u.useRef)(),f=(0,u.useRef)();r&&!f.current&&(f.current=new an((()=>d.current)));const m=(0,u.useCallback)((e=>{if(d.current=e,c.current=e?n.createBean(new sn):n.destroyBean(c.current),!e||!t.isAlive())return;const r={setWidth:e=>{d.current&&(d.current.style.width=e)},addOrRemoveCssClass:(e,t)=>f.current.addOrRemoveCssClass(e,t),setUserStyles:e=>l(e),setAriaSort:e=>{d.current&&(e?L(d.current,e):N(d.current))},setUserCompDetails:e=>o(e),getUserCompInstance:()=>g.current||void 0};t.setComp(r,e,h.current,p.current,c.current);const i=t.getSelectAllGui();i&&(h.current?.insertAdjacentElement("afterend",i),c.current.addDestroyFunc((()=>i.remove())))}),[]);(0,u.useLayoutEffect)((()=>xd(s,n,p.current,g)),[s]),(0,u.useEffect)((()=>{t.setDragSource(d.current)}),[s]);const v=(0,u.useMemo)((()=>!!(s?.componentFromFramework&&Fd(s.componentClass))),[s]),C=s&&s.componentFromFramework,w=s&&s.componentClass;return u.createElement("div",{ref:m,style:a,className:"ag-header-cell","col-id":i,role:"columnheader"},u.createElement("div",{ref:h,className:"ag-header-cell-resize",role:"presentation"}),u.createElement("div",{ref:p,className:"ag-header-cell-comp-wrapper",role:"presentation"},C&&v&&u.createElement(w,{...s.params}),C&&!v&&u.createElement(w,{...s.params,ref:g})))})),ah=(0,u.memo)((e=>{let{ctrl:t}=e;const{context:r,gos:n}=(0,u.useContext)(Td),[i,s]=(0,u.useState)(),[o,a]=(0,u.useState)((()=>new Ad("ag-header-cell","ag-floating-filter"))),[l,c]=(0,u.useState)((()=>new Ad)),[d,h]=(0,u.useState)((()=>new Ad("ag-floating-filter-button","ag-hidden"))),[p,g]=(0,u.useState)("false"),[f,m]=(0,u.useState)(),[,v]=(0,u.useState)(1),C=(0,u.useRef)(),w=(0,u.useRef)(null),b=(0,u.useRef)(null),y=(0,u.useRef)(null),S=(0,u.useRef)(null),E=(0,u.useRef)(),R=(0,u.useRef)(),T=e=>{null!=e&&E.current&&E.current(e)},x=(0,u.useCallback)((e=>{if(w.current=e,C.current=e?r.createBean(new sn):r.destroyBean(C.current),!e)return;R.current=new dn((e=>{E.current=e}));const n={addOrRemoveCssClass:(e,t)=>a((r=>r.setClass(e,t))),setUserStyles:e=>s(e),addOrRemoveBodyCssClass:(e,t)=>c((r=>r.setClass(e,t))),setButtonWrapperDisplayed:e=>{h((t=>t.setClass("ag-hidden",!e))),g(e?"false":"true")},setWidth:e=>{w.current&&(w.current.style.width=e)},setCompDetails:e=>m(e),getFloatingFilterComp:()=>R.current?R.current:null,setMenuIcon:e=>S.current?.appendChild(e)};t.setComp(n,e,S.current,b.current,C.current)}),[]);(0,u.useLayoutEffect)((()=>xd(f,r,b.current,T)),[f]);const k=(0,u.useMemo)((()=>o.toString()),[o]),P=(0,u.useMemo)((()=>l.toString()),[l]),A=(0,u.useMemo)((()=>d.toString()),[d]),F=(0,u.useMemo)((()=>!!(f&&f.componentFromFramework&&Fd(f.componentClass))),[f]),D=(0,u.useMemo)((()=>n.get("reactiveCustomComponents")),[]),I=(0,u.useMemo)((()=>{if(f){if(D){const e=new Xd(f.params,(()=>v((e=>e+1))));return T(e),e}f.componentFromFramework&&ih()}}),[f]),M=I?.getProps(),O=f&&f.componentFromFramework,L=f&&f.componentClass;return u.createElement("div",{ref:x,style:i,className:k,role:"gridcell"},u.createElement("div",{ref:b,className:P,role:"presentation"},O&&!D&&u.createElement(L,{...f.params,ref:F?()=>{}:T}),O&&D&&u.createElement(Gd.Provider,{value:{setMethods:e=>I.setMethods(e)}},u.createElement(L,{...M}))),u.createElement("div",{ref:y,"aria-hidden":p,className:A,role:"presentation"},u.createElement("button",{ref:S,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))})),lh=(0,u.memo)((e=>{let{ctrl:t}=e;const{context:r}=(0,u.useContext)(Td),[n,i]=(0,u.useState)(),[s,o]=(0,u.useState)((()=>new Ad)),[a,l]=(0,u.useState)((()=>new Ad)),[c,d]=(0,u.useState)("false"),[h,p]=(0,u.useState)(),[g,f]=(0,u.useState)(),m=(0,u.useMemo)((()=>t.column.getUniqueId()),[]),v=(0,u.useRef)(),C=(0,u.useRef)(null),w=(0,u.useRef)(null),b=(0,u.useRef)(null),y=(0,u.useRef)(),S=(0,u.useCallback)((e=>{if(C.current=e,v.current=e?r.createBean(new sn):r.destroyBean(v.current),!e)return;const n={setWidth:e=>{C.current&&(C.current.style.width=e)},addOrRemoveCssClass:(e,t)=>o((r=>r.setClass(e,t))),setUserStyles:e=>i(e),setHeaderWrapperHidden:e=>{const t=b.current;t&&(e?t.style.setProperty("display","none"):t.style.removeProperty("display"))},setHeaderWrapperMaxHeight:e=>{const t=b.current;t&&(null!=e?t.style.setProperty("max-height",`${e}px`):t.style.removeProperty("max-height"),t.classList.toggle("ag-header-cell-comp-wrapper-limited-height",null!=e))},setUserCompDetails:e=>f(e),setResizableDisplayed:e=>{l((t=>t.setClass("ag-hidden",!e))),d(e?"false":"true")},setAriaExpanded:e=>p(e),getUserCompInstance:()=>y.current||void 0};t.setComp(n,e,w.current,b.current,v.current)}),[]);(0,u.useLayoutEffect)((()=>xd(g,r,b.current)),[g]),(0,u.useEffect)((()=>{C.current&&t.setDragSource(C.current)}),[g]);const E=(0,u.useMemo)((()=>!!(g?.componentFromFramework&&Fd(g.componentClass))),[g]),R=(0,u.useMemo)((()=>"ag-header-group-cell "+s.toString()),[s]),T=(0,u.useMemo)((()=>"ag-header-cell-resize "+a.toString()),[a]),x=g&&g.componentFromFramework,k=g&&g.componentClass;return u.createElement("div",{ref:S,style:n,className:R,"col-id":m,role:"columnheader","aria-expanded":h},u.createElement("div",{ref:b,className:"ag-header-cell-comp-wrapper",role:"presentation"},x&&E&&u.createElement(k,{...g.params}),x&&!E&&u.createElement(k,{...g.params,ref:y})),u.createElement("div",{ref:w,"aria-hidden":c,className:T}))})),ch=(0,u.memo)((e=>{let{ctrl:t}=e;const{context:r}=(0,u.useContext)(Td),{topOffset:n,rowHeight:i}=(0,u.useMemo)((()=>t.getTopAndHeight()),[]),s=t.getAriaRowIndex(),o=t.headerRowClass,[a,l]=(0,u.useState)((()=>i+"px")),[c,d]=(0,u.useState)((()=>n+"px")),h=(0,u.useRef)(null),p=(0,u.useRef)(null),[g,f]=(0,u.useState)((()=>t.getUpdatedHeaderCtrls())),m=(0,u.useRef)(),v=(0,u.useRef)(null),C=(0,u.useCallback)((e=>{if(v.current=e,m.current=e?r.createBean(new sn):r.destroyBean(m.current),!e)return;const n={setHeight:e=>l(e),setTop:e=>d(e),setHeaderCtrls:(e,t,r)=>{p.current=h.current,h.current=e;const n=Ld(p.current,e,t);n!==p.current&&Od(r,(()=>f(n)))},setWidth:e=>{v.current&&(v.current.style.width=e)}};t.setComp(n,m.current,!1)}),[]),w=(0,u.useMemo)((()=>({height:a,top:c})),[a,c]),b=(0,u.useCallback)((e=>{switch(t.type){case"group":return u.createElement(lh,{ctrl:e,key:e.instanceId});case"filter":return u.createElement(ah,{ctrl:e,key:e.instanceId});default:return u.createElement(oh,{ctrl:e,key:e.instanceId})}}),[]);return u.createElement("div",{ref:C,className:o,role:"row",style:w,"aria-rowindex":s},g.map(b))})),uh=(0,u.memo)((e=>{let{pinned:t}=e;const[r,n]=(0,u.useState)(!0),[i,s]=(0,u.useState)([]),{context:o}=(0,u.useContext)(Td),a=(0,u.useRef)(null),l=(0,u.useRef)(null),c=(0,u.useRef)(),d="left"===t,h="right"===t,p=!d&&!h,g=(0,u.useCallback)((e=>{if(a.current=e,c.current=e?o.createBean(new uo(t)):o.destroyBean(c.current),!e)return;const r={setDisplayed:n,setCtrls:e=>s(e),setCenterWidth:e=>{l.current&&(l.current.style.width=e)},setViewportScrollLeft:e=>{a.current&&(a.current.scrollLeft=e)},setPinnedContainerWidth:e=>{a.current&&(a.current.style.width=e,a.current.style.minWidth=e,a.current.style.maxWidth=e)}};c.current.setComp(r,a.current)}),[]),f=r?"":"ag-hidden",m=()=>i.map((e=>u.createElement(ch,{ctrl:e,key:e.instanceId})));return u.createElement(u.Fragment,null,d&&u.createElement("div",{ref:g,className:"ag-pinned-left-header "+f,"aria-hidden":!r,role:"rowgroup"},m()),h&&u.createElement("div",{ref:g,className:"ag-pinned-right-header "+f,"aria-hidden":!r,role:"rowgroup"},m()),p&&u.createElement("div",{ref:g,className:"ag-header-viewport "+f,role:"presentation",tabIndex:-1},u.createElement("div",{ref:l,className:"ag-header-container",role:"rowgroup"},m())))})),dh=(0,u.memo)((()=>{const[e,t]=(0,u.useState)((()=>new Ad)),[r,n]=(0,u.useState)(),{context:i}=(0,u.useContext)(Td),s=(0,u.useRef)(null),o=(0,u.useRef)(),a=(0,u.useCallback)((e=>{if(s.current=e,o.current=e?i.createBean(new to):i.destroyBean(o.current),!e)return;const r={addOrRemoveCssClass:(e,r)=>t((t=>t.setClass(e,r))),setHeightAndMinHeight:e=>n(e)};o.current.setComp(r,e,e)}),[]),l=(0,u.useMemo)((()=>"ag-header "+e.toString()),[e]),c=(0,u.useMemo)((()=>({height:r,minHeight:r})),[r]);return u.createElement("div",{ref:a,className:l,style:c,role:"presentation"},u.createElement(uh,{pinned:"left"}),u.createElement(uh,{pinned:null}),u.createElement(uh,{pinned:"right"}))})),hh=(e,t)=>{(0,u.useEffect)((()=>{const r=t.current;if(r){const t=r.parentElement;if(t){const n=document.createComment(e);return t.insertBefore(n,r),()=>{t.removeChild(n)}}}}),[e])},ph=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new dn((e=>{this.resolveInstanceCreated=e})),this.onValueChange=e=>this.updateValue(e),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){Wd(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}setRef(e){this.componentInstance=e,this.resolveInstanceCreated?.(),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},gh=(0,u.memo)((e=>{const[t,r]=(0,u.useState)(),n=(0,u.useContext)(Td),{context:i,popupSvc:s,localeSvc:o,gos:a,editSvc:l}=n,{editDetails:c,cellCtrl:d,eParentCell:h}=e;return(e=>{const t=(0,u.useRef)(e),r=(0,u.useRef)(),n=(0,u.useRef)(!1),i=(0,u.useRef)(!1),[,s]=(0,u.useState)(0);n.current&&(i.current=!0),(0,u.useEffect)((()=>(n.current||(r.current=t.current(),n.current=!0),s((e=>e+1)),()=>{i.current&&r.current?.()})),[])})((()=>{const{compDetails:t}=c,n=a.get("stopEditingWhenCellsLoseFocus"),u=i.createBean(l.createPopupEditorWrapper(t.params)),p=u.getGui();if(e.jsChildComp){const t=e.jsChildComp.getGui();t&&p.appendChild(t)}const{column:g,rowNode:m}=d,v={column:g,rowNode:m,type:"popupCellEditor",eventSource:h,ePopup:p,position:c.popupPosition,keepWithinBounds:!0},C=s?.positionPopupByComponent.bind(s,v),w=f(o),b=s?.addPopup({modal:n,eChild:p,closeOnEsc:!0,closedCallback:()=>{d.onPopupEditorClosed()},anchorToElement:h,positionCallback:C,ariaLabel:w("ariaLabelCellEditor","Cell Editor")}),y=b?b.hideFunc:void 0;return r(u),e.jsChildComp?.afterGuiAttached?.(),()=>{y?.(),i.destroyBean(u)}})),(0,u.useLayoutEffect)((()=>()=>{d.isCellFocused()&&t?.getGui().contains(wt(n))&&h.focus({preventScroll:!0})}),[t]),u.createElement(u.Fragment,null,t&&e.wrappedContent&&(0,Ed.createPortal)(e.wrappedContent,t.getGui()))})),fh=(e,t,r,n,i,s)=>{const{context:o}=(0,u.useContext)(Td),a=(0,u.useCallback)((()=>{const e=i.current;if(!e)return;const t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),o.destroyBean(e),i.current=void 0}),[]);(0,u.useEffect)((()=>{const n=null!=e,o=e?.compDetails&&!e.compDetails.componentFromFramework;if(!(n&&o&&!(t&&null==r)))return void a();const l=e.compDetails;if(i.current){const t=i.current,r=!!(null!=t.refresh&&0==e.force)&&t.refresh(l.params);if(!0===r||void 0===r)return;a()}l.newAgStackInstance().then((e=>{if(!e)return;const n=e.getGui();if(!n)return;(t?r:s.current).appendChild(n),i.current=e}))}),[e,t,n]),(0,u.useEffect)((()=>a),[])},mh=(e,t,r)=>{const n=e.compProxy;return u.createElement(u.Fragment,null,n?((e,t,r)=>{const{compProxy:n}=e;r(n);const i=n.getProps(),s=Fd(t);return u.createElement(Gd.Provider,{value:{setMethods:e=>n.setMethods(e)}},s?u.createElement(t,{...i}):u.createElement(t,{...i,ref:e=>n.setRef(e)}))})(e,t,r):u.createElement(t,{...e.compDetails.params,ref:r}))},vh=(0,u.memo)((e=>{let{cellCtrl:t,printLayout:r,editingRow:n}=e;const i=(0,u.useContext)(Td),{context:s}=i,{colIdSanitised:o,instanceId:a}=t,l=(0,u.useRef)(),[c,d]=(0,u.useState)((()=>t.isCellRenderer()?void 0:{compDetails:void 0,value:t.getValueToDisplay(),force:!1})),[h,p]=(0,u.useState)(),[g,f]=(0,u.useState)(1),[m,v]=(0,u.useState)(),[C,w]=(0,u.useState)(!1),[b,y]=(0,u.useState)(!1),[S,E]=(0,u.useState)(!1),[R,T]=(0,u.useState)(),x=(0,u.useMemo)((()=>t.isForceWrapper()),[t]),k=(0,u.useMemo)((()=>t.getCellAriaRole()),[t]),P=(0,u.useRef)(null),A=(0,u.useRef)(null),F=(0,u.useRef)(null),D=(0,u.useRef)(),I=(0,u.useRef)(),M=(0,u.useRef)(),O=(0,u.useRef)([]),L=(0,u.useRef)(),[N,_]=(0,u.useState)(0),G=(0,u.useCallback)((e=>{L.current=e,_((e=>e+1))}),[]),B=x||null!=c&&(C||S||b),H=(0,u.useCallback)((e=>{if(I.current=e,e){const r=e.isCancelBeforeStart&&e.isCancelBeforeStart();setTimeout((()=>{r?(t.stopEditing(!0),t.focusCell(!0)):t.cellEditorAttached()}))}}),[t]),z=(0,u.useRef)();z.current||(z.current=new an((()=>P.current))),fh(c,B,L.current,N,D,P);const V=(0,u.useRef)();(0,u.useLayoutEffect)((()=>{const e=V.current,t=c;if(V.current=c,null==e||null==e.compDetails||null==t||null==t.compDetails)return;const r=e.compDetails,n=t.compDetails;if(r.componentClass!=n.componentClass)return;if(null==F.current?.refresh)return;1!=F.current.refresh(n.params)&&f((e=>e+1))}),[c]),(0,u.useLayoutEffect)((()=>{if(!(h&&!h.compDetails.componentFromFramework))return;const e=h.compDetails,t=!0===h.popup,r=e.newAgStackInstance();return r.then((e=>{if(!e)return;const r=e.getGui();if(H(e),!t){const t=(x?M:P).current;t?.appendChild(r),e.afterGuiAttached&&e.afterGuiAttached()}T(e)})),()=>{r.then((e=>{const t=e.getGui();s.destroyBean(e),H(void 0),T(void 0),t?.parentElement?.removeChild(t)}))}}),[h]);const W=(0,u.useCallback)((e=>{if(M.current=e,!e)return O.current.forEach((e=>e())),void(O.current=[]);const r=t=>{if(t){const r=t.getGui();e.insertAdjacentElement("afterbegin",r),O.current.push((()=>{s.destroyBean(t),ce(r)}))}return t};if(C){r(t.createSelectionCheckbox())}S&&r(t.createDndSource()),b&&r(t.createRowDragComp())}),[t,s,S,b,C]),U=(0,u.useCallback)((()=>{const e=!t.isCellSpanning()||A.current,i=P.current;if(l.current=i?s.createBean(new sn):s.destroyBean(l.current),!i||!e||!t)return;const o={addOrRemoveCssClass:(e,t)=>z.current.addOrRemoveCssClass(e,t),setUserStyles:e=>v(e),getFocusableElement:()=>P.current,setIncludeSelection:e=>w(e),setIncludeRowDrag:e=>y(e),setIncludeDndSource:e=>E(e),getCellEditor:()=>I.current||null,getCellRenderer:()=>F.current??D.current,getParentOfValue:()=>L.current??M.current??P.current,setRenderDetails:(e,t,r)=>{d((n=>n?.compDetails!==e||n?.value!==t||n?.force!==r?{value:t,compDetails:e,force:r}:n))},setEditDetails:(e,r,n,i)=>{if(e){let t;i?t=new ph(e.params,(()=>f((e=>e+1)))):e.componentFromFramework&&ih(),p({compDetails:e,popup:r,popupPosition:n,compProxy:t}),r||d(void 0)}else{t.hasBrowserFocus()&&o.getFocusableElement().focus({preventScroll:!0}),p((e=>{e?.compProxy&&(I.current=void 0)}))}}},a=M.current||void 0;t.setComp(o,i,A.current??void 0,a,r,n,l.current)}),[]),j=(0,u.useCallback)((e=>{P.current=e,U()}),[]),$=(0,u.useCallback)((e=>{A.current=e,U()}),[]),K=(0,u.useMemo)((()=>!!(c?.compDetails?.componentFromFramework&&Fd(c.compDetails.componentClass))),[c]);(0,u.useLayoutEffect)((()=>{P.current&&(z.current.addOrRemoveCssClass("ag-cell-value",!B),z.current.addOrRemoveCssClass("ag-cell-inline-editing",!!h&&!h.popup),z.current.addOrRemoveCssClass("ag-cell-popup-editing",!!h&&!!h.popup),z.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!h||!!h.popup),t.setInlineEditingCss())}));const Y=()=>u.createElement(u.Fragment,null,null!=c&&((e,t,r,n,i,s,o)=>{const{compDetails:a,value:l}=e,c=!a,d=a&&a.componentFromFramework,h=a&&a.componentClass,p=l?.toString?l.toString():l,g=()=>u.createElement(u.Fragment,null,c&&u.createElement(u.Fragment,null,p),d&&!s&&u.createElement(h,{...a.params,key:t,ref:n}),d&&s&&u.createElement(h,{...a.params,key:t}));return u.createElement(u.Fragment,null,i?u.createElement("span",{role:"presentation",id:`cell-${r}`,className:"ag-cell-value",ref:o},g()):g())})(c,g,a,F,B,K,G),null!=h&&((e,t,r,n,i)=>{const s=e.compDetails,o=s.componentClass,a=s.componentFromFramework&&!e.popup,l=s.componentFromFramework&&e.popup,c=!s.componentFromFramework&&e.popup;return u.createElement(u.Fragment,null,a&&mh(e,o,t),l&&u.createElement(gh,{editDetails:e,cellCtrl:n,eParentCell:r,wrappedContent:mh(e,o,t)}),c&&i&&u.createElement(gh,{editDetails:e,cellCtrl:n,eParentCell:r,jsChildComp:i}))})(h,H,P.current,t,R)),q=()=>u.createElement("div",{ref:j,style:m,role:k,"col-id":o},B?u.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:W},Y()):Y());return t.isCellSpanning()?u.createElement("div",{ref:$,className:"ag-spanned-cell-wrapper",role:"presentation"},q()):q()})),Ch=(0,u.memo)((e=>{let{rowCtrl:t,containerType:r}=e;const{context:n,gos:i}=(0,u.useContext)(Td),s=(0,u.useRef)(),o=(0,u.useRef)(t.getDomOrder()),a=t.isFullWidth(),l=t.rowNode.displayed,[c,d]=(0,u.useState)((()=>l?t.rowNode.getRowIndexString():null)),[h,p]=(0,u.useState)((()=>t.rowId)),[g,f]=(0,u.useState)((()=>t.businessKey)),[m,v]=(0,u.useState)((()=>t.rowStyles)),C=(0,u.useRef)(null),w=(0,u.useRef)(null),[b,y]=(0,u.useState)((()=>null)),[S,E]=(0,u.useState)(),[R,T]=(0,u.useState)((()=>l?t.getInitialRowTop(r):void 0)),[x,k]=(0,u.useState)((()=>l?t.getInitialTransform(r):void 0)),P=(0,u.useRef)(null),A=(0,u.useRef)(),F=(0,u.useRef)(!1),[D,I]=(0,u.useState)(0);(0,u.useEffect)((()=>{if(F.current||!S||D>10)return;const e=P.current?.firstChild;e?(t.setupDetailRowAutoHeight(e),F.current=!0):I((e=>e+1))}),[S,D]);const M=(0,u.useRef)();M.current||(M.current=new an((()=>P.current)));const O=(0,u.useCallback)((e=>{if(P.current=e,s.current=e?n.createBean(new sn):n.destroyBean(s.current),!e)return void t.unsetComp(r);if(!t.isAlive())return;const i={setTop:T,setTransform:k,addOrRemoveCssClass:(e,t)=>M.current.addOrRemoveCssClass(e,t),setDomOrder:e=>o.current=e,setRowIndex:d,setRowId:p,setRowBusinessKey:f,setUserStyles:v,setCellCtrls:(e,t)=>{w.current=C.current,C.current=e;const r=Ld(w.current,e,o.current);r!==w.current&&Od(t,(()=>y(r)))},showFullWidth:e=>E(e),getFullWidthCellRenderer:()=>A.current,refreshFullWidth:e=>B.current?(E((t=>({...t,params:e()}))),!0):!(!A.current||!A.current.refresh)&&A.current.refresh(e())};t.setComp(i,e,r,s.current)}),[]);(0,u.useLayoutEffect)((()=>xd(S,n,P.current,A)),[S]);const L=(0,u.useMemo)((()=>{const e={top:R,transform:x};return Object.assign(e,m),e}),[R,x,m]),N=a&&S?.componentFromFramework,_=!a&&null!=b,G=(0,u.useMemo)((()=>!!(S?.componentFromFramework&&Fd(S.componentClass))),[S]),B=(0,u.useRef)(!1);(0,u.useEffect)((()=>{B.current=G&&!!S&&!!i.get("reactiveCustomComponents")}),[G,S]);return u.createElement("div",{ref:O,role:"row",style:L,"row-index":c,"row-id":h,"row-business-key":g},_&&b?.map((e=>u.createElement(vh,{cellCtrl:e,editingRow:t.editing,printLayout:t.printLayout,key:e.instanceId}))),N&&(()=>{const e=S.componentClass;return u.createElement(u.Fragment,null,G?u.createElement(e,{...S.params}):u.createElement(e,{...S.params,ref:A}))})())})),wh=(0,u.memo)((e=>{let{name:t}=e;const{context:r,gos:n}=(0,u.useContext)(Td),i=(0,u.useMemo)((()=>Fs(t)),[t]),s=(0,u.useRef)(null),o=(0,u.useRef)(null),a=(0,u.useRef)(null),l=(0,u.useRef)([]),c=(0,u.useRef)([]),[d,h]=(0,u.useState)((()=>[])),p=!!n.get("enableCellSpan")&&!!i.getSpannedRowCtrls,g=(0,u.useRef)([]),f=(0,u.useRef)([]),[m,v]=(0,u.useState)((()=>[])),C=(0,u.useRef)(!1),w=(0,u.useRef)(),b=(0,u.useMemo)((()=>Pd("ag-viewport",ks(t))),[t]),y=(0,u.useMemo)((()=>Pd(Ps(t))),[t]),S=(0,u.useMemo)((()=>Pd("ag-spanning-container",As(t))),[t]),E="center"===i.type||p;hh(" AG Row Container "+t+" ",E?s:o);const R=(0,u.useCallback)((()=>{const e=!E||null!=s.current,t=null!=o.current,r=!p||null!=a.current;return e&&t&&r}),[]),T=(0,u.useCallback)((()=>null==s.current&&null==o.current&&null==a.current),[]),x=(0,u.useCallback)((()=>{if(T()&&(w.current=r.destroyBean(w.current)),R()){const e=e=>{const t=Ld(c.current,l.current,C.current);t!==c.current&&(c.current=t,Od(e,(()=>h(t))))},n=e=>{const t=Ld(f.current,g.current,C.current);t!==f.current&&(f.current=t,Od(e,(()=>v(t))))},i={setHorizontalScroll:e=>{s.current&&(s.current.scrollLeft=e)},setViewportHeight:e=>{s.current&&(s.current.style.height=e)},setRowCtrls:t=>{let{rowCtrls:r,useFlushSync:n}=t;const i=!!n&&l.current.length>0&&r.length>0;l.current=r,e(i)},setSpannedRowCtrls:(e,t)=>{const r=!!t&&g.current.length>0&&e.length>0;g.current=e,n(r)},setDomOrder:t=>{C.current!=t&&(C.current=t,e(!1))},setContainerWidth:e=>{o.current&&(o.current.style.width=e)},setOffsetTop:e=>{o.current&&(o.current.style.transform=`translateY(${e})`)}};w.current=r.createBean(new Bs(t)),w.current.setComp(i,o.current,a.current??void 0,s.current)}}),[R,T]),k=(0,u.useCallback)((e=>{o.current=e,x()}),[x]),P=(0,u.useCallback)((e=>{a.current=e,x()}),[x]),A=(0,u.useCallback)((e=>{s.current=e,x()}),[x]),F=()=>u.createElement("div",{className:y,ref:k,role:"rowgroup"},d.map((e=>u.createElement(Ch,{rowCtrl:e,containerType:i.type,key:e.instanceId}))));if(!E)return F();return u.createElement("div",{className:b,ref:A,role:"presentation"},F(),p&&u.createElement("div",{className:S,ref:P,role:"rowgroup"},m.map((e=>u.createElement(Ch,{rowCtrl:e,containerType:i.type,key:e.instanceId})))))})),bh=(0,u.memo)((()=>{const e=(0,u.useContext)(Td),{context:t,overlays:r}=e,[n,i]=(0,u.useState)(""),[s,o]=(0,u.useState)(0),[a,l]=(0,u.useState)(0),[c,d]=(0,u.useState)("0px"),[h,p]=(0,u.useState)("0px"),[g,f]=(0,u.useState)("100%"),[m,v]=(0,u.useState)("0px"),[C,w]=(0,u.useState)("0px"),[b,y]=(0,u.useState)("100%"),[S,E]=(0,u.useState)(!0),[R,T]=(0,u.useState)(!0),[x,k]=(0,u.useState)(null),[P,A]=(0,u.useState)(""),[D,M]=(0,u.useState)(null),[O,L]=(0,u.useState)("ag-layout-normal"),N=(0,u.useRef)();N.current||(N.current=new an((()=>_.current)));const _=(0,u.useRef)(null),G=(0,u.useRef)(null),B=(0,u.useRef)(null),H=(0,u.useRef)(null),z=(0,u.useRef)(null),V=(0,u.useRef)(null),W=(0,u.useRef)(null),U=(0,u.useRef)([]),j=(0,u.useRef)([]);hh(" AG Grid Body ",_),hh(" AG Pinned Top ",G),hh(" AG Sticky Top ",B),hh(" AG Middle ",V),hh(" AG Pinned Bottom ",W);const $=(0,u.useCallback)((n=>{if(_.current=n,!n)return U.current=t.destroyBeans(U.current),j.current.forEach((e=>e())),void(j.current=[]);if(!t)return;const s=(e,t)=>{e.appendChild(t),j.current.push((()=>e.removeChild(t)))},a=(e,r,n)=>{s(e,document.createComment(n)),s(e,(e=>{const r=t.createBean(new e);return U.current.push(r),r})(r).getGui())};a(n,Us," AG Fake Horizontal Scroll ");const c=r?.getOverlayWrapperCompClass();c&&a(n,c," AG Overlay Wrapper "),z.current&&a(z.current,$s," AG Fake Vertical Scroll ");const u={setRowAnimationCssOnBodyViewport:i,setColumnCount:e=>{_.current&&I(_.current,e)},setRowCount:e=>{_.current&&F(_.current,e)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:d,setStickyTopTop:p,setStickyTopWidth:f,setTopInvisible:E,setBottomInvisible:T,setColumnMovingCss:(e,t)=>N.current.addOrRemoveCssClass(e,t),updateLayoutClasses:L,setAlwaysVerticalScrollClass:k,setPinnedTopBottomOverflowY:A,setCellSelectableCss:(e,t)=>M(t?e:null),setBodyViewportWidth:e=>{V.current&&(V.current.style.width=e)},registerBodyViewportResizeListener:t=>{if(V.current){const r=we(e,V.current,t);j.current.push((()=>r()))}},setStickyBottomHeight:v,setStickyBottomBottom:w,setStickyBottomWidth:y,setGridRootRole:e=>n.setAttribute("role",e)},h=t.createBean(new zs);U.current.push(h),h.setComp(u,n,V.current,G.current,W.current,B.current,H.current)}),[]),K=(0,u.useMemo)((()=>Pd("ag-root","ag-unselectable",O)),[O]),Y=(0,u.useMemo)((()=>Pd("ag-body-viewport",n,O,x,D)),[n,O,x,D]),q=(0,u.useMemo)((()=>Pd("ag-body",O)),[O]),X=(0,u.useMemo)((()=>Pd("ag-floating-top",S?"ag-invisible":null,D)),[D,S]),J=(0,u.useMemo)((()=>Pd("ag-sticky-top",D)),[D]),Q=(0,u.useMemo)((()=>Pd("ag-sticky-bottom","0px"===m?"ag-invisible":null,D)),[D,m]),Z=(0,u.useMemo)((()=>Pd("ag-floating-bottom",R?"ag-invisible":null,D)),[D,R]),ee=(0,u.useMemo)((()=>({height:s,minHeight:s,overflowY:P})),[s,P]),te=(0,u.useMemo)((()=>({height:c,top:h,width:g})),[c,h,g]),re=(0,u.useMemo)((()=>({height:m,bottom:C,width:b})),[m,C,b]),ne=(0,u.useMemo)((()=>({height:a,minHeight:a,overflowY:P})),[a,P]),ie=e=>u.createElement(wh,{name:e,key:`${e}-container`}),se=e=>{let{section:t,children:r,className:n,style:i}=e;return u.createElement("div",{ref:t,className:n,role:"presentation",style:i},r.map(ie))};return u.createElement("div",{ref:$,className:K},u.createElement(dh,null),se({section:G,className:X,style:ee,children:["topLeft","topCenter","topRight","topFullWidth"]}),u.createElement("div",{className:q,ref:z,role:"presentation"},se({section:V,className:Y,children:["left","center","right","fullWidth"]})),se({section:B,className:J,style:te,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),se({section:H,className:Q,style:re,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),se({section:W,className:Z,style:ne,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))})),yh=(0,u.forwardRef)(((e,t)=>{const{children:r,eFocusableElement:n,onTabKeyDown:i,gridCtrl:s,forceFocusOutWhenTabGuardsAreEmpty:o,isEmpty:a}=e,{context:l}=(0,u.useContext)(Td),c=(0,u.useRef)(null),d=(0,u.useRef)(null),h=(0,u.useRef)(),p=e=>{const t=null==e?void 0:parseInt(e,10).toString();[c,d].forEach((e=>{void 0===t?e.current?.removeAttribute("tabindex"):e.current?.setAttribute("tabindex",t)}))};(0,u.useImperativeHandle)(t,(()=>({forceFocusOutOfContainer(e){h.current?.forceFocusOutOfContainer(e)}})));const g=(0,u.useCallback)((()=>{const e=c.current,t=d.current;if(e||t){if(e&&t){const r={setTabIndex:p};h.current=l.createBean(new Vo({comp:r,eTopGuard:e,eBottomGuard:t,eFocusableElement:n,onTabKeyDown:i,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:e=>s.focusInnerElement(e),isEmpty:a}))}}else h.current=l.destroyBean(h.current)}),[]),f=(0,u.useCallback)((e=>{c.current=e,g()}),[g]),m=(0,u.useCallback)((e=>{d.current=e,g()}),[g]),v=e=>{const t="top"===e?Ho:zo;return u.createElement("div",{className:`${Bo} ${t}`,role:"presentation",ref:"top"===e?f:m})};return u.createElement(u.Fragment,null,v("top"),r,v("bottom"))})),Sh=(0,u.memo)(yh),Eh=(0,u.memo)((e=>{let{context:t}=e;const[r,n]=(0,u.useState)(""),[i,s]=(0,u.useState)(""),[o,a]=(0,u.useState)(null),[l,c]=(0,u.useState)(null),[d,h]=(0,u.useState)(!1),[p,g]=(0,u.useState)(),f=(0,u.useRef)(),m=(0,u.useRef)(null),v=(0,u.useRef)(),[C,w]=(0,u.useState)(null),b=(0,u.useRef)((()=>{})),y=(0,u.useRef)(),S=(0,u.useRef)([]),E=(0,u.useCallback)((()=>{}),[]),R=(0,u.useMemo)((()=>t.isDestroyed()?null:t.getBeans()),[t]);hh(" AG Grid ",m);const T=(0,u.useCallback)((e=>{if(m.current=e,f.current=e?t.createBean(new Qo):t.destroyBean(f.current),!e||t.isDestroyed())return;const r=f.current;b.current=r.focusInnerElement.bind(r);const i={destroyGridUi:()=>{},setRtlClass:n,forceFocusOutOfContainer:e=>{e||!y.current?.isDisplayed()?v.current?.forceFocusOutOfContainer(e):y.current.forceFocusOutOfContainer(e)},updateLayoutClasses:s,getFocusableContainers:()=>{const e=[],t=m.current?.querySelector(".ag-root");return t&&e.push({getGui:()=>t}),S.current.forEach((t=>{t.isDisplayed()&&e.push(t)})),e},setCursor:a,setUserSelect:c};r.setComp(i,e,e),h(!0)}),[]);(0,u.useEffect)((()=>{const e=f.current,r=m.current;if(!p||!R||!e||!C||!r)return;const n=[],{watermarkSelector:i,paginationSelector:s,sideBarSelector:o,statusBarSelector:a,gridHeaderDropZonesSelector:l}=e.getOptionalSelectors(),c=[];if(l){const e=t.createBean(new l.component),i=e.getGui();r.insertAdjacentElement("afterbegin",i),c.push(i),n.push(e)}if(o){const e=t.createBean(new o.component),r=e.getGui(),i=C.querySelector(".ag-tab-guard-bottom");i&&(i.insertAdjacentElement("beforebegin",r),c.push(r)),n.push(e),S.current.push(e)}const u=e=>{const i=t.createBean(new e),s=i.getGui();return r.insertAdjacentElement("beforeend",s),c.push(s),n.push(i),i};if(a&&u(a.component),s){const e=u(s.component);y.current=e,S.current.push(e)}return i&&u(i.component),()=>{t.destroyBeans(n),c.forEach((e=>{e.parentElement?.removeChild(e)}))}}),[p,C,R]);const x=(0,u.useMemo)((()=>Pd("ag-root-wrapper",r,i)),[r,i]),k=(0,u.useMemo)((()=>Pd("ag-root-wrapper-body","ag-focus-managed",i)),[i]),P=(0,u.useMemo)((()=>({userSelect:null!=l?l:"",WebkitUserSelect:null!=l?l:"",cursor:null!=o?o:""})),[l,o]),A=(0,u.useCallback)((e=>{v.current=e,g(null!==e)}),[]),F=(0,u.useCallback)((()=>!f.current?.isFocusable()),[]);return u.createElement("div",{ref:T,className:x,style:P,role:"presentation"},u.createElement("div",{className:k,ref:w,role:"presentation"},d&&C&&R&&u.createElement(Td.Provider,{value:R},u.createElement(Sh,{ref:A,eFocusableElement:C,onTabKeyDown:E,gridCtrl:f.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:F},u.createElement(bh,null)))))})),Rh=class extends rr{wireBeans(e){this.ctrlsSvc=e.ctrlsSvc}areHeaderCellsRendered(){return this.ctrlsSvc.getHeaderRowContainerCtrls().every((e=>e.getAllCtrls().every((e=>e.areCellsRendered()))))}},Th=new Set(Object.keys({gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,setGridApi:void 0,componentWrappingElement:void 0,maxComponentCreationTimeMs:void 0,children:void 0})),xh=e=>{const t=(0,u.useRef)(),r=(0,u.useRef)(null),n=(0,u.useRef)(null),i=(0,u.useRef)([]),s=(0,u.useRef)([]),o=(0,u.useRef)(e),a=(0,u.useRef)(),l=(0,u.useRef)(),c=(0,u.useRef)(!1),[d,h]=(0,u.useState)(void 0),[,p]=(0,u.useState)(0),g=(0,u.useCallback)((o=>{if(r.current=o,!o)return i.current.forEach((e=>e())),void(i.current.length=0);const u=e.modules||[];n.current||(n.current=new sh((()=>p((e=>e+1))),e.componentWrappingElement,e.maxComponentCreationTimeMs),i.current.push((()=>{n.current?.destroy(),n.current=null})));const d=function(e,t,r){"object"!==typeof e&&(e={});const n={...e};return r.forEach((e=>{const r=t[e];"undefined"!==typeof r&&(n[e]=r)})),n}(e.gridOptions,e,Object.keys(e).filter((e=>!Th.has(e)))),g=new Ah((()=>{if(c.current){const e=()=>a.current?.shouldQueueUpdates()?void 0:s.current.shift();let t=e();for(;t;)t(),t=e()}}));a.current=g;const f=new Rh,m={providedBeanInstances:{frameworkCompWrapper:new kh(n.current,d.reactiveCustomComponents??(v="reactiveCustomComponents",Lc.gridOptions?.[v])??!0),renderStatus:f},modules:u,frameworkOverrides:g,setThemeOnGridDiv:!0};var v;const C=new _c;d.gridId??(d.gridId=l.current),t.current=C.create(o,d,(r=>{h(r),r.createBean(f),i.current.push((()=>{r.destroy()})),r.getBean("ctrlsSvc").whenReady({addDestroyFunc:e=>{i.current.push(e)}},(()=>{if(r.isDestroyed())return;const n=t.current;n&&e.setGridApi?.(n)}))}),(e=>{e.getBean("ctrlsSvc").whenReady({addDestroyFunc:e=>{i.current.push(e)}},(()=>{s.current.forEach((e=>e())),s.current.length=0,c.current=!0}))}),m),i.current.push((()=>{t.current=void 0})),t.current&&(l.current=t.current.getGridId())}),[]),f=(0,u.useMemo)((()=>({height:"100%",...e.containerStyle||{}})),[e.containerStyle]),m=(0,u.useCallback)((e=>{c.current&&!a.current?.shouldQueueUpdates()?e():s.current.push(e)}),[]);return(0,u.useEffect)((()=>{const r=function(e,t){const r={};return Object.keys(t).forEach((n=>{if(Th.has(n))return;const i=t[n];e[n]!==i&&(r[n]=i)})),r}(o.current,e);o.current=e,m((()=>{t.current&&function(e,t){if(!e)return;const r={};let n=!1;if(Object.keys(e).forEach((t=>{r[t]=e[t],n=!0})),!n)return;const i={type:"gridOptionsChanged",options:r};t.dispatchEvent(i);const s={type:"componentStateChanged",...r};t.dispatchEvent(s)}(r,t.current)}))}),[e]),u.createElement("div",{style:f,className:e.className,ref:g},d&&!d.isDestroyed()?u.createElement(Eh,{context:d}):null,n.current?.getPortals()??null)};var kh=class extends Vc{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const r=(e=>{switch(e){case"filter":return Yd;case"floatingFilterComponent":return Jd;case"dateComponent":return $d;case"dragAndDropImageComponent":return Kd;case"loadingOverlayComponent":return Zd;case"noRowsOverlayComponent":return th;case"statusPanel":return rh;case"toolPanel":return nh;case"menuItem":return eh;case"cellRenderer":return jd;case"innerHeaderComponent":return Qd}})(t.name);if(r)return new r(e,this.parent,t)}else switch(t.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":ih()}const r=!t.cellRenderer&&"toolPanel"!==t.name;return new Vd(e,this.parent,t,r)}},Ph=(0,u.forwardRef)(((e,t)=>{const r=(0,u.useContext)(Td),{registry:n,context:i,gos:s,rowModel:o}=r,[a,l]=(0,u.useState)((()=>new Ad)),[c,d]=(0,u.useState)((()=>new Ad)),[h,p]=(0,u.useState)(),[g,f]=(0,u.useState)(),m=(0,u.useRef)(),v=(0,u.useRef)(null),C=(0,u.useRef)(),w=(0,u.useMemo)((()=>$n(e.api.getGridId(),h?.rowModelType??"clientSide")),[e]),b=(0,u.useMemo)((()=>a.toString()+" ag-details-row"),[a]),y=(0,u.useMemo)((()=>c.toString()+" ag-details-grid"),[c]);t&&(0,u.useImperativeHandle)(t,(()=>({refresh:()=>m.current?.refresh()??!1}))),e.template&&et(230);const S=(0,u.useCallback)((t=>{if(v.current=t,!t)return m.current=i.destroyBean(m.current),void C.current?.();const a={addOrRemoveCssClass:(e,t)=>l((r=>r.setClass(e,t))),addOrRemoveDetailGridCssClass:(e,t)=>d((r=>r.setClass(e,t))),setDetailGrid:e=>p(e),setRowData:e=>f(e),getGui:()=>v.current},c=n.createDynamicBean("detailCellRendererCtrl",!0);if(c&&(i.createBean(c),c.init(a,e),m.current=c,s.get("detailRowAutoHeight"))){const n=()=>{if(null==v.current)return;const t=v.current.clientHeight;if(null!=t&&t>0){setTimeout((()=>{e.node.setRowHeight(t),(ot(s)||at(s))&&o.onRowHeightChanged()}),0)}};C.current=we(r,t,n),n()}}),[]),E=(0,u.useCallback)((e=>{m.current?.registerDetailWithMaster(e)}),[]);return u.createElement("div",{className:b,ref:S},h&&u.createElement(xh,{className:y,...h,modules:w,rowData:g,setGridApi:E}))})),Ah=class extends Ko{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:_d,agGroupRowRenderer:_d,agDetailCellRenderer:Ph},this.wrapIncoming=(e,t)=>{return"ensureVisible"===t?(r=e,Md||setTimeout((()=>Md=!1),0),Md=!0,r()):e();var r}}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return"19"===Dd}},Fh=class extends u.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e,this.apiListeners.forEach((t=>t(e)))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return u.createElement(xh,{...this.props,setGridApi:this.setGridApi})}};var Dh=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility="5d41402abc4b2a76b9719d911017c592"!=this.md5("hello")}md5cycle(e,t){let r=e[0],n=e[1],i=e[2],s=e[3];r=this.ff(r,n,i,s,t[0],7,-680876936),s=this.ff(s,r,n,i,t[1],12,-389564586),i=this.ff(i,s,r,n,t[2],17,606105819),n=this.ff(n,i,s,r,t[3],22,-1044525330),r=this.ff(r,n,i,s,t[4],7,-176418897),s=this.ff(s,r,n,i,t[5],12,1200080426),i=this.ff(i,s,r,n,t[6],17,-1473231341),n=this.ff(n,i,s,r,t[7],22,-45705983),r=this.ff(r,n,i,s,t[8],7,1770035416),s=this.ff(s,r,n,i,t[9],12,-1958414417),i=this.ff(i,s,r,n,t[10],17,-42063),n=this.ff(n,i,s,r,t[11],22,-1990404162),r=this.ff(r,n,i,s,t[12],7,1804603682),s=this.ff(s,r,n,i,t[13],12,-40341101),i=this.ff(i,s,r,n,t[14],17,-1502002290),n=this.ff(n,i,s,r,t[15],22,1236535329),r=this.gg(r,n,i,s,t[1],5,-165796510),s=this.gg(s,r,n,i,t[6],9,-1069501632),i=this.gg(i,s,r,n,t[11],14,643717713),n=this.gg(n,i,s,r,t[0],20,-373897302),r=this.gg(r,n,i,s,t[5],5,-701558691),s=this.gg(s,r,n,i,t[10],9,38016083),i=this.gg(i,s,r,n,t[15],14,-660478335),n=this.gg(n,i,s,r,t[4],20,-405537848),r=this.gg(r,n,i,s,t[9],5,568446438),s=this.gg(s,r,n,i,t[14],9,-1019803690),i=this.gg(i,s,r,n,t[3],14,-187363961),n=this.gg(n,i,s,r,t[8],20,1163531501),r=this.gg(r,n,i,s,t[13],5,-1444681467),s=this.gg(s,r,n,i,t[2],9,-51403784),i=this.gg(i,s,r,n,t[7],14,1735328473),n=this.gg(n,i,s,r,t[12],20,-1926607734),r=this.hh(r,n,i,s,t[5],4,-378558),s=this.hh(s,r,n,i,t[8],11,-2022574463),i=this.hh(i,s,r,n,t[11],16,1839030562),n=this.hh(n,i,s,r,t[14],23,-35309556),r=this.hh(r,n,i,s,t[1],4,-1530992060),s=this.hh(s,r,n,i,t[4],11,1272893353),i=this.hh(i,s,r,n,t[7],16,-155497632),n=this.hh(n,i,s,r,t[10],23,-1094730640),r=this.hh(r,n,i,s,t[13],4,681279174),s=this.hh(s,r,n,i,t[0],11,-358537222),i=this.hh(i,s,r,n,t[3],16,-722521979),n=this.hh(n,i,s,r,t[6],23,76029189),r=this.hh(r,n,i,s,t[9],4,-640364487),s=this.hh(s,r,n,i,t[12],11,-421815835),i=this.hh(i,s,r,n,t[15],16,530742520),n=this.hh(n,i,s,r,t[2],23,-995338651),r=this.ii(r,n,i,s,t[0],6,-198630844),s=this.ii(s,r,n,i,t[7],10,1126891415),i=this.ii(i,s,r,n,t[14],15,-1416354905),n=this.ii(n,i,s,r,t[5],21,-57434055),r=this.ii(r,n,i,s,t[12],6,1700485571),s=this.ii(s,r,n,i,t[3],10,-1894986606),i=this.ii(i,s,r,n,t[10],15,-1051523),n=this.ii(n,i,s,r,t[1],21,-2054922799),r=this.ii(r,n,i,s,t[8],6,1873313359),s=this.ii(s,r,n,i,t[15],10,-30611744),i=this.ii(i,s,r,n,t[6],15,-1560198380),n=this.ii(n,i,s,r,t[13],21,1309151649),r=this.ii(r,n,i,s,t[4],6,-145523070),s=this.ii(s,r,n,i,t[11],10,-1120210379),i=this.ii(i,s,r,n,t[2],15,718787259),n=this.ii(n,i,s,r,t[9],21,-343485551),e[0]=this.add32(r,e[0]),e[1]=this.add32(n,e[1]),e[2]=this.add32(i,e[2]),e[3]=this.add32(s,e[3])}cmn(e,t,r,n,i,s){return t=this.add32(this.add32(t,e),this.add32(n,s)),this.add32(t<<i|t>>>32-i,r)}ff(e,t,r,n,i,s,o){return this.cmn(t&r|~t&n,e,t,i,s,o)}gg(e,t,r,n,i,s,o){return this.cmn(t&n|r&~n,e,t,i,s,o)}hh(e,t,r,n,i,s,o){return this.cmn(t^r^n,e,t,i,s,o)}ii(e,t,r,n,i,s,o){return this.cmn(r^(t|~n),e,t,i,s,o)}md51(e){const t=e.length,r=[1732584193,-271733879,-1732584194,271733878];let n;for(n=64;n<=e.length;n+=64)this.md5cycle(r,this.md5blk(e.substring(n-64,n)));e=e.substring(n-64);const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(this.md5cycle(r,i),n=0;n<16;n++)i[n]=0;return i[14]=8*t,this.md5cycle(r,i),r}md5blk(e){const t=[];for(let r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}rhex(e){const t="0123456789abcdef".split("");let r="",n=0;for(;n<4;n++)r+=t[e>>8*n+4&15]+t[e>>8*n&15];return r}hex(e){for(let t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")}md5(e){return this.hex(this.md51(e))}add32(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)}add32Std(e,t){return e+t&4294967295}add32Compat(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}},Ih={"01":"GRID","02":"CHARTS","0102":"BOTH"},Mh="https://www.ag-grid.com/licensing/",Oh=class e{constructor(e){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new Dh,this.md5.init()}validateLicense(){const t=this.getLicenseDetails(e.licenseKey),r=`AG Grid ${"BOTH"===t.currentLicenseType?"and AG Charts ":""}Enterprise`,n=void 0===t.suppliedLicenseType?"":`AG ${"BOTH"===t.suppliedLicenseType?"Grid and AG Charts":"GRID"===t.suppliedLicenseType?"Grid":"Charts"} Enterprise`;if(t.missing)this.isWebsiteUrl()&&!this.isForceWatermark()||this.outputMissingLicenseKey(r);else if(t.expired){const i=e.getGridReleaseDate(),s=e.formatDate(i);this.outputExpiredKey(t.expiry,s,r,n)}else t.valid?t.isTrial&&t.trialExpired&&this.outputExpiredTrialKey(t.expiry,r,n):this.outputInvalidLicenseKey(!!t.incorrectLicenseType,r,n)}static extractExpiry(t){const r=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(e.decode(r),10))}static extractLicenseComponents(t){let r=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(r=r.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};const n=r.length-32,i=r.substring(n),s=r.substring(0,n),[o,a,l]=e.extractBracketedInformation(r);return{md5:i,license:s,version:o,isTrial:a,type:l}}getLicenseDetails(t){const r=e.chartsLicenseManager?"BOTH":"GRID";if(!t?.length)return{licenseKey:t,valid:!1,missing:!0,currentLicenseType:r};const n=e.getGridReleaseDate(),{md5:i,license:s,version:o,isTrial:a,type:l}=e.extractLicenseComponents(t);let c,u,d,h=i===this.md5.md5(s)&&-1===t.indexOf("For_Trialing_ag-Grid_Only"),p=null,g=!1;function f(){c=p<new Date,u=void 0}if(h&&(p=e.extractExpiry(s),h=!isNaN(p.getTime()),h))switch(u=n>p,o){case"legacy":case"2":a&&f();break;case"3":l?.length?(d=l,l!==Ih["01"]&&l!==Ih["0102"]||"BOTH"===r&&"BOTH"!==d?(h=!1,g=!0):a&&f()):h=!1}return h?{licenseKey:t,valid:h,expiry:e.formatDate(p),expired:u,version:o,isTrial:a,trialExpired:c,incorrectLicenseType:g,currentLicenseType:r,suppliedLicenseType:d}:{licenseKey:t,valid:h,incorrectLicenseType:g,currentLicenseType:r,suppliedLicenseType:d}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!!this.watermarkMessage?.length}getWatermarkMessage(){return this.watermarkMessage||""}getHostname(){const e=(this.document.defaultView||window).location,{hostname:t=""}=e;return t}isForceWatermark(){const e=(this.document.defaultView||window).location,{pathname:t}=e;return!!t&&-1!==t.indexOf("forceWatermark")}isWebsiteUrl(){return null!==this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)}isLocalhost(){return null!==this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)}static formatDate(e){const t=e.getDate(),r=e.getMonth(),n=e.getFullYear();return t+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][r]+" "+n}static getGridReleaseDate(){return new Date(parseInt(e.decode(e.RELEASE_INFORMATION),10))}static decode(t){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n,i,s,o,a,l,c,u="",d=0;const h=t.replace(/[^A-Za-z0-9+/=]/g,"");for(;d<h.length;)o=r.indexOf(h.charAt(d++)),a=r.indexOf(h.charAt(d++)),l=r.indexOf(h.charAt(d++)),c=r.indexOf(h.charAt(d++)),n=o<<2|a>>4,i=(15&a)<<4|l>>2,s=(3&l)<<6|c,u+=String.fromCharCode(n),64!=l&&(u+=String.fromCharCode(i)),64!=c&&(u+=String.fromCharCode(s));return u=e.utf8_decode(u),u}static utf8_decode(e){e=e.replace(/rn/g,"n");let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}static setChartsLicenseManager(e){this.chartsLicenseManager=e}static setLicenseKey(e){this.licenseKey=e,this.chartsLicenseManager?.setLicenseKey(e,!0)}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const t=e.match(/\[(.*?)\]/g).map((e=>e.replace("[","").replace("]","")));if(!t||0===t.length)return["legacy",!1,void 0];const r=1===t.filter((e=>"TRIAL"===e)).length,n=t.filter((e=>0===e.indexOf("v")))[0];return[n?n.replace("v",""):"legacy",r,Ih[t.filter((e=>Ih[e]))[0]]]}centerPadAndOutput(e){const t=this.totalMessageLength-e.length;console.error(e.padStart(t/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";console.error(e.padEnd(this.totalMessageLength-r.length,t)+r)}outputInvalidLicenseKey(e,t,r){e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${r} only and does not cover you for ${t}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Mh}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Mh}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,t,r){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${t} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${r} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,t,r,n){this.centerPadAndOutput(""),this.centerPadAndOutput(` ${r} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${n} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${t}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""),this.watermarkMessage="License Expired"}};Oh.RELEASE_INFORMATION="MTc0NDc4ODcwODE2Nw==";var Lh=Oh,Nh={tag:"div",cls:"ag-watermark",children:[{tag:"div",ref:"eLicenseTextRef",cls:"ag-watermark-text"}]},_h={selector:"AG-WATERMARK",component:class extends un{constructor(){super(Nh),this.eLicenseTextRef=cn,this.registerCSS('.ag-watermark{bottom:20px;color:#9b9b9b;opacity:.7;position:absolute;transition:opacity 1s ease-out 3s;&:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDkiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyMDkgMzYiPjxwYXRoIGZpbGw9IiM5QjlCOUIiIGQ9Ik0xOTIuOTkzIDIzLjY1OHYtNy45NDZoLTEzLjU0MWwtNy45NDcgNy45NDZ6TTIwOC4yNSAzLjk1aC0xNi45NzRsLTguMDEgNy45NDdoMjQuOTg0ek0xNjMuNjIyIDMxLjYwNWw0LjA2OS00LjA2OWgxMy43MzJ2Ny45NDdoLTE3LjgwMXoiLz48cGF0aCBmaWxsPSIjOUI5QjlCIiBkPSJNMTY2LjYxIDE5Ljc4aDguNzczbDguMDEtNy45NDZIMTY2LjYxek0xNTcuMDExIDMxLjYwNWg2LjYxMWw3Ljg4My03Ljk0N2gtMTQuNDk0ek0xOTEuMjc2IDMuOTVsLTQuMDY4IDQuMDdIMTYxLjI3Vi4wNzJoMzAuMDA2ek0yMC44NCAzMC4yMDZIOC4zNzhsLTIuMTYyIDUuMzRILjc1TDEyLjI1NyA4LjU5Mmg0Ljc2OEwyOC41MyAzNS41NDZoLTUuNTN6bS0xLjcxNy00LjI2TDE0LjYwOSAxNC45NWwtNC41MTQgMTAuOTk4ek0xMDQuNDM3IDE4LjUwOWMxLjU4OS0yLjM1MiA1LjU5NC0yLjYwNyA3LjI0Ny0yLjYwN3Y0LjU3OGMtMi4wMzQgMC00LjA2OS4wNjMtNS4yNzcuOTUzLTEuMjA3Ljg5LTEuODQzIDIuMDk4LTEuODQzIDMuNTZ2MTAuNTUzaC00Ljk1OVYxNS45MDJoNC43Njh6TTExOS4zNzYgMTUuOTAyaC00Ljk1OHYxOS42NDRoNC45NTh6TTExOS4zNzYgNy4xM2gtNC45NTh2NS44NDhoNC45NTh6TTE0My45NzkgNy4xM3YyOC40MTZoLTQuNzY4bC0uMTI3LTIuOTg4YTguMyA4LjMgMCAwIDEtMi42NyAyLjQ4Yy0xLjA4MS41NzItMi40MTYuODktMy45NDIuODktMS4zMzUgMC0yLjYwNi0uMjU1LTMuNjg3LS43LTEuMTQ0LS41MDgtMi4xNjItMS4xNDQtMi45ODgtMi4wMzRhOS42IDkuNiAwIDAgMS0xLjk3MS0zLjE3OWMtLjUwOC0xLjIwNy0uNjk5LTIuNjA2LS42OTktNC4xMzJzLjI1NC0yLjkyNC42OTktNC4xOTZjLjUwOS0xLjI3MSAxLjE0NS0yLjM1MiAxLjk3MS0zLjI0MnMxLjg0NC0xLjU4OSAyLjk4OC0yLjA5OCAyLjM1Mi0uNzYzIDMuNjg3LS43NjNjMS41MjYgMCAyLjc5Ny4yNTUgMy44NzguODI3czEuOTcxIDEuMzM1IDIuNjcgMi40MTZWNy4xOTNoNC45NTl6bS0xMC40MjYgMjQuNTM4YzEuNjUzIDAgMi45MjQtLjU3MiAzLjk0MS0xLjY1M3MxLjUyNi0yLjU0MyAxLjUyNi00LjMyMy0uNTA5LTMuMTc4LTEuNTI2LTQuMzIyYy0xLjAxNy0xLjA4MS0yLjI4OC0xLjY1My0zLjk0MS0xLjY1My0xLjU5IDAtMi45MjUuNTcyLTMuODc4IDEuNjUzLTEuMDE3IDEuMDgtMS41MjYgMi41NDMtMS41MjYgNC4zMjIgMCAxLjc4LjUwOSAzLjE4IDEuNTI2IDQuMjYgMS4wMTcgMS4xNDQgMi4yODggMS43MTYgMy44NzggMS43MTZNNTcuMjAyIDIwLjM1M0g0NC45MzN2NC4yNTloNi45OTNjLS4xOSAyLjE2MS0xLjAxNyAzLjgxNC0yLjQxNiA1LjE1LTEuMzk4IDEuMjctMy4xNzggMS45MDYtNS40NjcgMS45MDYtMS4yNzEgMC0yLjQ4LS4yNTQtMy40OTYtLjY5OWE3IDcgMCAwIDEtMi43MzQtMS45N2MtLjc2My0uODI3LTEuMzM1LTEuODQ0LTEuNzgtMy4wNTJzLS42MzYtMi40OC0uNjM2LTMuOTQyLjE5LTIuNzMzLjYzNi0zLjk0MWMuMzgxLTEuMjA4IDEuMDE3LTIuMTYyIDEuNzgtMy4wNTIuNzYzLS44MjYgMS42NTMtMS40NjIgMi43MzMtMS45N2E5LjEgOS4xIDAgMCAxIDMuNTYtLjdxNC4wMDUgMCA2LjEwMyAxLjkwN2wzLjMwNi0zLjMwNWMtMi40OC0xLjkwNy01LjY1OC0yLjkyNS05LjQwOS0yLjkyNS0yLjA5NyAwLTQuMDA0LjMxOC01LjcyMSAxLjAxOC0xLjcxNi42OTktMy4xNzkgMS41ODktNC4zODYgMi43OTdBMTIuMSAxMi4xIDAgMCAwIDMxLjIgMTYuMjJjLS42MzUgMS43MTctLjk1MyAzLjYyNC0uOTUzIDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1NyAxLjAxNyAyLjAzNSAwIDMuODc4LS4zMTggNS41MzEtMS4wMTcgMS42NTMtLjcgMy4wNTItMS41OSA0LjE5Ni0yLjc5N3ExLjcxNi0xLjgxMiAyLjY3LTQuMzg3Yy42MzYtMS43MTYuOTU0LTMuNjIzLjk1NC01LjY1OHYtLjgyNmMtLjE5MS0uMTI3LS4yNTUtLjQ0NS0uMjU1LS43TTk1Ljk4MiAyMC4zNTNoLTEyLjI3djQuMjU5aDYuOTkzYy0uMTkgMi4xNjEtMS4wMTcgMy44MTQtMi40MTYgNS4xNS0xLjM5OCAxLjI3LTMuMTc4IDEuOTA2LTUuNDY3IDEuOTA2LTEuMjcxIDAtMi40OC0uMjU0LTMuNDk2LS42OTlhNyA3IDAgMCAxLTIuNzM0LTEuOTdjLS43NjMtLjgyNy0xLjMzNS0xLjg0NC0xLjc4LTMuMDUycy0uNjM2LTIuNDgtLjYzNi0zLjk0Mi4xOS0yLjczMy42MzYtMy45NDFjLjM4MS0xLjIwOCAxLjAxNy0yLjE2MiAxLjc4LTMuMDUyLjc2My0uODI2IDEuNjUzLTEuNDYyIDIuNzM0LTEuOTdhOS4xIDkuMSAwIDAgMSAzLjU2LS43cTQuMDA1IDAgNi4xMDMgMS45MDdsMy4zMDUtMy4zMDVjLTIuNDc5LTEuOTA3LTUuNjU4LTIuOTI1LTkuNDA4LTIuOTI1LTIuMDk4IDAtNC4wMDUuMzE4LTUuNzIyIDEuMDE4LTEuNzE2LjY5OS0zLjE3OCAxLjU4OS00LjM4NiAyLjc5N2ExMi4xIDEyLjEgMCAwIDAtMi43OTcgNC4zODZjLS42MzYgMS43MTctLjk1NCAzLjYyNC0uOTU0IDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1OCAxLjAxNyAyLjAzNCAwIDMuODc4LS4zMTggNS41My0xLjAxNyAxLjY1My0uNyAzLjA1Mi0xLjU5IDQuMTk2LTIuNzk3cTEuNzE4LTEuODEyIDIuNjctNC4zODdjLjYzNi0xLjcxNi45NTQtMy42MjMuOTU0LTUuNjU4di0uODI2Yy0uMTktLjEyNy0uMjU1LS40NDUtLjI1NS0uNyIvPjwvc3ZnPg==");background-repeat:no-repeat;background-size:170px 40px;content:"";display:block;height:40px;width:170px}}:where(.ag-ltr) .ag-watermark{right:25px}:where(.ag-rtl) .ag-watermark{left:25px}.ag-watermark-text{font-family:Impact,sans-serif;font-size:19px;font-weight:700;opacity:.5}:where(.ag-ltr) .ag-watermark-text{padding-left:.7rem}:where(.ag-rtl) .ag-watermark-text{padding-right:.7rem}')}wireBeans(e){this.licenseManager=e.licenseManager}postConstruct(){const e=this.shouldDisplayWatermark();this.setDisplayed(e),e&&(this.eLicenseTextRef.textContent=this.licenseManager.getWatermarkMessage(),window.setTimeout((()=>this.addCssClass("ag-opacity-zero")),0),window.setTimeout((()=>this.setDisplayed(!1)),5e3))}shouldDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}}};var Gh="33.2.4",Bh={moduleName:"EnterpriseCore",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="licenseManager"}postConstruct(){this.validateLicense()}validateLicense(){this.licenseManager=new Lh(mt(this.beans)),this.licenseManager.validateLicense()}static getLicenseDetails(e){return new Lh(null).getLicenseDetails(e)}getWatermarkSelector(){return _h}isDisplayWatermark(){return this.licenseManager.isDisplayWatermark()}getWatermarkMessage(){return this.licenseManager.getWatermarkMessage()}static setLicenseKey(e){Lh.setLicenseKey(e)}static setChartsLicenseManager(e){Lh.setChartsLicenseManager(e)}}],icons:{accordionOpen:"tree-open",accordionClosed:"tree-closed",accordionIndeterminate:"tree-indeterminate",close:"cross",cancel:"cancel",maximize:"maximize",minimize:"minimize",columnDrag:"grip"},dependsOn:[]};var Hh=class extends Uo{constructor(e){super(function(e){return{tag:"div",cls:`ag-virtual-list-viewport ag-${e}-virtual-list-viewport`,role:"presentation",children:[{tag:"div",ref:"eContainer",cls:`ag-virtual-list-container ag-${e}-virtual-list-container`}]}}(e?.cssIdentifier||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0,this.eContainer=cn,this.awaitStableCallbacks=[];const{cssIdentifier:t="default",ariaRole:r="listbox",listName:n,moveItemCallback:i}=e||{};this.cssIdentifier=t,this.ariaRole=r,this.listName=n,this.moveItemCallback=i}wireBeans(e){this.environment=e.environment}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:e=>this.focusInnerElement(e),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.refreshAriaProperties(),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanged.bind(this)})}onGridStylesChanged(e){e.listItemHeightChanged&&(this.rowHeight=this.getItemHeight(),this.refresh())}refreshAriaProperties(){const e=this.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),t=this.eContainer;b(t,this.model?.getRowCount()>0?this.ariaRole:"presentation"),y(t,e)}addResizeObserver(){const e=we(this.beans,this.getGui(),(()=>be(this.beans,(()=>this.drawVirtualRows()))));this.addDestroyFunc(e)}focusInnerElement(e){return this.focusRow(e?this.model.getRowCount()-1:0),!0}onFocusIn(e){const t=e.target;t.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=parseInt(t.getAttribute("aria-posinset"),10)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){const{key:t,shiftKey:r}=e;switch(t){case Qn.UP:case Qn.DOWN:{const n=t===Qn.UP;e.preventDefault(),r?this.moveItem(n):this.navigate(n)}break;case Qn.PAGE_HOME:case Qn.PAGE_END:case Qn.PAGE_UP:case Qn.PAGE_DOWN:null!==this.navigateToPage(t)&&e.preventDefault()}}onTabKeyDown(e){Xt(e),this.forceFocusOutOfContainer(e.shiftKey)}getNextRow(e){if(null==this.lastFocusedRowIndex)return;const t=this.lastFocusedRowIndex+(e?-1:1);return t<0||t>=this.model.getRowCount()?void 0:t}moveItem(e){if(!this.moveItemCallback)return;const t=this.getComponentAt(this.lastFocusedRowIndex);t&&this.moveItemCallback(t,e)}navigate(e){const t=this.getNextRow(e);void 0!==t&&this.focusRow(t)}navigateToPage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"focused",r=!1;"focused"===t&&(t=this.getLastFocusedRow(),r=!0);const n=this.model.getRowCount()-1;let i=-1;return e===Qn.PAGE_HOME?i=0:e===Qn.PAGE_END?i=n:e===Qn.PAGE_DOWN?i=Math.min(t+this.pageSize,n):e===Qn.PAGE_UP&&(i=Math.max(t-this.pageSize,0)),-1===i?null:(r?this.focusRow(i):this.ensureIndexVisible(i),i)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(e){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(e),be(this.beans,(()=>{if(this.isScrolling=!1,!this.isAlive())return;const t=this.renderedRows.get(e);t&&t.eDiv.focus()})))}getComponentAt(e){const t=this.renderedRows.get(e);return t&&t.rowComponent}forEachRenderedRow(e){this.renderedRows.forEach(((t,r)=>e(t.rowComponent,r)))}getItemHeight(){return this.isHeightFromTheme?this.environment.getDefaultListItemHeight():this.rowHeight}ensureIndexVisible(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=this.model.getRowCount();if("number"!==typeof e||e<0||e>=r)return et(229,{index:e}),!1;const n=e*this.rowHeight,i=n+this.rowHeight,s=this.getGui(),o=s.scrollTop,a=s.offsetHeight,l=o+a,c=t?0:this.rowHeight,u=l<i-c;if(o>n+c)return s.scrollTop=n,!0;if(u){const e=i-a;return s.scrollTop=e,!0}return!1}setComponentCreator(e){this.componentCreator=e}setComponentUpdater(e){this.componentUpdater=e}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(e){this.isHeightFromTheme=!1,this.rowHeight=e,this.refresh()}refresh(e){if(null==this.model||!this.isAlive())return;const t=this.model.getRowCount();this.eContainer.style.height=t*this.rowHeight+"px",this.refreshAriaProperties(),this.awaitStable((()=>{this.isAlive()&&(this.canSoftRefresh(e)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))}))}awaitStable(e){if(this.awaitStableCallbacks.push(e),this.awaitStableCallbacks.length>1)return;const t=this.model.getRowCount();Ve((()=>this.eContainer.clientHeight>=t*this.rowHeight),(()=>{if(!this.isAlive())return;const e=this.awaitStableCallbacks;this.awaitStableCallbacks=[],e.forEach((e=>e()))}))}canSoftRefresh(e){return!!(e&&this.renderedRows.size&&"function"===typeof this.model.areRowsEqual&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach(((e,t)=>this.removeRow(t)))}drawVirtualRows(e){if(!this.isAlive()||!this.model)return;const t=this.getGui(),r=t.scrollTop,n=r+t.offsetHeight;if(r===n)this.clearVirtualRows();else{const t=Math.floor(r/this.rowHeight),i=Math.floor(n/this.rowHeight);this.pageSize=Math.floor((n-r)/this.rowHeight),this.ensureRowsRendered(t,i,e)}}ensureRowsRendered(e,t,r){this.renderedRows.forEach(((r,n)=>{(n<e||n>t)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)})),r&&this.refreshRows();for(let n=e;n<=t;n++)this.renderedRows.has(n)||n<this.model.getRowCount()&&this.insertRow(n)}insertRow(e){const t=this.model.getRow(e),r="tree"===this.ariaRole?"treeitem":"option",n=Re({tag:"div",cls:`ag-virtual-list-item ag-${this.cssIdentifier}-virtual-list-item`,role:r,attrs:{tabindex:"-1"}});P(n,this.model.getRowCount()),A(n,e+1),n.style.height=`${this.rowHeight}px`,n.style.top=this.rowHeight*e+"px";const i=this.componentCreator(t,n);i.addGuiEventListener("focusin",(()=>this.lastFocusedRowIndex=e)),n.appendChild(i.getGui()),this.renderedRows.has(e-1)?this.renderedRows.get(e-1).eDiv.insertAdjacentElement("afterend",n):this.renderedRows.has(e+1)?this.renderedRows.get(e+1).eDiv.insertAdjacentElement("beforebegin",n):this.eContainer.appendChild(n),this.renderedRows.set(e,{rowComponent:i,eDiv:n,value:t})}removeRow(e){const t=this.renderedRows.get(e);this.eContainer.removeChild(t.eDiv),this.destroyBean(t.rowComponent),this.renderedRows.delete(e)}refreshRows(){const e=this.model.getRowCount();this.renderedRows.forEach(((t,r)=>{if(r>=e)this.removeRow(r);else{const e=this.model.getRow(r);this.model.areRowsEqual?.(t.value,e)?this.componentUpdater(e,t.rowComponent):this.removeRow(r)}}))}addScrollListener(){this.addGuiEventListener("scroll",(()=>this.drawVirtualRows()),{passive:!0})}setModel(e){this.model=e}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),this.awaitStableCallbacks.length=0,super.destroy())}};function zh(e,t,r){e.group!==r&&(e.group&&!r&&(e.expanded=!1),e.group=r,e.updateHasChildren(),t.selectionSvc?.updateRowSelectable(e),e.dispatchRowEvent("groupChanged"))}function Vh(e,t){const{gos:r,rowGroupColsSvc:n}=t;if(!n||!e)return!1;const i=r.get("groupLockGroupColumns");if(!e.isRowGroupActive()||0===i)return!1;if(-1===i)return!0;return i>n.columns.findIndex((t=>t.getColId()===e.getColId()))}function Wh(e,t,r){null!=e&&null!=t&&e.splice(r,0,...t)}var Uh={tag:"div",cls:"ag-unselectable",role:"presentation"},jh=class extends un{constructor(e){super(Uh),this.horizontal=e,this.state="notDragging",this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=Re({tag:"div"}),this.addElementClasses(this.ePillDropList,"list"),this.registerCSS(".ag-column-drop{align-items:center;display:inline-flex;overflow:auto;position:relative;width:100%}.ag-column-drop-list{align-items:center;display:flex}.ag-column-drop-cell{align-items:center;background-color:var(--ag-column-drop-cell-background-color);border:var(--ag-column-drop-cell-border);border-radius:500px;color:var(--ag-column-drop-cell-text-color);display:flex;padding:calc(var(--ag-spacing)*.25);position:relative;&:focus-visible{box-shadow:var(--ag-focus-shadow)}:where(.ag-drag-handle){color:var(--ag-column-drop-cell-drag-handle-color)}}:where(.ag-ltr) .ag-column-drop-cell{padding-left:calc(var(--ag-spacing)*.75)}:where(.ag-rtl) .ag-column-drop-cell{padding-right:calc(var(--ag-spacing)*.75)}.ag-column-drop-cell-text{flex:1 1 auto;margin:0 var(--ag-spacing);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-column-drop-vertical{align-items:stretch;display:flex;flex-direction:column;min-height:75px;overflow:hidden}.ag-column-drop-vertical-title-bar{align-items:center;display:flex;flex:none;padding:var(--ag-widget-container-vertical-padding) calc(var(--ag-spacing)*2) 0}.ag-column-drop-vertical-list{align-items:stretch;flex-direction:column;flex-grow:1;overflow-x:auto;padding-bottom:var(--ag-spacing);padding-left:var(--ag-spacing);padding-right:var(--ag-spacing);position:relative;>*{flex:none}}:where(.ag-column-drop-empty) .ag-column-drop-vertical-list{overflow:hidden}.ag-column-drop-cell-button{cursor:pointer;min-width:0;opacity:.75;&:hover{opacity:1}}.ag-column-drop-wrapper{display:flex}.ag-column-drop-horizontal-half-width{width:50%!important}.ag-column-drop-cell-ghost{opacity:.5}.ag-column-drop-horizontal{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;white-space:nowrap}:where(.ag-ltr) .ag-column-drop-horizontal{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-column-drop-horizontal{padding-right:var(--ag-cell-horizontal-padding)}.ag-column-drop-horizontal-list{gap:var(--ag-cell-widget-spacing)}.ag-column-drop-vertical-cell{margin-top:var(--ag-spacing)}:where(.ag-ltr) .ag-column-drop-vertical-icon{margin-right:var(--ag-widget-horizontal-spacing)}:where(.ag-rtl) .ag-column-drop-vertical-icon{margin-left:var(--ag-widget-horizontal-spacing)}.ag-select-agg-func-popup{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);height:calc(var(--ag-spacing)*5*3.5);padding:0;position:absolute}.ag-select-agg-func-virtual-list-item{cursor:default;&:hover{background-color:var(--ag-selected-row-background-color)}}:where(.ag-ltr) .ag-select-agg-func-virtual-list-item{padding-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-select-agg-func-virtual-list-item{padding-right:calc(var(--ag-spacing)*2)}:where(.ag-ltr) .ag-column-drop-horizontal-half-width:where(:not(:last-child)){border-right:1px solid var(--ag-border-color)}:where(.ag-rtl) .ag-column-drop-horizontal-half-width:where(:not(:last-child)){border-left:1px solid var(--ag-border-color)}")}toggleResizable(e){this.positionableFeature.setResizable(!!e&&{bottom:!0}),this.resizeEnabled=e}isSourceEventFromTarget(e){const{dropZoneTarget:t,dragSource:r}=e;return t.contains(r.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach((e=>e())),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,le(this.getGui()),le(this.ePillDropList)}init(e){this.params=e??{},this.createManagedBean(new Yi(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.onKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new $i(this.getGui()),this.createManagedBean(this.positionableFeature),this.refreshGui(),y(this.ePillDropList,this.getAriaLabel())}onTabKeyDown(e){const t=si(this.getFocusableElement(),null,!0),r=t.length;if(0===r)return;const{shiftKey:n}=e,i=wt(this.beans),s=i===t[0],o=i===br(t);1===r||s&&n||o&&!n||t[n?0:r-1].focus()}onKeyDown(e){const{key:t}=e,r=!this.horizontal;let n=t===Qn.DOWN,i=t===Qn.UP;if(!r){const e=this.gos.get("enableRtl");n=!e&&t===Qn.RIGHT||e&&t===Qn.LEFT,i=!e&&t===Qn.LEFT||e&&t===Qn.RIGHT}if(n||i)if(e.preventDefault(),e.shiftKey)this.moveFocusedItem(i);else{const e=ai(this.beans,this.getFocusableElement(),!1,i);e&&e.focus()}}moveFocusedItem(e){const t=this.getFocusedItem();if(-1===t)return;const r=e?-1:1;if(!this.normalizeAndUpdateInsertIndex(t,t+r))return;const n=this.childPillComponents[t];if(!n.isMovable())return;const i=n.getItem();this.focusItemAtIndex(this.insertIndex),this.rearrangeItems([i],!0)}addElementClasses(e,t){t=t?`-${t}`:"";const r=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop${t}`,`ag-column-drop-${r}${t}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),onDragCancel:this.onDragCancel.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.beans.dragAndDrop?.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(e){const t=this.getNewInsertIndex(e);return!(t<0)&&this.normalizeAndUpdateInsertIndex(this.insertIndex,t)}normalizeAndUpdateInsertIndex(e,t){const r=this.minimumAllowedNewInsertIndex(),n=Math.max(r,t),i=n!==e;return i&&(this.insertIndex=n),i}getNewInsertIndex(e){const t=e.event,r=this.horizontal?t.clientX:t.clientY,n=this.childPillComponents.map((e=>e.getGui().getBoundingClientRect())),i=n.findIndex((e=>this.horizontal?e.right>r&&e.left<r:e.top<r&&e.bottom>r));if(-1===i){const e=this.gos.get("enableRtl");if(n.every((e=>r>(this.horizontal?e.right:e.bottom))))return e&&this.horizontal?0:this.childPillComponents.length;return n.every((e=>r<(this.horizontal?e.left:e.top)))?e&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=i?i+1:i}checkDragStartedBySelf(e){"notDragging"===this.state&&(this.state="rearrangeItems",this.potentialDndItems=this.getItems(e.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(e),this.refreshGui())}onDragging(e){this.checkDragStartedBySelf(e),this.checkInsertIndex(e)&&this.refreshGui()}handleDragEnterEnd(e){}onDragEnter(e){const t=this.getItems(e.dragSource.getDragItem());this.state="newItemsIn";const r=t.filter((t=>this.isItemDroppable(t,e))),n=r.every((e=>-1!==this.childPillComponents.map((e=>e.getItem())).indexOf(e)));0!==r.length&&(this.potentialDndItems=r,n?this.state="notDragging":(this.handleDragEnterEnd(e),this.checkInsertIndex(e),this.refreshGui()))}isPotentialDndItems(){return!!this.potentialDndItems?.length}handleDragLeaveEnd(e){}onDragLeave(e){if("rearrangeItems"===this.state){const t=this.getItems(e.dragSource.getDragItem());this.removeItems(t)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}onDragCancel(e){this.isPotentialDndItems()&&("newItemsIn"===this.state&&this.handleDragLeaveEnd(e),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}onDragStop(){this.isPotentialDndItems()&&("newItemsIn"===this.state?this.addItems(this.potentialDndItems):this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],this.refreshGui()),this.state="notDragging"}removeItems(e){const t=this.getExistingItems().filter((t=>!e.includes(t)));this.updateItems(t)}addItems(e){if(!e)return;const t=this.getExistingItems().slice(),r=e.filter((e=>t.indexOf(e)<0));Wh(t,r,this.insertIndex),this.updateItems(t)}addItem(e){this.insertIndex=this.getExistingItems().length,this.addItems([e]),this.refreshGui()}rearrangeItems(e,t){let r;return r=t?this.getExistingItems().filter((t=>-1===e.indexOf(t))):this.getNonGhostItems().slice(),Wh(r,e,this.insertIndex),!yr(r,this.getExistingItems())&&(this.updateItems(r),!0)}refreshGui(){let e=0;this.horizontal||(e=this.ePillDropList.scrollTop);const t=this.resizeEnabled,r=this.getFocusedItem(),{eGridDiv:n}=this.beans,i=ni();let s=null;i&&(s=ai(this.beans,n)??ai(this.beans,n,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),0!==e&&(this.ePillDropList.scrollTop=e),t&&this.toggleResizable(t),i&&this.restoreFocus(r,s)}getFocusedItem(){const e=this.getGui(),t=wt(this.beans);if(!e.contains(t))return-1;return Array.from(e.querySelectorAll(".ag-column-drop-cell")).indexOf(t)}focusItemAtIndex(e){const t=this.getGui(),r=Array.from(t.querySelectorAll(".ag-column-drop-cell"))[e];r&&r.focus({preventScroll:!0})}restoreFocus(e,t){const r=this.getGui(),n=Array.from(r.querySelectorAll(".ag-column-drop-cell"));if(-1===e)return;0===n.length&&t.focus();const i=n[Math.min(n.length-1,e)];i&&i.focus()}focusList(e){const t=e?this.childPillComponents.length-1:0;this.restoreFocus(t,this.getFocusableElement())}getNonGhostItems(){const e=this.getExistingItems();return this.isPotentialDndItems()?e.filter((e=>!this.potentialDndItems.includes(e))):e}addItemsToGui(){const e=this.getNonGhostItems().map((e=>this.createItemComponent(e,!1)));if(this.isPotentialDndItems()){const t=this.potentialDndItems.map((e=>this.createItemComponent(e,!0)));this.insertIndex>=e.length?e.push(...t):e.splice(this.insertIndex,0,...t)}this.appendChild(this.ePillDropList),e.forEach(((e,t)=>{t>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(e.getGui())})),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){const{childPillComponents:e,ePillDropList:t}=this,r=e.length;b(t,0===r?"presentation":"listbox");for(let n=0;n<r;n++){const t=e[n].getGui();A(t,n+1),P(t,r)}}createItemComponent(e,t){const r=this.createPillComponent(e,this.dropTarget,t,this.horizontal);return r.addEventListener("columnRemove",this.removeItems.bind(this,[e])),this.createBean(r),this.guiDestroyFunctions.push((()=>this.destroyBean(r))),t||this.childPillComponents.push(r),r}addIconAndTitleToGui(){const{title:e,icon:t}=this.params;if(!e||!t)return;const r=Re({tag:"div"});if(T(r,!0),this.addElementClasses(r,"title-bar"),this.addElementClasses(t,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),r.appendChild(t),!this.horizontal){const t=Re({tag:"span"});this.addElementClasses(t,"title"),t.textContent=e,r.appendChild(t)}this.appendChild(r)}isExistingItemsEmpty(){return 0===this.getExistingItems().length}addEmptyMessageToGui(){const{emptyMessage:e}=this.params;if(!e||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const t=Re({tag:"span"});t.textContent=e,this.addElementClasses(t,"empty-message"),this.ePillDropList.appendChild(t)}addArrow(e){if(this.horizontal){const t=vo(this.gos.get("enableRtl")?"panelDelimiterRtl":"panelDelimiter",this.beans);this.addElementClasses(t,"cell-separator"),e.appendChild(t)}}},$h={tag:"span",role:"option",children:[{tag:"span",ref:"eDragHandle",cls:"ag-drag-handle ag-column-drop-cell-drag-handle",role:"presentation"},{tag:"span",ref:"eText",cls:"ag-column-drop-cell-text",attrs:{"aria-hidden":"true"}},{tag:"span",ref:"eButton",cls:"ag-column-drop-cell-button",role:"presentation"}]},Kh=class extends un{constructor(e,t,r,n,i){super(),this.dragSourceDropTarget=e,this.ghost=t,this.horizontal=r,this.template=n,this.agComponents=i,this.eText=cn,this.eDragHandle=cn,this.eButton=cn}postConstruct(){this.setTemplate(this.template??$h,this.agComponents);const e=this.getGui(),{beans:t,eDragHandle:r,eText:n,eButton:i}=this;this.addElementClasses(e),this.addElementClasses(r,"drag-handle"),this.addElementClasses(n,"text"),this.addElementClasses(i,"button"),r.appendChild(vo("columnDrag",t)),i.appendChild(vo("cancel",t)),this.tooltipFeature=this.createOptionalManagedBean(t.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.getGui()})),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const e=this.getLocaleTextFunc(),t=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(t,e),y(this.getGui(),t.join(". "))}addAdditionalAriaInstructions(e,t){if(this.isRemovable()){const r=t("ariaDropZoneColumnComponentDescription","Press DELETE to remove");e.push(r)}}setupTooltip(){const e=()=>this.tooltipFeature?.setTooltipAndRefresh(this.getTooltip());e(),this.addManagedEventListeners({newColumnsLoaded:e})}getDragSourceId(){}getDefaultIconName(){return"notAllowed"}addDragSource(){const{beans:{dragAndDrop:e},eDragHandle:t}=this,r=this.createGetDragItem(),n=this.getDefaultIconName(),i={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:t,getDefaultIconName:()=>n,getDragItem:r,dragItemName:this.getDisplayName()};e?.addDragSource(i,!0),this.addDestroyFunc((()=>e?.removeDragSource(i)))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){X(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const e={type:"columnRemove"};this.addGuiEventListener("keydown",(e=>this.onKeyDown(e))),this.addManagedElementListeners(this.eButton,{click:t=>{this.dispatchLocalEvent(e),t.stopPropagation()}});const t=new $o(this.eButton);this.addManagedListeners(t,{tap:()=>this.dispatchLocalEvent(e)}),this.addDestroyFunc(t.destroy.bind(t))}onKeyDown(e){e.key===Qn.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchLocalEvent({type:"columnRemove"}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const e=cr(this.getDisplayValue());this.eText.innerHTML=e}addElementClasses(e,t){t=t?`-${t}`:"";const r=this.horizontal?"horizontal":"vertical";e.classList.add(`ag-column-drop-cell${t}`,`ag-column-drop-${r}-cell${t}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}},Yh=class extends Kh{constructor(e,t,r,n,i){super(t,r,i),this.column=e,this.dropZonePurpose=n,this.eSortIndicator=cn,this.popupShowing=!1}postConstruct(){const{sortSvc:e,colNames:t}=this.beans;this.template={tag:"span",role:"option",children:[{tag:"span",ref:"eDragHandle",cls:"ag-drag-handle ag-column-drop-cell-drag-handle",role:"presentation"},{tag:"span",ref:"eText",cls:"ag-column-drop-cell-text",attrs:{"aria-hidden":"true"}},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:void 0,{tag:"span",ref:"eButton",cls:"ag-column-drop-cell-button",role:"presentation"}]},e&&(this.agComponents=[e.getSortIndicatorSelector()]),this.displayName=t.getDisplayNameForColumn(this.column,"columnDrop"),super.postConstruct(),e&&(this.setupSort(),this.addManagedEventListeners({sortChanged:()=>{this.setupAria()}})),this.isGroupingZone()&&this.addManagedPropertyListener("groupLockGroupColumns",(()=>{this.refreshRemove(),this.refreshDraggable(),this.setupAria()}))}getItem(){return this.column}getDisplayName(){return this.displayName}getTooltip(){return this.column.getColDef().headerTooltip}addAdditionalAriaInstructions(e,t){const r=this.gos.get("rowGroupPanelSuppressSort"),n=this.gos.get("functionsReadOnly");if(this.isAggregationZone()&&!n){const r=t("ariaDropZoneColumnValueItemDescription","Press ENTER to change the aggregation type");e.push(r)}if(this.isGroupingZone()&&this.column.isSortable()&&!r){const r=t("ariaDropZoneColumnGroupItemDescription","Press ENTER to sort");e.push(r)}super.addAdditionalAriaInstructions(e,t)}isMovable(){return this.isDraggable()}isDraggable(){return this.isReadOnly()}isRemovable(){return this.isReadOnly()}isReadOnly(){return!this.isGroupingAndLocked()&&!this.gos.get("functionsReadOnly")}getAriaDisplayName(){const e=this.getLocaleTextFunc(),{name:t,aggFuncName:r}=this.getColumnAndAggFuncName(),n=e("ariaDropZoneColumnComponentAggFuncSeparator"," of "),i={asc:e("ariaDropZoneColumnComponentSortAscending","ascending"),desc:e("ariaDropZoneColumnComponentSortDescending","descending")},s=this.column.getSort(),o=this.gos.get("rowGroupPanelSuppressSort");return[r&&`${r}${n}`,t,this.isGroupingZone()&&!o&&s&&`, ${i[s]}`].filter((e=>!!e)).join("")}getColumnAndAggFuncName(){const e=this.displayName;let t="";if(this.isAggregationZone()){const e=this.column.getAggFunc(),r="string"===typeof e?e:"agg";t=this.getLocaleTextFunc()(r,r)}return{name:e,aggFuncName:t}}setupSort(){if(this.column.isSortable()&&this.isGroupingZone()&&!this.gos.get("rowGroupPanelSuppressSort")){this.eSortIndicator.setupSort(this.column,!0);const e=e=>{e.preventDefault(),this.beans.sortSvc.progressSortFromEvent(this.column,e)};this.addGuiEventListener("click",e),this.addGuiEventListener("keydown",(t=>{t.key===Qn.ENTER&&this.isGroupingZone()&&e(t)}))}}getDefaultIconName(){return"hide"}createGetDragItem(){const{column:e}=this;return()=>{const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}}setupComponents(){super.setupComponents(),this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&this.addGuiEventListener("click",this.onShowAggFuncSelection.bind(this))}onKeyDown(e){super.onKeyDown(e);e.key===Qn.ENTER&&this.isAggregationZone()&&!this.gos.get("functionsReadOnly")&&(e.preventDefault(),this.onShowAggFuncSelection())}getDisplayValue(){const{name:e,aggFuncName:t}=this.getColumnAndAggFuncName();return this.isAggregationZone()?`${t}(${e})`:e}onShowAggFuncSelection(){if(this.popupShowing)return;this.popupShowing=!0;const{aggFuncSvc:e,popupSvc:t}=this.beans,r=new Hh({cssIdentifier:"select-agg-func"}),n=e.getFuncNames(this.column),i=this.getGui(),s=r.getGui();r.setModel({getRow:function(e){return n[e]},getRowCount:function(){return n.length}}),this.createBean(r);const o=Re({tag:"div",cls:"ag-select-agg-func-popup"});o.style.top="0px",o.style.left="0px",o.appendChild(s),o.style.width=`${i.clientWidth}px`;const[a]=this.addManagedElementListeners(o,{focusout:e=>{!o.contains(e.relatedTarget)&&c&&c.hideFunc()}}),l=this.getLocaleTextFunc(),c=t.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:e=>{this.destroyBean(r),this.popupShowing=!1,"Escape"===e?.key&&i.focus(),a&&a()},ariaLabel:l("ariaLabelAggregationFunction","Aggregation Function")});c&&r.setComponentCreator(this.createAggSelect.bind(this,c.hideFunc)),r.addGuiEventListener("keydown",(e=>{if(e.key===Qn.ENTER||e.key===Qn.SPACE){const e=r.getLastFocusedRow();if(null==e)return;const t=r.getComponentAt(e);t&&t.selectItem()}})),t.positionPopupByComponent({type:"aggFuncSelect",eventSource:i,ePopup:o,keepWithinBounds:!0,column:this.column,position:"under"}),r.refresh();let u=n.findIndex((e=>e===this.column.getAggFunc()));-1===u&&(u=0),r.focusRow(u)}createAggSelect(e,t){const r=this.getLocaleTextFunc(),n=t.toString(),i=r(n,n);return new qh((()=>{e(),this.getGui().focus(),this.beans.valueColsSvc?.setColumnAggFunc?.(this.column,t,"toolPanelDragAndDrop")}),i)}isGroupingAndLocked(){return this.isGroupingZone()&&Vh(this.column,this.beans)}isAggregationZone(){return"aggregation"===this.dropZonePurpose}isGroupingZone(){return"rowGroup"===this.dropZonePurpose}getDragSourceType(){return Ti.ToolPanel}destroy(){super.destroy(),this.column=null}},qh=class extends un{constructor(e,t){super({tag:"div",cls:"ag-select-agg-func-item"}),this.selectItem=e,this.getGui().innerText=t,this.addGuiEventListener("click",this.selectItem)}},Xh=class extends jh{constructor(e,t){super(e),this.dropZonePurpose=t,this.addElementClasses(this.getGui(),this.dropZonePurpose.toLowerCase())}init(e){super.init(e),this.addManagedEventListeners({newColumnsLoaded:this.refreshGui.bind(this)}),this.addManagedPropertyListeners(["functionsReadOnly","rowGroupPanelSuppressSort","groupLockGroupColumns"],this.refreshGui.bind(this))}getItems(e){return e.columns??[]}isInterestedIn(e){return e===Ti.HeaderCell||e===Ti.ToolPanel}minimumAllowedNewInsertIndex(){const{gos:e,rowGroupColsSvc:t}=this.beans,r=e.get("groupLockGroupColumns"),n=t?.columns.length??0;return-1===r?n:Math.min(r,n)}showOrHideColumnOnExit(e){return this.isRowGroupPanel()&&It(this.gos,!0)&&!e.fromNudge}handleDragEnterEnd(e){if(this.showOrHideColumnOnExit(e)){const t=e.dragSource.getDragItem().columns;this.setColumnsVisible(t,!1,"uiColumnDragged")}}handleDragLeaveEnd(e){if(this.showOrHideColumnOnExit(e)){const t=e.dragSource.getDragItem();this.setColumnsVisible(t.columns,!0,"uiColumnDragged")}}setColumnsVisible(e,t,r){if(e){const n=e.filter((e=>!e.getColDef().lockVisible));this.beans.colModel.setColsVisible(n,t,r)}}isRowGroupPanel(){return"rowGroup"===this.dropZonePurpose}createPillComponent(e,t,r,n){return new Yh(e,t,r,this.dropZonePurpose,n)}},Jh=class extends Xh{constructor(e){super(e,"pivot")}postConstruct(){const e=this.getLocaleTextFunc(),t=e("pivotColumnsEmptyMessage","Drag here to set column labels"),r=e("pivots","Column Labels");super.init({icon:vo("pivotPanel",this.beans,null),emptyMessage:t,title:r}),this.addManagedEventListeners({newColumnsLoaded:this.refresh.bind(this),columnPivotChanged:this.refresh.bind(this),columnPivotModeChanged:this.checkVisibility.bind(this)}),this.refresh()}getAriaLabel(){return this.getLocaleTextFunc()("ariaPivotDropZonePanelLabel","Column Labels")}refresh(){this.checkVisibility(),this.refreshGui()}checkVisibility(){const e=this.beans.colModel,t=e.isPivotMode();if(this.horizontal)switch(this.gos.get("pivotPanelShow")){case"always":this.setDisplayed(t);break;case"onlyWhenPivoting":{const r=e.isPivotActive();this.setDisplayed(t&&r);break}default:this.setDisplayed(!1)}else this.setDisplayed(t)}isItemDroppable(e,t){return!(this.gos.get("functionsReadOnly")||!e.isPrimary())&&(e.isAllowPivot()&&(!e.isPivotActive()||this.isSourceEventFromTarget(t)))}updateItems(e){this.beans.pivotColsSvc?.setColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"pivot":"notAllowed"}getExistingItems(){return this.beans.pivotColsSvc?.columns??[]}},Qh=class extends Xh{constructor(e){super(e,"rowGroup")}postConstruct(){const e=this.getLocaleTextFunc(),t=e("rowGroupColumnsEmptyMessage","Drag here to set row groups"),r=e("groups","Row Groups");super.init({icon:vo("rowGroupPanel",this.beans,null),emptyMessage:t,title:r}),this.addManagedEventListeners({columnRowGroupChanged:this.refreshGui.bind(this)})}getAriaLabel(){return this.getLocaleTextFunc()("ariaRowGroupDropZonePanelLabel","Row Groups")}isItemDroppable(e,t){return!(this.gos.get("functionsReadOnly")||!e.isPrimary()||e.colDef.showRowGroup)&&(e.isAllowRowGroup()&&(!e.isRowGroupActive()||this.isSourceEventFromTarget(t)))}updateItems(e){this.beans.rowGroupColsSvc?.setColumns(e,"toolPanelUi")}getIconName(){return this.isPotentialDndItems()?"group":"notAllowed"}getExistingItems(){return this.beans.rowGroupColsSvc?.columns??[]}};var Zh={sum:"Sum",first:"First",last:"Last",min:"Min",max:"Max",count:"Count",avg:"Average"};function ep(e){const{values:t}=e;let r=null;for(let n=0;n<t.length;n++){const e=t[n];"number"===typeof e?null===r?r=e:r+="number"===typeof r?e:BigInt(e):"bigint"===typeof e&&(r=null===r?e:("bigint"===typeof r?r:BigInt(r))+e)}return r}function tp(e){return e.values.length>0?e.values[0]:null}function rp(e){return e.values.length>0?br(e.values):null}function np(e){const{values:t}=e;let r=null;for(let n=0;n<t.length;n++){const e=t[n];"number"!==typeof e&&"bigint"!==typeof e||!(null===r||r>e)||(r=e)}return r}function ip(e){const{values:t}=e;let r=null;for(let n=0;n<t.length;n++){const e=t[n];"number"!==typeof e&&"bigint"!==typeof e||!(null===r||r<e)||(r=e)}return r}function sp(e){const{values:t}=e;let r=0;for(let i=0;i<t.length;i++){const e=t[i];r+=null!=e&&"number"===typeof e.value?e.value:1}const n=e.rowNode?.aggData?.[e.column.getColId()];return n&&n.value===r?n:{value:r,toString:function(){return this.value.toString()},toNumber:function(){return this.value}}}function op(e){const{values:t}=e;let r=0,n=0;for(let o=0;o<t.length;o++){const e=t[o];let i=null;"number"===typeof e||"bigint"===typeof e?(i=e,n++):null==e||"number"!==typeof e.value&&"bigint"!==typeof e.value||"number"!==typeof e.count||(i=e.value*("number"===typeof e.value?e.count:BigInt(e.count)),n+=e.count),"number"===typeof i?r+="number"===typeof r?i:BigInt(i):"bigint"===typeof i&&(r=("bigint"===typeof r?r:BigInt(r))+i)}let i=null;n>0&&(i=r/("number"===typeof r?n:BigInt(n)));const s=e.rowNode?.aggData?.[e.column?.getColId()];return s&&s.count===n&&s.value===i?s:{count:n,value:i,toString:function(){return"number"===typeof this.value||"bigint"===typeof this.value?this.value.toString():""},toNumber:function(){return this.value}}}function ap(e,t,r,n,i,s){const o="string"===typeof r?e.aggFuncSvc.getAggFunc(r):r;if("function"!==typeof o)return tt(109,{aggFuncOrString:r}),null;return o(Ut(e.gos,{values:t,column:n,colDef:n.colDef,pivotResultColumn:s,rowNode:i,data:i?.data}))}var lp=new Set(["__localEventService","__objectId","sticky","__autoHeights","__checkAutoHeightsDebounced"]);function cp(e,t){if(e.sibling)return;const r=new Bi(t);Object.keys(e).forEach((t=>{lp.has(t)||(r[t]=e[t])})),r.footer=!0,r.setRowTop(null),r.setRowIndex(null),r.oldRowTop=null,r.id="rowGroupFooter_"+e.id,r.sibling=e,e.sibling=r}function up(e){e.sibling&&(e.sibling.setRowTop(null),e.sibling.setRowIndex(null),e.sibling=void 0)}var dp=class extends rn{constructor(){super(...arguments),this.beanName="valueColsSvc",this.eventName="columnValueChanged",this.columnProcessors={set:(e,t,r)=>this.setValueActive(t,e,r),add:(e,t,r)=>this.setValueActive(!0,e,r),remove:(e,t,r)=>this.setValueActive(!1,e,r)},this.columnExtractors={setFlagFunc:(e,t,r)=>this.setColValueActive(e,t,r),getIndexFunc:()=>{},getInitialIndexFunc:()=>{},getValueFunc:e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0},getInitialValueFunc:e=>null!=e.initialAggFunc&&""!=e.initialAggFunc},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>Er(this.columns,e)}}extractCols(e,t){return this.columns=super.extractCols(e,t),this.columns.forEach((e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?this.setColAggFunc(e,t.aggFunc):e.getAggFunc()||this.setColAggFunc(e,t.initialAggFunc)})),this.columns}setColumnAggFunc(e,t,r){if(!e)return;const n=this.colModel.getColDefCol(e);n&&(this.setColAggFunc(n,t),this.dispatchColumnChangedEvent(this.eventSvc,this.eventName,[n],r))}syncColumnWithState(e,t,r){const n=r("aggFunc").value1;void 0!==n&&("string"===typeof n?(this.setColAggFunc(e,n),e.isValueActive()||(this.setColValueActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e))):(xe(n)&&et(33),e.isValueActive()&&(this.setColValueActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e))))}setValueActive(e,t,r){if(e!==t.isValueActive()&&(this.setColValueActive(t,e,r),e&&!t.getAggFunc()&&this.aggFuncSvc)){const e=this.aggFuncSvc.getDefaultAggFunc(t);this.setColAggFunc(t,e)}}setColAggFunc(e,t){e.aggFunc=t,e.dispatchStateUpdatedEvent("aggFunc")}setColValueActive(e,t,r){e.aggregationActive!==t&&(e.aggregationActive=t,e.dispatchColEvent("columnValueChanged",r))}},hp={moduleName:"SharedAggregation",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="aggFuncSvc",this.aggFuncsMap={},this.initialised=!1}postConstruct(){this.init()}init(){this.initialised||(this.initialiseWithDefaultAggregations(),this.addAggFuncs(this.gos.get("aggFuncs")))}initialiseWithDefaultAggregations(){const e=this.aggFuncsMap;e.sum=ep,e.first=tp,e.last=rp,e.min=np,e.max=ip,e.count=sp,e.avg=op,this.initialised=!0}isAggFuncPossible(e,t){const r=this.getFuncNames(e).includes(t),n=xe(this.aggFuncsMap[t]);return r&&n}getDefaultFuncLabel(e){return Zh[e]??e}getDefaultAggFunc(e){const t=e.getColDef().defaultAggFunc;if(xe(t)&&this.isAggFuncPossible(e,t))return t;if(this.isAggFuncPossible(e,"sum"))return"sum";const r=this.getFuncNames(e);return r?.length?r[0]:null}addAggFuncs(e){if(this.init(),e)for(const t of Object.keys(e))this.aggFuncsMap[t]=e[t]}getAggFunc(e){return this.init(),this.aggFuncsMap[e]}getFuncNames(e){const t=e.getColDef().allowedAggFuncs;return null==t?Object.keys(this.aggFuncsMap).sort():t}clear(){this.aggFuncsMap={}}},class extends rr{constructor(){super(...arguments),this.beanName="aggColNameSvc"}getHeaderName(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const{valueColsSvc:r,colModel:n,rowGroupColsSvc:i}=this.beans,s=e.getColDef().pivotValueColumn;let o,a=null;if(xe(s)){const n=r?.columns??[],i=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===n.length,l=void 0!==e.getColDef().pivotTotalColumnIds;if(i&&!l)return t;a=s?s.getAggFunc():null,o=!0}else{const t=e.isValueActive(),r=n.isPivotMode()||0!==i?.columns.length;t&&r?(a=e.getAggFunc(),o=!0):o=!1}if(o){const e="string"===typeof a?a:"func";return`${this.getLocaleTextFunc()(e,e)}(${t})`}return t}},class extends rr{constructor(){super(...arguments),this.beanName="footerSvc"}addTotalRows(e,t,r,n,i,s){let o=e;if(i){return(n&&kt(this.gos))===s&&(cp(t,this.beans),r(t.sibling,o++)),o}const a=Pt(this.gos);return(n&&a({node:t}))===s&&(cp(t,this.beans),r(t.sibling,o++)),o}getTopDisplayIndex(e,t,r,n){let i=t;if(e[0].footer){if(0===t)return 0;i-=1}const s=e[e.length-1],o=i>=r.length;return s.footer&&o?s.rowIndex:n(i)}getTotalValue(e){return this.getLocaleTextFunc()("footerTotal","Total")+" "+(e??"")}},dp],apiFunctions:{addAggFuncs:function(e,t){e.aggFuncSvc&&e.aggFuncSvc.addAggFuncs(t)},clearAggFuncs:function(e){e.aggFuncSvc&&e.aggFuncSvc.clear()},setColumnAggFunc:function(e,t,r){e.valueColsSvc?.setColumnAggFunc?.(t,r,"api")}},dependsOn:[Bh]},pp={moduleName:"Aggregation",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="aggStage",this.refreshProps=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","suppressAggFilteredOnly","grandTotalRow"]),this.step="aggregate"}wireBeans(e){this.colModel=e.colModel,this.pivotColsSvc=e.pivotColsSvc,this.valueColsSvc=e.valueColsSvc,this.pivotResultCols=e.pivotResultCols,this.valueSvc=e.valueSvc}execute(e){const t=!this.valueColsSvc?.columns?.length,r=!this.gos.getCallback("getGroupRowAgg");if(t&&r&&e.changedPath?.active)return;const n=this.createAggDetails(e);this.recursivelyCreateAggData(n)}createAggDetails(e){const t=this.colModel.isPivotActive(),r=this.valueColsSvc?.columns,n=t&&this.pivotColsSvc?this.pivotColsSvc.columns:[];return{alwaysAggregateAtRootLevel:this.gos.get("alwaysAggregateAtRootLevel"),groupIncludeTotalFooter:!!kt(this.gos),changedPath:e.changedPath,valueColumns:r??[],pivotColumns:n,filteredOnly:!this.isSuppressAggFilteredOnly(),userAggFunc:this.gos.getCallback("getGroupRowAgg")}}isSuppressAggFilteredOnly(){return void 0!==xt(this.gos)||this.gos.get("suppressAggFilteredOnly")}recursivelyCreateAggData(e){e.changedPath.forEachChangedNodeDepthFirst((t=>{if(!t.hasChildren())return void(t.aggData&&this.setAggData(t,null));if(-1===t.level&&!e.groupIncludeTotalFooter){const r=!this.colModel.isPivotMode();if(!e.alwaysAggregateAtRootLevel&&r)return void this.setAggData(t,null)}this.aggregateRowNode(t,e)}),!0)}aggregateRowNode(e,t){const r=0===t.valueColumns.length,n=0===t.pivotColumns.length;let i;i=t.userAggFunc?t.userAggFunc({nodes:e.childrenAfterFilter}):r?null:n?this.aggregateRowNodeUsingValuesOnly(e,t):this.aggregateRowNodeUsingValuesAndPivot(e),this.setAggData(e,i),e.sibling&&this.setAggData(e.sibling,i)}aggregateRowNodeUsingValuesAndPivot(e){const t={},r=this.pivotResultCols?.getPivotResultCols()?.list??[];let n=!0;const i=this.beans;for(let s=0;s<r.length;s++){const o=r[s],a=o.getColDef();if(null!=a.pivotTotalColumnIds){n=!1;continue}const l=a.pivotKeys??[];let c;c=e.leafGroup?this.getValuesFromMappedSet(e.childrenMapped,l,a.pivotValueColumn):this.getValuesPivotNonLeaf(e,a.colId),t[a.colId]=ap(i,c,a.pivotValueColumn.getAggFunc(),a.pivotValueColumn,e,o)}if(!n)for(let s=0;s<r.length;s++){const n=r[s],o=n.getColDef();if(null==o.pivotTotalColumnIds||!o.pivotTotalColumnIds.length)continue;const a=o.pivotTotalColumnIds.map((e=>t[e]));t[o.colId]=ap(i,a,o.pivotValueColumn.getAggFunc(),o.pivotValueColumn,e,n)}return t}aggregateRowNodeUsingValuesOnly(e,t){const r={},{changedPath:n,valueColumns:i,filteredOnly:s}=t,o=n.active?n.getValueColumnsForNode(e,i):i,a=n.active?n.getNotValueColumnsForNode(e,i):null,l=this.getValuesNormal(e,o,s),c=e.aggData,u=this.beans;return o.forEach(((t,n)=>{r[t.getId()]=ap(u,l[n],t.getAggFunc(),t,e)})),a&&c&&a.forEach((e=>{r[e.getId()]=c[e.getId()]})),r}getValuesPivotNonLeaf(e,t){return e.childrenAfterFilter.map((e=>e.aggData[t]))}getValuesFromMappedSet(e,t,r){let n=e;for(let i=0;i<t.length;i++){const e=t[i];n=n?n[e]:null}return n?n.map((e=>this.valueSvc.getValue(r,e))):[]}getValuesNormal(e,t,r){const n=[];t.forEach((()=>n.push([])));const i=t.length,s=r?e.childrenAfterFilter:e.childrenAfterGroup,o=s.length;for(let a=0;a<o;a++){const e=s[a];for(let r=0;r<i;r++){const i=t[r],s=this.valueSvc.getValue(i,e);n[r].push(s)}}return n}setAggData(e,t){const r=e.aggData;if(e.aggData=t,e.__localEventService){const n=t=>{const n=e.aggData?e.aggData[t]:void 0,i=r?r[t]:void 0;if(n===i)return;const s=this.colModel.getCol(t);s&&e.dispatchCellChangedEvent(s,n,i)};if(r)for(const e of Object.keys(r))n(e);if(t)for(const e of Object.keys(t))r&&e in r||n(e)}}},class extends rr{constructor(){super(...arguments),this.beanName="filterAggStage",this.refreshProps=new Set([]),this.step="filter_aggregates"}wireBeans(e){this.filterManager=e.filterManager}execute(e){var t=this;const r=this.beans.colModel.isPivotMode(),n=this.filterManager?.isAggregateFilterPresent()||this.filterManager?.isAggregateQuickFilterPresent(),i=xt(this.gos)||(r?e=>e.node.leafGroup:e=>!e.node.group),{changedPath:s}=e,o=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.childrenAfterFilter&&(e.childrenAfterAggFilter=e.childrenAfterFilter,r&&e.childrenAfterAggFilter.forEach((e=>o(e,r))),t.setAllChildrenCount(e)),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)};s.forEachChangedNodeDepthFirst(n?e=>{e.childrenAfterAggFilter=e.childrenAfterFilter?.filter((e=>{if(i({node:e})){if(this.filterManager.doesRowPassAggregateFilters({rowNode:e}))return o(e,!0),!0}const t=e.childrenAfterAggFilter?.length;return t}))||null,this.setAllChildrenCount(e),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)}:o,!0)}setAllChildrenCountTreeData(e){const t=e.childrenAfterAggFilter;let r=0;if(t){const e=t.length;r=e;for(let n=0;n<e;++n)r+=t[n].allChildrenCount??0}e.setAllChildrenCount(0===r&&e.level>=0?null:r)}setAllChildrenCountGridGrouping(e){let t=0;e.childrenAfterAggFilter.forEach((e=>{e.group?t+=e.allChildrenCount:t++})),e.setAllChildrenCount(t)}setAllChildrenCount(e){e.hasChildren()?this.gos.get("treeData")?this.setAllChildrenCountTreeData(e):this.setAllChildrenCountGridGrouping(e):e.setAllChildrenCount(null)}}],rowModels:["clientSide"],dependsOn:[hp]},gp=class extends rn{constructor(){super(...arguments),this.beanName="pivotColsSvc",this.eventName="columnPivotChanged",this.columnProcessors={set:(e,t,r)=>this.setColPivotActive(e,t,r),add:(e,t,r)=>this.setColPivotActive(e,!0,r),remove:(e,t,r)=>this.setColPivotActive(e,!1,r)},this.columnOrdering={enableProp:"pivot",initialEnableProp:"initialPivot",indexProp:"pivotIndex",initialIndexProp:"initialPivotIndex"},this.columnExtractors={setFlagFunc:(e,t,r)=>this.setColPivotActive(e,t,r),getIndexFunc:e=>e.pivotIndex,getInitialIndexFunc:e=>e.initialPivotIndex,getValueFunc:e=>e.pivot,getInitialValueFunc:e=>e.initialPivot},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>Er(this.columns,e)}}syncColumnWithState(e,t,r,n){const{value1:i,value2:s}=r("pivot","pivotIndex");void 0===i&&void 0===s||("number"===typeof s||i?(e.isPivotActive()||(this.setColPivotActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e)),n&&"number"===typeof s&&(n[e.getId()]=s)):e.isPivotActive()&&(this.setColPivotActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e)))}setColPivotActive(e,t,r){e.pivotActive!==t&&(e.pivotActive=t,e.dispatchColEvent("columnPivotChanged",r)),e.dispatchStateUpdatedEvent("pivot")}},fp=class extends rr{addExpandedCss(e,t){t.isExpandable()&&(e.push("ag-row-group"),e.push(t.expanded?"ag-row-group-expanded":"ag-row-group-contracted"))}getRowExpandedListeners(e){const{rowNode:t}=e,r=this.updateExpandedCss.bind(this,e,t);return{expandedChanged:r,hasChildrenChanged:r}}setExpanded(e,t,r,n){if(e.expanded===t)return;e.expanded=t,e.dispatchRowEvent("expandedChanged");const i={...Hi(e,this.gos,"rowGroupOpened"),expanded:t,event:r||null};this.dispatchExpandedEvent(i,n),this.beans.rowRenderer.refreshCells({rowNodes:[e]})}isExpandable(e){return!e.footer&&(this.beans.colModel.isPivotMode()?e.hasChildren()&&!e.leafGroup:e.hasChildren()||e.master)}updateExpandedCss(e,t){const r=t.isExpandable(),n=1==t.expanded;e.forEachGui(void 0,(e=>{const t=e.rowComp;t.addOrRemoveCssClass("ag-row-group",r),t.addOrRemoveCssClass("ag-row-group-expanded",r&&n),t.addOrRemoveCssClass("ag-row-group-contracted",r&&!n),x(e.element,r&&n)}))}};function mp(e){let t=e.get("groupHideParentOfSingleChild");return t||(t=e.get("groupRemoveSingleChildren"),!t&&e.get("groupRemoveLowestSingleChildren")&&(t="leafGroupsOnly")),{groupHideParentOfSingleChild:t,isGroupMultiAutoColumn:At(e),hideOpenParents:e.get("groupHideOpenParents"),grandTotalRow:kt(e),groupTotalRow:Pt(e)}}function vp(e,t,r){return!0===e.groupHideParentOfSingleChild&&r&&1===t.childrenAfterGroup.length}function Cp(e,t,r){return"leafGroupsOnly"===e.groupHideParentOfSingleChild&&r&&t.leafGroup&&1===t.childrenAfterGroup.length}function wp(e,t,r,n,i,s){const o=n&&!r,a=n&&t.leafGroup,l=e.hideOpenParents&&t.expanded&&!t.master&&!a;return!o&&!l&&!i&&!s}var bp=e=>{const t=e.allLeafChildren,r=e.sibling;e.treeNodeFlags=0,e.childrenAfterGroup=t,e.childrenMapped=null,e.groupData=null,r&&(r.childrenAfterGroup=e.childrenAfterGroup,r.childrenAfterAggFilter=e.childrenAfterAggFilter,r.childrenAfterFilter=e.childrenAfterFilter,r.childrenAfterSort=e.childrenAfterSort,r.childrenMapped=null,r.groupData=null);for(const n of t){const t=n.sibling;yp(n),t&&yp(t),n.parent=e,n.level=0,n.key=null,n.treeNodeFlags=0,(n.group||n.hasChildren())&&(n.group=!1,n.updateHasChildren())}e.updateHasChildren()},yp=e=>{e.allLeafChildren=null,e.childrenAfterGroup=null,e.childrenAfterAggFilter=null,e.childrenAfterFilter=null,e.childrenAfterSort=null,e.childrenMapped=null,e.groupData&&(e.groupData=null)};function Sp(e,t,r){let n=e;const i=n.level-t.level;if(i<=0)return!1;if(!r.get("groupHideOpenParents"))return!1;for(let s=0;s<i;s++){if(!(n.parent?.childrenAfterSort?.[0]===n))return!1;n=n.parent}return n===t}function Ep(e,t,r,n){const i=""===r.key,s=!!r.rowGroupColumn&&(!e||e?.isRowGroupDisplayed(r.rowGroupColumn.getId()));if(i&&s){const e=Sp(t,r,n.gos);if(r===t||e){return f(n.localeSvc)("blanks","(Blanks)")}}return null}var Rp=class extends rr{constructor(){super(...arguments),this.indentClass=null}init(e,t,r,n,i,s,o){this.params=o,this.eGui=t,this.eCheckbox=r,this.eExpanded=n,this.eContracted=i,this.comp=e,this.compClass=s;const{node:a,column:l}=o;this.node=a,this.displayedNode=a;this.isEmbeddedRowMismatch()||(a.footer?this.initFooterCell():l?(this.displayedNode=this.beans.valueSvc.getDisplayedNode(a,l)??this.node,this.setupExpand(),this.setupCheckbox(),this.addGroupValue(),this.setupIndent()):this.initFullWidthCell())}initFooterCell(){const{node:e,column:t}=this.params,r=-1===e.level;(e.rowGroupColumn&&t&&t.isRowGroupDisplayed(e.rowGroupColumn.getId())||r)&&(this.addFooterValue(),this.setupIndent(),r||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!0))}initFullWidthCell(){this.setupExpand(),(()=>{const{rowDragSvc:e}=this.beans;if(!this.params.rowDrag||!e)return;const t=e.createRowDragComp((()=>this.params.value),this.params.node);this.createManagedBean(t),this.eGui.insertAdjacentElement("afterbegin",t.getGui())})(),this.setupCheckbox(),this.addGroupValue(),this.setupIndent()}getCellAriaRole(){const e=this.params.colDef?.cellAriaRole,t=this.params.column?.getColDef().cellAriaRole;return e||t||"gridcell"}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const{visibleCols:e}=this.beans,t="left"===this.params.pinned,r="right"===this.params.pinned,n=!t&&!r;return this.gos.get("enableRtl")?e.isPinningLeft()?!r:!n:e.isPinningLeft()?!t:!n}addGroupValue(){const{params:{column:e,value:t},node:r,displayedNode:n,beans:i}=this,s=this.getFormattedValue()??Ep(e,r,n,i),o=this.getInnerCompDetails(s);this.comp.setInnerRenderer(o,s??t??null)}getFormattedValue(){const{valueSvc:e}=this.beans,{value:t,valueFormatted:r,column:n}=this.params,{rowGroupColumn:i}=this.displayedNode;return i&&n?n?.isRowGroupDisplayed(i.getId())?e.formatValue(i,this.node,t):null:r}addFooterValue(){const{expressionSvc:e,footerSvc:t}=this.beans,{totalValueGetter:r,column:n,node:i,value:s}=this.params,o=this.getFormattedValue()??Ep(n,i,i,this.beans);let a="";r?"function"===typeof r?a=r({...this.params,valueFormatted:o}):"string"===typeof r?a=e?.evaluate(r,{...this.params,valueFormatted:o}):et(179):a=t?.getTotalValue(o??s);const l=this.getInnerCompDetails(o);this.comp.setInnerRenderer(l,a??"")}setupExpand(){const{colModel:e}=this.beans,{eGridCell:t,column:r,suppressDoubleClickExpand:n}=this.params,i=(e,t)=>{const r=vo(e,this.beans,null);r&&(t.appendChild(r),this.addDestroyFunc((()=>t.removeChild(r))))};i("groupExpanded",this.eExpanded),i("groupContracted",this.eContracted);const s=this.comp,o=()=>{if(!this.isExpandable())return;const e=this.displayedNode.expanded;s.setExpandedDisplayed(e),s.setContractedDisplayed(!e),x(t,!!this.displayedNode.expanded)},a=()=>{const r=this.isExpandable();s.addOrRemoveCssClass("ag-cell-expandable",r),s.addOrRemoveCssClass("ag-row-group",r);const n=!r&&e.isPivotMode();s.addOrRemoveCssClass("ag-pivot-leaf-group",n);const i=!e.isPivotMode()&&(!this.displayedNode.footer||-1!==this.displayedNode.level);s.addOrRemoveCssClass("ag-row-group-leaf-indent",!r&&i);const a=this.getChildCount(),l=a>0?`(${a})`:"";s.setChildCount(l),r?o():(s.setExpandedDisplayed(!1),s.setContractedDisplayed(!1),k(t))};(()=>{r?.isCellEditable(this.displayedNode)&&this.gos.get("enableGroupEdit")||n||this.addManagedListeners(t,{dblclick:this.onCellDblClicked.bind(this)}),this.addManagedListeners(this.eExpanded,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(this.eContracted,{click:this.onExpandClicked.bind(this)}),this.addManagedListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedListeners(this.displayedNode,{allChildrenCountChanged:a,masterChanged:a,groupChanged:a,hasChildrenChanged:a,expandedChanged:o})})(),a()}getInnerCompDetails(e){const{userCompFactory:t,findSvc:r}=this.beans,n={...this.params,valueFormatted:e};if(n.fullWidth){const e=this.gos.get("groupRowRendererParams"),i=Fn(t,e,n);return i||(r?.isMatch(n.node,null)?Fn(t,{...e,innerRenderer:"agFindCellRenderer"},n):void 0)}const i=e=>e&&e.componentClass==this.compClass,s=Fn(t,n,n);if(s&&!i(s))return s;const{displayedNode:{rowGroupColumn:o}}=this,a=o?.colDef,l=o&&n.column?.isRowGroupDisplayed(o.getId());if(a&&l){const e=Dn(t,a,n);if(e){if(!i(e))return e;if(a?.cellRendererParams?.innerRenderer)return Fn(t,a.cellRendererParams,n)}}return r?.isMatch(n.node,n.column)?Dn(t,{...a??n.colDef,cellRenderer:"agFindCellRenderer"},n):void 0}getChildCount(){const{column:e,suppressCount:t}=this.params;if(t)return 0;const{allChildrenCount:r,rowGroupColumn:n}=this.displayedNode;if(!((r??0)>0&&(!n||!e||e?.isRowGroupDisplayed(n.getId()))))return 0;return this.gos.get("showOpenedGroup")&&this.displayedNode!==this.node&&!Sp(this.node,this.displayedNode,this.gos)?0:r??0}isExpandable(){const{node:e,column:t,colDef:r}=this.params;if(!this.displayedNode.isExpandable())return!1;if(!t)return!0;if(e.hasChildren()&&r){const{showRowGroup:e}=r;if(!e)return!1;if(!0===e)return!0}if(e===this.displayedNode){if(e.rowGroupColumn){const r=t?.isRowGroupDisplayed(e.rowGroupColumn.getId());if(r)return!0}return!!e.master&&(!0===r?.showRowGroup||null==r?.showRowGroup)}return Sp(this.node,this.displayedNode,this.gos)}setupIndent(){const{suppressPadding:e,node:t,colDef:r}=this.params;if(e)return;const n=()=>{let e=0;e=r&&!0!==r.showRowGroup?0:t.uiLevel;const n="ag-row-group-indent-"+e;n!==this.indentClass&&(this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass=n,this.comp.addOrRemoveCssClass(n,!0),this.eGui.style.setProperty("--ag-indentation-level",String(e)))};this.addManagedListeners(t,{uiLevelChanged:n.bind(this)}),n()}setupCheckbox(){const{node:e}=this.params;!e.footer&&!e.rowPinned&&!e.detail&&(this.addManagedPropertyListener("rowSelection",(e=>{let{currentValue:t,previousValue:r}=e;const n="object"===typeof t?t:void 0,i="object"===typeof r?r:void 0;n?.checkboxLocation!==i?.checkboxLocation&&(this.destroyCheckbox(),this.addCheckbox())})),this.addCheckbox())}addCheckbox(){const{selectionSvc:e}=this.beans;if(!e||!ct(this.gos))return;const{node:t,column:r}=this.params,n=this.gos.get("rowSelection"),i=Ot(n);if("selectionColumn"===i)return;if("autoGroupColumn"===i){const e=null!=r?.getColDef().showRowGroup,n=!r&&t.group;if(!(e||n))return}const s="object"===typeof n?Mt(n):this.params.checkbox;if(!("function"===typeof s||!0===s))return;if("string"===typeof r?.getColDef().showRowGroup&&!this.isExpandable())return void this.comp.setCheckboxSpacing(!0);const o=e.createCheckboxSelectionComponent();this.cbComp=o,this.createBean(o),o.init({rowNode:t,column:r,overrides:{isVisible:s,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(o.getGui()),this.comp.setCheckboxVisible(!0)}destroyCheckbox(){this.comp.setCheckboxSpacing(!1),this.comp.setCheckboxVisible(!1),this.cbComp&&this.eCheckbox.removeChild(this.cbComp.getGui()),this.cbComp=this.destroyBean(this.cbComp)}onExpandClicked(e){Jt(e)||(Xt(e),this.onExpandOrContract(e))}onKeyDown(e){if(!(e.key===Qn.ENTER)||this.params.suppressEnterExpand)return;this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(Jt(e))return;er(this.eExpanded,e)||er(this.eContracted,e)||this.onExpandOrContract(e)}onExpandOrContract(e){if(!this.isExpandable())return;const t=this.displayedNode,r=!t.expanded;!r&&t.sticky&&this.beans.ctrlsSvc.getScrollFeature().setVerticalScrollPosition(t.rowTop-t.stickyRowTop),t.setExpanded(r,e)}destroy(){super.destroy(),this.destroyCheckbox()}},Tp={tag:"span",cls:"ag-cell-wrapper",children:[{tag:"span",ref:"eExpanded",cls:"ag-group-expanded ag-hidden"},{tag:"span",ref:"eContracted",cls:"ag-group-contracted ag-hidden"},{tag:"span",ref:"eCheckbox",cls:"ag-group-checkbox ag-invisible"},{tag:"span",ref:"eValue",cls:"ag-group-value"},{tag:"span",ref:"eChildCount",cls:"ag-group-child-count"}]},xp=class extends un{constructor(){super(Tp),this.eExpanded=cn,this.eContracted=cn,this.eCheckbox=cn,this.eValue=cn,this.eChildCount=cn}init(e){const t={setInnerRenderer:(e,t)=>this.setRenderDetails(e,t),setChildCount:e=>this.eChildCount.textContent=e,addOrRemoveCssClass:(e,t)=>this.addOrRemoveCssClass(e,t),setContractedDisplayed:e=>X(this.eContracted,e),setExpandedDisplayed:e=>X(this.eExpanded,e),setCheckboxVisible:e=>this.eCheckbox.classList.toggle("ag-invisible",!e),setCheckboxSpacing:e=>this.eCheckbox.classList.toggle("ag-group-checkbox-spacing",e)},r=this.createManagedBean(new Rp),n=!e.colDef,i=this.getGui();r.init(t,i,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,e),n&&b(i,r.getCellAriaRole())}setRenderDetails(e,t){e?e.newAgStackInstance().then((e=>{if(!e)return;const t=()=>this.destroyBean(e);this.isAlive()?(this.eValue.appendChild(e.getGui()),this.addDestroyFunc(t)):t()})):this.eValue.innerText=t}destroy(){this.destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}},kp=class extends rr{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}postConstruct(){this.isClientSide=ot(this.gos),this.beans.ctrlsSvc.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl})),this.resetStickyContainers()}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventSvc.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getLastPixelOfGroup(e){return this.isClientSide?function(e){if(e.isExpandable()||e.footer){if(e.footer&&0===e.rowIndex)return Number.MAX_SAFE_INTEGER;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.footer?e.sibling:e;for(;t.isExpandable()&&t.expanded;)if(t.master&&t.detailNode)t=t.detailNode;else if(t.childrenAfterSort){if(0===t.childrenAfterSort.length)break;t=br(t.childrenAfterSort)}return t.rowTop+t.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}(e):function(e){if(e.isExpandable()||e.footer){if(e.master&&e.detailNode)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.childStore?.getStoreBounds();return e.footer&&(t=e.sibling.childStore?.getStoreBounds()),(t?.heightPx??0)+(t?.topPx??0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}updateStickyRows(e){const t="top"===e;let r=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,r);const{rowModel:n,rowRenderer:i}=this.beans,s=t?i.firstVisibleVPixel-this.extraTopHeight:i.lastVisibleVPixel-this.extraTopHeight,o=new Set,a=e=>{if(o.add(e),t){const t=this.getLastPixelOfGroup(e),n=s+r+e.rowHeight;e.stickyRowTop=t<n?r+(t-n):r}else{const t=this.getFirstPixelOfGroup(e),n=s-(r+e.rowHeight);e.stickyRowTop=t>n?r-(t-n):r}r=0,o.forEach((e=>{const t=e.stickyRowTop+e.rowHeight;r<t&&(r=t)}))},l=this.areFooterRowsStickySuppressed(),c=this.gos.get("suppressGroupRowsSticky"),u=t=>{if(!t.displayed)return!1;if(t.footer){if(!0===l)return!1;if("grand"===l&&-1===t.level)return!1;if("group"===l&&t.level>-1)return!1;const r=!!t.sibling.rowIndex&&t.sibling.rowIndex+1===t.rowIndex;if("bottom"===e&&r)return!1;return!o.has(t)}if(t.isExpandable()){if(!0===c)return!1;if("bottom"===e)return!1;return!o.has(t)&&t.expanded}return!1};for(let d=0;d<100;d++){let e=s+r;t||(e=s-r);const i=n.getRowIndexAtPixel(e),o=n.getRow(i);if(null==o)break;const l=this.getStickyAncestors(o).find((e=>(t?e.rowIndex<i:e.rowIndex>i)&&u(e)));if(l){a(l);continue}if(!(t?o.rowTop<e:o.rowTop+o.rowHeight>e)||!u(o))break;a(o)}return t||o.forEach((e=>{e.stickyRowTop=r-(e.stickyRowTop+e.rowHeight)})),this.refreshNodesAndContainerHeight(e,o,r)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(!0===e)return!0;const t="group"===e,r="grand"===e;return!(!t||!r)||(r?"grand":!!t&&"group")}canRowsBeSticky(){const e=Rt(this.gos),t=this.areFooterRowsStickySuppressed(),r=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!r)}getStickyAncestors(e){const t=[];let r=e.footer?e.sibling:e.parent;for(;r;)r.sibling&&t.push(r.sibling),t.push(r),r=r.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some((t=>t.rowNode===e))){for(let r=0;r<this.stickyTopRowCtrls.length;r++){const n=this.stickyTopRowCtrls[r].rowNode;n!==e&&t.add(n)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows()}else{for(let r=0;r<this.stickyBottomRowCtrls.length;r++){const n=this.stickyBottomRowCtrls[r].rowNode;n!==e&&t.add(n)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(e,t,r){const n="top"===e,i=n?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,s={},o=[];for(let p=0;p<i.length;p++){const e=i[p].rowNode;!t.has(e)?(s[e.id]=i[p],e.sticky=!1):o.push(i[p])}const a=new Set;for(let p=0;p<o.length;p++)a.add(o[p].rowNode);const l=[];t.forEach((e=>{a.has(e)||(e.sticky=!0,l.push(this.createRowCon(e,!1,!1)))}));let c=!!l.length||o.length!==i.length;n?this.topContainerHeight!==r&&(this.topContainerHeight=r,this.gridBodyCtrl.setStickyTopHeight(r),c=!0):this.bottomContainerHeight!==r&&(this.bottomContainerHeight=r,this.gridBodyCtrl.setStickyBottomHeight(r),c=!0),this.destroyRowCtrls(s,!1);const u=[...o,...l];u.sort(((e,t)=>t.rowNode.rowIndex-e.rowNode.rowIndex)),n||u.reverse(),u.forEach((e=>e.setRowTop(e.rowNode.stickyRowTop)));const d=this.beans.pageBounds;let h=0;return n?(t.forEach((e=>{e.rowIndex<d.getFirstRow()&&(h+=e.rowHeight)})),h>this.topContainerHeight&&(h=this.topContainerHeight),this.setOffsetTop(h)):(t.forEach((e=>{e.rowIndex>d.getLastRow()&&(h+=e.rowHeight)})),h>this.bottomContainerHeight&&(h=this.bottomContainerHeight),this.setOffsetBottom(h)),!!c&&(n?this.stickyTopRowCtrls=u:this.stickyBottomRowCtrls=u,!0)}ensureRowHeightsValid(){let e=!1;const t=t=>{const r=t.rowNode;if(r.rowHeightEstimated){const t=dt(this.beans,r);r.setRowHeight(t.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}};var Pp={moduleName:"GroupCellRenderer",version:Gh,userComponents:{agGroupRowRenderer:xp,agGroupCellRenderer:xp},dynamicBeans:{groupCellRendererCtrl:Rp},icons:{groupContracted:"tree-closed",groupExpanded:"tree-open"},css:[".ag-group-checkbox-spacing{width:var(--ag-icon-size)}:where(.ag-ltr) .ag-group-checkbox-spacing{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-checkbox-spacing{margin-left:var(--ag-cell-widget-spacing)}"],dependsOn:[Bh]},Ap={moduleName:"GroupColumn",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="autoColSvc"}postConstruct(){this.addManagedPropertyListener("autoGroupColumnDef",this.updateColumns.bind(this))}addColumns(e){null!=this.columns&&(e.list=this.columns.list.concat(e.list),e.tree=this.columns.tree.concat(e.tree),Nr(e))}createColumns(e,t){const r=this.beans,{colModel:n,gos:i,rowGroupColsSvc:s,colGroupSvc:o}=r,a=n.isPivotMode(),l=Ft(i,a),c=a?i.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),u=s?.columns,d=()=>{this.columns&&(Fr(r,this.columns.tree),this.columns=null)};if(!(u&&u.length>0||i.get("treeData"))||c||l)return void d();const h=this.generateAutoCols(u),p=Lr(h,this.columns?.list||null),g=e.treeDepth,f=this.columns?this.columns.treeDepth:-1;if(p&&f==g)return;d();const m=o?.findDepth(e.tree)??0,v=o?.balanceTreeForAutoCols(h,m)??[];this.columns={list:h,tree:v,treeDepth:m,map:{}};t((e=>{if(!e)return null;const t=e.filter((e=>!Dr(e)));return[...h,...t]}))}updateColumns(e){const t=_r(e.source);this.columns?.list.forEach(((e,r)=>this.updateOneAutoCol(e,r,t)))}getColumn(e){return this.columns?.list.find((t=>Gr(t,e)))??null}getColumns(){return this.columns?.list??null}generateAutoCols(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=[],r=this.gos.get("treeData");let n=At(this.gos);return r&&n&&(et(182),n=!1),n?e.forEach(((e,r)=>{t.push(this.createOneAutoCol(e,r))})):t.push(this.createOneAutoCol()),t}isSuppressAutoCol(){const e=this.gos;if("custom"===e.get("groupDisplayType"))return!0;return"custom"===e.get("treeDataDisplayType")}createOneAutoCol(e,t){let r;r=e?`${Tr}-${e.getId()}`:Tr;const n=this.createAutoColDef(r,e,t);n.colId=r;const i=new gr(n,null,r,!0);return this.createBean(i),i}updateOneAutoCol(e,t,r){const n=e.getColDef(),i="string"==typeof n.showRowGroup?n.showRowGroup:void 0,s=this.beans,o=null!=i?s.colModel.getColDefCol(i):void 0,a=e.getId(),l=this.createAutoColDef(a,o??void 0,t);e.setColDef(l,null,r),Jr(s,{state:[{colId:a,...l}]},r)}createAutoColDef(e,t,r){let n=this.createBaseColDef(t);if(ir(n,this.gos.get("autoGroupColumnDef")),n=Wr(this.beans,n,e,!0),!this.gos.get("treeData")){ke(n.field)&&ke(n.valueGetter)&&ke(n.filterValueGetter)&&"agGroupColumnFilter"!==n.filter&&(n.filter=!1)}r&&r>0&&(n.headerCheckboxSelection=!1);const i=Tt(this.gos),s=n.valueGetter||null!=n.field;return i&&!s&&(n.sortIndex=void 0,n.initialSort=void 0),n}createBaseColDef(e){const t=this.gos.get("autoGroupColumnDef"),r={headerName:this.getLocaleTextFunc()("group","Group"),showRowGroup:e?.getColId()??!0};return t&&(t.cellRenderer||t.cellRendererSelector)||(r.cellRenderer="agGroupCellRenderer",this.beans.findSvc?.setupGroupCol(r)),e&&(r.headerName=this.beans.colNames.getDisplayNameForColumn(e,"header")??void 0,r.headerValueGetter=e.colDef.headerValueGetter),r}destroy(){Fr(this.beans,this.columns?.tree),super.destroy()}},class extends rr{constructor(){super(...arguments),this.beanName="showRowGroupCols"}refresh(){this.showRowGroupCols=[],this.showRowGroupColsMap={};const{colModel:e,rowGroupColsSvc:t}=this.beans;e.getCols().forEach((e=>{const r=e.getColDef().showRowGroup,n="string"===typeof r;(n||!0===r)&&(this.showRowGroupCols.push(e),n?this.showRowGroupColsMap[r]=e:t&&t.columns.forEach((t=>{this.showRowGroupColsMap[t.getId()]=e})))}))}getShowRowGroupCols(){return this.showRowGroupCols}getShowRowGroupCol(e){return this.showRowGroupColsMap[e]}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;const{rowGroupColsSvc:r,colModel:n}=this.beans;if(!0===t&&r)return r.columns.slice(0);const i=n.getColDefCol(t);return i?[i]:null}isRowGroupDisplayed(e,t){const{colDef:r}=e;if(null==r?.showRowGroup)return!1;const n=!0===r.showRowGroup,i=r.showRowGroup===t;return n||i}},class extends rn{constructor(){super(...arguments),this.beanName="rowGroupColsSvc",this.eventName="columnRowGroupChanged",this.columnProcessors={set:(e,t,r)=>this.setActive(t,e,r),add:(e,t,r)=>this.setActive(!0,e,r),remove:(e,t,r)=>this.setActive(!1,e,r)},this.columnOrdering={enableProp:"rowGroup",initialEnableProp:"initialRowGroup",indexProp:"rowGroupIndex",initialIndexProp:"initialRowGroupIndex"},this.columnExtractors={setFlagFunc:(e,t,r)=>this.setColRowGroupActive(e,t,r),getIndexFunc:e=>e.rowGroupIndex,getInitialIndexFunc:e=>e.initialRowGroupIndex,getValueFunc:e=>e.rowGroup,getInitialValueFunc:e=>e.initialRowGroup},this.modifyColumnsNoEventsCallbacks={addCol:e=>this.columns.push(e),removeCol:e=>Er(this.columns,e)}}moveColumn(e,t,r){if(0===this.columns.length)return;const n=this.columns[e],i=this.columns.slice(e,t);this.columns.splice(e,1),this.columns.splice(t,0,n),this.updateIndexMap(),this.eventSvc.dispatchEvent({type:this.eventName,columns:i,column:1===i.length?i[0]:null,source:r})}syncColumnWithState(e,t,r,n){const{value1:i,value2:s}=r("rowGroup","rowGroupIndex");void 0===i&&void 0===s||("number"===typeof s||i?(e.isRowGroupActive()||(this.setColRowGroupActive(e,!0,t),this.modifyColumnsNoEventsCallbacks.addCol(e)),n&&"number"===typeof s&&(n[e.getId()]=s)):e.isRowGroupActive()&&(this.setColRowGroupActive(e,!1,t),this.modifyColumnsNoEventsCallbacks.removeCol(e)))}setActive(e,t,r){e!==t.isRowGroupActive()&&(this.setColRowGroupActive(t,e,r),It(this.gos,e)&&this.colModel.setColsVisible([t],!e,r))}setColRowGroupActive(e,t,r){e.rowGroupActive!==t&&(e.rowGroupActive=t,e.dispatchColEvent("columnRowGroupChanged",r)),e.dispatchStateUpdatedEvent("rowGroup")}},gp,dp],dependsOn:[Bh,Pp]},Fp={moduleName:"ClientSideRowModelHierarchy",version:Gh,rowModels:["clientSide"],beans:[class extends rr{constructor(){super(...arguments),this.beanName="groupStage",this.refreshProps=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType","treeData","treeDataChildrenField","treeDataParentIdField"]),this.step="group",this.approach=null,this.strategy=void 0}destroy(){super.destroy(),this.strategy=void 0,this.approach=null}createStrategy(){const{beans:e,approach:t}=this;let r;switch(t){case"treeSelfRef":r="treeParentIdStrategy";break;case"group":r="groupStrategy"}if(r){const t=e.registry.createDynamicBean(r,!1);return this.createOptionalManagedBean(t),t}}execute(e){let t=this.strategy;const r=jt(this.gos);return this.approach!==r&&(this.approach=r,this.destroyBean(t),t&&"treeNested"!==this.approach&&"treePath"!==this.approach&&bp(e.rowNode),t=this.createStrategy(),this.strategy=t),t?.execute(e),!!t}},class extends rr{constructor(){super(...arguments),this.beanName="flattenStage",this.refreshProps=new Set(["groupHideParentOfSingleChild","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupTotalRow","masterDetail"]),this.step="map"}execute(e){const t=e.rowNode,r=[],n=this.beans.colModel.isPivotMode(),i=n&&t.leafGroup&&t.aggData,s=i?[t]:t.childrenAfterSort,o=mp(this.gos);this.recursivelyAddToRowsToDisplay(o,s,r,n,0);if(!i&&r.length>0&&o.grandTotalRow){cp(t,this.beans);const e="top"===o.grandTotalRow;this.addRowNodeToRowsToDisplay(o,t.sibling,r,0,e)}return r}recursivelyAddToRowsToDisplay(e,t,r,n,i){if(t?.length)for(let s=0;s<t.length;s++){const o=t[s],a=o.hasChildren(),l=vp(e,o,a),c=Cp(e,o,a);if(wp(e,o,a,n,l,c)&&this.addRowNodeToRowsToDisplay(e,o,r,i),!n||!o.leafGroup)if(a){const t=l||c;if(o.expanded||t){const s=e.groupTotalRow({node:o});s||up(o);const a=t?i:i+1;"top"===s&&(cp(o,this.beans),this.addRowNodeToRowsToDisplay(e,o.sibling,r,a)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,r,n,a),"bottom"===s&&(cp(o,this.beans),this.addRowNodeToRowsToDisplay(e,o.sibling,r,a))}}else{const t=this.beans.masterDetailSvc?.getDetail(o);t&&this.addRowNodeToRowsToDisplay(e,t,r,i)}}}addRowNodeToRowsToDisplay(e,t,r,n,i){i?r.unshift(t):r.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:n)}},class extends fp{constructor(){super(...arguments),this.beanName="expansionSvc",this.events=[]}wireBeans(e){this.rowModel=e.rowModel}expandRows(e){const t=new Set(e);this.rowModel.forEachNode((e=>{e.id&&t.has(e.id)&&(e.expanded=!0)})),this.onGroupExpandedOrCollapsed()}expandAll(e){const{gos:t,colModel:r,eventSvc:n}=this.beans,i=this.rowModel,s=t.get("treeData"),o=r.isPivotActive(),a=t=>{t&&t.forEach((t=>{const r=()=>{t.expanded=e,a(t.childrenAfterGroup)};if(s){return void(xe(t.childrenAfterGroup)&&r())}if(o){return void(!t.leafGroup&&r())}t.group&&r()}))},l=i.rootNode;l&&a(l.childrenAfterGroup),i.refreshModel({step:"map"}),n.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}onGroupExpandedOrCollapsed(){this.rowModel.refreshModel({step:"map"})}dispatchExpandedEvent(e,t){this.events.push(e);const r=()=>{this.rowModel.onRowGroupOpened(),this.events.forEach((e=>this.eventSvc.dispatchEvent(e))),this.events=[]};t?r():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.debounce(r)),this.dispatchExpandedDebounced())}debounce(e){const t=this.beans.animationFrameSvc;if(!t)return()=>window.setTimeout(e,0);let r=!1;return()=>{t.active?r||(r=!0,t.addDestroyTask((()=>{r=!1,e()}))):window.setTimeout(e,0)}}}],dependsOn:[Bh]},Dp={moduleName:"StickyRow",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="stickyRowSvc"}createStickyRowFeature(e,t,r){const n=this.gos;if(Rt(n)&&ot(n)||at(n))return e.createManagedBean(new kp(t,r))}}]},Ip={selector:"AG-GRID-HEADER-DROP-ZONES",component:class extends un{constructor(){super()}postConstruct(){this.setGui(this.createNorthPanel());const e=this.onRowGroupChanged.bind(this);this.addManagedEventListeners({columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedPropertyListener("rowGroupPanelShow",e),this.addManagedPropertyListener("pivotPanelShow",(()=>this.onPivotPanelShow())),this.onRowGroupChanged()}createNorthPanel(){const e=Re({tag:"div",cls:"ag-column-drop-wrapper",role:"presentation"}),t=new Qh(!0);this.rowGroupComp=this.createManagedBean(t);const r=new Jh(!0);this.pivotComp=this.createManagedBean(r),e.appendChild(t.getGui()),e.appendChild(r.getGui());const n=this.onDropPanelVisible.bind(this);return this.addManagedListeners(t,{displayChanged:n}),this.addManagedListeners(r,{displayChanged:n}),this.onDropPanelVisible(),e}onDropPanelVisible(){const{rowGroupComp:e,pivotComp:t}=this,r=e.isDisplayed()&&t.isDisplayed(),n="ag-column-drop-horizontal-half-width";e.addOrRemoveCssClass(n,r),t.addOrRemoveCssClass(n,r)}onRowGroupChanged(){const e=this.rowGroupComp;if(!e)return;const t=this.gos.get("rowGroupPanelShow");if("always"===t)e.setDisplayed(!0);else if("onlyWhenGrouping"===t){const t=0!==this.beans.rowGroupColsSvc?.columns?.length;e.setDisplayed(t)}else e.setDisplayed(!1)}onPivotPanelShow(){const e=this.pivotComp;if(!e)return;const t=this.gos.get("pivotPanelShow");if("always"===t)e.setDisplayed(!0);else if("onlyWhenPivoting"===t){const t=this.beans.colModel.isPivotActive();e.setDisplayed(t)}else e.setDisplayed(!1)}}},Mp=class{constructor(){this.allSets=new Map}removeFromChildrenAfterGroup(e,t){const r=this.getSet(e);(r.fromChildrenAfterGroup??(r.fromChildrenAfterGroup=new Set)).add(t)}isRemoveFromAllLeafChildren(e,t){return!!this.allSets.get(e)?.fromAllLeafChildren?.has(t)}preventRemoveFromAllLeafChildren(e,t){this.allSets.get(e)?.fromAllLeafChildren?.delete(t)}removeFromAllLeafChildren(e,t){const r=this.getSet(e);(r.fromAllLeafChildren??(r.fromAllLeafChildren=new Set)).add(t)}getSet(e){let t=this.allSets.get(e);return t||(t={fromChildrenAfterGroup:null,fromAllLeafChildren:null},this.allSets.set(e,t)),t}getAllParents(){return Array.from(this.allSets.keys())}flush(){const e=this.allSets;for(const t of e.keys()){const r=e.get(t);if(r){const{fromChildrenAfterGroup:e,fromAllLeafChildren:n}=r,{childrenAfterGroup:i,allLeafChildren:s}=t;i&&e&&(Op(i,e),t.updateHasChildren()),s&&n&&Op(s,n)}}e.clear()}};function Op(e,t){let r=0;for(let n=0,i=e.length;n<i;++n){const i=e[n];t.has(i)||(e[r++]=i)}e.length=r}function Lp(e,t){const r=e.sourceRowIndex,n=t.sourceRowIndex,i=r>=0,s=n>=0;return i&&s?r-n:!i&&!s?e.__objectId-t.__objectId:i?1:-1}var Np={moduleName:"SharedRowGrouping",version:Gh,apiFunctions:{setRowGroupColumns:function(e,t){e.rowGroupColsSvc?.setColumns(t,"api")},removeRowGroupColumns:function(e,t){e.rowGroupColsSvc?.removeColumns(t,"api")},addRowGroupColumns:function(e,t){e.rowGroupColsSvc?.addColumns(t,"api")},getRowGroupColumns:function(e){return e.rowGroupColsSvc?.columns??[]},moveRowGroupColumn:function(e,t,r){e.rowGroupColsSvc?.moveColumn?.(t,r,"api")}},dependsOn:[Bh,hp,Ap,Dp]},_p={moduleName:"RowGrouping",version:Gh,dynamicBeans:{groupStrategy:class extends rr{wireBeans(e){this.colModel=e.colModel,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc,this.selectionSvc=e.selectionSvc,this.showRowGroupCols=e.showRowGroupCols}execute(e){const t=this.createGroupingDetails(e),r=e.changedRowNodes;r?this.handleDeltaUpdate(t,r):this.shotgunResetEverything(t,!!e.afterColumnsChanged);const n=e.changedPath;this.positionLeafsAndGroups(n),this.orderGroups(t),this.selectionSvc?.updateSelectableAfterGrouping(n)}positionLeafsAndGroups(e){e.forEachChangedNodeDepthFirst((e=>{if(e.childrenAfterGroup){const t=[],r=[];let n;e.childrenAfterGroup.forEach((e=>{e.childrenAfterGroup?.length?""!==e.key||n?r.push(e):n=e:t.push(e)})),n&&r.push(n),e.childrenAfterGroup=[...t,...r]}}),!1)}createGroupingDetails(e){const{rowNode:t,changedPath:r,rowNodesOrderChanged:n}=e,i=this.rowGroupColsSvc?.columns;return{expandByDefault:this.gos.get("groupDefaultExpanded"),groupedCols:i,rootNode:t,pivotMode:this.colModel.isPivotMode(),groupedColCount:i?.length??0,rowNodesOrderChanged:!!n,changedPath:r,groupAllowUnbalanced:this.gos.get("groupAllowUnbalanced"),isGroupOpenByDefault:this.gos.getCallback("isGroupOpenByDefault"),initialGroupOrderComparator:this.gos.getCallback("initialGroupOrderComparator"),keyCreators:i?.map((e=>e.getColDef().keyCreator))??[]}}handleDeltaUpdate(e,t){let{removals:r,updates:n,adds:i}=t;const s=new Mp;r.size&&this.removeNodes(r,e,s);for(const l of n)this.moveNodeInWrongPath(l,e,s);const o=e.changedPath;for(const l of i)this.insertOneNode(l,e),o.active&&o.addParentNode(l.parent);const a=s.getAllParents();s.flush(),this.removeEmptyGroups(a,e),e.rowNodesOrderChanged&&this.sortChildren(e)}sortChildren(e){e.changedPath.forEachChangedNodeDepthFirst((t=>{(function(e){if(!e)return!1;const t=e.length;if(t<2)return!1;let r=!1;for(let n=1;n<t;n++)if(Lp(e[n-1],e[n])>0){r=!0;break}return!!r&&(e.sort(Lp),!0)})(t.childrenAfterGroup)&&e.changedPath.addParentNode(t)}),!1,!0)}orderGroups(e){const t=e.initialGroupOrderComparator;xe(t)&&function e(r){xe(r.childrenAfterGroup)&&!r.leafGroup&&(r.childrenAfterGroup.sort(((e,r)=>t({nodeA:e,nodeB:r}))),r.childrenAfterGroup.forEach((t=>e(t))))}(e.rootNode)}getExistingPathForNode(e,t){const r=[];let n=e.parent;for(;n&&n!==t.rootNode;)r.push({key:n.key,rowGroupColumn:n.rowGroupColumn,field:n.field}),n=n.parent;return r.reverse(),r}moveNodeInWrongPath(e,t,r){t.changedPath.active&&t.changedPath.addParentNode(e.parent);const n=e=>e.key;yr(this.getExistingPathForNode(e,t).map(n),this.getGroupInfo(e,t).map(n))||this.moveNode(e,t,r)}moveNode(e,t,r){if(this.removeNodesFromParents([e],t,r),this.insertOneNode(e,t,r),e.setData(e.data),t.changedPath.active){const r=e.parent;t.changedPath.addParentNode(r)}}removeNodes(e,t,r){if(this.removeNodesFromParents(e,t,r),t.changedPath.active)for(const n of e)t.changedPath.addParentNode(n.parent)}forEachParentGroup(e,t,r){let n=t;for(;n&&n!==e.rootNode;)r(n),n=n.parent}removeNodesFromParents(e,t,r){const n=null==r,i=r||new Mp;for(const s of e)this.removeFromParent(s,i),this.forEachParentGroup(t,s.parent,(e=>{i.removeFromAllLeafChildren(e,s)}));n&&i.flush()}removeEmptyGroups(e,t){let r=!0;const n=e=>{const t=this.getChildrenMappedKey(e.key,e.rowGroupColumn),r=e.parent;return!(!r?.childrenMapped||!r.childrenMapped[t])&&(!!e.group&&0===(e.childrenAfterGroup?.length??0))};for(;r;){r=!1;const i=new Mp;e.forEach((e=>{this.forEachParentGroup(t,e,(e=>{n(e)&&(r=!0,this.removeFromParent(e,i),this.selectionSvc?.setNodesSelected({nodes:[e],newValue:!1,source:"rowGroupChanged"}))}))})),i.flush()}}removeFromParent(e,t){e.parent&&(t?t.removeFromChildrenAfterGroup(e.parent,e):(Er(e.parent.childrenAfterGroup,e),e.parent.updateHasChildren()));const r=this.getChildrenMappedKey(e.key,e.rowGroupColumn);e.parent?.childrenMapped&&delete e.parent.childrenMapped[r],e.setRowTop(null),e.setRowIndex(null)}addToParent(e,t){const r=this.getChildrenMappedKey(e.key,e.rowGroupColumn);t?.childrenMapped&&t.childrenMapped[r]!==e&&(t.childrenMapped[r]=e,t.childrenAfterGroup.push(e),zh(t,this.beans,!0))}areGroupColsEqual(e,t){return null!=e&&null!=t&&e.pivotMode===t.pivotMode&&(yr(e.groupedCols,t.groupedCols)&&yr(e.keyCreators,t.keyCreators))}checkAllGroupDataAfterColsChanged(e){const t=e=>{e&&e.forEach((e=>{if(!e.group)return;const r={field:e.field,key:e.key,rowGroupColumn:e.rowGroupColumn,leafNode:e.allLeafChildren?.[0]};this.setGroupData(e,r),t(e.childrenAfterGroup)}))};t(e.rootNode.childrenAfterGroup)}shotgunResetEverything(e,t){if(this.noChangeInGroupingColumns(e,t))return;this.selectionSvc?.filterFromSelection?.((e=>!e.group));const{groupedCols:r}=e,n=e.rootNode;n.leafGroup=0===r.length,n.childrenAfterGroup=[],n.childrenMapped={},n.updateHasChildren();const i=n.sibling;i&&(i.childrenAfterGroup=n.childrenAfterGroup,i.childrenMapped=n.childrenMapped),this.insertNodes(n.allLeafChildren,e)}noChangeInGroupingColumns(e,t){let r=!1;const n=this.showRowGroupCols.getShowRowGroupCols(),i=n?n.map((e=>e.getId())).join("-"):"";return t&&(r=this.areGroupColsEqual(e,this.oldGroupingDetails),this.oldGroupDisplayColIds!==i&&this.checkAllGroupDataAfterColsChanged(e)),this.oldGroupingDetails=e,this.oldGroupDisplayColIds=i,r}insertNodes(e,t){e.forEach((e=>{this.insertOneNode(e,t),t.changedPath.active&&t.changedPath.addParentNode(e.parent)}))}insertOneNode(e,t,r){const n=this.getGroupInfo(e,t),i=this.findParentForNode(e,n,t,r);i.group||et(184,{parentGroupData:i.data,childNodeData:e.data}),e.parent=i,e.level=n.length,i.childrenAfterGroup.push(e),i.updateHasChildren()}findParentForNode(e,t,r,n){let i=r.rootNode;return t.forEach(((t,s)=>{i=this.getOrCreateNextNode(i,t,s,r),n?.isRemoveFromAllLeafChildren(i,e)?n?.preventRemoveFromAllLeafChildren(i,e):i.allLeafChildren.push(e)})),i}getOrCreateNextNode(e,t,r,n){const i=this.getChildrenMappedKey(t.key,t.rowGroupColumn);let s=e?.childrenMapped?.[i];return s||(s=this.createGroup(t,e,r,n),this.addToParent(s,e)),s}createGroup(e,t,r,n){const i=new Bi(this.beans);return i.group=!0,i.field=e.field,i.rowGroupColumn=e.rowGroupColumn,this.setGroupData(i,e),i.key=e.key,i.id=this.createGroupId(i,t,r),i.level=r,i.leafGroup=r===n.groupedColCount-1,i.allLeafChildren=[],i.setAllChildrenCount(0),i.rowGroupIndex=r,i.childrenAfterGroup=[],i.childrenMapped={},i.updateHasChildren(),i.parent=t,this.setExpandedInitialValue(n,i),i}createGroupId(e,t,r){const n=(e,t)=>{if(!e.rowGroupColumn)return null;const r=t?n(t,t.parent,0):null;return`${null==r?"":r+"-"}${e.rowGroupColumn.getColId()}-${e.key}`};return _i+n(e,t,r)}setGroupData(e,t){const r=t.rowGroupColumn;r&&t.leafNode&&(e.groupValue=this.valueSvc.getValue(r,t.leafNode)),e.groupData={};this.showRowGroupCols.getShowRowGroupCols().forEach((r=>{const n=e.rowGroupColumn;null!==n&&r.isRowGroupDisplayed(n.getId())&&(e.groupData[r.getColId()]=this.valueSvc.getValue(n,t.leafNode))}))}getChildrenMappedKey(e,t){return t?t.getId()+"-"+e:e}setExpandedInitialValue(e,t){if(e.pivotMode&&t.leafGroup)return void(t.expanded=!1);const r=e.isGroupOpenByDefault;if(r){const e={rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn};t.expanded=1==r(e)}else-1!==e.expandByDefault?t.expanded=t.level<e.expandByDefault:t.expanded=!0}getGroupInfo(e,t){const r=[];return t.groupedCols.forEach((n=>{let i=this.valueSvc.getKeyForNode(n,e),s=null!==i&&void 0!==i&&""!==i;if((t.pivotMode||!t.groupAllowUnbalanced)&&!s&&(i="",s=!0),s){const t={key:i,field:n.getColDef().field,rowGroupColumn:n,leafNode:e};r.push(t)}})),r}}},rowModels:["clientSide"],dependsOn:[Np,pp,Fp]},Gp={moduleName:"RowGroupingPanel",version:Gh,selectors:[Ip],icons:{pivotPanel:"pivot",rowGroupPanel:"group",panelDelimiter:"small-right",panelDelimiterRtl:"small-left"},dependsOn:[Bh,yu]};var Bp="PivotRowTotal_",Hp=(e,t)=>{let{headerName:r}=e,{headerName:n}=t;return r&&!n?1:!r&&n?-1:r||n?r<n?-1:r>n?1:0:0},zp="Exceeded maximum allowed pivot column count.",Vp=e=>{const t={};return e.forEach(((e,r)=>t[r]=e instanceof Map?Vp(e):e)),t},Wp={moduleName:"SharedPivot",version:Gh,beans:[class extends rr{constructor(){super(...arguments),this.beanName="pivotResultCols"}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols}destroy(){Fr(this.beans,this.pivotResultCols?.tree),super.destroy()}isPivotResultColsPresent(){return null!=this.pivotResultCols}lookupPivotResultCol(e,t){if(null==this.pivotResultCols)return null;const r=this.colModel.getColDefCol(t);let n=null;return this.pivotResultCols.list.forEach((t=>{const i=t.getColDef().pivotKeys,s=t.getColDef().pivotValueColumn;yr(i,e)&&s===r&&(n=t)})),n}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.colModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){if(this.colModel.ready&&(null!=e||null!=this.pivotResultCols)){if(e){this.processPivotResultColDef(e);const r=Br(this.beans,e,!1,this.pivotResultCols?.tree||this.previousPivotResultCols||void 0,t);Fr(this.beans,this.pivotResultCols?.tree,r.columnTree);const n=r.columnTree,i=r.treeDept,s=Pr(n),o={};this.pivotResultCols={tree:n,treeDepth:i,list:s,map:o},this.pivotResultCols.list.forEach((e=>this.pivotResultCols.map[e.getId()]=e));const a=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.colModel.refreshCols(!a)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.colModel.refreshCols(!1);this.visibleCols.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),r=this.gos.get("processPivotResultColGroupDef");if(!t&&!r)return;const n=e=>{e.forEach((e=>{if(xe(e.children)){const t=e;r&&r(t),n(t.children)}else{t&&t(e)}}))};e&&n(e)}},class extends rr{constructor(){super(...arguments),this.beanName="pivotColDefSvc"}wireBeans(e){this.colModel=e.colModel,this.pivotColsSvc=e.pivotColsSvc,this.valueColsSvc=e.valueColsSvc,this.colNames=e.colNames}postConstruct(){const e=()=>this.gos.get("serverSidePivotResultFieldSeparator")??"_";this.fieldSeparator=e(),this.addManagedPropertyListener("serverSidePivotResultFieldSeparator",(()=>{this.fieldSeparator=e()}));const t=()=>this.gos.get("pivotDefaultExpanded");this.pivotDefaultExpanded=t(),this.addManagedPropertyListener("pivotDefaultExpanded",(()=>{this.pivotDefaultExpanded=t()}))}createPivotColumnDefs(e){const t=this.createPivotColumnsFromUniqueValues(e);const r=function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((t=>{void 0!==t.children?e(t.children,r):r.push(t)})),r}(t);this.addRowGroupTotals(t,r),this.addExpandablePivotGroups(t,r),this.addPivotTotalsToGroups(t,r);return{pivotColumnGroupDefs:t,pivotColumnDefs:r.map((e=>({...e})))}}createPivotColumnsFromUniqueValues(e){const t=this.pivotColsSvc?.columns??[],r=t.length;return this.recursivelyBuildGroup(0,e,[],r,t)}recursivelyBuildGroup(e,t,r,n,i){if(e>=n)return this.buildMeasureCols(r);const{pivotComparator:s}=i[e].getColDef(),o=s?(e=>(t,r)=>e(t.headerName,r.headerName))(s):Hp,a=this.valueColsSvc?.columns;if(1===a?.length&&this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&e===n-1){const e=[];for(const n of t.keys()){const t=[...r,n],i=this.createColDef(a[0],n,t);i.columnGroupShow="open",e.push(i)}return e.sort(o),e}const l=[];for(const c of t.keys()){const s=-1===this.pivotDefaultExpanded||e<this.pivotDefaultExpanded,o=[...r,c];l.push({children:this.recursivelyBuildGroup(e+1,t.get(c),o,n,i),headerName:c,pivotKeys:o,columnGroupShow:"open",openByDefault:s,groupId:this.generateColumnGroupId(o)})}return l.sort(o),l}buildMeasureCols(e){const t=this.valueColsSvc?.columns??[];return 0===t.length?[this.createColDef(null,"-",e)]:t.map((t=>{const r=this.colNames.getDisplayNameForColumn(t,"header");return{...this.createColDef(t,r,e),columnGroupShow:"open"}}))}addExpandablePivotGroups(e,t){const r=this.gos.get("suppressExpandablePivotGroups");if(r||this.gos.get("pivotColumnGroupTotals"))return;const n=(e,t,i)=>{if("children"in e){const{valueColsSvc:s}=this,{columns:o=[]}=s??{},a=new Map;e.children.forEach((e=>{n(e,t,a)}));const l=!e.children.some((e=>e.children)),c=l&&1===o.length&&this.gos.get("removePivotHeaderRowWhenSingleValueColumn");return o.forEach((n=>{const i=this.colNames.getDisplayNameForColumn(n,"header"),s=this.createColDef(n,i,e.pivotKeys);if(s.pivotTotalColumnIds=a.get(n.getColId()),s.columnGroupShow=r?"open":"closed",s.aggFunc=n.getAggFunc(),!l||c){e.children.push(s),t.push(s)}})),void this.merge(i,a)}if(!e.pivotValueColumn)return;const s=e.pivotValueColumn.getColId();if(i.has(s)){i.get(s).push(e.colId)}else i.set(s,[e.colId])};e.forEach((e=>{n(e,t,new Map)}))}addPivotTotalsToGroups(e,t){if(!this.gos.get("pivotColumnGroupTotals"))return;const r="after"===this.gos.get("pivotColumnGroupTotals"),n=this.valueColsSvc?.columns,i=n?.map((e=>e.getAggFunc()));if(i&&!(i.length<1)&&this.sameAggFuncs(i)&&n){const i=n[0];e.forEach((e=>{this.recursivelyAddPivotTotal(e,t,i,r)}))}}recursivelyAddPivotTotal(e,t,r,n){const i=e;if(!i.children){const t=e;return t.colId?[t.colId]:null}let s=[];if(i.children.forEach((e=>{const i=this.recursivelyAddPivotTotal(e,t,r,n);i&&(s=s.concat(i))})),i.children.length>1){const i=this.getLocaleTextFunc()("pivotColumnGroupTotals","Total"),o=this.createColDef(r,i,e.pivotKeys,!0);o.pivotTotalColumnIds=s,o.aggFunc=r.getAggFunc(),o.columnGroupShow=this.gos.get("suppressExpandablePivotGroups")?"open":void 0;const a=e.children;n?a.push(o):a.unshift(o),t.push(o)}return s}addRowGroupTotals(e,t){if(!this.gos.get("pivotRowTotals"))return;const r="after"===this.gos.get("pivotRowTotals"),n=(this.valueColsSvc?.columns??[]).slice();r||n.reverse();const i=n.length>1||!this.gos.get("removePivotHeaderRowWhenSingleValueColumn");for(let s=0;s<n.length;s++){const o=n[s],a=this.colNames.getDisplayNameForColumn(o,"header"),l=this.createColDef(o,a,[]),c=[];for(let e=0;e<t.length;e++){const r=t[e];r.pivotValueColumn===o&&c.push(r.colId)}l.pivotTotalColumnIds=c,l.colId=Bp+l.colId;const u=i?{children:[l],pivotKeys:[],groupId:`${Bp}_pivotGroup_${o.getColId()}`}:l;t.push(l),r?e.push(u):e.unshift(u)}}createColDef(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i={};if(e){const t=e.getColDef();Object.assign(i,t),i.hide=!1}return i.headerName=t,i.colId=this.generateColumnId(r||[],e&&!n?e.getColId():""),i.field=i.colId,i.valueGetter=e=>e.data?.[e.colDef.field],i.pivotKeys=r,i.pivotValueColumn=e,!0===i.filter&&(i.filter="agNumberColumnFilter"),i}sameAggFuncs(e){if(1==e.length)return!0;for(let t=1;t<e.length;t++)if(e[t]!==e[0])return!1;return!0}merge(e,t){t.forEach(((t,r)=>{const n=[...e.has(r)?e.get(r):[],...t];e.set(r,n)}))}generateColumnGroupId(e){return`pivotGroup_${(this.pivotColsSvc?.columns??[]).map((e=>e.getColId())).join("-")}_${e.join("-")}`}generateColumnId(e,t){return`pivot_${(this.pivotColsSvc?.columns??[]).map((e=>e.getColId())).join("-")}_${e.join("-")}_${t}`}createColDefsFromFields(e){const t={};for(let i=0;i<e.length;i++){const r=e[i].split(this.fieldSeparator);let n=t;for(let e=0;e<r.length;e++){const t=r[e];null==n[t]&&(n[t]={}),n=n[t]}}const r=(e,t,n,i)=>{const s=[];for(const o of Object.keys(n)){const t=n[o],a=r(`${e}${this.fieldSeparator}${o}`,o,t,i+1);s.push(a)}if(0===s.length){const r=this.colModel.getColDefCol(t);if(r){const n=this.colNames.getDisplayNameForColumn(r,"header")??t,i=this.createColDef(r,n,void 0,!1);return i.colId=e,i.aggFunc=r.getAggFunc(),i.valueGetter=t=>t.data?.[e],i}return{colId:e,headerName:t,valueGetter:t=>t.data?.[e]}}if(this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===s.length&&"colId"in s[0])return s[0].headerName=t,s[0];return{openByDefault:-1===this.pivotDefaultExpanded||i<this.pivotDefaultExpanded,groupId:e,headerName:t,children:s}},n=[];for(const i of Object.keys(t)){const e=r(i,i,t[i],0);n.push(e)}return n}},gp],apiFunctions:{isPivotMode:function(e){return e.colModel.isPivotMode()},getPivotResultColumn:function(e,t,r){return e.pivotResultCols?.lookupPivotResultCol(t,r)??null},setValueColumns:function(e,t){e.valueColsSvc?.setColumns(t,"api")},getValueColumns:function(e){return e.valueColsSvc?.columns??[]},removeValueColumns:function(e,t){e.valueColsSvc?.removeColumns(t,"api")},addValueColumns:function(e,t){e.valueColsSvc?.addColumns(t,"api")},setPivotColumns:function(e,t){e.pivotColsSvc?.setColumns(t,"api")},removePivotColumns:function(e,t){e.pivotColsSvc?.removeColumns(t,"api")},addPivotColumns:function(e,t){e.pivotColsSvc?.addColumns(t,"api")},getPivotColumns:function(e){return e.pivotColsSvc?.columns??[]},setPivotResultColumns:function(e,t){e.pivotResultCols?.setPivotResultCols(t,"api")},getPivotResultColumns:function(e){const t=e.pivotResultCols?.getPivotResultCols();return t?t.list:null}},dependsOn:[Np,Ta]},Up={moduleName:"Pivot",version:Gh,rowModels:["clientSide"],beans:[class extends rr{constructor(){super(...arguments),this.beanName="pivotStage",this.refreshProps=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),this.step="pivot",this.uniqueValues=new Map,this.lastTimeFailed=!1,this.maxUniqueValues=-1,this.currentUniqueCount=0}wireBeans(e){this.valueSvc=e.valueSvc,this.colModel=e.colModel,this.pivotResultCols=e.pivotResultCols,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueColsSvc=e.valueColsSvc,this.pivotColsSvc=e.pivotColsSvc,this.pivotColDefSvc=e.pivotColDefSvc}execute(e){const t=e.changedPath;this.colModel.isPivotActive()?this.executePivotOn(t):this.executePivotOff(t)}executePivotOff(e){this.aggregationColumnsHashLastTime=null,this.uniqueValues=new Map,this.pivotResultCols.isPivotResultColsPresent()&&(this.pivotResultCols.setPivotResultCols(null,"rowModelUpdated"),e&&(e.active=!1))}executePivotOn(e){const t=this.valueColsSvc?.columns.length??1,r=this.gos.get("pivotMaxGeneratedColumns");let n;this.maxUniqueValues=-1===r?-1:r/t;try{n=this.bucketUpRowNodes(e)}catch(v){if(v.message===zp)return this.pivotResultCols.setPivotResultCols([],"rowModelUpdated"),this.eventSvc.dispatchEvent({type:"pivotMaxColumnsExceeded",message:v.message}),void(this.lastTimeFailed=!0);throw v}const i=this.setUniqueValues(n),s=this.valueColsSvc?.columns??[],o=s.map((e=>`${e.getId()}-${e.getColDef().headerName}`)).join("#"),a=s.map((e=>e.getAggFunc().toString())).join("#"),l=this.aggregationColumnsHashLastTime!==o,c=this.aggregationFuncsHashLastTime!==a;this.aggregationColumnsHashLastTime=o,this.aggregationFuncsHashLastTime=a;const u=(this.rowGroupColsSvc?.columns??[]).map((e=>e.getId())).join("#"),d=u!==this.groupColumnsHashLastTime;this.groupColumnsHashLastTime=u;const h=this.gos.get("pivotRowTotals"),p=this.gos.get("pivotColumnGroupTotals"),g=this.gos.get("suppressExpandablePivotGroups"),f=this.gos.get("removePivotHeaderRowWhenSingleValueColumn"),m=h!==this.pivotRowTotalsLastTime||p!==this.pivotColumnGroupTotalsLastTime||g!==this.suppressExpandablePivotGroupsLastTime||f!==this.removePivotHeaderRowWhenSingleValueColumnLastTime;if(this.pivotRowTotalsLastTime=h,this.pivotColumnGroupTotalsLastTime=p,this.suppressExpandablePivotGroupsLastTime=g,this.removePivotHeaderRowWhenSingleValueColumnLastTime=f,this.lastTimeFailed||i||l||d||c||m){const{pivotColumnGroupDefs:t,pivotColumnDefs:r}=this.pivotColDefSvc.createPivotColumnDefs(this.uniqueValues);this.pivotColumnDefs=r,this.pivotResultCols.setPivotResultCols(t,"rowModelUpdated"),e&&(e.active=!1)}this.lastTimeFailed=!1}setUniqueValues(e){return!!(JSON.stringify(Vp(this.uniqueValues))!==JSON.stringify(Vp(e)))&&(this.uniqueValues=e,!0)}bucketUpRowNodes(e){this.currentUniqueCount=0;const t=new Map;e.forEachChangedNodeDepthFirst((e=>{e.leafGroup&&(e.childrenMapped=null)}));const r=e=>{e.leafGroup?this.bucketRowNode(e,t):e.childrenAfterFilter?.forEach(r)};return e.executeFromRootNode(r),t}bucketRowNode(e,t){const r=this.pivotColsSvc?.columns;e.childrenMapped=0===r?.length?null:Vp(this.bucketChildren(e.childrenAfterFilter,r,0,t)),e.sibling&&(e.sibling.childrenMapped=e.childrenMapped)}bucketChildren(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const i=new Map,s=t[r];if(e.forEach((e=>{let t=this.valueSvc.getKeyForNode(s,e);if(ke(t)&&(t=""),!n.get(t)){this.currentUniqueCount+=1,n.set(t,new Map);const e=-1!==this.maxUniqueValues,r=this.currentUniqueCount>this.maxUniqueValues;if(e&&r)throw Error(zp)}i.has(t)||i.set(t,[]),i.get(t).push(e)})),r===t.length-1)return i;const o=new Map;for(const a of i.keys())o.set(a,this.bucketChildren(i.get(a),t,r+1,n.get(a)));return o}getPivotColumnDefs(){return this.pivotColumnDefs}}],dependsOn:[Wp,_p,Fp]},jp=(e,t)=>e.treeNode.sourceIdx-t.treeNode.sourceIdx,$p=wr.values(),Kp=class e{constructor(e,t){this.parent=e,this.key=t,this.children=null,this.invalidatedHead=null,this.invalidatedNext=void 0,this.row=null,this.oldRow=null,this.duplicateRows=null,this.childrenAfterGroup=wr,this.allLeafChildren=null,this.childrenChanged=!1,this.leafChildrenChanged=!1,this.sourceIdx=-1}get size(){return this.children?.size??0}isEmptyFillerNode(){return!this.row?.data&&!this.children?.size}enumChildren(){return this.children?.values()??$p}upsertKey(t){"string"!==typeof t&&(t=String(t));let r=this.children?.get(t);return r||(r=new e(this,t),(this.children??(this.children=new Map))?.set(r.key,r)),r}appendKey(t){const r=this.children;"string"!==typeof t&&(t=String(t));let n=r?.get(t);return n?(r.delete(t),r.set(t,n)):(n=new e(this,t),(this.children??(this.children=new Map))?.set(n.key,n)),n}destroy(){const{row:e,parent:t}=this;null!==e&&e.treeNode===this&&(e.treeNode=null),null!==t&&(this.parent=null,t.children?.delete(this.key))}setRow(e){const t=this.row;return t!==e&&(null!==t&&(t.treeNode=null),null!==e&&(e.treeNode=this),this.row=e,!0)}removeRow(e){const{row:t,duplicateRows:r}=this;if(t===e){if(this.row=null,null!==r)for(const n of r){this.row=n,r.delete(n);break}}else if(!r?.delete(e))return!1;return 0===r?.size&&(this.duplicateRows=null),e.treeNode=null,!0}addDuplicateRow(e){let t=this.duplicateRows;if(null===t)t=new Set,this.duplicateRows=t;else if(t.has(e))return!1;return t.add(e),e.treeNode=this,e.childrenAfterGroup=wr,e.allLeafChildren=null,!0}sortFirstDuplicateRow(){const e=this.duplicateRows,t=this.row;if(!t||!e)return t;let r=t;for(const n of e)n.sourceRowIndex<r.sourceRowIndex&&(r=n);return r!==t&&(e.delete(r),e.add(t),this.row=r),r}dequeueInvalidated(){for(;;){const e=this.invalidatedHead;if(!e)return null;if(this.invalidatedHead=e.invalidatedNext??null,e.parent===this)return e.invalidatedNext=void 0,e}}invalidate(){let e=this,t=this.parent;for(;null!==t&&void 0===e.invalidatedNext;)e.invalidatedNext=t.invalidatedHead,t.invalidatedHead=e,e=t,t=e.parent}invalidateOrder(){const e=this.parent;e&&!e.childrenChanged&&((e.children?.size??0)>1||(this.children?.size??0)>1||!e.row?.data)&&(e.childrenChanged=!0,e.invalidate())}getNewSourceIdx(){const e=this.row;return e?.data?e.sourceRowIndex:this.childrenAfterGroup[0]?.treeNode?.sourceIdx??this.sourceIdx}updateChildrenAfterGroup(e,t){this.childrenChanged=!1;const r=e&&this.children?.size;if(!r)return 0!==this.childrenAfterGroup.length&&(this.childrenAfterGroup=t?[]:wr,this.leafChildrenChanged=!0,!0);let n=!1,i=this.childrenAfterGroup;i===wr?(i=new Array(r),this.childrenAfterGroup=i,n=!0):i.length!==r&&(i.length=r,n=!0);let s=0,o=-1,a=!1;for(const l of this.enumChildren()){const e=l.getNewSourceIdx();e<o&&(a=!0),o=e,l.sourceIdx=e;const t=l.row;i[s]!==t&&(i[s]=t,n=!0),++s}return n&&(this.leafChildrenChanged=!0),a&&this.reorderChildrenList(i),n||a}reorderChildrenList(e){const t=e.length,r=this.children;e.sort(jp),r.clear();for(let n=0;n<t;++n){const t=e[n].treeNode;r.set(t.key,t)}}updateAllLeafChildren(){const{parent:e,childrenAfterGroup:t}=this;this.leafChildrenChanged=!1;let r=!1;const n=t.length;if(0===n)this.allLeafChildren&&(r||(r=0!==this.allLeafChildren.length),this.allLeafChildren=null);else{const e=this.allLeafChildren??(this.allLeafChildren=[]),i=e.length;let s=0;for(let o=0;o<n;++o){const n=t[o],a=n.treeNode?.allLeafChildren,l=a?.length;if(n.data&&((s>=i||e[s]!==n)&&(e[s]=n,r=!0),++s),l)for(let t=0;t<l;++t){const n=a[t];(s>=i||e[s]!==n)&&(e[s]=n,r=!0),++s}}i!==s&&(e.length=s,r=!0)}r&&e&&(e.leafChildrenChanged=!0)}},Yp=e=>0!==(2&e.treeNodeFlags),qp=e=>0!==(4&e.treeNodeFlags),Xp=e=>0!==(16&e.treeNodeFlags),Jp=(e,t)=>{t?e.treeNodeFlags|=2:e.treeNodeFlags&=-3},Qp=e=>{e&&(e.treeNodeFlags|=16)},Zp=e=>{const t=e.level<0,r=e.treeNodeFlags,n=0!==(1&r);if(e.treeNodeFlags=1|-29&r,!n||t){const t=e.childrenAfterGroup;e.childrenAfterFilter=t,e.childrenAfterAggFilter=t,e.childrenAfterSort=t}if(t){const t=e.sibling;t&&(t.childrenAfterGroup=e.childrenAfterGroup,t.childrenMapped=e.childrenMapped)}},eg=e=>{e.treeNodeFlags=0},tg=class extends To{constructor(){super(...arguments),this.oldGroupDisplayColIds="",this.rowsPendingDestruction=null,this.treeCommitPending=!0,this.treeRoot=null}activate(e){super.activate(e),this.treeSetRootNode(e),this.treeCommitPending=!0}treeSetRootNode(e){let t=this.treeRoot;t||(t=new Kp(null,""),t.childrenChanged=!0,this.treeRoot=t),t.row=e,e.treeNode=t}destroy(){super.destroy(),this.treeRoot=null,this.rowsPendingDestruction=null,this.oldGroupDisplayColIds=""}deactivate(){const{treeRoot:e,rootNode:t}=this;e&&(t&&e.removeRow(t),this.treeDestroy(e),e.destroy()),t&&eg(t),this.commitDestroyedRows(),super.deactivate(),this.treeRoot=null,this.oldGroupDisplayColIds=""}treeSetRow(e,t,r){const n=e.row;if(e===this.treeRoot)return!1;let i=!1;if(n!==t){const r=t.treeNode;null!==r&&r!==e&&(r.removeRow(t),r.invalidate()),null===n?(e.setRow(t),i=!0):n.data?e.addDuplicateRow(t)&&(i=!0):(e.setRow(t),this.destroyRow(n,!0),i=!0)}return r||qp(t)||((e=>{const t=e.treeNodeFlags;0!==(1&t)&&(e.treeNodeFlags=4|t)})(t),i=!0),i&&e.invalidate(),this.rowsPendingDestruction?.delete(t),i}treeRemove(e,t){if(e===this.treeRoot)return;let r=!1;if(e.removeRow(t)){const n=e.parent;n&&(n.childrenChanged=!0),this.destroyRow(t,!t.data),r=!0}r&&e.invalidate()}treeCommit(e){const{treeRoot:t,rootNode:r}=this;if(!t||!r)return;this.treeCommitPending=!1;const n=this.treeData,i=e?.active?e:null,s={rootNode:r,activeChangedPath:i,treeData:n,expandByDefault:this.gos.get("groupDefaultExpanded"),isGroupOpenByDefault:this.gos.getCallback("isGroupOpenByDefault")};this.treeCommitChildren(s,t,!1,0);const o=t.row;o&&(n&&(o.leafGroup=!1),t.childrenChanged&&t.updateChildrenAfterGroup(n,!0)&&Qp(o),!n&&i||(o.childrenAfterGroup=t.childrenAfterGroup),i&&Xp(o)&&i.addParentNode(o),Zp(o),o.updateHasChildren()),this.commitDestroyedRows(),n&&this.beans.selectionSvc?.updateSelectableAfterGrouping(e)}treeCommitChildren(e,t,r,n){for(;;){const i=t.dequeueInvalidated();if(null===i)break;i.parent===t&&this.treeCommitChild(e,i,r||!(t.row?.expanded??1),n)}t.childrenChanged||(t.childrenChanged=(e.treeData?t.size:0)!==t.row.childrenAfterGroup?.length)}treeCommitChild(e,t,r,n){t.isEmptyFillerNode()?this.treeClear(t):(this.treeCommitPreOrder(e,t,n),this.treeCommitChildren(e,t,r,n+1),t.isEmptyFillerNode()?this.treeClear(t):this.treeCommitPostOrder(e,t,r))}treeCommitPreOrder(e,t,r){let n=t.row;if(null===n?(n=this.createFillerRow(t,r),t.setRow(n)):(n=t.sortFirstDuplicateRow(),void 0===n.allChildrenCount&&(n.allChildrenCount=null)),e.treeData){if(n.level=r,n.parent=t.parent.row,t.oldRow!==n)for(const r of t.enumChildren()){const e=r.row;null!==e&&(e.parent=n)}const e=t.key;n.key!==e?(n.key=e,(e=>{const t=e.treeNodeFlags;0!==(1&t)&&(e.treeNodeFlags=12|t)})(n),this.setGroupData(n,e)):n.groupData||this.setGroupData(n,e)}else e.activeChangedPath||(n.level=0,n.parent=e.rootNode,n.key=t.key)}treeCommitPostOrder(e,t,r){const n=t.parent,i=t.row,s=t.oldRow,o=i.group;if(t.childrenChanged&&t.updateChildrenAfterGroup(e.treeData,!1)&&Qp(i),t.leafChildrenChanged&&t.updateAllLeafChildren(),e.treeData||!e.activeChangedPath){i.childrenAfterGroup=t.childrenAfterGroup,i.allLeafChildren=t.allLeafChildren;const r=t.childrenAfterGroup.length>0,a=r||!i.data;o!==a?(Qp(i),zh(i,this.beans,a),a||i.expanded||Jp(i,!1)):i.hasChildren()!==r&&(Qp(i),i.updateHasChildren()),a&&!Yp(i)&&(i.expanded=((e,t,r)=>{if(t!==r&&null!==t&&t.group&&Yp(t)&&!e.isGroupOpenByDefault)return t.expanded;const n=e.isGroupOpenByDefault;return n?1==n({rowNode:r,field:r.field,key:r.key,level:r.level,rowGroupColumn:r.rowGroupColumn}):-1===e.expandByDefault||r.level<e.expandByDefault})(e,s,i),Jp(i,!0)),qp(i)&&(Qp(n.row),(e=>0!==(8&e.treeNodeFlags))(i)&&i.setData(i.data))}s!==i&&(t.oldRow=i,null===s||!o&&0===t.size||Qp(i),n.childrenChanged=!0,Qp(n.row)),Xp(i)&&(this.treeData?e.activeChangedPath?.addParentNode(i):Qp(e.rootNode)),Zp(i),t.duplicateRows?.size&&!t.duplicateRowsWarned&&(t.duplicateRowsWarned=!0,et(186,{rowId:i.id,rowData:i.data,duplicateRowsData:Array.from(t.duplicateRows).map((e=>e.data))})),r&&null!==i.rowIndex&&i.clearRowTopAndRowIndex();const a=t.getNewSourceIdx(),l=t.sourceIdx;l!==a&&(t.sourceIdx=a,-1!==l&&(n.childrenChanged=!0))}createFillerRow(e,t){const r=new Bi(this.beans);r.key=e.key,r.group=!0,r.field=null,r.leafGroup=!1,r.rowGroupIndex=null,r.allChildrenCount=null;let n=t+"-"+e.key,i=e.parent;for(;null!==i;){const e=i.parent;if(null===e)break;n=`${--t}-${i.key}-${n}`,i=e}return r.id=_i+n,r}setGroupData(e,t){e.groupValue=t;const r={};e.groupData=r;const n=this.beans.showRowGroupCols?.getShowRowGroupCols();if(n)for(const i of n)r[i.getColId()]=t}treeClear(e){const{parent:t,oldRow:r}=e;if(null!==t&&null!==r&&(t.childrenChanged=!0,null!==t.row&&Qp(t.row)),e!==this.treeRoot){let t=e.row;for(;null!==t&&e.removeRow(t);)this.destroyRow(t,!t.data),t=e.row}for(const n of e.enumChildren())this.treeClear(n);e.destroy()}treeDestroy(e){const{row:t,duplicateRows:r}=e;if(t&&(e===this.treeRoot||t.data?eg(t):this.destroyRow(t,!0)),r)for(const n of r)e===this.treeRoot||n.data?eg(n):this.destroyRow(n,!0);for(const n of e.enumChildren())this.treeDestroy(n);e.destroy()}destroyRow(e,t){if(e.isSelected())t=!1;else if(!(e=>0!==(1&e.treeNodeFlags))(e))return void eg(e);t?(eg(e),e.clearRowTopAndRowIndex(),e.groupData=null):(this.rowsPendingDestruction??(this.rowsPendingDestruction=new Set)).add(e)}commitDestroyedRows(){const{rowsPendingDestruction:e}=this;let t=null;if(null!==e){for(const r of e)this.destroyRow(r,!0),r.isSelected()&&(t??(t=[])).push(r);this.rowsPendingDestruction=null}t&&this.deselectNodes(t)}refreshModel(e,t){if(t&&this.treeCommitPending&&this.treeCommit(e.changedPath),e.afterColumnsChanged)if(this.treeData){const e=this.beans.showRowGroupCols?.getShowRowGroupCols()?.map((e=>e.getId())).join("-")??"";if(this.oldGroupDisplayColIds!==e){this.oldGroupDisplayColIds=e;const t=this.rootNode?.childrenAfterGroup;if(t)for(let e=0,r=t.length??0;e<r;++e){const r=t[e],n=r.treeNode;n&&this.setGroupData(r,n.key)}}}else this.oldGroupDisplayColIds=""}},rg=e=>{const t=(e=>{if("string"!==typeof e||!e.length)return[];const t=e.split(".");return t.includes("__proto__")?[]:t})(e);let r=null;const n=t.length-1;return r=0===n?t=>t?.[e]:n>0?e=>{let r=e;for(let i=0;i<=n&&null!==r&&void 0!==r;++i)if(r=r[t[i]],i<n&&"object"!==typeof r&&void 0!==r)return null;return r}:()=>{},r.path=e,r},ng=2147483648,ig=1073741824,sg=536870912,og=536870911,ag=(e,t)=>{const r=new Set,n=e=>{r.add(e);for(const t of e.childrenAfterGroup)n(t)};n(e);const i=e.childrenAfterGroup;i.length=0;for(const s of e.allLeafChildren)if(r.has(s))s.parent===e&&i.push(s);else{const r=s.parent;et(270,{id:s.id,parentId:r.id}),r.childrenAfterGroup=r.childrenAfterGroup.filter((e=>e!==s)),r.treeNodeFlags=r.treeNodeFlags-1|ig|ng,s.parent=e,t(s,0),n(s),i.push(s)}},lg=(e,t)=>{e.childrenAfterFilter=t,e.childrenAfterAggFilter=t,e.childrenAfterSort=t;const r=e.sibling;r&&(r.childrenAfterGroup=e.childrenAfterGroup,r.childrenAfterAggFilter=e.childrenAfterAggFilter,r.childrenAfterSort=e.childrenAfterSort)},cg=(e,t)=>{e.allLeafChildren??(e.allLeafChildren=null),e.childrenAfterFilter??(e.childrenAfterFilter=t),e.childrenAfterAggFilter??(e.childrenAfterAggFilter=t),e.childrenAfterSort??(e.childrenAfterSort=t);const r=e.sibling;r&&(r.allLeafChildren=e.allLeafChildren,r.childrenAfterGroup=e.childrenAfterGroup,r.childrenAfterAggFilter=e.childrenAfterAggFilter,r.childrenAfterFilter=e.childrenAfterFilter,r.childrenAfterSort=e.childrenAfterSort)},ug=(e,t,r)=>{if(0===r)return!!t&&(e.allLeafChildren=null,!!t?.length);let n=!1;t?t.length!==r&&(t.length=r,n=!0):(t=e.allLeafChildren=new Array(r),n=!0);let i=0;const s=e.childrenAfterGroup;if(s)for(const o of s){n||(n=t[i]!==o),t[i++]=o;const e=o.allLeafChildren;if(e)for(const r of e)n||(n=t[i]!==r),t[i++]=r}return n},dg=(e,t,r)=>e?1==e({rowNode:r,field:r.field,key:r.key,level:r.level,rowGroupColumn:r.rowGroupColumn}):-1===t||r.level<t,hg=(e,t,r,n)=>{let{rowNode:i,changedRowNodes:s}=t;const o=s?.updates,a=s?.adds,l=i.allLeafChildren;for(let c=0,u=l.length;c<u;++c){const t=l[c],s=o?.has(t)||a?.has(t),u=t.parent;let d;if(s||n){const n=r(t.data);null===n||void 0===n?d=i:(d=e.getRowNode(n),d||(et(271,{id:t.id,parentId:n}),d=i))}else d=t.parent??i;let h=d.treeNodeFlags;const p=h&og;h=-536870912&h|p+1;let g=d.childrenAfterGroup;g&&g!==wr||(d.childrenAfterGroup=g=[]),(g.length<=p||g[p]!==t)&&(g[p]=t,h|=ig),(s||t.parent!==d)&&(t.parent=d,h|=ng,u!==d&&null!==u&&(u.treeNodeFlags|=ng)),d.treeNodeFlags=h}},pg={moduleName:"SharedTreeData",version:Gh,dependsOn:[Bh,hp,Ap,Dp]},gg={moduleName:"TreeData",version:Gh,beans:[class extends tg{constructor(){super(...arguments),this.beanName="csrmPathTreeNodeSvc"}loadNewRowData(e){const t=this.rootNode,r=this.treeRoot;this.treeClear(r),this.treeSetRootNode(t),super.loadNewRowData(e);const n=t.allLeafChildren,i=this.gos.get("getDataPath");for(let s=0,o=n.length;s<o;++s)this.addOrUpdateRow(i,n[s],!0);this.treeCommitPending=!0}get treeData(){const e=this.gos;return e.get("treeData")&&!!e.get("getDataPath")}refreshModel(e,t){const r=e.changedRowNodes;r&&this.executeTransactions(r,e.rowNodesOrderChanged),super.refreshModel(e,t)}executeTransactions(e,t){const r=this.treeRoot;if(!r)return;this.treeSetRootNode(this.rootNode);for(const s of e.removals){const e=s.treeNode;e&&this.treeRemove(e,s)}const n=this.gos.get("getDataPath");for(const s of e.updates)this.addOrUpdateRow(n,s,!1);for(const s of e.adds)this.addOrUpdateRow(n,s,!0);const i=r.row?.allLeafChildren;if(t&&i)for(let s=0,o=i.length;s<o;++s){const e=i[s].treeNode;e&&e.sourceIdx!==s&&e.invalidateOrder()}this.treeCommitPending=!0}addOrUpdateRow(e,t,r){const n=this.treeRoot;if(!this.treeData)return void this.treeSetRow(n.upsertKey(t.id),t,r);const i=e?.(t.data),s=i?.length;if(s){let e=0,o=n;do{o=o.upsertKey(i[e++])}while(e<s);this.treeSetRow(o,t,r)}else et(185,{data:t.data})}},class extends tg{constructor(){super(...arguments),this.beanName="csrmChildrenTreeNodeSvc",this.childrenGetter=null}get treeData(){return this.gos.get("treeData")}extractRowData(){const e=this.treeRoot;return e&&Array.from(e.enumChildren(),(e=>e.row.data))}destroy(){super.destroy(),this.childrenGetter=null}activate(e){const t=this.childrenGetter,r=this.gos.get("treeDataChildrenField");t&&t.path===r||(this.childrenGetter=rg(r)),super.activate(e)}updateRowData(e,t){return et(268),{changedRowNodes:t,rowNodeTransaction:{add:[],remove:[],update:[]},rowsInserted:!1}}loadNewRowData(e){const t=this.treeRoot,r=this.rootNode,n=this.childrenGetter,i=new Map,s=[];r.allLeafChildren=s,this.treeClear(t),this.treeSetRootNode(r);const o=(e,t)=>{let r=i.get(t);if(void 0!==r)return void tt(2,{nodeId:r.id});r=this.createRowNode(t,s.length),i.set(t,r),s.push(r),e=e.upsertKey(r.id),this.treeSetRow(e,r,!0);const a=n?.(t);if(a)for(let n=0,i=a.length;n<i;++n)o(e,a[n])};for(let a=0,l=e.length;a<l;++a)o(t,e[a]);this.treeCommitPending=!0}setImmutableRowData(e,t){this.dispatchRowDataUpdateStartedEvent(t);const r=this.gos,n=this.treeRoot,i=this.rootNode,s=this.childrenGetter,o=Dt(r),a=!r.get("suppressMaintainUnsortedOrder"),l=new Map,c=new Fc(!1,i);e.changedPath=c;const u=e.changedRowNodes,d=i.allLeafChildren,h=[],p=[];let g=!1,f=!1;const m=a?(e,t,r)=>{const n=t?.length;let i=!0,s=-1;for(let o=0;o<n;++o){const n=v(e,t[o],r);n>=0&&(n<s&&(i=!1),s=n)}i||(g=!0,e.childrenChanged||(e.childrenChanged=!0,e.invalidate()))}:(e,t,r)=>{for(let n=0,i=t.length;n<i;++n)v(e,t[n],r)},v=(e,t,r)=>{let n=l.get(t);if(void 0!==n)return et(2,{nodeId:n.id}),-1;const i=o({data:t,level:r});let c,d,g=!1;n=this.getRowNode(i),n?n.data!==t&&(u.update(n),n.updateData(t),!n.selectable&&n.isSelected()&&p.push(n)):(n=this.createRowNode(t,-1),u.add(n),g=!0),l.set(t,n),a?(d=e.appendKey(n.id),c=n.sourceRowIndex,n.sourceRowIndex=h.push(n)-1):(d=e.upsertKey(n.id),c=-1),this.treeSetRow(d,n,g)&&(f=!0);const v=s?.(t);return v&&m(d,v,r+1),c};if(m(n,t,0),d)for(let w=0,b=d.length;w<b;++w){const e=d[w],t=e.treeNode;if(t){const r=e.data;r&&!l.has(r)&&(u.remove(e),this.treeRemove(t,e))}}if(!a){const e=t=>{for(const r of t.enumChildren()){const t=r.row;t&&(t.sourceRowIndex=h.push(t)-1,e(r))}};e(n)}i.allLeafChildren=h,n.allLeafChildren=h,p.length&&this.deselectNodes(p),this.treeCommitPending=!0;const C=i.sibling;C&&(C.allLeafChildren=h),(f||g)&&(e.rowDataUpdated=!0,e.rowNodesOrderChanged||(e.rowNodesOrderChanged=g))}refreshModel(e,t){const r=this.rootNode;if(r&&e.changedProps?.has("treeData")&&!e.newData){this.treeSetRootNode(r);const e=this.treeRoot,t=r.allLeafChildren;if(t)for(let r=0,n=t.length;r<n;++r){const e=t[r];e.groupData=null,e.treeNode?.invalidate()}e.childrenChanged=!0,this.treeCommitPending=!0}super.refreshModel(e,t)}}],dynamicBeans:{treeParentIdStrategy:class extends rr{constructor(){super(...arguments),this.parentIdGetter=null,this.oldGroupDisplayColIds=null}destroy(){super.destroy(),this.parentIdGetter=null,this.oldGroupDisplayColIds=null}execute(e){const t=e.rowNode;let r=!e.changedRowNodes,n=t.childrenAfterGroup;n&&n!==t.allLeafChildren||(r=!0,t.childrenAfterGroup=n=[]);let i=!1;(e.afterColumnsChanged||null===this.oldGroupDisplayColIds)&&(i=this.updateGroupDisplayColsIds());let s=this.parentIdGetter;const o=this.gos.get("treeDataParentIdField");s&&s.path===o||(s=rg(o));const a=!this.gos.get("getRowId");a||hg(this.beans.rowModel,e,s,r),n.length=t.treeNodeFlags&og,t.treeNodeFlags=0;const l=this.gos.get("groupDefaultExpanded"),c=this.gos.getCallback("isGroupOpenByDefault"),u=e.changedPath?.active?e.changedPath:void 0;let d=0;const h=(e,t)=>{++d;let n=e.treeNodeFlags;const s=e.childrenAfterGroup??(e.childrenAfterGroup=wr),o=n&og;let a=0!==(n&ig);s.length!==o&&(s.length=o,a=!0);let p=a||0!==(n&ng),g=a;e.treeNodeFlags=n&sg,e.level=t++;let f=0;for(let r=0;r<o;++r){const e=s[r];h(e,t)&&(g=!0),f+=(e.allLeafChildren?.length??0)+1}let m=e.allLeafChildren;m!==s&&void 0!==m||(m=e.allLeafChildren=null),(g||(m?.length??0)!==f)&&(g=ug(e,m,f));const v=e.id;e.key===v&&e.groupData&&!i||(p=!0,e.key=v,this.setGroupData(e,v));const C=o>0;return e.group!==C?(p=!0,zh(e,this.beans,C),C||e.expanded||(n=e.treeNodeFlags&=-536870913)):e.hasChildren()!==C&&(p=!0,e.updateHasChildren()),C&&0===(n&sg)&&(e.treeNodeFlags|=sg,e.expanded=dg(c,l,e)),(a||g||r)&&cg(e,s),p&&u?.addParentNode(e),g};for(let p=0,g=n.length;p<g;++p)h(n[p],0);r&&lg(t,n),d===t.allLeafChildren.length||a||ag(t,h)}updateGroupDisplayColsIds(){const e=this.beans.showRowGroupCols?.getShowRowGroupCols()?.map((e=>e.getId())).join("-")??"";return this.oldGroupDisplayColIds!==e&&(this.oldGroupDisplayColIds=e,!0)}setGroupData(e,t){const r={};e.groupData=r;const n=this.beans.showRowGroupCols?.getShowRowGroupCols();if(n)for(const i of n)r[i.getColId()]=t}}},rowModels:["clientSide"],dependsOn:[pg,pp,Fp]};Symbol("WrappedFunctionMarker");var fg={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",stackedLine:"line",normalizedLine:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall",funnel:"funnel",coneFunnel:"cone-funnel",pyramid:"pyramid"},mg=new Set(["columnLineCombo","areaColumnCombo","customCombo"]);function vg(e){return mg.has(e)}function Cg(e){return"doughnut"===e?"donut":e}function wg(e){return fg[e]}var bg=["number","category","grouped-category","log","time"];bg.reduce(((e,t)=>({...e,[t]:{title:{_enabledFromTheme:!0}}})),{});var yg=e=>t=>void 0==t||e(t),Sg=["doughnut"];yg((e=>{if(wg(t=e)||vg(t))return!0;var t;if(function(e){return Sg.includes(e)}(e)){const t=Cg(e);return Le(`The chart type '${e}' has been deprecated. Please use '${t}' instead.`),t}return!1})),yg((e=>"object"===typeof e)),yg((e=>"object"===typeof e)),yg((e=>"string"===typeof e||"function"===typeof e));function Eg(e){return e.map(((e,t,r)=>e.map(((e,n)=>r.slice(0,t+1).reduce(((e,t)=>e+t[n]),0)))))}function Rg(e){const t=e.map(((t,r)=>e.reduce(((e,t)=>Math.max(e,t[r])),0)));return e.map((e=>e.map(((e,r)=>e/t[r]*19))))}var Tg=[[1,3,5],[2,6,4],[5,3,1]],xg=Eg(Tg),kg=(Rg(xg),Tg),Pg=Eg(kg);Rg(Pg);var Ag=["number","category","time","grouped-category"];let Fg=function(e){return e.RENT="\u05e9\u05db\u05e8 \u05d3\u05d9\u05e8\u05d4",e.BUILDING_MAINTENANCE="\u05d5\u05e2\u05d3 \u05d1\u05d9\u05ea",e.BILLS="\u05d7\u05e9\u05d1\u05d5\u05e0\u05d5\u05ea",e.INVESTMENT="\u05d4\u05e9\u05e7\u05e2\u05d5\u05ea",e.MORTGAGE="\u05de\u05e9\u05db\u05e0\u05ea\u05d0",e.MORTGAGE_INSURANCE="\u05d1\u05d9\u05d8\u05d5\u05d7 \u05dc\u05de\u05e9\u05db\u05e0\u05ea\u05d0",e.DIGITAL_SERVICES="\u05e9\u05d9\u05e8\u05d5\u05ea\u05d9\u05dd \u05d3\u05d9\u05d2\u05d9\u05d8\u05dc\u05d9\u05d9\u05dd",e.HEALTH_INSURANCE="\u05e7\u05d5\u05e4\u05d5\u05ea \u05d7\u05d5\u05dc\u05d9\u05dd",e.KINDERGARTEN="\u05d2\u05e0\u05d9\u05dd",e.EXTRACURRICULARS="\u05d7\u05d5\u05d2\u05d9\u05dd",e.BUDDY="\u05d1\u05d0\u05d3\u05d9",e.CAR_INSURANCE="\u05d1\u05d9\u05d8\u05d5\u05d7\u05d9 \u05e8\u05db\u05d1",e.PRIVATE_INSURANCE="\u05d1\u05d9\u05d8\u05d5\u05d7 \u05e4\u05e8\u05d8\u05d9",e.FUEL="\u05d3\u05dc\u05e7",e.RESTAURANTS="\u05de\u05e1\u05e2\u05d3\u05d5\u05ea",e.GROCERIES="\u05e1\u05d5\u05e4\u05e8\u05de\u05e8\u05e7\u05d8",e.NESPRESSO="\u05e0\u05e1\u05e4\u05e8\u05e1\u05d5",e.TAMI_4="\u05ea\u05de\u05d9 4",e.SHOPPING="\u05e9\u05d5\u05e4\u05d9\u05e0\u05d2",e.ONLINE_SHOPPING="\u05e9\u05d5\u05e4\u05d9\u05e0\u05d2 \u05d1\u05d7\u05d5\u05f4\u05dc",e.TOLL_ROAD="\u05db\u05d1\u05d9\u05e9 6",e.PARKING="\u05d7\u05e0\u05d9\u05d4",e.CARD_FEE="\u05d3\u05de\u05d9 \u05db\u05e8\u05d8\u05d9\u05e1",e.ITURAN="\u05d0\u05d9\u05ea\u05d5\u05e8\u05d0\u05df",e.REFAUND="\u05d4\u05d7\u05d6\u05e8",e.TRANSFERS="\u05d4\u05e2\u05d1\u05e8\u05d5\u05ea",e.CAR_MAINTENANCE="\u05d8\u05d9\u05e4\u05d5\u05dc\u05d9 \u05e8\u05db\u05d1",e.ENTERTAINMENT="\u05d1\u05d9\u05dc\u05d5\u05d9\u05d9\u05dd",e.FEES="\u05e2\u05de\u05dc\u05d5\u05ea",e}({}),Dg=function(e){return e.CONSTANT="\u05e7\u05d1\u05d5\u05e2",e.CHANGING="\u05de\u05e9\u05ea\u05e0\u05d4",e}({});class Ig extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",r=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=r}}class Mg extends Ig{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Og extends Ig{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Lg extends Ig{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ng;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(Ng||(Ng={}));var _g=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class Gg{constructor(e){let{headers:t={},customFetch:n,region:i=Ng.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=i,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return _g(this,void 0,void 0,(function*(){try{const{headers:n,method:i,body:s}=t;let o,a={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(a["x-region"]=l),s&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!==typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",o=s):"string"===typeof s?(a["Content-Type"]="text/plain",o=s):"undefined"!==typeof FormData&&s instanceof FormData?o=s:(a["Content-Type"]="application/json",o=JSON.stringify(s)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:o}).catch((e=>{throw new Mg(e)})),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new Og(c);if(!c.ok)throw new Lg(c);let d,h=(null!==(r=c.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return d="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:d,error:null}}catch(n){return{data:null,error:n}}}))}}var Bg=r(980);const{PostgrestClient:Hg,PostgrestQueryBuilder:zg,PostgrestFilterBuilder:Vg,PostgrestTransformBuilder:Wg,PostgrestBuilder:Ug,PostgrestError:jg}=Bg,$g={"X-Client-Info":"realtime-js/2.11.2"};var Kg,Yg,qg,Xg,Jg,Qg;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(Kg||(Kg={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(Yg||(Yg={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(qg||(qg={})),function(e){e.websocket="websocket"}(Xg||(Xg={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Jg||(Jg={}));class Zg{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let s=this.HEADER_LENGTH+2;const o=r.decode(e.slice(s,s+n));s+=n;const a=r.decode(e.slice(s,s+i));s+=i;return{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class ef{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Qg||(Qg={}));const tf=function(e,t){var r;const n=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((r,i)=>(r[i]=rf(i,e,t,n),r)),{})},rf=(e,t,r,n)=>{const i=t.find((t=>t.name===e)),s=null===i||void 0===i?void 0:i.type,o=r[e];return s&&!n.includes(s)?nf(s,o):sf(o)},nf=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return cf(t,r)}switch(e){case Qg.bool:return of(t);case Qg.float4:case Qg.float8:case Qg.int2:case Qg.int4:case Qg.int8:case Qg.numeric:case Qg.oid:return af(t);case Qg.json:case Qg.jsonb:return lf(t);case Qg.timestamp:return uf(t);case Qg.abstime:case Qg.date:case Qg.daterange:case Qg.int4range:case Qg.int8range:case Qg.money:case Qg.reltime:case Qg.text:case Qg.time:case Qg.timestamptz:case Qg.timetz:case Qg.tsrange:case Qg.tstzrange:default:return sf(t)}},sf=e=>e,of=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},af=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},lf=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},cf=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const s=e.slice(1,r);try{n=JSON.parse("["+s+"]")}catch(i){n=s?s.split(","):[]}return n.map((e=>nf(t,e)))}return e},uf=e=>"string"===typeof e?e.replace(" ","T"):e,df=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class hf{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(r)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var pf,gf,ff,mf;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(pf||(pf={}));class vf{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vf.syncState(this.state,e,t,r),this.pendingDiffs.forEach((e=>{this.state=vf.syncDiff(this.state,e,t,r)})),this.pendingDiffs=[],n()})),this.channel._on(r.diff,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=vf.syncDiff(this.state,e,t,r),n())})),this.onJoin(((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})})),this.onLeave(((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,r,n){const i=this.cloneDeep(e),s=this.transformState(t),o={},a={};return this.map(i,((e,t)=>{s[e]||(a[e]=t)})),this.map(s,((e,t)=>{const r=i[e];if(r){const n=t.map((e=>e.presence_ref)),i=r.map((e=>e.presence_ref)),s=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=r.filter((e=>n.indexOf(e.presence_ref)<0));s.length>0&&(o[e]=s),l.length>0&&(a[e]=l)}else o[e]=t})),this.syncDiff(i,{joins:o,leaves:a},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,((t,n)=>{var i;const s=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),s.length>0){const r=e[t].map((e=>e.presence_ref)),n=s.filter((e=>r.indexOf(e.presence_ref)<0));e[t].unshift(...n)}r(t,s,n)})),this.map(s,((t,r)=>{let i=e[t];if(!i)return;const s=r.map((e=>e.presence_ref));i=i.filter((e=>s.indexOf(e.presence_ref)<0)),e[t]=i,n(t,i,r),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((r=>t(r,e[r])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):n,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(gf||(gf={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(ff||(ff={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(mf||(mf={}));class Cf{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Yg.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new hf(this,qg.join,this.params,this.timeout),this.rejoinTimer=new ef((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=Yg.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yg.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Yg.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yg.errored,this.rejoinTimer.scheduleTimeout())})),this._on(qg.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new vf(this),this.broadcastEndpointURL=df(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(mf.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(mf.CLOSED)));const a={},l={broadcast:i,presence:s,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map((e=>e.filter)))&&void 0!==n?n:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:r}=t;var n;if(this.socket.setAuth(),void 0!==r){const t=this.bindings.postgres_changes,i=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,s=[];for(let n=0;n<i;n++){const i=t[n],{filter:{event:o,schema:a,table:l,filter:c}}=i,u=r&&r[n];if(!u||u.event!==o||u.schema!==a||u.table!==l||u.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(mf.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},i),{id:u.id}))}return this.bindings.postgres_changes=s,void(e&&e(mf.SUBSCRIBED))}null===e||void 0===e||e(mf.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(mf.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(mf.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise((r=>{var n,i,s;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===s?void 0:s.ack)||r("ok"),o.receive("ok",(()=>r("ok"))),o.receive("error",(()=>r("error"))),o.receive("timeout",(()=>r("timed out")))}));{const{event:s,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=Yg.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qg.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((r=>{const n=new hf(this,qg.leave,{},e);n.receive("ok",(()=>{t(),r("ok")})).receive("timeout",(()=>{t(),r("timed out")})).receive("error",(()=>{r("error")})),n.send(),this._canPush()||n.trigger("ok",{})}))}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout((()=>n.abort()),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),s}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new hf(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const s=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=qg;if(r&&[o,a,l,c].indexOf(s)>=0&&r!==this._joinRef())return;let u=this._onMessage(s,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===s})).map((e=>e.callback(u,r))):null===(i=this.bindings[s])||void 0===i||i.filter((e=>{var r,n,i,o,a,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(n=t.ids)||void 0===n?void 0:n.includes(s))&&("*"===o||(null===o||void 0===o?void 0:o.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null===e||void 0===e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s})).map((e=>{if("object"===typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:s}=e,o={schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:s};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)}))}_isClosed(){return this.state===Yg.closed}_isJoined(){return this.state===Yg.joined}_isJoining(){return this.state===Yg.joining}_isLeaving(){return this.state===Yg.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter((e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&Cf.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(qg.close,{},e)}_onError(e){this._on(qg.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yg.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=tf(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=tf(e.columns,e.old_record)),t}}const wf=()=>{},bf="undefined"!==typeof WebSocket;class yf{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=$g,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=wf,this.conn=null,this.sendBuffer=[],this.serializer=new Zg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${Xg.websocket}`,this.httpEndpoint=df(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ef((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(bf)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Sf(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),r.e(952).then(r.t.bind(r,952,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Kg.connecting:return Jg.Connecting;case Kg.open:return Jg.Open;case Kg.closing:return Jg.Closing;default:return Jg.Closed}}isConnected(){return this.connectionState()===Jg.Open}channel(e){const t=new Cf(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:r,payload:n,ref:i}=e,s=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let t=null;try{t=JSON.parse(atob(e.split(".")[1]))}catch(tt){}if(t&&t.exp){if(!(Math.floor(Date.now()/1e3)-t.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(qg.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:r,payload:n,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(r,n,i))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(qg.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Sf{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Kg.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class Ef extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Rf(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class Tf extends Ef{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class xf extends Ef{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var kf=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const Pf=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}},Af=e=>{if(Array.isArray(e))return e.map((e=>Af(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[r,n]=e;const i=r.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[i]=Af(n)})),t};var Ff=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const Df=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),If=(e,t,n)=>Ff(void 0,void 0,void 0,(function*(){const i=yield kf(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(r.bind(r,630))).Response:Response}));e instanceof i&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then((r=>{t(new Tf(Df(r),e.status||500))})).catch((e=>{t(new xf(Df(e),e))})):t(new xf(Df(e),e))}));function Mf(e,t,r,n,i,s){return Ff(this,void 0,void 0,(function*(){return new Promise(((o,a)=>{e(r,((e,t,r,n)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))})(t,n,i,s)).then((e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()})).then((e=>o(e))).catch((e=>If(e,a,n)))}))}))}function Of(e,t,r,n){return Ff(this,void 0,void 0,(function*(){return Mf(e,"GET",t,r,n)}))}function Lf(e,t,r,n,i){return Ff(this,void 0,void 0,(function*(){return Mf(e,"POST",t,n,i,r)}))}function Nf(e,t,r,n,i){return Ff(this,void 0,void 0,(function*(){return Mf(e,"DELETE",t,n,i,r)}))}var _f=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const Gf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Hf{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=r,this.fetch=Pf(n)}uploadOrUpdate(e,t,r,n){return _f(this,void 0,void 0,(function*(){try{let i;const s=Object.assign(Object.assign({},Bf),n);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const a=s.metadata;"undefined"!==typeof Blob&&r instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(i=r,i.append("cacheControl",s.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null===n||void 0===n?void 0:n.headers)&&(o=Object.assign(Object.assign({},o),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{})),d=yield u.json();if(u.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(i){if(Rf(i))return{data:null,error:i};throw i}}))}upload(e,t,r){return _f(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,r)}))}uploadToSignedUrl(e,t,r,n){return _f(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(e),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Bf.upsert},n),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);const a=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:s}),l=yield a.json();if(a.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(a){if(Rf(a))return{data:null,error:a};throw a}}))}createSignedUploadUrl(e,t){return _f(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(n["x-upsert"]="true");const i=yield Lf(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new Ef("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(r){if(Rf(r))return{data:null,error:r};throw r}}))}update(e,t,r){return _f(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,r)}))}move(e,t,r){return _f(this,void 0,void 0,(function*(){try{return{data:yield Lf(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Rf(n))return{data:null,error:n};throw n}}))}copy(e,t,r){return _f(this,void 0,void 0,(function*(){try{return{data:{path:(yield Lf(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Rf(n))return{data:null,error:n};throw n}}))}createSignedUrl(e,t,r){return _f(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e),i=yield Lf(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null===r||void 0===r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const s=(null===r||void 0===r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(n){if(Rf(n))return{data:null,error:n};throw n}}))}createSignedUrls(e,t,r){return _f(this,void 0,void 0,(function*(){try{const n=yield Lf(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null===r||void 0===r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(n){if(Rf(n))return{data:null,error:n};throw n}}))}download(e,t){return _f(this,void 0,void 0,(function*(){const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield Of(this.fetch,`${this.url}/${r}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(s){if(Rf(s))return{data:null,error:s};throw s}}))}info(e){return _f(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield Of(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Af(e),error:null}}catch(r){if(Rf(r))return{data:null,error:r};throw r}}))}exists(e){return _f(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,n){return Ff(this,void 0,void 0,(function*(){return Mf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Rf(r)&&r instanceof xf){const e=r.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:r}}throw r}}))}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==o&&n.push(o);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${a}`)}}}remove(e){return _f(this,void 0,void 0,(function*(){try{return{data:yield Nf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Rf(t))return{data:null,error:t};throw t}}))}list(e,t,r){return _f(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},Gf),t),{prefix:e||""});return{data:yield Lf(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Rf(n))return{data:null,error:n};throw n}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const zf={"X-Client-Info":"storage-js/2.7.1"};var Vf=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class Wf{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},zf),t),this.fetch=Pf(r)}listBuckets(){return Vf(this,void 0,void 0,(function*(){try{return{data:yield Of(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Rf(e))return{data:null,error:e};throw e}}))}getBucket(e){return Vf(this,void 0,void 0,(function*(){try{return{data:yield Of(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Rf(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return Vf(this,void 0,void 0,(function*(){try{return{data:yield Lf(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Rf(r))return{data:null,error:r};throw r}}))}updateBucket(e,t){return Vf(this,void 0,void 0,(function*(){try{const r=yield function(e,t,r,n,i){return Ff(this,void 0,void 0,(function*(){return Mf(e,"PUT",t,n,i,r)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:r,error:null}}catch(r){if(Rf(r))return{data:null,error:r};throw r}}))}emptyBucket(e){return Vf(this,void 0,void 0,(function*(){try{return{data:yield Lf(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Rf(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return Vf(this,void 0,void 0,(function*(){try{return{data:yield Nf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Rf(t))return{data:null,error:t};throw t}}))}}class Uf extends Wf{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new Hf(this.url,this.headers,e,this.fetch)}}let jf="";jf="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const $f={headers:{"X-Client-Info":`supabase-js-${jf}/2.49.4`}},Kf={schema:"public"},Yf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qf={};var Xf=r(630),Jf=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const Qf=e=>{let t;return t=e||("undefined"===typeof fetch?Xf.default:fetch),function(){return t(...arguments)}},Zf=(e,t,r)=>{const n=Qf(r),i="undefined"===typeof Headers?Xf.Headers:Headers;return(r,s)=>Jf(void 0,void 0,void 0,(function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new i(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),n(r,Object.assign(Object.assign({},s),{headers:l}))}))};var em=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};const tm="2.69.1",rm=3e4,nm=9e4,im={"X-Client-Info":`gotrue-js/${tm}`},sm="X-Supabase-Api-Version",om={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},am=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class lm extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function cm(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class um extends lm{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class dm extends lm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class hm extends lm{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class pm extends hm{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class gm extends hm{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fm extends hm{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class mm extends hm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vm extends hm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Cm extends hm{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function wm(e){return cm(e)&&"AuthRetryableFetchError"===e.name}class bm extends hm{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ym extends hm{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Em=" \t\n\r=".split(""),Rm=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Em.length;t+=1)e[Em[t].charCodeAt(0)]=-2;for(let t=0;t<Sm.length;t+=1)e[Sm[t].charCodeAt(0)]=t;return e})();function Tm(e,t,r){const n=Rm[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function xm(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(0===(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let o=0;o<e.length;o+=1)Tm(e.charCodeAt(o),i,s);return t.join("")}function km(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Pm(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}km(n,t)}}function Am(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let i=0;i<e.length;i+=1)Tm(e.charCodeAt(i),r,n);return new Uint8Array(t)}const Fm=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Dm={tested:!1,writable:!1},Im=()=>{if(!Fm())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Dm.tested)return Dm.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Dm.tested=!0,Dm.writable=!0}catch(t){Dm.tested=!0,Dm.writable=!1}return Dm.writable};const Mm=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.bind(r,630)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}},Om=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Lm=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}},Nm=async(e,t)=>{await e.removeItem(t)};class _m{constructor(){this.promise=new _m.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Gm(e){const t=e.split(".");if(3!==t.length)throw new ym("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!am.test(t[r]))throw new ym("JWT not in base64url format");return{header:JSON.parse(xm(t[0])),payload:JSON.parse(xm(t[1])),signature:Am(t[2]),raw:{header:t[0],payload:t[1]}}}function Bm(e){return("0"+e.toString(16)).substr(-2)}async function Hm(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zm(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Bm).join("")}();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Om(e,`${t}-code-verifier`,i);const s=await Hm(n);return[s,n===s?"plain":"s256"]}_m.promiseConstructor=Promise;const Vm=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var Wm=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const Um=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),jm=[502,503,504];async function $m(e){var t,r;if(!("object"===typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"===typeof r.json))throw new Cm(Um(e),0);if(jm.includes(e.status))throw new Cm(Um(e),e.status);let n,i;try{n=await e.json()}catch(o){throw new dm(Um(o),o)}const s=function(e){const t=e.headers.get(sm);if(!t)return null;if(!t.match(Vm))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(o){return null}}(e);if(s&&s.getTime()>=om.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?i=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(i=n.error_code),i){if("weak_password"===i)throw new bm(Um(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new pm}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new bm(Um(n),e.status,n.weak_password.reasons);throw new um(Um(n),e.status||500,i)}async function Km(e,t,r,n){var i;const s=Object.assign({},null===n||void 0===n?void 0:n.headers);s[sm]||(s[sm]=om.name),(null===n||void 0===n?void 0:n.jwt)&&(s.Authorization=`Bearer ${n.jwt}`);const o=null!==(i=null===n||void 0===n?void 0:n.query)&&void 0!==i?i:{};(null===n||void 0===n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,r,n,i,s){const o=((e,t,r,n)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))})(t,n,i,s);let a;try{a=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new Cm(Um(l),0)}a.ok||await $m(a);if(null===n||void 0===n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(l){await $m(l)}}(e,t,r+a,{headers:s,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function Ym(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function qm(e){const t=Ym(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function Xm(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Jm(e){return{data:e,error:null}}function Qm(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,o=Wm(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},user:Object.assign({},o)},error:null}}function Zm(e){return e}var ev=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};class tv{constructor(e){let{url:t="",headers:r={},fetch:n}=e;this.url=t,this.headers=r,this.fetch=Mm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await Km(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(cm(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await Km(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Xm})}catch(r){if(cm(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=ev(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null===r||void 0===r?void 0:r.newEmail,delete n.newEmail),await Km(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Qm,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(cm(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Km(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xm})}catch(t){if(cm(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,i,s,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await Km(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:Zm});if(c.error)throw c.error;const u=await c.json(),d=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t})),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(cm(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await Km(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xm})}catch(t){if(cm(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Km(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Xm})}catch(r){if(cm(r))return{data:{user:null},error:r};throw r}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await Km(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Xm})}catch(r){if(cm(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await Km(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(cm(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Km(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(cm(t))return{data:null,error:t};throw t}}}const rv={getItem:e=>Im()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Im()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Im()&&globalThis.localStorage.removeItem(e)}};function nv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const iv=!!(globalThis&&Im()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class sv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ov extends sv{}async function av(e,t,r){iv&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout((()=>{n.abort(),iv&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},(async n=>{if(!n){if(0===t)throw iv&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ov(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(iv)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}iv&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{iv&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const lv={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:im,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cv(e,t,r){return await r()}class uv{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=uv.nextInstanceID,uv.nextInstanceID+=1,this.instanceID>0&&Fm()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},lv),e);if(this.logDebugMessages=!!n.debug,"function"===typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new tv({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Mm(n.fetch),this.lock=n.lock||cv,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Fm()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=av:this.lock=cv,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Im()?this.storage=rv:(this.memoryStorage={},this.storage=nv(this.memoryStorage)):(this.memoryStorage={},this.storage=nv(this.memoryStorage)),Fm()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger(`GoTrueClient@${this.instanceID} (${tm}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach(((e,r)=>{t[r]=e}))}catch(n){}return r.searchParams.forEach(((e,r)=>{t[r]=e})),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Fm()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return cm(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout((async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return cm(t)?{error:t}:{error:new dm("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await Km(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:Ym}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const a=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(i){if(cm(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:r,password:n,options:s}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await zm(this.storage,this.storageKey)),i=await Km(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:a},xform:Ym})}else{if(!("phone"in e))throw new fm("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:o}=e;i=await Km(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null===o||void 0===o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(n=null===o||void 0===o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:Ym})}}const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const a=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(i){if(cm(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:i}=e;t=await Km(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:qm})}else{if(!("phone"in e))throw new fm("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:i}=e;t=await Km(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:qm})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}):{data:{user:null,session:null},error:new gm}}catch(t){if(cm(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Lm(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:i}=await Km(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ym});if(await Nm(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new gm}}catch(i){if(cm(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:s}=e,o=await Km(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:Ym}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new gm}}catch(t){if(cm(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,i,s;try{if("email"in e){const{email:n,options:i}=e;let s=null,o=null;"pkce"===this.flowType&&([s,o]=await zm(this.storage,this.storageKey));const{error:a}=await Km(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null===i||void 0===i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:o},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=await Km(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null===r||void 0===r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(i=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},channel:null!==(s=null===r||void 0===r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===o||void 0===o?void 0:o.message_id},error:a}}throw new fm("You must provide either an email or phone number.")}catch(o){if(cm(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:s,error:o}=await Km(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Ym});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const a=s.session,l=s.user;return(null===a||void 0===a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(cm(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let i=null,s=null;return"pkce"===this.flowType&&([i,s]=await zm(this.storage,this.storageKey)),await Km(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:Jm})}catch(i){if(cm(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new pm;const{error:n}=await Km(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(cm(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:s}=await Km(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:r,type:n,options:i}=e,{data:s,error:o}=await Km(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:o}}throw new fm("You must provide either an email or phone number and a type")}catch(t){if(cm(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Lm(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<nm;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await Km(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xm}):await this._useSession((async e=>{var t,r,n;const{data:i,error:s}=e;if(s)throw s;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Km(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:Xm}):{data:{user:null},error:new pm}}))}catch(t){if(cm(t))return function(e){return cm(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Nm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new pm;const s=n.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await zm(this.storage,this.storageKey));const{data:l,error:c}=await Km(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:s.access_token,xform:Xm});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}}))}catch(r){if(cm(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pm;const t=Date.now()/1e3;let r=t,n=!0,i=null;const{payload:s}=Gm(e.access_token);if(s.exp&&(r=s.exp,n=r<=t),n){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:n,error:s}=await this._getUser(e.access_token);if(s)throw s;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(cm(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var r;if(!e){const{data:n,error:i}=t;if(i)throw i;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new pm;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(cm(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Fm())throw new mm("No browser detected.");if(e.error||e.error_description||e.error_code)throw new mm(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new vm("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new mm("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vm("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:s,expires_in:o,expires_at:a,token_type:l}=e;if(!i||!o||!s||!l)throw new mm("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(o);let d=c+u;a&&(d=parseInt(a));const h=d-c;1e3*h<=rm&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);const p=d-u;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,c);const{data:g,error:f}=await this._getUser(i);if(f)throw f;const m={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:d,refresh_token:s,token_type:l,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(r){if(cm(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Lm(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const s=null===(r=n.session)||void 0===r?void 0:r.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return cm(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Nm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession((async t=>{var r,n;try{const{data:{session:n},error:i}=t;if(i)throw i;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(i){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,n=null;"pkce"===this.flowType&&([r,n]=await zm(this.storage,this.storageKey,!0));try{return await Km(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(cm(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(cm(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession((async t=>{var r,n,i,s,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await Km(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==o?o:void 0})}));if(n)throw n;return Fm()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===r||void 0===r?void 0:r.url),{data:{provider:e.provider,url:null===r||void 0===r?void 0:r.url},error:null}}catch(r){if(cm(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var r,n;const{data:i,error:s}=t;if(s)throw s;return await Km(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})}))}catch(t){if(cm(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Km(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ym})),n=(e,t)=>{const r=200*Math.pow(2,e);return t&&wm(t)&&Date.now()+r-i<rm},new Promise(((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await r(s);if(!n(s,null,t))return void e(t)}catch(i){if(!n(s,i))return void t(i)}})()})))}catch(i){if(this._debug(t,"error",i),cm(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Fm()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Lm(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r))return this._debug(t,"session is not valid"),void(null!==r&&await this._removeSession());const n=1e3*(null!==(e=r.expires_at)&&void 0!==e?e:1/0)-Date.now()<nm;if(this._debug(t,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),wm(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(t,"error",r),void console.error(r)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new pm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new _m;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new pm;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(i){if(this._debug(n,"error",i),cm(i)){const e={session:null,error:i};return wm(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],i=Array.from(this.stateChangeEmitters.values()).map((async r=>{try{await r.callback(e,t)}catch(i){n.push(i)}}));if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Om(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Nm(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Fm()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),rm);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-t)/rm);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof sv))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fm()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if((null===r||void 0===r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null===r||void 0===r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await zm(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null===r||void 0===r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null===r||void 0===r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await Km(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(cm(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var r,n;const{data:i,error:s}=t;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=await Km(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(r=null===i||void 0===i?void 0:i.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null===a||void 0===a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(t){if(cm(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:s,error:o}=await Km(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})}))}catch(t){if(cm(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await Km(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(cm(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null===e||void 0===e?void 0:e.factors)||[],n=r.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=r.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Gm(n.access_token);let o=null;s.aal&&(o=s.aal);let a=o;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==r?r:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:s.amr||[]},error:null}}))))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find((t=>t.kid===e));if(t)return t;if(t=this.jwks.keys.find((t=>t.kid===e)),t&&this.jwks_cached_at+6e5>Date.now())return t;const{data:r,error:n}=await Km(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;if(!r.keys||0===r.keys.length)throw new ym("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),t=r.keys.find((t=>t.kid===e)),!t)throw new ym("No matching signing key found in JWKS");return t}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]};try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:n,payload:i,signature:s,raw:{header:o,payload:a}}=Gm(r);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp),!n.kid||"HS256"===n.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:i,header:n,signature:s},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),c=await this.fetchJwk(n.kid,t),u=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,u,s,function(e){const t=[];return Pm(e,(e=>t.push(e))),new Uint8Array(t)}(`${o}.${a}`)))throw new ym("Invalid JWT signature");return{data:{claims:i,header:n,signature:s},error:null}}catch(r){if(cm(r))return{data:null,error:r};throw r}}}uv.nextInstanceID=0;const dv=uv;class hv extends dv{constructor(e){super(e)}}var pv=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class gv{constructor(e,t,r){var n,i,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=e.replace(/\/$/,"");this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:r,auth:n,realtime:i,global:s}=e,{db:o,auth:a,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),s),accessToken:()=>em(this,void 0,void 0,(function*(){return""}))};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!==r&&void 0!==r?r:{},{db:Kf,realtime:qf,auth:Object.assign(Object.assign({},Yf),{storageKey:a}),global:$f});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=l.auth)&&void 0!==s?s:{},this.headers,l.global.fetch),this.fetch=Zf(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new Hg(`${o}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new Gg(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Uf(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return pv(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:n,persistSession:i,detectSessionInUrl:s,storage:o,storageKey:a,flowType:l,lock:c,debug:u}=e;const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hv({url:this.authUrl,headers:Object.assign(Object.assign({},d),t),storageKey:a,autoRefreshToken:n,persistSession:i,detectSessionInUrl:s,storage:o,flowType:l,lock:c,debug:u,fetch:r,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new yf(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}const fv=((e,t,r)=>new gv(e,t,r))("https://viutydvbuzsavjcniayx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZpdXR5ZHZidXpzYXZqY25pYXl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcxMjU2ODUsImV4cCI6MjA2MjcwMTY4NX0.48hy1FdOs5O2jx6LhLsdui1r4CFjk22Mvpb2Lp480Ns");let mv=!1,vv=null,Cv={};async function wv(){if(!mv)return vv||(vv=(async()=>{const{data:e,error:t}=await fv.from("vendor_category_map").select("vendor, category");if(t)return console.error("Failed to load vendor-category map:",t),void(vv=null);Cv=e.reduce(((e,t)=>(t.vendor&&Object.values(Fg).includes(t.category)&&(e[t.vendor]=t.category),e)),{}),mv=!0,vv=null})(),vv)}async function bv(e){return await wv(),Cv[e]}let yv=!1,Sv=null,Ev={};async function Rv(){if(!yv)return Sv||(Sv=(async()=>{const{data:e,error:t}=await fv.from("transaction_category_overrides").select("transaction_id, category");if(t)return console.error("Failed to load transaction_category_overrides:",t),void(Sv=null);Ev=e.reduce(((e,t)=>(t.transaction_id&&Object.values(Fg).includes(t.category)&&(e[t.transaction_id]=t.category),e)),{}),yv=!0,Sv=null})(),Sv)}async function Tv(e,t,r){return await Rv(),Ev[`${e}-${t}-${r}`]}const xv={sortable:!0,filter:!0,cellStyle:{whiteSpace:"pre-wrap"},autoHeight:!0,enableRowGroup:!0},kv=e=>{const t=new Set(e.values.filter(Boolean));return Array.from(t).join(", ")},Pv=[{field:"date",headerName:"Date"},{field:"transactionType",headerName:"Constant / Changing",aggFunc:kv},{field:"category",headerName:"Category",editable:!0,cellEditor:"agSelectCellEditor",cellEditorParams:{values:Object.values(Fg).sort(((e,t)=>e.localeCompare(t,"he")))},aggFunc:kv},{field:"vendor",headerName:"Vendor"},{field:"billedAmount",headerName:"Billed Amount",valueFormatter:e=>{let{value:t}=e;return"number"===typeof t?t.toLocaleString("en-US"):t},aggFunc:"sum"},{field:"details",headerName:"Details",editable:!0,aggFunc:kv},{field:"source",headerName:"Credit Card",aggFunc:kv},{field:"amount",headerName:"Amount",valueFormatter:e=>{let{value:t}=e;return"number"===typeof t?t.toLocaleString("en-US"):t},aggFunc:"sum"},{field:"type",headerName:"Type"}];let Av=!1,Fv=null,Dv={};async function Iv(){if(!Av)return Fv||(Fv=(async()=>{const{data:e,error:t}=await fv.from("transaction_details").select("transaction_id, details");if(t)return console.error("Failed to load transaction_details:",t),void(Fv=null);Dv=e.reduce(((e,t)=>(t.transaction_id&&t.details&&(e[t.transaction_id]=t.details),e)),{}),Av=!0,Fv=null})(),Fv)}async function Mv(e,t,r){return await Iv(),Dv[`${e}-${t}-${r}`]}var Ov=r(579);(class{static register(e){Wn(e,void 0)}static registerModules(e){e.forEach((e=>Wn(e,void 0)))}}).registerModules([hd,Cd,Sd,vd,Xu,ld,qu,cd,vu,yd,bd,_p,Up,gg,Gp]);const Lv=e=>{let{transactions:t,filteredCategory:r}=e;const[n,i]=(0,u.useState)();return(0,u.useEffect)((()=>{var e;n&&(null===(e=n.getColumnFilterInstance("category"))||void 0===e||e.then((e=>{e&&(r?"\u05dc\u05dc\u05d0 \u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"===r?e.setModel({type:"blank"}):e.setModel({type:"equals",filter:r}):e.setModel(null),n.onFilterChanged())})))}),[r,n]),(0,Ov.jsx)("div",{className:"ag-theme-quartz",children:(0,Ov.jsx)(Fh,{rowData:t,columnDefs:Pv,getRowStyle:e=>{const t=e.data;if(t)return t.transactionType===Dg.CONSTANT?{backgroundColor:"#e0ffe0"}:t.transactionType===Dg.CHANGING?{backgroundColor:"#ffe0e0"}:void 0},animateRows:!0,pagination:!0,rowModelType:"clientSide",onCellValueChanged:async e=>{if("category"===e.colDef.field){const t=e.data,{vendor:r}=e.data,n=e.newValue;Object.values(Fg).includes(n)&&(n===Fg.REFAUND?await async function(e,t,r,n){const i=`${e}-${t}-${r}`,{error:s}=await fv.from("transaction_category_overrides").upsert([{transaction_id:i,category:n}]);if(s)throw console.error("Failed to save vendor-category mapping:",s),s;Ev[i]=n}(t.date,t.vendor,t.amount,Fg.REFAUND):await async function(e,t){const{error:r}=await fv.from("vendor_category_map").upsert([{vendor:e,category:t}]);if(r)throw console.error("Failed to save vendor-category mapping:",r),r;Cv[e]=t}(r,n))}else if("details"===e.colDef.field){const t=e.data;await async function(e,t,r,n){const i=`${e}-${t}-${r}`,{error:s}=await fv.from("transaction_details").upsert([{transaction_id:i,details:n}]);if(s)throw console.error("Failed to save vendor-category mapping:",s),s;Dv[i]=n}(t.date,t.vendor,t.amount,e.newValue)}},onGridReady:e=>{i(e.api)},rowGroupPanelShow:"always",groupDisplayType:"singleColumn",groupDefaultExpanded:0,domLayout:"autoHeight",suppressHorizontalScroll:!1,defaultColDef:xv})})};class Nv{static getTransactions(){const e=[],t={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"1",vendor:"\u05d9\u05d0\u05d9\u05e8 \u05db\u05d4\u05df",amount:9450,billedAmount:9450};e.push(t);const r={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"1",vendor:"\u05d5\u05e2\u05d3 \u05d1\u05d9\u05ea \u05d7\u05d9\u05d9\u05e7\u05d4",amount:440,billedAmount:440};e.push(r);const n={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"1",vendor:"\u05dc\u05d0\u05d5\u05de\u05d9 \u05dc\u05de\u05e9\u05db\u05e0\u05ea-\u05d9",amount:12600,billedAmount:12600};e.push(n);const i={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"1",vendor:"\u05d2\u05df \u05e8\u05d5\u05e0\u05d9\u05ea \u05d1\u05e2\u05f4\u05de",amount:4200,billedAmount:4200};e.push(i);const s={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"1",vendor:"\u05e9\u05d5\u05e9\u05e0\u05d4",amount:4200,billedAmount:4200};e.push(s);const o={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"10",vendor:"\u05e7\u05e8\u05e7\u05e2 \u05d1\u05e8\u05e2\u05e0\u05e0\u05d4",amount:6145,billedAmount:6145};e.push(o);const a={source:"Bank Leumi",transactionType:Dg.CONSTANT,date:"10",vendor:"\u05de\u05db\u05d1\u05d9-\u05d9",amount:121,billedAmount:121};return e.push(a),e}}let _v=function(e){return e.AMERICAN_EXPRESS="American Express",e.LEUMI="Leumi",e.ISRACARD="Isracard",e.MAX="Max",e.LIFE_STYLE="Life Style",e.ONE_ZERO="ONE ZERO",e}({});var Gv={version:"0.18.5"},Bv=1200,Hv=1252,zv=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Vv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Wv=function(e){-1!=zv.indexOf(e)&&(Hv=Vv[0]=e)};var Uv=function(e){Bv=e,Wv(e)};function jv(){Uv(1200),Wv(1252)}function $v(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Kv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Yv,qv=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?Kv(e.slice(2)):65279==t?e.slice(1):e},Xv=function(e){return String.fromCharCode(e)},Jv=function(e){return String.fromCharCode(e)};var Qv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zv(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,o=(3&r)<<4|(n=e.charCodeAt(c++))>>4,a=(15&n)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(n)?a=l=64:isNaN(i)&&(l=64),t+=Qv.charAt(s)+Qv.charAt(o)+Qv.charAt(a)+Qv.charAt(l);return t}function eC(e){var t="",r=0,n=0,i=0,s=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Qv.indexOf(e.charAt(l++))<<2|(s=Qv.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(o=Qv.indexOf(e.charAt(l++)))>>2,64!==o&&(t+=String.fromCharCode(n)),i=(3&o)<<6|(a=Qv.indexOf(e.charAt(l++))),64!==a&&(t+=String.fromCharCode(i));return t}var tC=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),rC=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function nC(e){return tC?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function iC(e){return tC?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var sC=function(e){return tC?rC(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function oC(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function aC(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return aC(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var lC=tC?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:rC(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var cC=/\u0000/g,uC=/[\u0001-\u0006]/g;function dC(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function hC(e,t){var r=""+e;return r.length>=t?r:yw("0",t-r.length)+r}function pC(e,t){var r=""+e;return r.length>=t?r:yw(" ",t-r.length)+r}function gC(e,t){var r=""+e;return r.length>=t?r:r+yw(" ",t-r.length)}var fC=Math.pow(2,32);function mC(e,t){return e>fC||e<-fC?function(e,t){var r=""+Math.round(e);return r.length>=t?r:yw("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:yw("0",t-r.length)+r}(Math.round(e),t)}function vC(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var CC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wC=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var bC={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},yC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function EC(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,a=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(a=(d=Math.floor(i))*o+s,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),s=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=s):(u=c,a=o)),!r)return[0,n*a,u];var h=Math.floor(n*a/u);return[h,n*a-h*u,u]}function RC(e,t,r){if(e>2958465||e<0)return null;var n=0|e,i=Math.floor(86400*(e-n)),s=0,o=[],a={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,86400==++i&&(a.T=i=0,++n,++a.D)),60===n)o=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var TC=new Date(1899,11,31,0,0,0),xC=TC.getTime(),kC=new Date(1900,2,1,0,0,0);function PC(e,t){var r=e.getTime();return t?r-=1262304e5:e>=kC&&(r+=864e5),(r-(xC+6e4*(e.getTimezoneOffset()-TC.getTimezoneOffset())))/864e5}function AC(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FC(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=AC(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=AC(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),AC(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function DC(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):FC(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return QC(14,PC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function IC(e,t,r,n){var i,s="",o=0,a=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=r.m,c=t.length;break;case 3:return wC[r.m-1][1];case 5:return wC[r.m-1][0];default:return wC[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=r.d,c=t.length;break;case 3:return CC[r.q][0];default:return CC[r.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(a=n>=2?3===n?1e3:100:1===n?10:1,(o=Math.round(a*(r.S+r.u)))>=60*a&&(o=0),"s"===t?0===o?"0":""+o/a:(s=hC(o,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):hC(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*r.D+r.H;break;case"[m]":case"[mm]":i=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":i=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?hC(i,c):""}function MC(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var OC=/%/g;function LC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+LC(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+s)%i)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NC=/# (\?+)( ?)\/( ?)(\d+)/;var _C=/^#*0*\.([0#]+)/,GC=/\).*[0#]/,BC=/\(###\) ###\\?-####/;function HC(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function zC(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function VC(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function WC(e,t,r){if(40===e.charCodeAt(0)&&!t.match(GC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?WC("n",n,r):"("+WC("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return $C(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(OC,""),i=t.length-n.length;return $C(e,n,r*Math.pow(10,2*i))+yw("%",i)}(e,t,r);if(-1!==t.indexOf("E"))return LC(t,r);if(36===t.charCodeAt(0))return"$"+WC(e,t.substr(" "==t.charAt(1)?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+mC(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=mC(r,0))&&(i=""),i.length>t.length?i:HC(t.substr(0,t.length-i.length))+i;if(s=t.match(NC))return function(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(0===s?"":""+s)+" "+(0===o?yw(" ",e[1].length+1+e[4].length):pC(o,e[1].length)+e[2]+"/"+e[3]+hC(a,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+mC(l,t.length-t.indexOf("0"));if(s=t.match(_C))return i=zC(r,s[1].length).replace(/^([^\.]+)$/,"$1."+HC(s[1])).replace(/\.$/,"."+HC(s[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+yw("0",HC(s[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+zC(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+MC(mC(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+WC(e,t,-r):MC(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+hC(VC(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return WC(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=dC(WC(e,t.replace(/[\\-]/g,""),r)),o=0,dC(dC(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<i.length?i.charAt(o++):"0"===e?"0":""})));if(t.match(BC))return"("+(i=WC(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=EC(l,Math.pow(10,o)-1,!1),i=""+c," "==(u=$C("n",s[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],(u=gC(a[2],o)).length<s[4].length&&(u=HC(s[4].substr(s[4].length-u.length))+u),i+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c+((a=EC(l,Math.pow(10,o)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?pC(a[1],o)+s[2]+"/"+s[3]+gC(a[2],o):yw(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=mC(r,0),t.length<=i.length?i:HC(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=t.indexOf(".")-o,h=t.length-i.length-d;return HC(t.substr(0,d)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=VC(r,s[1].length),r<0?"-"+WC(e,t,-r):MC(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?hC(0,3-e.length):"")+e}))+"."+hC(o,s[1].length);switch(t){case"###,##0.00":return WC(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=MC(mC(l,0));return"0"!==p?c+p:"";case"###,###.00":return WC(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return WC(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function UC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+UC(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+s)%i)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function jC(e,t,r){if(40===e.charCodeAt(0)&&!t.match(GC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jC("n",n,r):"("+jC("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return $C(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(OC,""),i=t.length-n.length;return $C(e,n,r*Math.pow(10,2*i))+yw("%",i)}(e,t,r);if(-1!==t.indexOf("E"))return UC(t,r);if(36===t.charCodeAt(0))return"$"+jC(e,t.substr(" "==t.charAt(1)?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+hC(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,0===r&&(i=""),i.length>t.length?i:HC(t.substr(0,t.length-i.length))+i;if(s=t.match(NC))return function(e,t,r){return r+(0===t?"":""+t)+yw(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+hC(l,t.length-t.indexOf("0"));if(s=t.match(_C))return i=(i=(""+r).replace(/^([^\.]+)$/,"$1."+HC(s[1])).replace(/\.$/,"."+HC(s[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+yw("0",HC(s[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+MC(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jC(e,t,-r):MC(""+r)+"."+yw("0",s[1].length);if(s=t.match(/^#,#*,#0/))return jC(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=dC(jC(e,t.replace(/[\\-]/g,""),r)),o=0,dC(dC(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<i.length?i.charAt(o++):"0"===e?"0":""})));if(t.match(BC))return"("+(i=jC(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=EC(l,Math.pow(10,o)-1,!1),i=""+c," "==(u=$C("n",s[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],(u=gC(a[2],o)).length<s[4].length&&(u=HC(s[4].substr(s[4].length-u.length))+u),i+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c+((a=EC(l,Math.pow(10,o)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?pC(a[1],o)+s[2]+"/"+s[3]+gC(a[2],o):yw(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:HC(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=t.indexOf(".")-o,h=t.length-i.length-d;return HC(t.substr(0,d)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+jC(e,t,-r):MC(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?hC(0,3-e.length):"")+e}))+"."+hC(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=MC(""+l);return"0"!==p?c+p:"";default:if(t.match(/\.[0#?]*$/))return jC(e,t.slice(0,t.lastIndexOf(".")),r)+HC(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $C(e,t,r){return(0|r)===r?jC(e,t,r):WC(e,t,r)}var KC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function YC(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":vC(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(KC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var qC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function XC(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function JC(e,t){var r=function(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var o=r[0].match(qC),a=r[1].match(qC);return XC(t,o)?[n,r[0]]:XC(t,a)?[n,r[1]]:[n,r[null!=o&&null!=a?2:1]]}return[n,s]}function QC(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:bC)[e])&&(n=r.table&&r.table[yC[e]]||bC[yC[e]]),null==n&&(n=SC[e]||"General")}if(vC(n,0))return DC(t,r);t instanceof Date&&(t=PC(t,r.date1904));var i=JC(n,t);if(vC(i[1]))return DC(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var i,s,o,a=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!vC(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(o=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(o);a[a.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c),g="("===p||")"===p?p:"t";a[a.length]={t:g,v:p},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=RC(t,r,"2"===e.charAt(c+1))))return"";a[a.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=RC(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),a[a.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var f={t:u,v:u};if(null==i&&(i=RC(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(f.v=i.H>=12?"P":"A"),f.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(f.v=i.H>=12?"PM":"AM"),f.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=i&&(f.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),f.t="T",c+=5,h="h"):(f.t="t",++c),null==i&&"T"===f.t)return"";a[a.length]=f,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(KC)){if(null==i&&null==(i=RC(t,r)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",YC(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":a[a.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c}var m,v=0,C=0;for(c=a.length-1,d="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=h,d="h",v<1&&(v=1);break;case"s":(m=a[c].v.match(/\.0+$/))&&(C=Math.max(C,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=a[c].t;break;case"m":"s"===d&&(a[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[c].v.match(/[Hh]/)&&(v=1),v<2&&a[c].v.match(/[Mm]/)&&(v=2),v<3&&a[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var w,b="";for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=IC(a[c].t.charCodeAt(0),a[c].v,i,C),a[c].t="t";break;case"n":case"?":for(w=c+1;null!=a[w]&&("?"===(u=a[w].t)||"D"===u||(" "===u||"t"===u)&&null!=a[w+1]&&("?"===a[w+1].t||"t"===a[w+1].t&&"/"===a[w+1].v)||"("===a[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===a[w].v||" "===a[w].v&&null!=a[w+1]&&"?"==a[w+1].t));)a[c].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[c].v,c=w-1;break;case"G":a[c].t="t",a[c].v=DC(t,r)}var y,S,E="";if(b.length>0){40==b.charCodeAt(0)?(y=t<0&&45===b.charCodeAt(0)?-t:t,S=$C("n",b,y)):(S=$C("n",b,y=t<0&&n>1?-t:t),y<0&&a[0]&&"t"==a[0].t&&(S=S.substr(1),a[0].v="-"+a[0].v)),w=S.length-1;var R=a.length;for(c=0;c<a.length;++c)if(null!=a[c]&&"t"!=a[c].t&&a[c].v.indexOf(".")>-1){R=c;break}var T=a.length;if(R===a.length&&-1===S.indexOf("E")){for(c=a.length-1;c>=0;--c)null!=a[c]&&-1!=="n?".indexOf(a[c].t)&&(w>=a[c].v.length-1?(w-=a[c].v.length,a[c].v=S.substr(w+1,a[c].v.length)):w<0?a[c].v="":(a[c].v=S.substr(0,w+1),w=-1),a[c].t="t",T=c);w>=0&&T<a.length&&(a[T].v=S.substr(0,w+1)+a[T].v)}else if(R!==a.length&&-1===S.indexOf("E")){for(w=S.indexOf(".")-1,c=R;c>=0;--c)if(null!=a[c]&&-1!=="n?".indexOf(a[c].t)){for(s=a[c].v.indexOf(".")>-1&&c===R?a[c].v.indexOf(".")-1:a[c].v.length-1,E=a[c].v.substr(s+1);s>=0;--s)w>=0&&("0"===a[c].v.charAt(s)||"#"===a[c].v.charAt(s))&&(E=S.charAt(w--)+E);a[c].v=E,a[c].t="t",T=c}for(w>=0&&T<a.length&&(a[T].v=S.substr(0,w+1)+a[T].v),w=S.indexOf(".")+1,c=R;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===R)){for(s=a[c].v.indexOf(".")>-1&&c===R?a[c].v.indexOf(".")+1:0,E=a[c].v.substr(0,s);s<a[c].v.length;++s)w<S.length&&(E+=S.charAt(w++));a[c].v=E,a[c].t="t",T=c}}}for(c=0;c<a.length;++c)null!=a[c]&&"n?".indexOf(a[c].t)>-1&&(y=n>1&&t<0&&c>0&&"-"===a[c-1].v?-t:t,a[c].v=$C(a[c].t,a[c].v,y),a[c].t="t");var x="";for(c=0;c!==a.length;++c)null!=a[c]&&(x+=a[c].v);return x}(i[1],t,r,i[0])}function ZC(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=bC[r]){if(bC[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return bC[t]=e,t}function ew(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',bC=e}var tw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var nw=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)i[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!==typeof Int32Array?i.subarray(256*n,256*n+256):i.slice(256*n,256*n+256);return s}(t),n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],d=r[8],h=r[9],p=r[10],g=r[11],f=r[12],m=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,i=0,s=e.length;i<s;)n=n>>>8^t[255&(n^e.charCodeAt(i++))];return~n},e.buf=function(e,r){for(var C=-1^r,w=e.length-15,b=0;b<w;)C=v[e[b++]^255&C]^m[e[b++]^C>>8&255]^f[e[b++]^C>>16&255]^g[e[b++]^C>>>24]^p[e[b++]]^h[e[b++]]^d[e[b++]]^u[e[b++]]^c[e[b++]]^l[e[b++]]^a[e[b++]]^o[e[b++]]^s[e[b++]]^i[e[b++]]^n[e[b++]]^t[e[b++]];for(w+=15;b<w;)C=C>>>8^t[255&(C^e[b++])];return~C},e.str=function(e,r){for(var n=-1^r,i=0,s=e.length,o=0,a=0;i<s;)(o=e.charCodeAt(i++))<128?n=n>>>8^t[255&(n^o)]:o<2048?n=(n=n>>>8^t[255&(n^(192|o>>6&31))])>>>8^t[255&(n^(128|63&o))]:o>=55296&&o<57344?(o=64+(1023&o),a=1023&e.charCodeAt(i++),n=(n=(n=(n=n>>>8^t[255&(n^(240|o>>8&7))])>>>8^t[255&(n^(128|o>>2&63))])>>>8^t[255&(n^(128|a>>6&15|(3&o)<<4))])>>>8^t[255&(n^(128|63&a))]):n=(n=(n=n>>>8^t[255&(n^(224|o>>12&15))])>>>8^t[255&(n^(128|o>>6&63))])>>>8^t[255&(n^(128|63&o))];return~n},e}(),iw=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){Qb(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),i=e.read_shift(2),s=e.l+i,o={};if(21589===n)1&(r=e.read_shift(1))&&(o.mtime=e.read_shift(4)),i>5&&(2&r&&(o.atime=e.read_shift(4)),4&r&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime));e.l=s,t[n]=o}return t}function o(){return e||(e={})}function a(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(tC&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),i=0,s="";for(i=0;i<n.length;++i)if(s=n[i],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var o=(n[1]||"").match(/boundary="(.*?)"/);if(!o)throw new Error("MAD cannot find boundary");var a="--"+(o[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,p=0;for(i=0;i<n.length;++i){var g=n[i];g!==a&&g!==a+"--"||(p++&&ce(u,n.slice(d,i),r),d=i)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,i,s,o,a,p=512,g=[],f=e.slice(0,512);Qb(f,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(C,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(f);switch(r=m[0]){case 3:p=512;break;case 4:p=4096;break;case 0:if(0==m[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==p&&Qb(f=e.slice(0,p),28);var w=e.slice(0,p);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(f,r);var b=f.read_shift(4,"i");if(3===r&&0!==b)throw new Error("# Directory Sectors: Expected 0 saw "+b);f.l+=4,s=f.read_shift(4,"i"),f.l+=4,f.chk("00100000","Mini Stream Cutoff Size: "),o=f.read_shift(4,"i"),n=f.read_shift(4,"i"),a=f.read_shift(4,"i"),i=f.read_shift(4,"i");for(var y=-1,E=0;E<109&&!((y=f.read_shift(4,"i"))<0);++E)g[E]=y;var R=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);return n[r-1]=e.slice(r*t),n}(e,p);c(a,i,R,p,g);var T=function(e,t,r,n){var i=e.length,s=[],o=[],a=[],l=[],c=n-1,u=0,d=0,h=0,p=0;for(u=0;u<i;++u)if(a=[],(h=u+t)>=i&&(h-=i),!o[h]){l=[];var g=[];for(d=h;d>=0;){g[d]=!0,o[d]=!0,a[a.length]=d,l.push(e[d]);var f=r[Math.floor(4*d/n)];if(n<4+(p=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+n);if(!e[f])break;if(g[d=Ub(e[f],p)])break}s[h]={nodes:a,data:wb([l])}}return s}(R,s,g,p);T[s].name="!Directory",n>0&&o!==v&&(T[o].name="!MiniFAT"),T[g[0]].name="!FAT",T.fat_addrs=g,T.ssz=p;var x=[],k=[],P=[];!function(e,t,r,n,i,s,o,a){for(var c,h=0,p=n.length?2:0,g=t[e].data,f=0,m=0;f<g.length;f+=128){var C=g.slice(f,f+128);Qb(C,64),m=C.read_shift(2),c=yb(C,0,m-p),n.push(c);var w={name:c,type:C.read_shift(1),color:C.read_shift(1),L:C.read_shift(4,"i"),R:C.read_shift(4,"i"),C:C.read_shift(4,"i"),clsid:C.read_shift(16),state:C.read_shift(4,"i"),start:0,size:0};0!==C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2)&&(w.ct=d(C,C.l-8)),0!==C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2)&&(w.mt=d(C,C.l-8)),w.start=C.read_shift(4,"i"),w.size=C.read_shift(4,"i"),w.size<0&&w.start<0&&(w.size=w.type=0,w.start=v,w.name=""),5===w.type?(h=w.start,i>0&&h!==v&&(t[h].name="!StreamData")):w.size>=4096?(w.storage="fat",void 0===t[w.start]&&(t[w.start]=u(r,w.start,t.fat_addrs,t.ssz)),t[w.start].name=w.name,w.content=t[w.start].data.slice(0,w.size)):(w.storage="minifat",w.size<0?w.size=0:h!==v&&w.start!==v&&t[h]&&(w.content=l(w,t[h].data,(t[a]||{}).data))),w.content&&Qb(w.content,0),s[c]=w,o.push(w)}}(s,T,R,x,n,{},k,o),function(e,t,r){for(var n=0,i=0,s=0,o=0,a=0,l=r.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=r[n];for(;a<u.length;++a)i=e[n=u[a]].L,s=e[n].R,o=e[n].C,c[n]===n&&(-1!==i&&c[i]!==i&&(c[n]=c[i]),-1!==s&&c[s]!==s&&(c[n]=c[s])),-1!==o&&(c[o]=n),-1!==i&&n!=c[n]&&(c[i]=c[n],u.lastIndexOf(i)<a&&u.push(i)),-1!==s&&n!=c[n]&&(c[s]=c[n],u.lastIndexOf(s)<a&&u.push(s));for(n=1;n<l;++n)c[n]===n&&(-1!==s&&c[s]!==s?c[n]=c[s]:-1!==i&&c[i]!==i&&(c[n]=c[i]));for(n=1;n<l;++n)if(0!==e[n].type){if((a=n)!=c[a])do{a=c[a],t[n]=t[a]+"/"+t[n]}while(0!==a&&-1!==c[a]&&a!=c[a]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(k,P,x),x.shift();var A={FileIndex:k,FullPaths:P};return t&&t.raw&&(A.raw={header:w,sectors:R}),A}function l(e,t,r){for(var n=e.start,i=e.size,s=[],o=n;r&&i>0&&o>=0;)s.push(t.slice(o*m,o*m+m)),i-=m,o=Ub(r,4*o);return 0===s.length?ey(0):lC(s).slice(0,e.size)}function c(e,t,r,n,i){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=r[e],a=(n>>>2)-1;if(!o)return;for(var l=0;l<a&&(s=Ub(o,4*l))!==v;++l)i.push(s);c(Ub(o,n-4),t-1,r,n,i)}}function u(e,t,r,n,i){var s=[],o=[];i||(i=[]);var a=n-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,s[s.length]=l,o.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=Ub(e[u],c)}return{nodes:s,data:wb([o])}}function d(e,t){return new Date(1e3*(Wb(e,t+4)/1e7*Math.pow(2,32)+Wb(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(iw.find(e,"/"+t))return;var r=ey(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),p(e)}(e)}function p(e,t){h(e);for(var i=!1,s=!1,o=e.FullPaths.length-1;o>=0;--o){var a=e.FileIndex[o];switch(a.type){case 0:s?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(a.R*a.L*a.C)&&(i=!0),a.R>-1&&a.L>-1&&a.R==a.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(o=0;o<e.FullPaths.length;++o)u[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&d.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<d.length;++o){var p=r(d[o][0]);(s=u[p])||(d.push([p,{name:n(p).replace("/",""),type:1,clsid:b,ct:l,mt:l,content:null}]),u[p]=!0)}for(d.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),i=0,s=0,o=Math.min(r.length,n.length);i<o;++i){if(s=r[i].length-n[i].length)return s;if(r[i]!=n[i])return r[i]<n[i]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],o=0;o<d.length;++o)e.FullPaths[o]=d[o][0],e.FileIndex[o]=d[o][1];for(o=0;o<d.length;++o){var g=e.FileIndex[o],f=e.FullPaths[o];if(g.name=n(f).replace("/",""),g.L=g.R=g.C=-(g.color=1),g.size=g.content?g.content.length:0,g.start=0,g.clsid=g.clsid||b,0===o)g.C=d.length>1?1:-1,g.size=0,g.type=5;else if("/"==f.slice(-1)){for(c=o+1;c<d.length&&r(e.FullPaths[c])!=f;++c);for(g.C=c>=d.length?-1:c,c=o+1;c<d.length&&r(e.FullPaths[c])!=r(f);++c);g.R=c>=d.length?-1:c,g.type=1}else r(e.FullPaths[o+1]||"")==r(f)&&(g.R=o+1),g.type=2}}}function g(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=e.FullPaths[0],o=s,a=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(o=e.FullPaths[l].slice(s.length),(a=e.FileIndex[l]).size&&a.content&&"\x01Sh33tJ5"!=o){o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=a.content,u=tC&&Buffer.isBuffer(c)?c.toString("binary"):S(c),d=0,h=Math.min(1024,u.length),p=0,g=0;g<=h;++g)(p=u.charCodeAt(g))>=32&&p<128&&++d;var f=d>=4*h/5;i.push(n),i.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+o),i.push("Content-Transfer-Encoding: "+(f?"quoted-printable":"base64")),i.push("Content-Type: "+oe(a,o)),i.push(""),i.push(f?le(u):ae(u))}return i.push(n+"--\r\n"),i.join("\r\n")}(e,r);if(p(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],s=[],o=ey(1),a=r.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,p=e.FullPaths[0],g=p,f=e.FileIndex[0],m=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(g=e.FullPaths[c].slice(p.length),(f=e.FileIndex[c]).size&&f.content&&"\x01Sh33tJ5"!=g){var C=d,w=ey(g.length);for(u=0;u<g.length;++u)w.write_shift(1,127&g.charCodeAt(u));w=w.slice(0,w.l),m[h]=nw.buf(f.content,0);var b=f.content;8==a&&(b=E(b)),(o=ey(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,a),f.mt?i(o,f.mt):o.write_shift(4,0),o.write_shift(-4,8&l?0:m[h]),o.write_shift(4,8&l?0:b.length),o.write_shift(4,8&l?0:f.content.length),o.write_shift(2,w.length),o.write_shift(2,0),d+=o.length,n.push(o),d+=w.length,n.push(w),d+=b.length,n.push(b),8&l&&((o=ey(12)).write_shift(-4,m[h]),o.write_shift(4,b.length),o.write_shift(4,f.content.length),d+=o.l,n.push(o)),(o=ey(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,a),o.write_shift(4,0),o.write_shift(-4,m[h]),o.write_shift(4,b.length),o.write_shift(4,f.content.length),o.write_shift(2,w.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,C),v+=o.l,s.push(o),v+=w.length,s.push(w),++h}return o=ey(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,h),o.write_shift(2,h),o.write_shift(4,v),o.write_shift(4,d),o.write_shift(2,0),lC([lC(n),lC(s),o])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];if(i.content){var s=i.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var o=e.FullPaths.length+3>>2,a=t+127>>7,l=(t+7>>3)+r+o+a,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,a,o,r,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),s=ey(n[7]<<9),o=0,a=0;for(o=0;o<8;++o)s.write_shift(1,w[o]);for(o=0;o<8;++o)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),o=0;o<3;++o)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:v),s.write_shift(4,n[1]),o=0;o<109;++o)s.write_shift(-4,o<n[2]?n[1]+o:-1);if(n[1])for(a=0;a<n[1];++a){for(;o<236+127*a;++o)s.write_shift(-4,o<n[2]?n[1]+o:-1);s.write_shift(-4,a===n[1]-1?v:a+1)}var l=function(e){for(a+=e;o<a-1;++o)s.write_shift(-4,o+1);e&&(++o,s.write_shift(-4,v))};for(a=o=0,a+=n[1];o<a;++o)s.write_shift(-4,y.DIFSECT);for(a+=n[2];o<a;++o)s.write_shift(-4,y.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=a,l(u+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,y.ENDOFCHAIN);for(a=o=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=a,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,y.ENDOFCHAIN);for(o=0;o<n[4]<<2;++o){var h=e.FullPaths[o];if(h&&0!==h.length){d=e.FileIndex[o],0===o&&(d.start=d.size?d.start-1:v);var g=0===o&&r.root||d.name;if(u=2*(g.length+1),s.write_shift(64,g,"utf16le"),s.write_shift(2,u),s.write_shift(1,d.type),s.write_shift(1,d.color),s.write_shift(-4,d.L),s.write_shift(-4,d.R),s.write_shift(-4,d.C),d.clsid)s.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,d.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,d.start),s.write_shift(4,d.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((d=e.FileIndex[o]).size>=4096)if(s.l=d.start+1<<9,tC&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((d=e.FileIndex[o]).size>0&&d.size<4096)if(tC&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(tC)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var f,m=64,v=-2,C="d0cf11e0a1b11ae1",w=[208,207,17,224,161,177,26,225],b="00000000000000000000000000000000",y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:C,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:b,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function E(e){return f?f.deflateRawSync(e):Y(e)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var P="undefined"!==typeof Uint8Array,A=P?new Uint8Array(256):[],F=0;F<256;++F)A[F]=k(F);function D(e,t){var r=A[255&e];return t<=8?r>>>8-t:(r=r<<8|A[e>>8&255],t<=16?r>>>16-t:(r=r<<8|A[e>>16&255])>>>24-t)}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function M(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function O(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function L(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function N(e,t,r){var n=7&t,i=t>>>3,s=(1<<r)-1,o=e[i]>>>n;return r<8-n?o&s:(o|=e[i+1]<<8-n,r<16-n?o&s:(o|=e[i+2]<<16-n,r<24-n?o&s:(o|=e[i+3]<<24-n)&s))}function _(e,t,r){var n=7&t,i=t>>>3;return n<=5?e[i]|=(7&r)<<n:(e[i]|=r<<n&255,e[i+1]=(7&r)>>8-n),t+3}function G(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function H(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function z(e,t){var r=e.length,n=2*r>t?2*r:t+5,i=0;if(r>=t)return e;if(tC){var s=iC(n);if(e.copy)e.copy(s);else for(;i<e.length;++i)s[i]=e[i];return s}if(P){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;i<r;++i)o[i]=e[i];return o}return e.length=n,e}function V(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function W(e,t,r){var n=1,i=0,s=0,o=0,a=0,l=e.length,c=P?new Uint16Array(32):V(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var u=P?new Uint16Array(l):V(l);for(s=0;s<l;++s)c[i=e[s]]++,n<i&&(n=i),u[s]=0;for(c[0]=0,s=1;s<=n;++s)c[s+16]=a=a+c[s-1]<<1;for(s=0;s<l;++s)0!=(a=e[s])&&(u[s]=c[a+16]++);var d=0;for(s=0;s<l;++s)if(0!=(d=e[s]))for(a=D(u[s],n)>>n-d,o=(1<<n+4-d)-1;o>=0;--o)t[a|o<<d]=15&d|s<<4;return n}var U=P?new Uint16Array(512):V(512),j=P?new Uint16Array(32):V(32);if(!P){for(var $=0;$<512;++$)U[$]=0;for($=0;$<32;++$)j[$]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,j,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);W(r,U,288)}();var K=function(){for(var e=P?new Uint8Array(32768):[],t=0,r=0;t<x.length-1;++t)for(;r<x[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=P?new Uint8Array(259):[];for(t=0,r=0;t<T.length-1;++t)for(;r<T[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),i=r+n==e.length;for(t.write_shift(1,+i),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var i=0,s=0,o=P?new Uint16Array(32768):[];s<t.length;){var a=Math.min(65535,t.length-s);if(a<10){for(7&(i=_(r,i,+!(s+a!=t.length)))&&(i+=8-(7&i)),r.l=i/8|0,r.write_shift(2,a),r.write_shift(2,65535&~a);a-- >0;)r[r.l++]=t[s++];i=8*r.l}else{i=_(r,i,+!(s+a!=t.length)+2);for(var l=0;a-- >0;){var c=t[s],u=-1,d=0;if((u=o[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+d]==t[s+d]&&d<250;)++d;if(d>2){(c=n[d])<=22?i=B(r,i,A[c+1]>>1)-1:(B(r,i,3),B(r,i+=5,A[c-23]>>5),i+=3);var h=c<8?0:c-4>>2;h>0&&(H(r,i,d-T[c]),i+=h),c=e[s-u],i=B(r,i,A[c]>>3),i-=3;var p=c<4?0:c-2>>1;p>0&&(H(r,i,s-u-x[c]),i+=p);for(var g=0;g<d;++g)o[l]=32767&s,l=32767&(l<<5^t[s]),++s;a-=d-1}else c<=143?c+=48:i=G(r,i,1),i=B(r,i,A[c]),o[l]=32767&s,++s}i=B(r,i,0)-1}}return r.l=(i+7)/8|0,r.l}(t,r)}}();function Y(e){var t=ey(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)}var q=P?new Uint16Array(32768):V(32768),X=P?new Uint16Array(32768):V(32768),J=P?new Uint16Array(128):V(128),Q=1,Z=1;function ee(e,t){var r=O(e,t)+257,n=O(e,t+=5)+1,i=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,o=P?new Uint8Array(19):V(19),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=P?new Uint8Array(8):V(8),u=P?new Uint8Array(8):V(8),d=o.length,h=0;h<i;++h)o[R[h]]=s=M(e,t),l<s&&(l=s),c[s]++,t+=3;var p=0;for(c[0]=0,h=1;h<=l;++h)u[h]=p=p+c[h-1]<<1;for(h=0;h<d;++h)0!=(p=o[h])&&(a[h]=u[p]++);var g=0;for(h=0;h<d;++h)if(0!=(g=o[h])){p=A[a[h]]>>8-g;for(var f=(1<<7-g)-1;f>=0;--f)J[p|f<<g]=7&g|h<<3}var m=[];for(l=1;m.length<r+n;)switch(t+=7&(p=J[L(e,t)]),p>>>=3){case 16:for(s=3+I(e,t),t+=2,p=m[m.length-1];s-- >0;)m.push(p);break;case 17:for(s=3+M(e,t),t+=3;s-- >0;)m.push(0);break;case 18:for(s=11+L(e,t),t+=7;s-- >0;)m.push(0);break;default:m.push(p),l<p&&(l=p)}var v=m.slice(0,r),C=m.slice(r);for(h=r;h<286;++h)v[h]=0;for(h=n;h<30;++h)C[h]=0;return Q=W(v,q,286),Z=W(C,X,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[nC(t),2];for(var r=0,n=0,i=iC(t||1<<18),s=0,o=i.length>>>0,a=0,l=0;0==(1&n);)if(n=M(e,r),r+=3,n>>>1!=0)for(n>>1==1?(a=9,l=5):(r=ee(e,r),a=Q,l=Z);;){!t&&o<s+32767&&(o=(i=z(i,s+32767)).length);var c=N(e,r,a),u=n>>>1==1?U[c]:q[c];if(r+=15&u,0===((u>>>=4)>>>8&255))i[s++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=s+T[u];d>0&&(h+=N(e,r,d),r+=d),c=N(e,r,l),r+=15&(u=n>>>1==1?j[c]:X[c]);var p=(u>>>=4)<4?0:u-2>>1,g=x[u];for(p>0&&(g+=N(e,r,p),r+=p),!t&&o<h&&(o=(i=z(i,h+100)).length);s<h;)i[s]=i[s-g],++s}}else{7&r&&(r+=8-(7&r));var f=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,f>0)for(!t&&o<s+f&&(o=(i=z(i,s+f)).length);f-- >0;)i[s++]=e[r>>>3],r+=8}return t?[i,r+7>>>3]:[i.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;Qb(r,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var i=r.length-4;(80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&i>=0;)--i;r.l=i+4,r.l+=4;var o=r.read_shift(2);r.l+=6;var a=r.read_shift(4);for(r.l=a,i=0;i<o;++i){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2),d=r.read_shift(2),p=r.read_shift(2);r.l+=8;var g=r.read_shift(4),f=s(r.slice(r.l+u,r.l+u+d));r.l+=u+d+p;var m=r.l;r.l=g+4,ie(r,l,c,n,f),r.l=m}return n}function ie(e,t,r,n,i){e.l+=2;var o=e.read_shift(2),a=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,i=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(i);var o=31&t,a=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(a),n.setSeconds(o<<1),n}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),p="",g=0;g<d;++g)p+=String.fromCharCode(e[e.l++]);if(h){var m=s(e.slice(e.l,e.l+h));(m[21589]||{}).mt&&(l=m[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(a){case 8:v=function(e,t){if(!f)return te(e,t);var r=new(0,f.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+a)}var C=!1;8&o&&(134695760==e.read_shift(4)&&(e.read_shift(4),C=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&re(C,"Bad compressed size: "+t+" != "+c),u!=r&&re(C,"Bad uncompressed size: "+r+" != "+u),ue(n,p,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&se[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[n[1]]?se[n[1]]:"application/octet-stream"}function ae(e){for(var t=Zv(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<n.length;++i){var s=n[i];if(0!=s.length)for(var o=0;o<s.length;){var a=76,l=s.slice(o,o+a);"="==l.charAt(a-1)?a--:"="==l.charAt(a-2)?a-=2:"="==l.charAt(a-3)&&(a-=3),l=s.slice(o,o+a),(o+=a)<s.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,i="",s="",o="",a=0;a<10;++a){var l=t[a];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":o=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++a,s.toLowerCase()){case"base64":n=sC(eC(t.slice(a).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return sC(t.join("\r\n"))}(t.slice(a));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,i.slice(r.length),n,{unsafe:!0});o&&(u.ctype=o)}function ue(e,t,r,i){var s=i&&i.unsafe;s||h(e);var o=!s&&iw.find(e,t);if(!o){var a=e.FullPaths[0];t.slice(0,a.length)==a?a=t:("/"!=a.slice(-1)&&(a+="/"),a=(a+t).replace("//","/")),o={name:n(t),type:2},e.FileIndex.push(o),e.FullPaths.push(a),s||iw.utils.cfb_gc(e)}return o.content=r,o.size=r?r.length:0,i&&(i.CLSID&&(o.clsid=i.CLSID),i.mt&&(o.mt=i.mt),i.ct&&(o.ct=i.ct)),o}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=r[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var s=t.toUpperCase(),o=!0===i?r.indexOf(s):n.indexOf(s);if(-1!==o)return e.FileIndex[o];var a=!s.match(uC);for(s=s.replace(cC,""),a&&(s=s.replace(uC,"!")),o=0;o<r.length;++o){if((a?r[o].replace(uC,"!"):r[o]).replace(cC,"")==s)return e.FileIndex[o];if((a?n[o].replace(uC,"!"):n[o]).replace(cC,"")==s)return e.FileIndex[o]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||tC&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return o(),a(e.readFileSync(t),r)}(t,r);case"base64":return a(sC(eC(t)),r);case"binary":return a(sC(t),r)}return a(t,r)},t.parse=a,t.write=function(t,r){var n=g(t,r);switch(r&&r.type||"buffer"){case"file":return o(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:S(n);case"base64":return Zv("string"==typeof n?n:S(n));case"buffer":if(tC)return Buffer.isBuffer(n)?n:rC(n);case"array":return"string"==typeof n?sC(n):n}return n},t.writeFile=function(t,r,n){o();var i=g(t,n);e.writeFileSync(r,i)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var r=iw.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var i=iw.find(e,t);if(i)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==i)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){p(e,!0)},ReadShift:$b,CheckField:Jb,prep_blob:Qb,bconcat:lC,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");f=e}catch(r){console.error("cannot use native zlib: "+(r.message||r))}},_deflateRaw:Y,_inflateRaw:te,consts:y},t}();let sw;function ow(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function aw(e){for(var t=[],r=ow(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var lw=new Date(1899,11,30,0,0,0);function cw(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(lw.getTime()+6e4*(e.getTimezoneOffset()-lw.getTimezoneOffset())))/864e5}var uw=new Date,dw=lw.getTime()+6e4*(uw.getTimezoneOffset()-lw.getTimezoneOffset()),hw=uw.getTimezoneOffset();function pw(e){var t=new Date;return t.setTime(24*e*60*60*1e3+dw),t.getTimezoneOffset()!==hw&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-hw)),t}function gw(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(i[s],10)}return t}var fw=new Date("2017-02-19T19:06:09.000Z"),mw=isNaN(fw.getFullYear())?new Date("2/19/17"):fw,vw=2017==mw.getFullYear();function Cw(e,t){var r=new Date(e);if(vw)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==mw.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function ww(e,t){if(tC&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return ib(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return ib(Kv(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return ib(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return ib(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return r[e]||e}))}catch(s){}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function bw(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=bw(e[r]));return t}function yw(e,t){for(var r="";r.length<t;)r+=e;return r}function Sw(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var Ew=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rw(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Ew.indexOf(o))return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Tw=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var i=t.split(r),s=[i[0]],o=1;o<i.length;++o)s.push(n),s.push(i[o]);return s}}();function xw(e){return e?e.content&&e.type?ww(e.content,!0):e.data?qv(e.data):e.asNodeBuffer&&tC?qv(e.asNodeBuffer().toString("binary")):e.asBinary?qv(e.asBinary()):e._data&&e._data.getContent?qv(ww(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function kw(e){if(!e)return null;if(e.data)return $v(e.data);if(e.asNodeBuffer&&tC)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?$v(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Pw(e,t){for(var r=e.FullPaths||ow(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Aw(e,t){var r=Pw(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Fw(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?kw(e):xw(e)}(Aw(e,t));if(!t)return null;try{return Fw(e,t)}catch(n){return null}}function Dw(e,t,r){if(!r)return xw(Aw(e,t));if(!t)return null;try{return Dw(e,t)}catch(n){return null}}function Iw(e,t,r){if(!r)return kw(Aw(e,t));if(!t)return null;try{return Iw(e,t)}catch(n){return null}}function Mw(e){for(var t=e.FullPaths||ow(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ow(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=tC?rC(r):function(e){for(var t=[],r=0,n=e.length+250,i=nC(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var a=1023&e.charCodeAt(++s);i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(3&o)<<4,i[r++]=128|63&a}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|63&o;r>n&&(t.push(i.slice(0,r)),r=0,i=nC(65535),n=65530)}return t.push(i.slice(0,r)),lC(t)}(r),iw.utils.cfb_add(e,t,n);iw.utils.cfb_add(e,t,r)}else e.file(t,r)}function Lw(e,t){switch(t.type){case"base64":return iw.read(e,{type:"base64"});case"binary":return iw.read(e,{type:"binary"});case"buffer":case"array":return iw.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nw(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var i=n.shift();".."===i?r.pop():"."!==i&&r.push(i)}return r.join("/")}var _w='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Gw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Hw=_w.match(Bw)?Bw:/<[^>]*>/g,zw=/<\w*:/,Vw=/<(\/?)\w+:/;function Ww(e,t,r){for(var n={},i=0,s=0;i!==e.length&&(32!==(s=e.charCodeAt(i))&&10!==s&&13!==s);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Gw),a=0,l="",c=0,u="",d="",h=1;if(o)for(c=0;c!=o.length;++c){for(d=o[c],s=0;s!=d.length&&61!==d.charCodeAt(s);++s);for(u=d.slice(0,s).trim();32==d.charCodeAt(s+1);)++s;for(h=34==(i=d.charCodeAt(s+1))||39==i?1:0,l=d.slice(s+1+h,d.length-h),a=0;a!=u.length&&58!==u.charCodeAt(a);++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var p=(5===a&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(a+1);if(n[p]&&"ext"==u.slice(a-3,a))continue;n[p]=l,r||(n[p.toLowerCase()]=l)}}return n}function Uw(e){return e.replace(Vw,"<$1")}var jw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$w=aw(jw),Kw=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(-1==s)return i.replace(e,(function(e,t){return jw[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),Yw=/[&<>'"]/g;var qw=/[\u0000-\u001f]/g;function Xw(e){return(e+"").replace(Yw,(function(e){return $w[e]})).replace(/\n/g,"<br/>").replace(qw,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Jw=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function Qw(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Zw(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(i=e.charCodeAt(r++),n>191&&n<224?(o=(31&n)<<6,o|=63&i,t+=String.fromCharCode(o)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&s):(a=((7&n)<<18|(63&i)<<12|(63&s)<<6|63&(o=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t}function eb(e){var t,r,n,i=nC(2*e.length),s=1,o=0,a=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),a=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==a&&(i[o++]=255&a,i[o++]=a>>>8,a=0),i[o++]=t%256,i[o++]=t>>>8;return i.slice(0,o).toString("ucs2")}function tb(e){return rC(e,"binary").toString("utf8")}var rb="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",nb=tC&&(tb(rb)==Zw(rb)&&tb||eb(rb)==Zw(rb)&&eb)||Zw,ib=tC?function(e){return rC(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},sb=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),ob=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),ab=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),lb=/<\/?(?:vt:)?variant>/g,cb=/<(?:vt:)([^>]*)>([\s\S]*)</;function ub(e,t){var r=Ww(e),n=e.match(ab(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach((function(e){var t=e.replace(lb,"").match(cb);t&&i.push({v:nb(t[2]),t:t[1]})})),i}var db=/(^\s|\s$|\n)/;function hb(e){return ow(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function pb(e,t,r){return"<"+e+(null!=r?hb(r):"")+(null!=t?(t.match(db)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function gb(e){if(tC&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return nb(oC(aC(e)));throw new Error("Bad input format: expected Buffer or string")}var fb=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,mb="http://schemas.openxmlformats.org/package/2006/content-types",vb=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Cb=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,i=e[0][r].length;n<i;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},wb=tC?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:rC(e)}))):Cb(e)}:Cb,bb=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(zb(e,i)));return n.join("").replace(cC,"")},yb=tC?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(cC,""):bb(e,t,r)}:bb,Sb=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},Eb=tC?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Sb(e,t,r)}:Sb,Rb=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Hb(e,i)));return n.join("")},Tb=tC?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Rb(e,t,r)}:Rb,xb=function(e,t){var r=Wb(e,t);return r>0?Tb(e,t+4,t+4+r-1):""},kb=xb,Pb=function(e,t){var r=Wb(e,t);return r>0?Tb(e,t+4,t+4+r-1):""},Ab=Pb,Fb=function(e,t){var r=2*Wb(e,t);return r>0?Tb(e,t+4,t+4+r-1):""},Db=Fb,Ib=function(e,t){var r=Wb(e,t);return r>0?yb(e,t+4,t+4+r):""},Mb=Ib,Ob=function(e,t){var r=Wb(e,t);return r>0?Tb(e,t+4,t+4+r):""},Lb=Ob,Nb=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],s=5;s>=0;--s)i=256*i+e[t+s];return 2047==n?0==i?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}(e,t)},_b=Nb,Gb=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Bb(){yb=function(e,t,r){return Yv.utils.decode(1200,e.slice(t,r)).replace(cC,"")},Tb=function(e,t,r){return Yv.utils.decode(65001,e.slice(t,r))},kb=function(e,t){var r=Wb(e,t);return r>0?Yv.utils.decode(Hv,e.slice(t+4,t+4+r-1)):""},Ab=function(e,t){var r=Wb(e,t);return r>0?Yv.utils.decode(Bv,e.slice(t+4,t+4+r-1)):""},Db=function(e,t){var r=2*Wb(e,t);return r>0?Yv.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Mb=function(e,t){var r=Wb(e,t);return r>0?Yv.utils.decode(1200,e.slice(t+4,t+4+r)):""},Lb=function(e,t){var r=Wb(e,t);return r>0?Yv.utils.decode(65001,e.slice(t+4,t+4+r)):""}}tC&&(kb=function(e,t){if(!Buffer.isBuffer(e))return xb(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Ab=function(e,t){if(!Buffer.isBuffer(e))return Pb(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Db=function(e,t){if(!Buffer.isBuffer(e))return Fb(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Mb=function(e,t){if(!Buffer.isBuffer(e))return Ib(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Lb=function(e,t){if(!Buffer.isBuffer(e))return Ob(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},_b=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Nb(e,t)},Gb=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Yv&&Bb();var Hb=function(e,t){return e[t]},zb=function(e,t){return 256*e[t+1]+e[t]},Vb=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Wb=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ub=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},jb=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $b(e,t){var r,n,i,s,o,a,l="",c=[];switch(t){case"dbcs":if(a=this.l,tC&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)l+=String.fromCharCode(zb(this,a)),a+=2;e*=2;break;case"utf8":l=Tb(this,this.l,this.l+e);break;case"utf16le":e*=2,l=yb(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Yv)return $b.call(this,e,"dbcs");l=Yv.utils.decode(Bv,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=kb(this,this.l),e=4+Wb(this,this.l);break;case"lpstr-cp":l=Ab(this,this.l),e=4+Wb(this,this.l);break;case"lpwstr":l=Db(this,this.l),e=4+2*Wb(this,this.l);break;case"lpp4":e=4+Wb(this,this.l),l=Mb(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Wb(this,this.l),l=Lb(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=Hb(this,this.l+e++));)c.push(Xv(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=zb(this,this.l+e));)c.push(Xv(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",a=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(a))return i=Hb(this,a),this.l=a+1,s=$b.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Xv(zb(this,a))),a+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Yv){l=Yv.utils.decode(Bv,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(a))return i=Hb(this,a),this.l=a+1,s=$b.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Xv(Hb(this,a))),a+=1}l=c.join("");break;default:switch(e){case 1:return r=Hb(this,this.l),this.l++,r;case 2:return r=("i"===t?Vb:zb)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Ub:jb)(this,this.l),this.l+=4,r):(n=Wb(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?_b(this,this.l):_b([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=Eb(this,this.l,e)}}return this.l+=e,l}var Kb=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Yb=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},qb=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Xb(e,t,r){var n=0,i=0;if("dbcs"===r){for(i=0;i!=t.length;++i)qb(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof Yv&&874==Hv)for(i=0;i!=t.length;++i){var s=Yv.utils.encode(Hv,t.charAt(i));this[this.l+i]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);n=t.length}else{if("hex"===r){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===r){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,Kb(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?0==o?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[r+a]=255&s;e[r+6]=(15&i)<<4|15&s,e[r+7]=i>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,Yb(this,t,this.l)}}return this.l+=n,this}function Jb(e,t){var r=Eb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Qb(e,t){e.l=t,e.read_shift=$b,e.chk=Jb,e.write_shift=Xb}function Zb(e,t){e.l+=t}function ey(e){var t=nC(e);return Qb(t,0),t}function ty(e,t,r){if(e){var n,i,s;Qb(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){128&(a=e.read_shift(1))&&(a=(127&a)+((127&e.read_shift(1))<<7));var c=cx[a]||cx[65535];for(s=127&(n=e.read_shift(1)),i=1;i<4&&128&n;++i)s+=(127&(n=e.read_shift(1)))<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,a))return}}}function ry(){var e=[],t=tC?256:2048,r=function(e){var t=ey(e);return Qb(t,0),t},n=r(t),i=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},s=function(e){return n&&e<n.length-n.l?n:(i(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){i(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return i(),lC(e)},_bufs:e}}function ny(e,t,r){var n=bw(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iy(e,t,r){var n=bw(e);return n.s=ny(n.s,t.s,r),n.e=ny(n.e,t.s,r),n}function sy(e,t){if(e.cRel&&e.c<0)for(e=bw(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=bw(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=hy(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function oy(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?sy(e.s,t.biff)+":"+sy(e.e,t.biff):(e.s.rRel?"":"$")+ly(e.s.r)+":"+(e.e.rRel?"":"$")+ly(e.e.r):(e.s.cRel?"":"$")+uy(e.s.c)+":"+(e.e.cRel?"":"$")+uy(e.e.c)}function ay(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function ly(e){return""+(e+1)}function cy(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function uy(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function dy(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function hy(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function py(e){var t=e.indexOf(":");return-1==t?{s:dy(e),e:dy(e)}:{s:dy(e.slice(0,t)),e:dy(e.slice(t+1))}}function gy(e,t){return"undefined"===typeof t||"number"===typeof t?gy(e.s,e.e):("string"!==typeof e&&(e=hy(e)),"string"!==typeof t&&(t=hy(t)),e==t?e:e+":"+t)}function fy(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function my(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=QC(e.z,r?cw(t):t)}catch(n){}try{return e.w=QC((e.XF||{}).numFmtId||(r?14:0),r?cw(t):t)}catch(n){return""+t}}function vy(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Uy[e.v]||e.v:my(e,void 0==t?e.v:t))}function Cy(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function wy(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense;var s=e||(i?[]:{}),o=0,a=0;if(s&&null!=n.origin){if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?dy(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=fy(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==o&&(c.e.r=o=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var p={v:t[d][h]},g=o+d,f=a+h;if(c.s.r>g&&(c.s.r=g),c.s.c>f&&(c.s.c=f),c.e.r<g&&(c.e.r=g),c.e.c<f&&(c.e.c=f),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),null===p.v)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else{if(!n.sheetStubs)continue;p.t="z"}else"number"===typeof p.v?p.t="n":"boolean"===typeof p.v?p.t="b":p.v instanceof Date?(p.z=n.dateNF||bC[14],n.cellDates?(p.t="d",p.w=QC(p.z,cw(p.v))):(p.t="n",p.v=cw(p.v),p.w=QC(p.z,p.v))):p.t="s";else p=t[d][h];if(i)s[g]||(s[g]=[]),s[g][f]&&s[g][f].z&&(p.z=s[g][f].z),s[g][f]=p;else{var m=hy({c:f,r:g});s[m]&&s[m].z&&(p.z=s[m].z),s[m]=p}}}return c.s.c<1e7&&(s["!ref"]=gy(c)),s}function by(e,t){return wy(null,e,t)}function yy(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Sy(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ey(e,t){var r=e.l,n=e.read_shift(1),i=yy(e),s=[],o={t:i,h:i};if(0!==(1&n)){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(Sy(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var Ry=Ey;function Ty(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function xy(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var ky=yy;function Py(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var Ay=yy,Fy=Py;function Dy(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var i=0===n?_b([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Ub(t,0)>>2;return r?i/100:i}function Iy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var My=Iy;function Oy(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ly(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Ny=80,_y=[Ny,81],Gy={1:{n:"CodePage",t:2},2:{n:"Category",t:Ny},3:{n:"PresentationFormat",t:Ny},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Ny},15:{n:"Company",t:Ny},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Ny},27:{n:"ContentStatus",t:Ny},28:{n:"Language",t:Ny},29:{n:"Version",t:Ny},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},By={1:{n:"CodePage",t:2},2:{n:"Title",t:Ny},3:{n:"Subject",t:Ny},4:{n:"Author",t:Ny},5:{n:"Keywords",t:Ny},6:{n:"Comments",t:Ny},7:{n:"Template",t:Ny},8:{n:"LastAuthor",t:Ny},9:{n:"RevNumber",t:Ny},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Ny},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Hy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zy=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Vy(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Wy=bw(Vy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Uy={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$y={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var Ky={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Yy(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function qy(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(Hw)||[]).forEach((function(e){var i=Ww(e);if("<Relationship"===i[0]){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o="External"===i.TargetMode?i.Target:Nw(i.Target,t);r[o]=s,n[i.Id]=s}})),r["!id"]=n,r}var Xy=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Jy=function(){for(var e=new Array(Xy.length),t=0;t<Xy.length;++t){var r=Xy[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Qy(e){var t={};e=nb(e);for(var r=0;r<Xy.length;++r){var n=Xy[r],i=e.match(Jy[r]);null!=i&&i.length>0&&(t[n[1]]=Kw(i[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Cw(t[n[1]]))}return t}var Zy=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function eS(e,t,r,n){var i=[];if("string"==typeof e)i=ub(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map((function(e){return{v:e}})));var o="string"==typeof t?ub(t,n).map((function(e){return e.v})):t,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l)}a+=l}}var tS=/<[^>]+>[^<]*/g;var rS,nS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function iS(e,t,r){rS||(rS=aw(nS)),e[t=rS[t]||t]=r}function sS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function oS(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function aS(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function lS(e,t,r){return 31===t?aS(e):oS(e,0,r)}function cS(e,t,r){return lS(e,t,!1===r?0:4)}function uS(e){var t=e.l,r=pS(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,pS(e,3)]}function dS(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,1200===t?"utf16le":"utf8").replace(cC,"").replace(uC,"!"),1200===t&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function hS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function pS(e,t,r){var n,i=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&i!==t&&-1===_y.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&i)))throw new Error("Expected type "+t+" saw "+i);switch(12===t?i:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return oS(e,0,4).replace(cC,"");case 31:return aS(e);case 64:return sS(e);case 65:return hS(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return cS(e,i,!s.raw).replace(cC,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return lS(e,t,0)}(e,i).replace(cC,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(uS(e));return r}(e);case 4126:case 4127:return 4127==i?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(cC,""),e.l-i&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(cC,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function gS(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=e.read_shift(4),d=e.read_shift(4);s[o]=[u,d+r]}s.sort((function(e,t){return e[1]-t[1]}));var h={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1)}if((!t||0==o)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[s[o][0]];if(h[g.n]=pS(e,g.t,{raw:!0}),"version"===g.p&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(65535&h[g.n])).slice(-4)),"CodePage"==g.n)switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Uv(a=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(1===s[o][0]){if(a=h.CodePage=pS(e,2),Uv(a),-1!==l){var f=e.l;e.l=s[l][1],c=dS(e,a),e.l=f}}else if(0===s[o][0]){if(0===a){l=o,e.l=s[o+1][1];continue}c=dS(e,a)}else{var m,v=c[s[o][0]];switch(e[e.l]){case 65:e.l+=4,m=hS(e);break;case 30:case 31:e.l+=4,m=cS(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=vS(e,4);break;case 64:e.l+=4,m=Cw(sS(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=m}}return e.l=r+n,h}function fS(e,t,r){var n=e.content;if(!n)return{};Qb(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==iw.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(i=n.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),1===i&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);2===i&&(o=n.read_shift(16),l=n.read_shift(4));var d,h=gS(n,t),p={SystemIdentifier:c};for(var g in h)p[g]=h[g];if(p.FMTID=s,1===i)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{d=gS(n,null)}catch(f){}for(g in d)p[g]=d[g];return p.FMTID=[s,o],p}function mS(e,t){return e.read_shift(t),null}function vS(e,t){return 1===e.read_shift(t)}function CS(e){return e.read_shift(2,"u")}function wS(e,t){return function(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}(e,t,CS)}function bS(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=Bv;(r&&r.biff>=8&&(Bv=1200),r&&8!=r.biff)?12==r.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return Bv=s,o}function yS(e){var t=Bv;Bv=1200;var r,n=e.read_shift(2),i=e.read_shift(1),s=4&i,o=8&i,a=1+(1&i),l=0,c={};o&&(l=e.read_shift(2)),s&&(r=e.read_shift(4));var u=2==a?"dbcs-cont":"sbcs-cont",d=0===n?"":e.read_shift(n,u);return o&&(e.l+=4*l),s&&(e.l+=r),c.t=d,o||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Bv=t,c}function SS(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function ES(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):SS(e,n,r)}function RS(e,t,r){if(r.biff>5)return ES(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function TS(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(cC,"");return n&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(i>>1,"utf16le").replace(cC,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function xS(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(cC,""):""}function kS(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function PS(e,t){var r=kS(e);return r[3]=0,r}function AS(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function FS(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function DS(e){return[e.read_shift(2),Dy(e)]}function IS(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function MS(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var OS=MS;function LS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function NS(e){e.l+=2,e.l+=e.read_shift(2)}var _S={0:NS,4:NS,5:NS,6:NS,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:NS,9:NS,10:NS,11:NS,12:NS,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:NS,15:NS,16:NS,17:NS,18:NS,19:NS,20:NS,21:LS};function GS(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function BS(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var i=e.read_shift(2);return r&&2==r.biff&&(n=1-(i>>15),i&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},i]}var HS=RS;function zS(e,t,r){var n=e.l+t,i=8!=r.biff&&r.biff?2:4,s=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function VS(e,t,r){var n=AS(e);2!=r.biff&&9!=t||++e.l;var i=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}var WS=function(e,t,r){return 0===t?"":RS(e,0,r)};function US(e,t,r){var n,i=e.read_shift(2),s={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=bS(e,0,r),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"===typeof n&&(s.Name=n),s}var jS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $S(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=SS(e,o,r);32&i&&(c=jS[c.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var d=n!=e.l&&0!==a&&u>0?function(e,t,r,n){var i,s=e.l+t,o=OR(e,n,r);s!==e.l&&(i=MR(e,s-e.l,o,r));return[o,i]}(e,u,r,a):[];return{chKey:s,Name:c,itab:l,rgce:d}}function KS(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=bS(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)n.push(FS(e,r.biff,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function YS(e,t,r){var n=OS(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,HR(e,t,r)]}var qS={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function XS(e,t,r){if(!r.cellStyles)return Zb(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var JS=AS,QS=wS,ZS=ES;var eE=[2,3,48,49,131,139,140,245],tE=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=aw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var i=by(function(t,r){var n=[],i=nC(1);switch(r.type){case"base64":i=sC(eC(t));break;case"binary":i=sC(t);break;case"buffer":case"array":i=t}Qb(i,0);var s=i.read_shift(1),o=!!(136&s),a=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:a=!0,o=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=i.read_shift(2)),i.l+=3,2!=s&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=i.read_shift(2));var d=i.read_shift(2),h=r.codepage||1252;2!=s&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(h=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var p=[],g={},f=Math.min(i.length,2==s?521:u-10-(a?264:0)),m=l?32:11;i.l<f&&13!=i[i.l];)switch((g={}).name=Yv.utils.decode(h,i.slice(i.l,i.l+m)).replace(/[\u0000\r\n].*$/g,""),i.l+=m,g.type=String.fromCharCode(i.read_shift(1)),2==s||l||(g.offset=i.read_shift(4)),g.len=i.read_shift(1),2==s&&(g.offset=i.read_shift(2)),g.dec=i.read_shift(1),g.name.length&&p.push(g),2!=s&&(i.l+=l?13:14),g.type){case"B":a&&8==g.len||!r.WTF||console.log("Skipping "+g.name+":"+g.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+g.name+":"+g.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+g.type)}if(13!==i[i.l]&&(i.l=u-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u;var v=0,C=0;for(n[0]=[],C=0;C!=p.length;++C)n[0][C]=p[C].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,n[++v]=[],C=0,C=0;C!=p.length;++C){var w=i.slice(i.l,i.l+p[C].len);i.l+=p[C].len,Qb(w,0);var b=Yv.utils.decode(h,w);switch(p[C].type){case"C":b.trim().length&&(n[v][C]=b.replace(/\s+$/,""));break;case"D":8===b.length?n[v][C]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):n[v][C]=b;break;case"F":n[v][C]=parseFloat(b.trim());break;case"+":case"I":n[v][C]=l?2147483648^w.read_shift(-4,"i"):w.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":n[v][C]=!0;break;case"N":case"F":n[v][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[v][C]="##MEMO##"+(l?parseInt(b.trim(),10):w.read_shift(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(n[v][C]=+b||0);break;case"@":n[v][C]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":n[v][C]=new Date(864e5*(w.read_shift(4)-2440588)+w.read_shift(4));break;case"Y":n[v][C]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][C]=-w.read_shift(-8,"f");break;case"B":if(a&&8==p[C].len){n[v][C]=w.read_shift(8,"f");break}case"G":case"P":w.l+=p[C].len;break;case"0":if("_NullFlags"===p[C].name)break;default:throw new Error("DBF Unsupported data type "+p[C].type)}}else i.l+=d;if(2!=s&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=p,n}(t,n),n);return i["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,i}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Cy(r(e,t),t)}catch(n){if(t&&t.WTF)throw n}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var i=r||{};if(+i.codepage>=0&&Uv(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var s=ry(),o=rk(e,{header:1,raw:!0,cellDates:!0}),a=o[0],l=o.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,p=1;for(u=0;u<a.length;++u)if(((c[u]||{}).DBF||{}).name)a[u]=c[u].DBF.name,++h;else if(null!=a[u]){if(++h,"number"===typeof a[u]&&(a[u]=a[u].toString(10)),"string"!==typeof a[u])throw new Error("DBF Invalid column name "+a[u]+" |"+typeof a[u]+"|");if(a.indexOf(a[u])!==u)for(d=0;d<1024;++d)if(-1==a.indexOf(a[u]+"_"+d)){a[u]+="_"+d;break}}var g=fy(e["!ref"]),f=[],m=[],v=[];for(u=0;u<=g.e.c-g.s.c;++u){var C="",w="",b=0,y=[];for(d=0;d<l.length;++d)null!=l[d][u]&&y.push(l[d][u]);if(0!=y.length&&null!=a[u]){for(d=0;d<y.length;++d){switch(typeof y[d]){case"number":w="B";break;case"string":default:w="C";break;case"boolean":w="L";break;case"object":w=y[d]instanceof Date?"D":"C"}b=Math.max(b,String(y[d]).length),C=C&&C!=w?"C":w}b>250&&(b=250),"C"==(w=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>b&&(b=c[u].DBF.len),"B"==C&&"N"==w&&(C="N",v[u]=c[u].DBF.dec,b=c[u].DBF.len),m[u]="C"==C||"N"==w?b:n[C]||0,p+=m[u],f[u]=C}else f[u]="?"}var S=s.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*h),S.write_shift(2,p),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[Hv]||3)<<8),u=0,d=0;u<a.length;++u)if(null!=a[u]){var E=s.next(32),R=(a[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,R,"sbcs"),E.write_shift(1,"?"==f[u]?"C":f[u],"sbcs"),E.write_shift(4,d),E.write_shift(1,m[u]||n[f[u]]||0),E.write_shift(1,v[u]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),d+=m[u]||n[f[u]]||0}var T=s.next(264);for(T.write_shift(4,13),u=0;u<65;++u)T.write_shift(4,0);for(u=0;u<l.length;++u){var x=s.next(p);for(x.write_shift(1,0),d=0;d<a.length;++d)if(null!=a[d])switch(f[d]){case"L":x.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":x.write_shift(8,l[u][d]||0,"f");break;case"N":var k="0";for("number"==typeof l[u][d]&&(k=l[u][d].toFixed(v[d]||0)),h=0;h<m[d]-k.length;++h)x.write_shift(1,32);x.write_shift(1,k,"sbcs");break;case"D":l[u][d]?(x.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),x.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),x.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):x.write_shift(8,"00000000","sbcs");break;case"C":var P=String(null!=l[u][d]?l[u][d]:"").slice(0,m[d]);for(x.write_shift(1,P,"sbcs"),h=0;h<m[d]-P.length;++h)x.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),rE=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+ow(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?Jv(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:Jv(n)};function i(e,i){var s,o=e.split(/[\n\r]+/),a=-1,l=-1,c=0,u=0,d=[],h=[],p=null,g={},f=[],m=[],v=[],C=0;for(+i.codepage>=0&&Uv(+i.codepage);c!==o.length;++c){C=0;var w,b=o[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),y=b.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),S=y[0];if(b.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==y[1].charAt(0)&&h.push(b.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,R=!1,T=!1,x=!1,k=-1,P=-1;for(u=1;u<y.length;++u)switch(y[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(y[u].slice(1))-1,R=!0;break;case"Y":for(a=parseInt(y[u].slice(1))-1,R||(l=0),s=d.length;s<=a;++s)d[s]=[];break;case"K":'"'===(w=y[u].slice(1)).charAt(0)?w=w.slice(1,w.length-1):"TRUE"===w?w=!0:"FALSE"===w?w=!1:isNaN(Sw(w))?isNaN(Rw(w).getDate())||(w=Cw(w)):(w=Sw(w),null!==p&&YC(p)&&(w=pw(w))),"undefined"!==typeof Yv&&"string"==typeof w&&"string"!=(i||{}).type&&(i||{}).codepage&&(w=Yv.utils.decode(i.codepage,w)),E=!0;break;case"E":x=!0;var A=lR(y[u].slice(1),{r:a,c:l});d[a][l]=[d[a][l],A];break;case"S":T=!0,d[a][l]=[d[a][l],"S5S"];break;case"R":k=parseInt(y[u].slice(1))-1;break;case"C":P=parseInt(y[u].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}if(E&&(d[a][l]&&2==d[a][l].length?d[a][l][0]=w:d[a][l]=w,p=null),T){if(x)throw new Error("SYLK shared formula cannot have own formula");var F=k>-1&&d[k][P];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");d[a][l][1]=dR(F[1],{r:a-k,c:l-P})}break;case"F":var D=0;for(u=1;u<y.length;++u)switch(y[u].charAt(0)){case"X":l=parseInt(y[u].slice(1))-1,++D;break;case"Y":for(a=parseInt(y[u].slice(1))-1,s=d.length;s<=a;++s)d[s]=[];break;case"M":C=parseInt(y[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":p=h[parseInt(y[u].slice(1))];break;case"W":for(v=y[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)C=parseInt(v[2],10),m[s-1]=0===C?{hidden:!0}:{wch:C},GE(m[s-1]);break;case"C":m[l=parseInt(y[u].slice(1))-1]||(m[l]={});break;case"R":f[a=parseInt(y[u].slice(1))-1]||(f[a]={}),C>0?(f[a].hpt=C,f[a].hpx=zE(C)):0===C&&(f[a].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}D<1&&(p=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+b)}}return f.length>0&&(g["!rows"]=f),m.length>0&&(g["!cols"]=m),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,g]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return i(eC(e),t);case"binary":return i(e,t);case"buffer":return i(tC&&Buffer.isBuffer(e)?e.toString("binary"):oC(e),t);case"array":return i(ww(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],o=by(n,t);return ow(s).forEach((function(e){o[e]=s[e]})),o}function o(e,t,r,n){var i="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+uR(e.f,{r:r,c:n}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return Cy(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,n,i=["ID;PWXL;N;E"],s=[],a=fy(e["!ref"]),l=Array.isArray(e),c="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=i,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=ME(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=OE(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*HE(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(i,e["!rows"]),i.push("B;Y"+(a.e.r-a.s.r+1)+";X"+(a.e.c-a.s.c+1)+";D"+[a.s.c,a.s.r,a.e.c,a.e.r].join(" "));for(var u=a.s.r;u<=a.e.r;++u)for(var d=a.s.c;d<=a.e.c;++d){var h=hy({r:u,c:d});(r=l?(e[u]||[])[d]:e[h])&&(null!=r.v||r.f&&!r.F)&&s.push(o(r,0,u,d))}return i.join(c)+c+s.join(c)+c+"E"+c}}}(),nE=function(){function e(e,t){for(var r=e.split("\n"),n=-1,i=-1,s=0,o=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){for(var a=r[s].trim().split(","),l=a[0],c=a[1],u=r[++s]||"";1&(u.match(/["]/g)||[]).length&&s<r.length-1;)u+="\n"+r[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){o[++n]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[n][i]=!0:"FALSE"===u?o[n][i]=!1:isNaN(Sw(c))?isNaN(Rw(c).getDate())?o[n][i]=c:o[n][i]=Cw(c):o[n][i]=Sw(c),++i;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),o[n][i++]=""!==u?u:null}if("EOD"===u)break}}else o[++n]=[],i=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,r){return by(function(t,r){switch(r.type){case"base64":return e(eC(t),r);case"binary":return e(t,r);case"buffer":return e(tC&&Buffer.isBuffer(t)?t.toString("binary"):oC(t),r);case"array":return e(ww(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return Cy(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,i){e.push(t),e.push(r+","+n),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,i=[],s=fy(r["!ref"]),o=Array.isArray(r);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,s.e.r-s.s.r+1,""),e(i,"TUPLES",0,s.e.c-s.s.c+1,""),e(i,"DATA",0,0,"");for(var a=s.s.r;a<=s.e.r;++a){t(i,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=hy({r:a,c:l});if(n=o?(r[a]||[])[l]:r[c])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(i,1,0,"="+n.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=QC(n.z||bC[14],cw(Cw(n.v)))),t(i,0,n.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}()}}(),iE=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return by(function(e,t){for(var r=e.split("\n"),n=-1,i=-1,s=0,o=[];s!==r.length;++s){var a=r[s].trim().split(":");if("cell"===a[0]){var l=dy(a[1]);if(o.length<=l.r)for(n=o.length;n<=l.r;++n)o[n]||(o[n]=[]);switch(n=l.r,i=l.c,a[2]){case"t":o[n][i]=a[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":o[n][i]=+a[3];break;case"vtf":var c=a[a.length-1];case"vtc":"nl"===a[3]?o[n][i]=!!+a[4]:o[n][i]=+a[4],"vtf"==a[2]&&(o[n][i]=[o[n][i],c])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(t){if(!t||!t["!ref"])return"";for(var r,n=[],i=[],s="",o=py(t["!ref"]),a=Array.isArray(t),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c)if(s=hy({r:l,c:c}),(r=a?(t[l]||[])[c]:t[s])&&null!=r.v&&"z"!==r.t){switch(i=["cell",s,"t"],r.t){case"s":case"str":i.push(e(r.v));break;case"n":r.f?(i[2]="vtf",i[3]="n",i[4]=r.v,i[5]=e(r.f)):(i[2]="v",i[3]=r.v);break;case"b":i[2]="vt"+(r.f?"f":"c"),i[3]="nl",i[4]=r.v?"1":"0",i[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=cw(Cw(r.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=r.w||QC(r.z||bC[14],u);break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return Cy(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,i,n,o(e),s].join("\n")}}}(),sE=function(){function e(e,t,r,n,i){i.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(Sw(e))?isNaN(Rw(e).getDate())?t[r][n]=e:t[r][n]=Cw(e):t[r][n]=Sw(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},i=!1,s=0,o=0;s<e.length;++s)34==(o=e.charCodeAt(s))?i=!i:!i&&o in t&&(n[o]=(n[o]||0)+1);for(s in o=[],n)Object.prototype.hasOwnProperty.call(n,s)&&o.push([n[s],s]);if(!o.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&o.push([n[s],s]);return o.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[o.pop()[1]]||44}function i(e,t){var r=t||{},i="";var s=r.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=n(e.slice(0,1024)):i=r&&r.FS?r.FS:n(e.slice(0,1024));var a=0,l=0,c=0,u=0,d=0,h=i.charCodeAt(0),p=!1,g=0,f=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=r.dateNF?function(e){var t="number"==typeof e?bC[e]:e;return t=t.replace(rw,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,d),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=Sw(t)))if(!isNaN(Rw(t).getDate())||m&&t.match(m)){n.z=r.dateNF||bC[14];var i=0;m&&t.match(m)&&(t=function(e,t,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(rw)||[]).forEach((function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":s=c;break;case"h":o=c;break;case"s":l=c;break;case"m":o>=0?a=c:i=c}})),l>=0&&-1==a&&i>=0&&(a=i,i=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==o&&-1==a&&-1==l?c:-1==n&&-1==i&&-1==s?u:c+"T"+u}(0,r.dateNF,t.match(m)||[]),i=1),r.cellDates?(n.t="d",n.v=Cw(t,i)):(n.t="n",n.v=cw(Cw(t,i))),!1!==r.cellText&&(n.w=QC(n.z,n.v instanceof Date?cw(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(s[a]||(s[a]=[]),s[a][l]=n):s[hy({c:l,r:a})]=n),u=d+1,f=e.charCodeAt(u),o.e.c<l&&(o.e.c=l),o.e.r<a&&(o.e.r=a),g==h)++l;else if(l=0,++a,r.sheetRows&&r.sheetRows<=a)return!0}e:for(;d<e.length;++d)switch(g=e.charCodeAt(d)){case 34:34===f&&(p=!p);break;case h:case 10:case 13:if(!p&&v())break e}return d-u>0&&v(),s["!ref"]=gy(o),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,r):by(function(t,r){var n=r||{},i=[];if(!t||0===t.length)return i;for(var s=t.split(/[\r\n]/),o=s.length-1;o>=0&&0===s[o].length;)--o;for(var a=10,l=0,c=0;c<=o;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,a=Math.max(a,l);for(c=0;c<=o;++c){i[c]=[];var u=0;for(e(s[c].slice(0,a).trim(),i,c,u,n),u=1;u<=(s[c].length-a)/10+1;++u)e(s[c].slice(a+10*(u-1),a+10*u).trim(),i,c,u,n)}return n.sheetRows&&(i=i.slice(0,n.sheetRows)),i}(t,r),r):i(t,r)}function o(e,t){var r="",n="string"==t.type?[0,0,0,0]:Jx(e,t);switch(t.type){case"base64":r=eC(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Yv?Yv.utils.decode(t.codepage,e):tC&&Buffer.isBuffer(e)?e.toString("binary"):oC(e);break;case"array":r=ww(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=nb(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=nb(r):"binary"==t.type&&"undefined"!==typeof Yv&&t.codepage&&(r=Yv.utils.decode(t.codepage,Yv.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?iE.to_sheet("string"==t.type?r:nb(r),t):s(r,t)}return{to_workbook:function(e,t){return Cy(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,r=[],n=fy(e["!ref"]),i=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var o=[],a=n.s.c;a<=n.e.c;++a){var l=hy({r:s,c:a});if((t=i?(e[s]||[])[a]:e[l])&&null!=t.v){for(var c=(t.w||(vy(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";o.push(c+(0===a?" ":""))}else o.push("          ")}r.push(o.join(""))}return r.join("\n")}}}();var oE=function(){function e(e,t,r){if(e){Qb(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var i=e.read_shift(2),s=n[i]||n[65535],o=e.read_shift(2),a=e.l+o,l=s.f&&s.f(e,o,r);if(e.l=a,t(l,s,i))return}}}function t(t,r){if(!t)return t;var n=r||{};var i=n.dense?[]:{},s="Sheet1",o="",a=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:d=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||bC[14],n.cellDates&&(e[1].t="d",e[1].v=pw(e[1].v))),n.qpro&&e[3]>a&&(i["!ref"]=gy(d),l[s]=i,c.push(s),i=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],s=o||"Sheet"+(a+1),o="");var u=n.dense?(i[e[0].r]||[])[e[0].c]:i[hy(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[hy(e[0])]=e[1]}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=C,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>a&&(i["!ref"]=gy(d),l[s]=i,c.push(s),i=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],s="Sheet"+(a+1)),h>0&&e[0].r>=h)break;n.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[hy(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==a&&(s=e[1])}}),n)}if(i["!ref"]=gy(d),l[o||s]=i,c.push(o||s),!u.length)return{SheetNames:c,Sheets:l};for(var p={},g=[],f=0;f<u.length;++f)l[c[f]]?(g.push(u[f]||c[f]),p[u[f]]=l[u[f]]||l[c[f]]):(g.push(u[f]),p[u[f]]={"!ref":"A1"});return{SheetNames:g,Sheets:p}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var i=e.l+t,s=r(e,0,n);if(s[1].t="s",20768==n.vers){e.l++;var o=e.read_shift(1);return s[1].v=e.read_shift(o,"utf8"),s}return n.qpro&&e.l++,s[1].v=e.read_shift(i-e.l,"cstr"),s}function i(e,t,r){var n=ey(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var i=0;i<n.length;++i){var s=r.charCodeAt(i);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function s(e,t,r){var n=ey(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function o(e,t,r){var n=ey(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function a(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?uy(t):ly(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,r,n){var i=ey(6+n.length);i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),i.write_shift(1,39);for(var s=0;s<n.length;++s){var o=n.charCodeAt(s);i.write_shift(1,o>=128?95:o)}return i.write_shift(1,0),i}function h(e,t){var r=u(e),n=e.read_shift(4),i=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===i?(r[1].t="e",r[1].v=15):0===n&&3489660928===i?(r[1].t="e",r[1].v=42):r[1].v=0,r;var o=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*o)*(i*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function p(e,t,r,n){var i=ey(14);if(i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),0==n)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var s,o=0,a=0,l=0;return n<0&&(o=1,n=-n),a=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,a-31))>>>0))&&(++a,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,i.write_shift(4,s),i.write_shift(4,l),a+=16383+(o?32768:0),i.write_shift(2,a),i}function g(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function f(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var r=ey(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);r[r.l++]=i>127?95:i}return r[r.l++]=0,r}var v={0:{n:"BOF",f:CS},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var i=r(e,0,n);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,n){var i=r(e,0,n);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var i=e.l+t,s=r(e,0,n);if(s[1].v=e.read_shift(8,"f"),n.qpro)e.l=i;else{var o=e.read_shift(2);!function(e,t){Qb(e,0);var r=[],n=0,i="",s="",o="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=a(t[0].c,e.read_shift(2),!0),i=a(t[0].r,e.read_shift(2),!1),r.push(s+i);break;case 2:var h=a(t[0].c,e.read_shift(2),!0),p=a(t[0].r,e.read_shift(2),!1);s=a(t[0].c,e.read_shift(2),!0),i=a(t[0].r,e.read_shift(2),!1),r.push(h+p+":"+s+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var g="";d=e[e.l++];)g+=String.fromCharCode(d);r.push('"'+g.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),o=r.pop(),r.push(["AND","OR"][d-20]+"("+o+","+u+")");break;default:if(d<32&&c[d])u=r.pop(),o=r.pop(),r.push(o+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(n=l[d][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+r.join("|")+"|");var f=r.slice(-n);r.length-=n,r.push(l[d][0]+"("+f.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+o),s),e.l+=o}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:f},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},C={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var i=e.read_shift(2);if(14e3==i){for(r[i]=[0,""],r[i][0]=e.read_shift(2);e[e.l];)r[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:g},40:{n:"FORMULA28",f:function(e,t){var r=g(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:f},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Uv(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=ry(),a=fy(e["!ref"]),l=Array.isArray(e),c=[];dx(n,0,function(e){var t=ey(2);return t.write_shift(2,e),t}(1030)),dx(n,6,function(e){var t=ey(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(a));for(var u=Math.min(a.e.r,8191),d=a.s.r;d<=u;++d)for(var h=ly(d),p=a.s.c;p<=a.e.c;++p){d===a.s.r&&(c[p]=uy(p));var g=c[p]+h,f=l?(e[d]||[])[p]:e[g];if(f&&"z"!=f.t)if("n"==f.t)(0|f.v)==f.v&&f.v>=-32768&&f.v<=32767?dx(n,13,s(d,p,f.v)):dx(n,14,o(d,p,f.v));else dx(n,15,i(d,p,vy(f).slice(0,239)))}return dx(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Uv(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=ry();dx(n,0,function(e){var t=ey(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,i=0,s=0;s<e.SheetNames.length;++s){var o=e.SheetNames[s],a=e.Sheets[o];if(a&&a["!ref"]){++i;var l=py(a["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,i),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,s=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&dx(n,27,m(e.SheetNames[i],s++));var o=0;for(i=0;i<e.SheetNames.length;++i){var a=e.Sheets[e.SheetNames[i]];if(a&&a["!ref"]){for(var l=fy(a["!ref"]),c=Array.isArray(a),u=[],h=Math.min(l.e.r,8191),g=l.s.r;g<=h;++g)for(var f=ly(g),v=l.s.c;v<=l.e.c;++v){g===l.s.r&&(u[v]=uy(v));var C=u[v]+f,w=c?(a[g]||[])[v]:a[C];if(w&&"z"!=w.t)if("n"==w.t)dx(n,23,p(g,v,o,w.v));else dx(n,22,d(g,v,o,vy(w).slice(0,239)))}++o}}return dx(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(sC(eC(e)),r);case"binary":return t(sC(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var aE=function(){var e=sb("t"),t=sb("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var i={t:"s",v:Kw(n[1])},s=r.match(t);return s&&(i.s=function(e){var t={},r=e.match(Hw),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ww(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=Vv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==s[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),i}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(i).map(r).filter((function(e){return e.v}))}}(),lE=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),r.push("</"+i+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),cE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uE=/<(?:\w+:)?r>/,dE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hE(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Kw(nb(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nb(e),r&&(n.h=Xw(n.t))):e.match(uE)&&(n.r=nb(e),n.t=Kw(nb((e.replace(dE,"").match(cE)||[]).join("").replace(Hw,""))),r&&(n.h=lE(aE(n.r)))),n):{t:""}}var pE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,gE=/<(?:\w+:)?(?:si|sstItem)>/g,fE=/<\/(?:\w+:)?(?:si|sstItem)>/;function mE(e){if("undefined"!==typeof Yv)return Yv.utils.encode(Hv,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function vE(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function CE(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function wE(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=vE(e,4),t.U=vE(e,4),t.W=vE(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function bE(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function yE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function SE(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:bE(e,t),v:yE(e,e.length-e.l)}}function EE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function RE(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Hw,(function(e){var r=Ww(e);switch(Uw(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function TE(e){var t,r,n=0,i=mE(e),s=i.length+1;for((t=nC(s))[0]=i.length,r=1;r!=s;++r)t[r]=i[r-1];for(r=s-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var xE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(i){for(var s,o,a,l=mE(i),c=function(e){for(var n=t[e.length-1],i=104,s=e.length-1;s>=0;--s)for(var o=e[s],a=0;7!=a;++a)64&o&&(n^=r[i]),o*=2,--i;return n}(l),u=l.length,d=nC(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(s=c>>8,d[u]=n(e[0],s),--u,s=255&c,o=l[l.length-1],d[u]=n(o,s));u>0;)s=c>>8,d[--u]=n(l[u],s),s=255&c,d[--u]=n(l[u],s);for(u=15,a=15-l.length;a>0;)s=c>>8,d[u]=n(e[a],s),--a,s=255&c,d[--u]=n(l[u],s),--u,--a;return d}}(),kE=function(e){var t=0,r=xE(e);return function(e){var n=function(e,t,r,n,i){var s,o;for(i||(i=t),n||(n=xE(e)),s=0;s!=t.length;++s)o=t[s],o=255&((o^=n[r])>>5|o<<3),i[s]=o,++r;return[i,r,n]}("",e,t,r);return t=n[1],n[0]}};function PE(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=vE(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=vE(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=bE(e,i),t-=i,r.EncryptionVerifier=yE(e,t),r}(e,t),n}var AE=function(){function e(e,r){switch(r.type){case"base64":return t(eC(e),r);case"binary":return t(e,r);case"buffer":return t(tC&&Buffer.isBuffer(e)?e.toString("binary"):oC(e),r);case"array":return t(ww(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,s=/\\\w+\b/g,o=0,a=-1;n=s.exec(e);){if("\\cell"===n[0]){var l=e.slice(o,s.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++a,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][a]=c:r[hy({r:t,c:a})]=c}}o=s.lastIndex}a>i.e.c&&(i.e.c=a)})),r["!ref"]=gy(i),r}return{to_workbook:function(t,r){return Cy(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=fy(e["!ref"]),i=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){r.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)r.push("\\cellx"+(o+1));for(r.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var a=hy({r:s,c:o});(t=i?(e[s]||[])[o]:e[a])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(vy(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function FE(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function DE(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(0===o)return[0,0,t];var a,l=0,c=i+s;switch(a=o/(c>1?2-c:c),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4}return[l/6,a,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),FE(function(e){var t,r=e[0],n=e[1],i=e[2],s=2*n*(i<.5?i:1-i),o=i-s/2,a=[o,o,o],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=s*l,a[0]+=s,a[1]+=t;break;case 1:t=s*(2-l),a[0]+=t,a[1]+=s;break;case 2:t=s*(l-2),a[1]+=s,a[2]+=t;break;case 3:t=s*(4-l),a[1]+=t,a[2]+=s;break;case 4:t=s*(l-4),a[2]+=s,a[0]+=t;break;case 5:t=s*(6-l),a[2]+=t,a[0]+=s}for(var c=0;3!=c;++c)a[c]=Math.round(255*a[c]);return a}(r))}var IE=6;function ME(e){return Math.floor((e+Math.round(128/IE)/256)*IE)}function OE(e){return Math.floor((e-5)/IE*100+.5)/100}function LE(e){return Math.round((e*IE+5)/IE*256)/256}function NE(e){return LE(OE(ME(e)))}function _E(e){var t=Math.abs(e-NE(e)),r=IE;if(t>.005)for(IE=1;IE<15;++IE)Math.abs(e-NE(e))<=t&&(t=Math.abs(e-NE(e)),r=IE);IE=r}function GE(e){e.width?(e.wpx=ME(e.width),e.wch=OE(e.wpx),e.MDW=IE):e.wpx?(e.wch=OE(e.wpx),e.width=LE(e.wch),e.MDW=IE):"number"==typeof e.wch&&(e.width=LE(e.wch),e.wpx=ME(e.width),e.MDW=IE),e.customWidth&&delete e.customWidth}var BE=96;function HE(e){return 96*e/BE}function zE(e){return e*BE/96}var VE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var WE=["numFmtId","fillId","fontId","borderId","xfId"],UE=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var jE=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,o,a){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=ow(bC),i=0;i<n.length;++i)t.NumberFmt[n[i]]=bC[n[i]];var s=e[0].match(Hw);if(s)for(i=0;i<s.length;++i){var o=Ww(s[i]);switch(Uw(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var a=Kw(nb(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=a}ZC(a,l)}break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(l,c,a),(l=s.match(n))&&function(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Hw)||[]).forEach((function(e){var o=Ww(e);switch(Uw(o[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=nb(o.val));break;case"<b":i.bold=o.val?Qw(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Qw(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Qw(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Qw(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Qw(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Qw(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Qw(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<charset":if("1"==o.val)break;o.codepage=Vv[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Qw(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var a=Wy[i.color.index];81==i.color.index&&(a=Wy[1]),a||(a=Wy[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=DE(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}}))}(l,c,o,a),(l=s.match(r))&&function(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Hw)||[]).forEach((function(e){var r=Ww(e);switch(Uw(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":r.patternType&&(i.patternType=r.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),r.indexed&&(i.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(i.bgColor.theme=parseInt(r.theme,10)),r.tint&&(i.bgColor.tint=parseFloat(r.tint)),r.rgb&&(i.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),r.theme&&(i.fgColor.theme=parseInt(r.theme,10)),r.tint&&(i.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(i.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}}))}(l,c,0,a),(l=s.match(i))&&function(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Hw)||[]).forEach((function(e){var r=Ww(e);switch(Uw(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},r.diagonalUp&&(i.diagonalUp=Qw(r.diagonalUp)),r.diagonalDown&&(i.diagonalDown=Qw(r.diagonalDown)),t.Borders.push(i);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}}))}(l,c,0,a),(l=s.match(t))&&function(e,t,r){var n;t.CellXf=[];var i=!1;(e[0].match(Hw)||[]).forEach((function(e){var s=Ww(e),o=0;switch(Uw(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=s)[0],o=0;o<WE.length;++o)n[WE[o]]&&(n[WE[o]]=parseInt(n[WE[o]],10));for(o=0;o<UE.length;++o)n[UE[o]]&&(n[UE[o]]=Qw(n[UE[o]]));if(t.NumberFmt&&n.numFmtId>392)for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var a={};s.vertical&&(a.vertical=s.vertical),s.horizontal&&(a.horizontal=s.horizontal),null!=s.textRotation&&(a.textRotation=s.textRotation),s.indent&&(a.indent=s.indent),s.wrapText&&(a.wrapText=Qw(s.wrapText)),n.alignment=a;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}(l,c,a),c):c}}();var $E=Zb;var KE=Zb;var YE=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qE(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Hw)||[]).forEach((function(e){var i=Ww(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[YE.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function XE(){}function JE(){}var QE=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZE=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var tR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function rR(e,t){var r;e&&0!==e.length||(e=nR());var n={};if(!(r=e.match(tR)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",QE,qE],["fontScheme",ZE,XE],["fmtScheme",eR,JE]].forEach((function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function nR(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[_w];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Zb(e,t)}(e,4);break;case 2:t.xclrValue=kS(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function sR(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=iR(e);break;case 6:n[1]=function(e,t){return Zb(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function oR(e,t,r,n){var i,s=Array.isArray(e);t.forEach((function(t){var o=dy(t.ref);if(s?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[t.ref],!i){i={t:"z"},s?e[o.r][o.c]=i:e[t.ref]=i;var a=fy(e["!ref"]||"BDWGO1000001:A1");a.s.r>o.r&&(a.s.r=o.r),a.e.r<o.r&&(a.e.r=o.r),a.s.c>o.c&&(a.s.c=o.c),a.e.c<o.c&&(a.e.c=o.c);var l=gy(a);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(c.a==n[u].id){c.a=n[u].name||c.a;break}i.c.push(c)}))}var aR=yy;var lR=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,i){var s=!1,o=!1;0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==i.length?s=!0:"["==i.charAt(0)&&(s=!0,i=i.slice(1,-1));var a=n.length>0?0|parseInt(n,10):0,l=i.length>0?0|parseInt(i,10):0;return s?l+=t.c:--l,o?a+=t.r:--a,r+(s?"":"$")+uy(l)+(o?"":"$")+ly(a)}return function(n,i){return t=i,n.replace(e,r)}}(),cR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,uR=function(){return function(e,t){return e.replace(cR,(function(e,r,n,i,s,o){var a=cy(i)-(n?0:t.c),l=ay(o)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==a?"":n?a+1:"["+a+"]")}))}}();function dR(e,t){return e.replace(cR,(function(e,r,n,i,s,o){return r+("$"==n?n+i:uy(cy(i)+t.c))+("$"==s?s+o:ly(ay(o)+t.r))}))}function hR(e,t,r){var n=py(t).s,i=dy(r);return dR(e,{r:i.r-n.r,c:i.c-n.c})}function pR(e){return e.replace(/_xlfn\./g,"")}function gR(e){e.l+=1}function fR(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function mR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return vR(e);12==r.biff&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=fR(e,2),a=fR(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function vR(e){var t=fR(e,2),r=fR(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function CR(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=fR(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),i=fR(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function wR(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function bR(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function yR(e){return[e.read_shift(1),e.read_shift(1)]}function SR(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=vS(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Uy[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Oy(e);break;case 2:r[1]=RS(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ER(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),i=[],s=0;s!=n;++s)i.push((12==r.biff?My:IS)(e,8));return i}function RR(e,t,r){var n=0,i=0;12==r.biff?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--i&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=SR(e,r.biff);return o}function TR(e,t,r){return e.l+=2,[wR(e)]}function xR(e){return e.l+=6,[]}function kR(e){return e.l+=2,[CS(e),1&e.read_shift(2)]}var PR=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var AR={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Zb},3:{n:"PtgAdd",f:gR},4:{n:"PtgSub",f:gR},5:{n:"PtgMul",f:gR},6:{n:"PtgDiv",f:gR},7:{n:"PtgPower",f:gR},8:{n:"PtgConcat",f:gR},9:{n:"PtgLt",f:gR},10:{n:"PtgLe",f:gR},11:{n:"PtgEq",f:gR},12:{n:"PtgGe",f:gR},13:{n:"PtgGt",f:gR},14:{n:"PtgNe",f:gR},15:{n:"PtgIsect",f:gR},16:{n:"PtgUnion",f:gR},17:{n:"PtgRange",f:gR},18:{n:"PtgUplus",f:gR},19:{n:"PtgUminus",f:gR},20:{n:"PtgPercent",f:gR},21:{n:"PtgParen",f:gR},22:{n:"PtgMissArg",f:gR},23:{n:"PtgStr",f:function(e,t,r){return e.l++,bS(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Uy[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Oy(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[XR[i],qR[i],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===s[0]?qR:YR)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,CR(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,mR(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Zb},40:{n:"PtgMemNoMem",f:Zb},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==i&&r>=128&&(r-=256),{r:t,c:r,cRel:i,rRel:n}}(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(16384&s)>>14,a=(32768&s)>>15;if(s&=16383,1==a)for(;i>524287;)i-=1048576;if(1==o)for(;s>8191;)s-=16384;return{r:i,c:s,cRel:o,rRel:a}}(e,0,r);return[n,i]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=function(e,t,r){if(r.biff<8)return vR(e);var n=e.read_shift(12==r.biff?4:2),i=e.read_shift(12==r.biff?4:2),s=fR(e,2),o=fR(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,r);return[n,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,i,CR(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,i,mR(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,i]}},255:{}},FR={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DR={1:{n:"PtgElfLel",f:kR},2:{n:"PtgElfRw",f:TR},3:{n:"PtgElfCol",f:TR},6:{n:"PtgElfRwV",f:TR},7:{n:"PtgElfColV",f:TR},10:{n:"PtgElfRadical",f:TR},11:{n:"PtgElfRadicalS",f:xR},13:{n:"PtgElfColS",f:xR},15:{n:"PtgElfColSV",f:xR},16:{n:"PtgElfRadicalLel",f:kR},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:PR[r>>2&31],idx:n,c:i,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},IR={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&2==r.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:bR},33:{n:"PtgAttrBaxcel",f:bR},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),yR(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),yR(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function MR(e,t,r,n){if(n.biff<8)return Zb(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=RR(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=ER(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&12==n.biff&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return 0!==(t=i-e.l)&&s.push(Zb(e,t)),s}function OR(e,t,r){for(var n,i,s=e.l+t,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=AR[i]||AR[FR[i]],24!==i&&25!==i||(n=(24===i?DR:IR)[e[e.l+1]]),n&&n.f?o.push([n.n,n.f(e,t,r)]):Zb(e,t);return o}function LR(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)if(2===o[0])i.push('"'+o[1].replace(/"/g,'""')+'"');else i.push(o[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var NR={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _R(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function GR(e,t,r){var n=_R(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function BR(e,t,r,n,i){var s,o,a,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,p=0,g="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,C=e[0].length;v<C;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=d.pop(),o=d.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=yw(" ",e[0][f][1][1]);break;case 1:m=yw("\r",e[0][f][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}o+=m,f=-1}d.push(o+NR[w[0]]+s);break;case"PtgIsect":s=d.pop(),o=d.pop(),d.push(o+" "+s);break;case"PtgUnion":s=d.pop(),o=d.pop(),d.push(o+","+s);break;case"PtgRange":s=d.pop(),o=d.pop(),d.push(o+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":a=ny(w[1][1],u,i),d.push(sy(a,c));break;case"PtgRefN":a=r?ny(w[1][1],r,i):w[1][1],d.push(sy(a,c));break;case"PtgRef3d":h=w[1][1],a=ny(w[1][2],u,i);g=GR(n,h,i);d.push(g+"!"+sy(a,c));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],y=w[1][1];b||(b=0);var S=0==(b&=127)?[]:d.slice(-b);d.length-=b,"User"===y&&(y=S.shift()),d.push(y+"("+S.join(",")+")");break;case"PtgBool":d.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(w[1]);break;case"PtgNum":d.push(String(w[1]));break;case"PtgStr":d.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=iy(w[1][1],r?{s:r}:u,i),d.push(oy(l,i));break;case"PtgArea":l=iy(w[1][1],u,i),d.push(oy(l,i));break;case"PtgArea3d":h=w[1][1],l=w[1][2],g=GR(n,h,i),d.push(g+"!"+oy(l,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":p=w[1][2];var E=(n.names||[])[p-1]||(n[0]||[])[p],R=E?E.Name:"SH33TJSNAME"+String(p);R&&"_xlfn."==R.slice(0,6)&&!i.xlfn&&(R=R.slice(6)),d.push(R);break;case"PtgNameX":var T,x=w[1][1];if(p=w[1][2],!(i.biff<=5)){var k="";if(14849==((n[x]||[])[0]||[])[0]||(1025==((n[x]||[])[0]||[])[0]?n[x][p]&&n[x][p].itab>0&&(k=n.SheetNames[n[x][p].itab-1]+"!"):k=n.SheetNames[p-1]+"!"),n[x]&&n[x][p])k+=n[x][p].Name;else if(n[0]&&n[0][p])k+=n[0][p].Name;else{var P=(_R(n,x,i)||"").split(";;");P[p-1]?k=P[p-1]:k+="SH33TJSERRX"}d.push(k);break}x<0&&(x=-x),n[x]&&(T=n[x][p]),T||(T={Name:"SH33TJSERRY"}),d.push(T.Name);break;case"PtgParen":var A="(",F=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:A=yw(" ",e[0][f][1][1])+A;break;case 3:A=yw("\r",e[0][f][1][1])+A;break;case 4:F=yw(" ",e[0][f][1][1])+F;break;case 5:F=yw("\r",e[0][f][1][1])+F;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}d.push(A+d.pop()+F);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":a={c:w[1][1],r:w[1][0]};var D={c:r.c,r:r.r};if(n.sharedf[hy(a)]){var I=n.sharedf[hy(a)];d.push(BR(I,u,D,n,i))}else{var M=!1;for(s=0;s!=n.arrayf.length;++s)if(o=n.arrayf[s],!(a.c<o[0].s.c||a.c>o[0].e.c)&&!(a.r<o[0].s.r||a.r>o[0].e.r)){d.push(BR(o[1],u,D,n,i)),M=!0;break}M||d.push(w[1])}break;case"PtgArray":d.push("{"+LR(w[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(w))}if(3!=i.biff&&f>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var O=!0;switch((w=e[0][f])[1][0]){case 4:O=!1;case 0:m=yw(" ",w[1][1]);break;case 5:O=!1;case 1:m=yw("\r",w[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}d.push((O?m:"")+d.pop()+(O?"":m)),f=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function HR(e,t,r){var n,i=e.l+t,s=2==r.biff?1:2,o=e.read_shift(s);if(65535==o)return[[],Zb(e,t-2)];var a=OR(e,o,r);return t!==o+s&&(n=MR(e,t-o-s,a,r)),e.l=i,[a,n]}function zR(e,t,r){var n,i=e.l+t,s=e.read_shift(2),o=OR(e,s,r);return 65535==s?[[],Zb(e,t-2)]:(t!==s+2&&(n=MR(e,i-s-2,o,r)),[o,n])}function VR(e,t,r){var n=e.l+t,i=AS(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==zb(e,e.l+6))return[Oy(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=function(e,t,r){var n,i=e.l+t,s=2==r.biff?1:2,o=e.read_shift(s);if(65535==o)return[[],Zb(e,t-2)];var a=OR(e,o,r);return t!==o+s&&(n=MR(e,t-o-s,a,r)),e.l=i,[a,n]}(e,n-e.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function WR(e,t,r){var n=e.read_shift(4),i=OR(e,n,r),s=e.read_shift(4);return[i,s>0?MR(e,s,i,r):null]}var UR=WR,jR=WR,$R=WR,KR=WR,YR={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},XR={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function JR(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function QR(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ZR={},eT={};function tT(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function rT(e,t,r,n,i,s){try{n.cellNF&&(e.z=bC[t])}catch(a){if(n.WTF)throw a}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Cw(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==bC[t]&&ZC(tw[t]||"General",t),"e"===e.t)e.w=e.w||Uy[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=FC(e.v);else if("d"===e.t){var o=cw(e.v);e.w=(0|o)===o?o.toString(10):FC(o)}else{if(void 0===e.v)return"";e.w=DC(e.v,eT)}else"d"===e.t?e.w=QC(t,cw(e.v),eT):e.w=QC(t,e.v,eT)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=DE(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=DE(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}var nT=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,iT=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,sT=/<(?:\w:)?hyperlink [^>]*>/gm,oT=/"(\w*:\w*)"/,aT=/<(?:\w:)?col\b[^>]*[\/]?>/g,lT=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,cT=/<(?:\w:)?pageMargins[^>]*\/>/g,uT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,dT=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,hT=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pT(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(iT);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(uT);h?gT(h[0],a,i,r):(h=c.match(dT))&&function(e,t,r,n,i){gT(e.slice(0,e.indexOf(">")),r,n,i)}(h[0],h[1],a,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(oT);g&&function(e,t){var r=fy(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=gy(r))}(a,g[1])}var f=c.match(hT);f&&f[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(fT)||[]).forEach((function(e,r){var n=Ww(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),Qw(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(f[1],i);var m=[];if(t.cellStyles){var v=c.match(aT);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Ww(t[n],!0);i.hidden&&(i.hidden=Qw(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,_E(i.width)),GE(i);s<=o;)e[s++]=bw(i)}}(m,v)}d&&mT(d[1],a,t,l,s,o);var C=u.match(lT);C&&(a["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(C[0]));var w=[],b=u.match(nT);if(b)for(p=0;p!=b.length;++p)w[p]=fy(b[p].slice(b[p].indexOf('"')+1));var y=u.match(sT);y&&function(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Ww(nb(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Kw(s.location))):(s.Target="#"+Kw(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=fy(s.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=hy({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(a,y,n);var S=u.match(cT);if(S&&(a["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(Ww(S[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=gy(l)),t.sheetRows>0&&a["!ref"]){var E=fy(a["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),a["!fullref"]=a["!ref"],a["!ref"]=gy(E))}return m.length>0&&(a["!cols"]=m),w.length>0&&(a["!merges"]=w),a}function gT(e,t,r,n){var i=Ww(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Kw(nb(i.codeName)))}var fT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var mT=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=sb("v"),o=sb("f");return function(a,l,c,u,d,h){for(var p,g,f,m,v,C=0,w="",b=[],y=[],S=0,E=0,R=0,T="",x=0,k=0,P=0,A=0,F=Array.isArray(h.CellXf),D=[],I=[],M=Array.isArray(l),O=[],L={},N=!1,_=!!c.sheetStubs,G=a.split(t),B=0,H=G.length;B!=H;++B){var z=(w=G[B].trim()).length;if(0!==z){var V=0;e:for(C=0;C<z;++C)switch(w[C]){case">":if("/"!=w[C-1]){++C;break e}if(c&&c.cellStyles){if(x=null!=(g=Ww(w.slice(V,C),!0)).r?parseInt(g.r,10):x+1,k=-1,c.sheetRows&&c.sheetRows<x)continue;L={},N=!1,g.ht&&(N=!0,L.hpt=parseFloat(g.ht),L.hpx=zE(L.hpt)),"1"==g.hidden&&(N=!0,L.hidden=!0),null!=g.outlineLevel&&(N=!0,L.level=+g.outlineLevel),N&&(O[x-1]=L)}break;case"<":V=C}if(V>=C)break;if(x=null!=(g=Ww(w.slice(V,C),!0)).r?parseInt(g.r,10):x+1,k=-1,!(c.sheetRows&&c.sheetRows<x)){u.s.r>x-1&&(u.s.r=x-1),u.e.r<x-1&&(u.e.r=x-1),c&&c.cellStyles&&(L={},N=!1,g.ht&&(N=!0,L.hpt=parseFloat(g.ht),L.hpx=zE(L.hpt)),"1"==g.hidden&&(N=!0,L.hidden=!0),null!=g.outlineLevel&&(N=!0,L.level=+g.outlineLevel),N&&(O[x-1]=L)),b=w.slice(C).split(e);for(var W=0;W!=b.length&&"<"==b[W].trim().charAt(0);++W);for(b=b.slice(W),C=0;C!=b.length;++C)if(0!==(w=b[C].trim()).length){if(y=w.match(r),S=C,E=0,R=0,w="<c "+("<"==w.slice(0,1)?">":"")+w,null!=y&&2===y.length){for(S=0,T=y[1],E=0;E!=T.length&&!((R=T.charCodeAt(E)-64)<1||R>26);++E)S=26*S+R;k=--S}else++k;for(E=0;E!=w.length&&62!==w.charCodeAt(E);++E);if(++E,(g=Ww(w.slice(0,E),!0)).r||(g.r=hy({r:x-1,c:k})),p={t:""},null!=(y=(T=w.slice(E)).match(s))&&""!==y[1]&&(p.v=Kw(y[1])),c.cellFormula){if(null!=(y=T.match(o))&&""!==y[1]){if(p.f=Kw(nb(y[1])).replace(/\r\n/g,"\n"),c.xlfn||(p.f=pR(p.f)),y[0].indexOf('t="array"')>-1)p.F=(T.match(i)||[])[1],p.F.indexOf(":")>-1&&D.push([fy(p.F),p.F]);else if(y[0].indexOf('t="shared"')>-1){m=Ww(y[0]);var U=Kw(nb(y[1]));c.xlfn||(U=pR(U)),I[parseInt(m.si,10)]=[m,U,g.r]}}else(y=T.match(/<f[^>]*\/>/))&&I[(m=Ww(y[0])).si]&&(p.f=hR(I[m.si][1],I[m.si][2],g.r));var j=dy(g.r);for(E=0;E<D.length;++E)j.r>=D[E][0].s.r&&j.r<=D[E][0].e.r&&j.c>=D[E][0].s.c&&j.c<=D[E][0].e.c&&(p.F=D[E][1])}if(null==g.t&&void 0===p.v)if(p.f||p.F)p.v=0,p.t="n";else{if(!_)continue;p.t="z"}else p.t=g.t||"n";switch(u.s.c>k&&(u.s.c=k),u.e.c<k&&(u.e.c=k),p.t){case"n":if(""==p.v||null==p.v){if(!_)continue;p.t="z"}else p.v=parseFloat(p.v);break;case"s":if("undefined"==typeof p.v){if(!_)continue;p.t="z"}else f=ZR[parseInt(p.v,10)],p.v=f.t,p.r=f.r,c.cellHTML&&(p.h=f.h);break;case"str":p.t="s",p.v=null!=p.v?nb(p.v):"",c.cellHTML&&(p.h=Xw(p.v));break;case"inlineStr":y=T.match(n),p.t="s",null!=y&&(f=hE(y[1]))?(p.v=f.t,c.cellHTML&&(p.h=f.h)):p.v="";break;case"b":p.v=Qw(p.v);break;case"d":c.cellDates?p.v=Cw(p.v,1):(p.v=cw(Cw(p.v,1)),p.t="n");break;case"e":c&&!1===c.cellText||(p.w=p.v),p.v=jy[p.v]}if(P=A=0,v=null,F&&void 0!==g.s&&null!=(v=h.CellXf[g.s])&&(null!=v.numFmtId&&(P=v.numFmtId),c.cellStyles&&null!=v.fillId&&(A=v.fillId)),rT(p,P,A,c,d,h),c.cellDates&&F&&"n"==p.t&&YC(bC[P])&&(p.t="d",p.v=pw(p.v)),g.cm&&c.xlmeta){var $=(c.xlmeta.Cell||[])[+g.cm-1];$&&"XLDAPR"==$.type&&(p.D=!0)}if(M){var K=dy(g.r);l[K.r]||(l[K.r]=[]),l[K.r][K.c]=p}else l[g.r]=p}}}}O.length>0&&(l["!rows"]=O)}}();var vT=My;function CT(e){return[xy(e),Oy(e),"n"]}var wT=My;var bT=["left","right","top","bottom","header","footer"];function yT(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var i=Kw((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,i,t]}(e);u.s.r=u.s.c=0,u.e.c=a,c=uy(a),t[0].forEach((function(e,r){o[c+ly(r)]={t:"n",v:e,z:t[1]},l=r})),u.e.r<l&&(u.e.r=l),++a})),a>0&&(o["!ref"]=gy(u)),o}var ST=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ET=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],RT=[],TT=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xT(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=Qw(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function kT(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=Qw(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function PT(e){kT(e.WBProps,ST),kT(e.CalcPr,TT),xT(e.WBView,ET),xT(e.Sheets,RT),eT.date1904=Qw(e.WBProps.date1904)}var AT="][*?/\\".split("");function FT(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return AT.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}var DT=/<\w+:workbook/;function IT(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function MT(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],cx[16]={n:"BrtFRTArchID$",f:IT},ty(e,(function(e,a,l){switch(l){case 156:o.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=BR(e.Ptg,0,null,o,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([l,e]):o[0]=[l,e],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(e),o.XTI=o.XTI.concat(e);break;case 35:case 37:n.push(l),i=!0;break;case 36:case 38:n.pop(),i=!1;break;default:if(a.T);else if(!i||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),PT(r),r.Names=s,r.supbooks=o,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Hw,(function(a,l){var c=Ww(a);switch(Uw(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":a.match(DT)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=c[i];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":ST.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=Qw(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(r.WBProps.CodeName=nb(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Kw(nb(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=nb(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Qw(c.hidden||"0")&&(s.Hidden=!0),o=l+a.length;break;case"</definedName>":s.Ref=Kw(nb(e.slice(o,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return a})),-1===vb.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return PT(r),r}(e,r)}function OT(e,t,r,n,i,s,o,a){return".bin"===t.slice(-4)?function(e,t,r,n,i,s,o){if(!e)return e;var a=t||{};n||(n={"!id":{}});var l,c,u,d,h,p,g,f,m,v,C=a.dense?[]:{},w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=[],y=!1,S=!1,E=[];a.biff=12,a["!row"]=0;var R=0,T=!1,x=[],k={},P=a.supbooks||i.supbooks||[[]];if(P.sharedf=k,P.arrayf=x,P.SheetNames=i.SheetNames||i.Sheets.map((function(e){return e.name})),!a.supbooks&&(a.supbooks=P,i.Names))for(var A=0;A<i.Names.length;++A)P[0][A+1]=i.Names[A];var F,D,I=[],M=[],O=!1;if(cx[16]={n:"BrtShortReal",f:CT},ty(e,(function(e,t,A){if(!S)switch(A){case 148:l=e;break;case 0:c=e,a.sheetRows&&a.sheetRows<=c.r&&(S=!0),m=ly(h=c.r),a["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=zE(e.hpt)),M[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":f=ZR[e[1]],u.v=f.t,u.r=f.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==a.cellText&&(u.w=Uy[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=o.CellXf[e[0].iStyleRef])&&rT(u,d.numFmtId,null,a,s,o),p=-1==e[0].c?p+1:e[0].c,a.dense?(C[h]||(C[h]=[]),C[h][p]=u):C[uy(p)+m]=u,a.cellFormula){for(T=!1,R=0;R<x.length;++R){var L=x[R];c.r>=L[0].s.r&&c.r<=L[0].e.r&&p>=L[0].s.c&&p<=L[0].e.c&&(u.F=gy(L[0]),T=!0)}!T&&e.length>3&&(u.f=e[3])}if(w.s.r>c.r&&(w.s.r=c.r),w.s.c>p&&(w.s.c=p),w.e.r<c.r&&(w.e.r=c.r),w.e.c<p&&(w.e.c=p),a.cellDates&&d&&"n"==u.t&&YC(bC[d.numFmtId])){var N=RC(u.v);N&&(u.t="d",u.v=new Date(N.y,N.m-1,N.d,N.H,N.M,N.S,N.u))}F&&("XLDAPR"==F.type&&(u.D=!0),F=void 0),D&&(D=void 0);break;case 1:case 12:if(!a.sheetStubs||y)break;u={t:"z",v:void 0},p=-1==e[0].c?p+1:e[0].c,a.dense?(C[h]||(C[h]=[]),C[h][p]=u):C[uy(p)+m]=u,w.s.r>c.r&&(w.s.r=c.r),w.s.c>p&&(w.s.c=p),w.e.r<c.r&&(w.e.r=c.r),w.e.c<p&&(w.e.c=p),F&&("XLDAPR"==F.type&&(u.D=!0),F=void 0),D&&(D=void 0);break;case 176:E.push(e);break;case 49:F=((a.xlmeta||{}).Cell||[])[e-1];break;case 494:var _=n["!id"][e.relId];for(_?(e.Target=_.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=_):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)a.dense?(C[h]||(C[h]=[]),C[h][p]||(C[h][p]={t:"z",v:void 0}),C[h][p].l=e):(g=hy({c:p,r:h}),C[g]||(C[g]={t:"z",v:void 0}),C[g].l=e);break;case 426:if(!a.cellFormula)break;x.push(e),(v=a.dense?C[h][p]:C[uy(p)+m]).f=BR(e[1],0,{r:c.r,c:p},P,a),v.F=gy(e[0]);break;case 427:if(!a.cellFormula)break;k[hy(e[0].s)]=e[1],(v=a.dense?C[h][p]:C[uy(p)+m]).f=BR(e[1],0,{r:c.r,c:p},P,a);break;case 60:if(!a.cellStyles)break;for(;e.e>=e.s;)I[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},O||(O=!0,_E(e.w/256)),GE(I[e.e+1]);break;case 161:C["!autofilter"]={ref:gy(e)};break;case 476:C["!margins"]=e;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name),(e.above||e.left)&&(C["!outline"]={above:e.above,left:e.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:b.push(A),y=!0;break;case 38:b.pop(),y=!1;break;default:if(t.T);else if(!y||a.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}),a),delete a.supbooks,delete a["!row"],!C["!ref"]&&(w.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(C["!ref"]=gy(l||w)),a.sheetRows&&C["!ref"]){var L=fy(C["!ref"]);a.sheetRows<=+L.e.r&&(L.e.r=a.sheetRows-1,L.e.r>w.e.r&&(L.e.r=w.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>w.e.c&&(L.e.c=w.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),C["!fullref"]=C["!ref"],C["!ref"]=gy(L))}return E.length>0&&(C["!merges"]=E),I.length>0&&(C["!cols"]=I),M.length>0&&(C["!rows"]=M),C}(e,n,r,i,s,o,a):pT(e,n,r,i,s,o,a)}function LT(e,t,r,n,i,s,o,a){return".bin"===t.slice(-4)?function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=[],a=!1;return ty(e,(function(e,n,l){switch(l){case 550:s["!rel"]=e;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(l);break;case 38:o.pop();break;default:if(n.T>0)o.push(l);else if(n.T<0)o.pop();else if(!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,r,i,s):function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s,o={"!type":"chart","!drawel":null,"!rel":""},a=e.match(uT);return a&&gT(a[0],0,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,0,r,i,s)}function NT(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var i in bC)n.NumberFmt[i]=bC[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ty(e,(function(e,i,a){switch(a){case 44:n.NumberFmt[e[0]]=e[1],ZC(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=DE(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(a),o=!0;break;case 38:s.pop(),o=!1;break;default:if(i.T>0)s.push(a);else if(i.T<0)s.pop();else if(!o||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+a.toString(16))}})),n}(e,r,n):jE(e,r,n)}function _T(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return ty(e,(function(e,i,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var i=e.match(pE);if(i){n=i[2].replace(gE,"").split(fE);for(var s=0;s!=n.length;++s){var o=hE(n[s].trim(),t);null!=o&&(r[r.length]=o)}i=Ww(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}(e,r)}function GT(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],i={},s=!1;return ty(e,(function(e,o,a){switch(a){case 632:n.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var s=Ww(i[0]),o={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},a=dy(s.ref);if(!(t.sheetRows&&t.sheetRows<=a.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&hE(l[1])||{r:"",t:"",h:""};o.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),o.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(o.h=c.h),n.push(o)}}}})),n}(e,r)}function BT(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return ty(e,(function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(Hw)||[]).forEach((function(e){var n=Ww(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}function HT(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var i=n||{},s=!1;ty(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||i.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),i)}(e,0,0,n)}function zT(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return ty(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==a?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==a&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:a=e?1:0;break;case 338:a=2;break;case 35:s.push(r),o=!0;break;case 36:s.pop(),o=!1;break;default:if(t.T);else if(!o||i.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i,s=!1,o=2;return e.replace(Hw,(function(e){var t=Ww(e);switch(Uw(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var a=0;a<n.Types.length;++a)n.Types[a].name==t.name&&(i=n.Types[a]);break;case"<rc":1==o?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==o&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+t.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}(e,0,r)}var VT,WT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,UT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jT(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var i,s,o,a=e.match(WT);if(a)for(o=0;o!=a.length;++o)-1===(s=(i=a[o].match(UT))[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):n["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(s+1)]=i[2].slice(1,i[2].length-1);return n}function $T(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,i,s=e.match(WT);if(s)for(i=0;i!=s.length;++i)-1===(n=(r=s[i].match(UT))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function KT(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Qw(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Cw(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Kw(t)]=i}function YT(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Uy[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=FC(e.v):e.w=DC(e.v):e.w=function(e,t){var r=VT[e]||Kw(e);return"General"===r?DC(t):QC(r,t)}(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=VT[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&YC(n)){var i=RC(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function qT(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=VE[n.Pattern]||n.Pattern)}e[t.ID]=t}function XT(e,t,r,n,i,s,o,a,l,c){var u="General",d=n.StyleID,h={};c=c||{};var p=[],g=0;for(void 0===d&&a&&(d=a.StyleID),void 0===d&&o&&(d=o.StyleID);void 0!==s[d]&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&p.push(s[d].Interior),s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Qw(e);break;case"String":n.t="s",n.r=Jw(Kw(e)),n.v=e.indexOf("<")>-1?Kw(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Cw(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=Kw(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jy[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=Jw(t||e))}if(YT(n,u,c),!1!==c.cellFormula)if(n.Formula){var f=Kw(n.Formula);61==f.charCodeAt(0)&&(f=f.slice(1)),n.f=lR(f,i),delete n.Formula,"RC"==n.ArrayRange?n.F=lR("RC:RC",i):n.ArrayRange&&(n.F=lR(n.ArrayRange,i),l.push([fy(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function JT(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function QT(e,t){var r=t||{};ew();var n=qv(gb(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof Yv?Yv.utils.decode(65001,$v(n)):nb(n));var i,s=n.slice(0,1024).toLowerCase(),o=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var a=bw(r);return a.type="string",sE.to_workbook(n,a)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){s.indexOf("<"+e)>=0&&(o=!0)})),o)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return Cy(hx(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach((function(e,r){uk(n,hx(e,t),"Sheet"+(r+1))})),n}(n,r);VT={"General Number":"General","General Date":bC[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":bC[15],"Short Date":bC[14],"Long Time":bC[19],"Medium Time":bC[18],"Short Time":bC[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:bC[2],Standard:bC[4],Percent:bC[10],Scientific:bC[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,d={},h=[],p=r.dense?[]:{},g="",f={},m={},v=jT('<Data ss:Type="String">'),C=0,w=0,b=0,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},R="",T=0,x=[],k={},P={},A=0,F=[],D=[],I={},M=[],O=!1,L=[],N=[],_={},G=0,B=0,H={Sheets:[],WBProps:{date1904:!1}},z={};fb.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";i=fb.exec(n);)switch(i[3]=(V=i[3]).toLowerCase()){case"data":if("data"==V){if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break}if(c[c.length-1][1])break;"/"===i[1]?XT(n.slice(C,i.index),R,v,"comment"==c[c.length-1][0]?I:f,{c:w,r:b},S,M[w],m,L,r):(R="",v=jT(i[0]),C=i.index+i[0].length);break;case"cell":if("/"===i[1])if(D.length>0&&(f.c=D),(!r.sheetRows||r.sheetRows>b)&&void 0!==f.v&&(r.dense?(p[b]||(p[b]=[]),p[b][w]=f):p[uy(w)+ly(b)]=f),f.HRef&&(f.l={Target:Kw(f.HRef)},f.HRefScreenTip&&(f.l.Tooltip=f.HRefScreenTip),delete f.HRef,delete f.HRefScreenTip),(f.MergeAcross||f.MergeDown)&&(G=w+(0|parseInt(f.MergeAcross,10)),B=b+(0|parseInt(f.MergeDown,10)),x.push({s:{c:w,r:b},e:{c:G,r:B}})),r.sheetStubs)if(f.MergeAcross||f.MergeDown){for(var W=w;W<=G;++W)for(var U=b;U<=B;++U)(W>w||U>b)&&(r.dense?(p[U]||(p[U]=[]),p[U][W]={t:"z"}):p[uy(W)+ly(U)]={t:"z"});w=G+1}else++w;else f.MergeAcross?w=G+1:++w;else(f=$T(i[0])).Index&&(w=+f.Index-1),w<y.s.c&&(y.s.c=w),w>y.e.c&&(y.e.c=w),"/>"===i[0].slice(-2)&&++w,D=[];break;case"row":"/"===i[1]||"/>"===i[0].slice(-2)?(b<y.s.r&&(y.s.r=b),b>y.e.r&&(y.e.r=b),"/>"===i[0].slice(-2)&&(m=jT(i[0])).Index&&(b=+m.Index-1),w=0,++b):((m=jT(i[0])).Index&&(b=+m.Index-1),_={},("0"==m.AutoFitHeight||m.Height)&&(_.hpx=parseInt(m.Height,10),_.hpt=HE(_.hpx),N[b]=_),"1"==m.Hidden&&(_.hidden=!0,N[b]=_));break;case"worksheet":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));h.push(g),y.s.r<=y.e.r&&y.s.c<=y.e.c&&(p["!ref"]=gy(y),r.sheetRows&&r.sheetRows<=y.e.r&&(p["!fullref"]=p["!ref"],y.e.r=r.sheetRows-1,p["!ref"]=gy(y))),x.length&&(p["!merges"]=x),M.length>0&&(p["!cols"]=M),N.length>0&&(p["!rows"]=N),d[g]=p}else y={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,c.push([i[3],!1]),l=jT(i[0]),g=Kw(l.Name),p=r.dense?[]:{},x=[],L=[],N=[],z={name:g,Hidden:0},H.Sheets.push(z);break;case"table":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==i[0].slice(-2))break;c.push([i[3],!1]),M=[],O=!1}break;case"style":"/"===i[1]?qT(S,E,r):E=jT(i[0]);break;case"numberformat":E.nf=Kw(jT(i[0]).Format||"General"),VT[E.nf]&&(E.nf=VT[E.nf]);for(var j=0;392!=j&&bC[j]!=E.nf;++j);if(392==j)for(j=57;392!=j;++j)if(null==bC[j]){ZC(E.nf,j);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=jT(i[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!O&&u.wpx>10){O=!0,IE=6;for(var $=0;$<M.length;++$)M[$]&&GE(M[$])}O&&GE(u),M[u.Index-1||M.length]=u;for(var K=0;K<+u.Span;++K)M[M.length]=bw(u);break;case"namedrange":if("/"===i[1])break;H.Names||(H.Names=[]);var Y=Ww(i[0]),q={Name:Y.Name,Ref:lR(Y.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(q.Sheet=H.Sheets.length-1),H.Names.push(q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===i[0].slice(-2))break;"/"===i[1]?R+=n.slice(T,i.index):T=i.index+i[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=jT(i[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===i[0].slice(-2))break;"/"===i[1]?iS(k,V,n.slice(A,i.index)):A=i.index+i[0].length;break;case"styles":case"workbook":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else c.push([i[3],!1]);break;case"comment":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));JT(I),D.push(I)}else c.push([i[3],!1]),I={a:(l=jT(i[0])).Author};break;case"autofilter":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var X=jT(i[0]);p["!autofilter"]={ref:lR(X.Range).replace(/\$/g,"")},c.push([i[3],!0])}break;case"datavalidation":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;default:if(0==c.length&&"document"==i[3])return Tx(n,r);if(0==c.length&&"uof"==i[3])return Tx(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(i[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(i[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(n.slice(A,i.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else A=i.index+i[0].length;break;case"header":p["!margins"]||tT(p["!margins"]={},"xlml"),isNaN(+Ww(i[0]).Margin)||(p["!margins"].header=+Ww(i[0]).Margin);break;case"footer":p["!margins"]||tT(p["!margins"]={},"xlml"),isNaN(+Ww(i[0]).Margin)||(p["!margins"].footer=+Ww(i[0]).Margin);break;case"pagemargins":var Q=Ww(i[0]);p["!margins"]||tT(p["!margins"]={},"xlml"),isNaN(+Q.Top)||(p["!margins"].top=+Q.Top),isNaN(+Q.Left)||(p["!margins"].left=+Q.Left),isNaN(+Q.Right)||(p["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(p["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(i[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(i[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?KT(P,V,F,n.slice(A,i.index)):(F=i,A=i.index+i[0].length);break}if(r.WTF)throw"Unrecognized tag: "+i[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=d),Z.SheetNames=h,Z.Workbook=H,Z.SSF=bw(bC),Z.Props=k,Z.Custprops=P,Z}function ZT(e,t){switch($x(t=t||{}),t.type||"base64"){case"base64":return QT(eC(e),t);case"binary":case"buffer":case"file":return QT(e,t);case"array":return QT(oC(e),t)}}function ex(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Ly(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Ly(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var tx=[60,1084,2066,2165,2175];function rx(e,t,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=zb(r,r.l),c=ux[l],u=0;null!=c&&tx.indexOf(l)>-1;)s=zb(r,r.l+2),u=r.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),a=r.slice(u,r.l+4+s),o.push(a),r.l+=4+s,c=ux[l=zb(r,r.l)];var d=lC(o);Qb(d,0);var h=0;d.lens=[];for(var p=0;p<o.length;++p)d.lens.push(h),h+=o[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,i)}function nx(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=bC[n])}catch(s){if(t.WTF)throw s}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Uy[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=FC(e.v):e.w=DC(e.v):e.w=QC(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&"n"==e.t&&YC(bC[n]||String(n))){var i=RC(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function ix(e,t,r){return{v:e,ixfe:t,t:r}}function sx(e,t){var r={opts:{}},n={};var i,s,o,a,l,c,u,d,h=t.dense?[]:{},p={},g={},f=null,m=[],v="",C={},w="",b={},y=[],S=[],E=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},x=function(e){return e<8?Wy[e]:e<64&&E[e-8]||Wy[e]},k=function(e,t,r){if(!(_>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,i=t.XF.data;i&&i.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=i.patternType,(n=FE(x(i.icvFore)))&&(t.s.fgColor={rgb:n}),(n=FE(x(i.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,i=e,w=hy(e),g&&g.s&&g.e||(g={s:{r:0,c:0},e:{r:0,c:0}}),e.r<g.s.r&&(g.s.r=e.r),e.c<g.s.c&&(g.s.c=e.c),e.r+1>g.e.r&&(g.e.r=e.r+1),e.c+1>g.e.c&&(g.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<y.length;++n)if(!(y[n][0].s.c>e.c||y[n][0].s.r>e.r)&&!(y[n][0].e.c<e.c||y[n][0].e.r<e.r)){t.F=gy(y[n][0]),y[n][0].s.c==e.c&&y[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+BR(y[n][1],0,e,O,P));break}r.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[w]=t}},P={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var A=[],F=[],D=[],I=[],M=!1,O=[];O.SheetNames=P.snames,O.sharedf=P.sharedf,O.arrayf=P.arrayf,O.names=[],O.XTI=[];var L,N=0,_=0,G=0,B=[],H=[];P.codepage=1200,Uv(1200);for(var z=!1;e.l<e.length-1;){var V=e.l,W=e.read_shift(2);if(0===W&&10===N)break;var U=e.l===e.length?0:e.read_shift(2),j=ux[W];if(j&&j.f){if(t.bookSheets&&133===N&&133!==W)break;if(N=W,2===j.r||12==j.r){var $=e.read_shift(2);if(U-=2,!P.enc&&$!==W&&((255&$)<<8|$>>8)!==W)throw new Error("rt mismatch: "+$+"!="+W);12==j.r&&(e.l+=10,U-=10)}var K={};if(K=10===W?j.f(e,U,P):rx(W,j,e,U,P),0==_&&-1===[9,521,1033,2057].indexOf(N))continue;switch(W){case 34:r.opts.Date1904=R.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=K;break;case 66:var Y=Number(K);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}Uv(P.codepage=Y),z=!0;break;case 317:P.rrtabid=K;break;case 25:P.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:P.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:S.push(K);break;case 430:O.push([K]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(K);break;case 24:case 536:L={Name:K.Name,Ref:BR(K.rgce,0,null,O,P)},K.itab>0&&(L.Sheet=K.itab-1),O.names.push(L),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(H[K.itab-1]={ref:gy(K.rgce[0][0][1][2])});break;case 22:P.ExternCount=K;break;case 23:0==O.length&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(K),O.XTI=O.XTI.concat(K);break;case 2196:if(P.biff<8)break;null!=L&&(L.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&P.WTF&&console.error("Password verifier: "+K);break;case 133:p[K.pos]=K,P.snames.push(K.name);break;case 10:if(--_)break;if(g.e){if(g.e.r>0&&g.e.c>0){if(g.e.r--,g.e.c--,h["!ref"]=gy(g),t.sheetRows&&t.sheetRows<=g.e.r){var q=g.e.r;g.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=gy(g),g.e.r=q}g.e.r++,g.e.c++}A.length>0&&(h["!merges"]=A),F.length>0&&(h["!objects"]=F),D.length>0&&(h["!cols"]=D),I.length>0&&(h["!rows"]=I),R.Sheets.push(T)}""===v?C=h:n[v]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===P.biff&&(P.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),P.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(P.biff=5,z=!0,Uv(P.codepage=28591)),8==P.biff&&0==K.BIFFVer&&16==K.dt&&(P.biff=2),_++)break;if(h=t.dense?[]:{},P.biff<8&&!z&&(z=!0,Uv(P.codepage=t.codepage||1252)),P.biff<5||0==K.BIFFVer&&4096==K.dt){""===v&&(v="Sheet1"),g={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-U,name:v};p[X.pos]=X,P.snames.push(v)}else v=(p[V]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),A=[],F=[],P.arrayf=y=[],D=[],I=[],M=!1,T={Hidden:(p[V]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[hy({c:K.c,r:K.r})])&&++K.c,c={ixfe:K.ixfe,XF:S[K.ixfe]||{},v:K.val,t:"n"},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 5:case 517:c={ixfe:K.ixfe,XF:S[K.ixfe],v:K.val,t:K.t},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 638:c={ixfe:K.ixfe,XF:S[K.ixfe],v:K.rknum,t:"n"},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 189:for(var J=K.c;J<=K.C;++J){var Q=K.rkrec[J-K.c][0];c={ixfe:Q,XF:S[Q],v:K.rkrec[J-K.c][1],t:"n"},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:J,r:K.r},c,t)}break;case 6:case 518:case 1030:if("String"==K.val){f=K;break}if((c=ix(K.val,K.cell.ixfe,K.tt)).XF=S[c.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=hy({r:ee,c:te});b[re]?c.f=""+BR(K.formula,0,K.cell,O,P):c.F=((t.dense?(h[ee]||[])[te]:h[re])||{}).F}else c.f=""+BR(K.formula,0,K.cell,O,P)}G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k(K.cell,c,t),f=K;break;case 7:case 519:if(!f)throw new Error("String record expects Formula");f.val=K,(c=ix(K,f.cell.ixfe,"s")).XF=S[c.ixfe],t.cellFormula&&(c.f=""+BR(f.formula,0,f.cell,O,P)),G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k(f.cell,c,t),f=null;break;case 33:case 545:y.push(K);var ne=hy(K[0].s);if(s=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[ne],t.cellFormula&&s){if(!f)break;if(!ne||!s)break;s.f=""+BR(K[1],0,K[0],O,P),s.F=gy(K[0])}break;case 1212:if(!t.cellFormula)break;if(w){if(!f)break;b[hy(f.cell)]=K[0],((s=t.dense?(h[f.cell.r]||[])[f.cell.c]:h[hy(f.cell)])||{}).f=""+BR(K[0],0,i,O,P)}break;case 253:c=ix(m[K.isst].t,K.ixfe,"s"),m[K.isst].h&&(c.h=m[K.isst].h),c.XF=S[c.ixfe],G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:K.ixfe,XF:S[K.ixfe],t:"z"},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t));break;case 190:if(t.sheetStubs)for(var ie=K.c;ie<=K.C;++ie){var se=K.ixfe[ie-K.c];c={ixfe:se,XF:S[se],t:"z"},G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:ie,r:K.r},c,t)}break;case 214:case 516:case 4:(c=ix(K.val,K.ixfe,"s")).XF=S[c.ixfe],G>0&&(c.z=B[c.ixfe>>8&63]),nx(c,t,r.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 0:case 512:1===_&&(g=K);break;case 252:m=K;break;case 1054:if(4==P.biff){B[G++]=K[1];for(var oe=0;oe<G+163&&bC[oe]!=K[1];++oe);oe>=163&&ZC(K[1],G+163)}else ZC(K[1],K[0]);break;case 30:B[G++]=K;for(var ae=0;ae<G+163&&bC[ae]!=K;++ae);ae>=163&&ZC(K,G+163);break;case 229:A=A.concat(K);break;case 93:F[K.cmo[0]]=P.lastobj=K;break;case 438:P.lastobj.TxO=K;break;case 127:P.lastobj.ImData=K;break;case 440:for(l=K[0].s.r;l<=K[0].e.r;++l)for(a=K[0].s.c;a<=K[0].e.c;++a)(s=t.dense?(h[l]||[])[a]:h[hy({c:a,r:l})])&&(s.l=K[1]);break;case 2048:for(l=K[0].s.r;l<=K[0].e.r;++l)for(a=K[0].s.c;a<=K[0].e.c;++a)(s=t.dense?(h[l]||[])[a]:h[hy({c:a,r:l})])&&s.l&&(s.l.Tooltip=K[1]);break;case 28:if(P.biff<=5&&P.biff>=2)break;s=t.dense?(h[K[0].r]||[])[K[0].c]:h[hy(K[0])];var le=F[K[2]];s||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),s=h[K[0].r][K[0].c]={t:"z"}):s=h[hy(K[0])]={t:"z"},g.e.r=Math.max(g.e.r,K[0].r),g.s.r=Math.min(g.s.r,K[0].r),g.e.c=Math.max(g.e.c,K[0].c),g.s.c=Math.min(g.s.c,K[0].c)),s.c||(s.c=[]),o={a:K[1],t:le.TxO.t},s.c.push(o);break;case 2173:S[K.ixfe],K.ext.forEach((function(e){e[0]}));break;case 125:if(!P.cellStyles)break;for(;K.e>=K.s;)D[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},M||(M=!0,_E(K.w/256)),GE(D[K.e+1]);break;case 520:var ce={};null!=K.level&&(I[K.r]=ce,ce.level=K.level),K.hidden&&(I[K.r]=ce,ce.hidden=!0),K.hpt&&(I[K.r]=ce,ce.hpt=K.hpt,ce.hpx=zE(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||tT(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=K;break;case 161:h["!margins"]||tT(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(R.Views[0].RTL=!0);break;case 146:E=K;break;case 2198:d=K;break;case 140:u=K;break;case 442:v?T.CodeName=K||T.name:R.WBProps.CodeName=K||"ThisWorkbook"}}else j||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=U}return r.SheetNames=ow(p).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return p[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&C["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=C)):r.Preamble=C,r.Sheets&&H.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=m,r.SSF=bw(bC),P.enc&&(r.Encryption=P.enc),d&&(r.Themes=d),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),O.names.length>0&&(R.Names=O.names),r.Workbook=R,r}var ox="e0859ff2f94f6810ab9108002b27b3d9",ax="02d5cdd59c2e1b10939708002b2cf9ae";function lx(e,t){var r,n,i,s;if(t||(t={}),$x(t),jv(),t.codepage&&Wv(t.codepage),e.FullPaths){if(iw.find(e,"/encryption"))throw new Error("File is password-protected");r=iw.find(e,"!CompObj"),n=iw.find(e,"/Workbook")||iw.find(e,"/Book")}else{switch(t.type){case"base64":e=sC(eC(e));break;case"binary":e=sC(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Qb(e,0),n={content:e}}if(r&&ex(r),t.bookProps&&!t.bookSheets)i={};else{var o=tC?"buffer":"array";if(n&&n.content)i=sx(n.content,t);else if((s=iw.find(e,"PerfectOffice_MAIN"))&&s.content)i=oE.to_workbook(s.content,(t.type=o,t));else{if(!(s=iw.find(e,"NativeContent_MAIN"))||!s.content)throw(s=iw.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=oE.to_workbook(s.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&iw.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=iw.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");iw.utils.cfb_add(t,i,e.FileIndex[n].content)}})),iw.write(t)}(e))}var a={};return e.FullPaths&&function(e,t,r){var n=iw.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=fS(n,Gy,ax);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var o=iw.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=fS(o,By,ox);for(var l in a)null==t[l]&&(t[l]=a[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(eS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}var cx={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=i/20),r}},1:{f:function(e){return[Ty(e)]}},2:{f:function(e){return[Ty(e),Dy(e),"n"]}},3:{f:function(e){return[Ty(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Ty(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Ty(e),Oy(e),"n"]}},6:{f:function(e){return[Ty(e),yy(e),"str"]}},7:{f:function(e){return[Ty(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,i=Ty(e);i.r=r["!row"];var s=[i,yy(e),"str"];if(r.cellFormula){e.l+=2;var o=jR(e,n-e.l,r);s[3]=BR(o,0,i,r.supbooks,r)}else e.l=n;return s}},9:{f:function(e,t,r){var n=e.l+t,i=Ty(e);i.r=r["!row"];var s=[i,Oy(e),"n"];if(r.cellFormula){e.l+=2;var o=jR(e,n-e.l,r);s[3]=BR(o,0,i,r.supbooks,r)}else e.l=n;return s}},10:{f:function(e,t,r){var n=e.l+t,i=Ty(e);i.r=r["!row"];var s=[i,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var o=jR(e,n-e.l,r);s[3]=BR(o,0,i,r.supbooks,r)}else e.l=n;return s}},11:{f:function(e,t,r){var n=e.l+t,i=Ty(e);i.r=r["!row"];var s=[i,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var o=jR(e,n-e.l,r);s[3]=BR(o,0,i,r.supbooks,r)}else e.l=n;return s}},12:{f:function(e){return[xy(e)]}},13:{f:function(e){return[xy(e),Dy(e),"n"]}},14:{f:function(e){return[xy(e),e.read_shift(1),"e"]}},15:{f:function(e){return[xy(e),e.read_shift(1),"b"]}},16:{f:CT},17:{f:function(e){return[xy(e),yy(e),"str"]}},18:{f:function(e){return[xy(e),e.read_shift(4),"s"]}},19:{f:Ey},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Ay(e),o=$R(e,0,r),a=Py(e);e.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=Wy[n];l&&(t.rgb=FE(l));break;case 2:t.rgb=FE([s,o,a]);break;case 3:t.theme=n}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=yy(e),n}},44:{f:function(e,t){return[e.read_shift(2),yy(e)]}},45:{f:$E},46:{f:KE},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:XS},62:{f:function(e){return[Ty(e),Ey(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=hy(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zb,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=ky(e,t-19),r}},148:{f:vT,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?yy(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Fy(e,t-8),r.name=yy(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:My},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:yy(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:KS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,i=Iy(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=UR(e,n-e.l,r);o[1]=a}else e.l=n;return o}},427:{f:function(e,t,r){var n=e.l+t,i=[My(e,16)];if(r.cellFormula){var s=KR(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return bT.forEach((function(r){t[r]=Oy(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=My(e,16),i=Py(e),s=yy(e),o=yy(e),a=yy(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aR},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=My(e,16);return t.rfx=r.s,t.ref=hy(r.s),e.l+=16,t}},636:{T:-1},637:{f:Ry},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:yy(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ux={6:{f:VR},10:{f:mS},12:{f:CS},13:{f:CS},14:{f:vS},15:{f:vS},16:{f:Oy},17:{f:vS},18:{f:vS},19:{f:CS},20:{f:WS},21:{f:WS},23:{f:KS},24:{f:$S},25:{f:vS},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=RS(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},a,o,s]}}(e,0,r)}},29:{},34:{f:vS},35:{f:US},38:{f:Oy},39:{f:Oy},40:{f:Oy},41:{f:Oy},42:{f:vS},43:{f:vS},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?PE(e,t-2,n):function(e,t,r,n){var i={key:CS(e),verificationBytes:CS(e)};r.password&&(i.verifier=TE(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=kE(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=bS(e,0,r),n}},51:{f:CS},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:vS},65:{f:function(){}},66:{f:CS},77:{},80:{},81:{},82:{},85:{f:CS},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=RS(e,0,r);return e.read_shift(t+n-e.l),i}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((qS[n]||Zb)(e,t,r)),{cmo:[i,n,s],ft:o}}(e,t,r);var n=LS(e),i=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(_S[i](e,r-e.l))}catch(s){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:i}}},94:{},95:{f:vS},96:{},97:{},99:{f:vS},125:{f:XS},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:CS},131:{f:vS},132:{f:vS},133:{f:function(e,t,r){var n=e.read_shift(4),i=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var o=bS(e,0,r);return 0===o.length&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Hy[t]||t,t=e.read_shift(2),r[1]=Hy[t]||t,r}},141:{f:CS},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(PS(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:CS},157:{},158:{},160:{f:QS},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Oy(e),r.footer=Oy(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(DS(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}},193:{f:mS},197:{},198:{},199:{},200:{},201:{},202:{f:vS},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:CS},220:{},221:{f:vS},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return i.patternType=zy[a>>26],n.cellStyles?(i.alc=7&s,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=15&o,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=127&a,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:mS},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(IS(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(yS(e));return s.Count=n,s.Unique=i,s}},253:{f:function(e){var t=AS(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:wS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vS},353:{f:mS},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=SS(e,s),a=[];n>e.l;)a.push(ES(e));return[s,i,o,a]}},431:{f:vS},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var o=e.read_shift(2);e.read_shift(2),CS(e);var a=e.read_shift(2);e.l+=a;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((i+=SS(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?o:2*o))break}if(i.length!==o&&i.length!==2*o)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch(u){return e.l=n+t,{t:i}}}},439:{f:vS},440:{f:function(e,t){var r=IS(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,a,l,c,u,d="";16&i&&(s=xS(e,e.l)),128&i&&(o=xS(e,e.l)),257===(257&i)&&(a=xS(e,e.l)),1===(257&i)&&(l=TS(e,e.l)),8&i&&(d=xS(e,e.l)),32&i&&(c=e.read_shift(16)),64&i&&(u=sS(e)),e.l=r;var h=o||a||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&i&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var p={Target:h};return c&&(p.guid=c),u&&(p.time=u),s&&(p.Tooltip=s),p}(e,t-24);return[r,n]}},441:{},442:{f:ES},443:{},444:{f:CS},445:{},446:{},448:{f:mS},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:mS},512:{f:zS},513:{f:JS},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=AS(e),i=Oy(e);return n.val=i,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=AS(e);2==r.biff&&e.l++;var i=ES(e,e.l,r);return n.val=i,n}},517:{f:VS},519:{f:ZS},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:YS},549:{f:BS},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=DS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),RS(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=MS(e);e.l++;var i=e.read_shift(1);return[zR(e,t-=8,r),i,n]}},2048:{f:function(e,t){e.read_shift(2);var r=IS(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(cC,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:GS},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:mS},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(sR(e,e.l));return{ixfe:r,ext:i}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vS,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2);return[SS(e,n,r),SS(e,i,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var i,s=e.slice(e.l);e.l=n;try{i=Lw(s,{type:"array"})}catch(a){return}var o=Dw(i,"theme/theme/theme1.xml",!0);if(o)return rR(o,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:mS},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:CS},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,16&i&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(PS(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zS},1:{},2:{f:function(e){var t=AS(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=AS(e);++e.l;var r=Oy(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=AS(e);++e.l;var i=RS(e,0,r);return n.t="str",n.val=i,n}},5:{f:VS},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:GS},11:{},22:{f:CS},30:{f:HS},31:{},32:{},33:{f:YS},36:{},37:{f:BS},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:CS},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,i=AS(e),s=e.read_shift(2),o=SS(e,s,r);return e.l=n,i.t="str",i.val=o,i}},223:{},234:{},354:{},421:{},518:{f:VR},521:{f:GS},536:{f:$S},547:{f:US},561:{},579:{},1030:{f:VR},1033:{f:GS},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function dx(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Gb(r)&&e.push(r)}}function hx(e,t){var r=t||{};var n=r.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,a=s&&s.index||e.length,l=Tw(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var f=l[o].trim(),m=f.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=f.split(/<\/t[dh]>/i);for(a=0;a<v.length;++a){var C=v[a].trim();if(C.match(/<t[dh]/i)){for(var w=C,b=0;"<"==w.charAt(0)&&(b=w.indexOf(">"))>-1;)w=w.slice(b+1);for(var y=0;y<g.length;++y){var S=g[y];S.s.c==u&&S.s.r<c&&c<=S.e.r&&(u=S.e.c+1,y=-1)}var E=Ww(C.slice(0,C.indexOf(">")));h=E.colspan?+E.colspan:1,((d=+E.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var R=E.t||E["data-t"]||"";if(w.length)if(w=ob(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),w.length){var T={t:"s",v:w};r.raw||!w.trim().length||"s"==R||("TRUE"===w?T={t:"b",v:!0}:"FALSE"===w?T={t:"b",v:!1}:isNaN(Sw(w))?isNaN(Rw(w).getDate())||(T={t:"d",v:Cw(w)},r.cellDates||(T={t:"n",v:cw(T.v)}),T.z=r.dateNF||bC[14]):T={t:"n",v:Sw(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[hy({r:c,c:u})]=T,u+=h}else u+=h;else u+=h}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0}}return n["!ref"]=gy(p),g.length&&(n["!merges"]=g),n}function px(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=hy({r:r,c:o}),d=n.dense?(e[r]||[])[o]:e[u],h=d&&null!=d.v&&(d.h||Xw(d.w||(vy(d),d.w)||""))||"",p={};a>1&&(p.rowspan=a),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",null!=d.v&&(p["data-v"]=d.v),null!=d.z&&(p["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(pb("td",h,p))}}return"<tr>"+s.join("")+"</tr>"}var gx='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fx="</body></html>";function mx(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function vx(e,t){var r=t||{},n=null!=r.header?r.header:gx,i=null!=r.footer?r.footer:fx,s=[n],o=py(e["!ref"]);r.dense=Array.isArray(e),s.push(mx(0,0,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(px(e,o,a,r));return s.push("</table>"+i),s.join("")}function Cx(e,t,r){var n=r||{};var i=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)i=n.origin;else{var o="string"==typeof n.origin?dy(n.origin):n.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=py(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==i&&(c.e.r=i=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,f=0,m=0,v=0,C=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<a.length&&f<l;++g){var b=a[g];if(bx(b)){if(n.display)continue;p[f]={hidden:!0}}var y=b.children;for(m=v=0;m<y.length;++m){var S=y[m];if(!n.display||!bx(S)){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):ob(S.innerHTML),R=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var T=d[h];T.s.c==v+s&&T.s.r<f+i&&f+i<=T.e.r&&(v=T.e.c+1-s,h=-1)}w=+S.getAttribute("colspan")||1,((C=+S.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:f+i,c:v+s},e:{r:f+i+(C||1)-1,c:v+s+(w||1)-1}});var x={t:"s",v:E},k=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=E&&(0==E.length?x.t=k||"z":n.raw||0==E.trim().length||"s"==k||("TRUE"===E?x={t:"b",v:!0}:"FALSE"===E?x={t:"b",v:!1}:isNaN(Sw(E))?isNaN(Rw(E).getDate())||(x={t:"d",v:Cw(E)},n.cellDates||(x={t:"n",v:cw(x.v)}),x.z=n.dateNF||bC[14]):x={t:"n",v:Sw(E)})),void 0===x.z&&null!=R&&(x.z=R);var P="",A=S.getElementsByTagName("A");if(A&&A.length)for(var F=0;F<A.length&&(!A[F].hasAttribute("href")||"#"==(P=A[F].getAttribute("href")).charAt(0));++F);P&&"#"!=P.charAt(0)&&(x.l={Target:P}),n.dense?(e[f+i]||(e[f+i]=[]),e[f+i][v+s]=x):e[hy({c:v+s,r:f+i})]=x,c.e.c<v+s&&(c.e.c=v+s),v+=w}}++f}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,f-1+i),e["!ref"]=gy(c),f>=l&&(e["!fullref"]=gy((c.e.r=a.length-g+f-1+i,c))),e}function wx(e,t){return Cx((t||{}).dense?[]:{},e,t)}function bx(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function yx(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Kw(t.replace(/<[^>]*>/g,""))]}var Sx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ex(e,t){var r=t||{};var n,i,s,o,a,l,c=gb(e),u=[],d={name:""},h="",p=0,g={},f=[],m=r.dense?[]:{},v={value:""},C="",w=0,b=[],y=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,T={},x=[],k={},P=[],A=1,F=1,D=[],I={Names:[]},M={},O=["",""],L=[],N={},_="",G=0,B=!1,H=!1,z=0;for(fb.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");a=fb.exec(c);)switch(a[3]=a[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===a[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=gy(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=gy(E)),x.length&&(m["!merges"]=x),P.length&&(m["!rows"]=P),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),f.push(s.name),g[s.name]=m,H=!1):"/"!==a[0].charAt(a[0].length-2)&&(s=Ww(a[0],!1),y=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},x=[],P=[],H=!0);break;case"table-row-group":"/"===a[1]?--R:++R;break;case"table-row":case"\u884c":if("/"===a[1]){y+=A,A=1;break}if((o=Ww(a[0],!1))["\u884c\u53f7"]?y=o["\u884c\u53f7"]-1:-1==y&&(y=0),(A=+o["number-rows-repeated"]||1)<10)for(z=0;z<A;++z)R>0&&(P[y+z]={level:R});S=-1;break;case"covered-table-cell":"/"!==a[1]&&++S,r.sheetStubs&&(r.dense?(m[y]||(m[y]=[]),m[y][S]={t:"z"}):m[hy({r:y,c:S})]={t:"z"}),C="",b=[];break;case"table-cell":case"\u6570\u636e":if("/"===a[0].charAt(a[0].length-2))++S,v=Ww(a[0],!1),F=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=r.cellFormula&&(l.f=JR(Kw(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=Kw(v["string-value"]||""),r.dense?(m[y]||(m[y]=[]),m[y][S]=l):m[hy({r:y,c:S})]=l),S+=F-1;else if("/"!==a[1]){C="",w=0,b=[],F=1;var V=A?y+A-1:y;if(++S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),y<E.s.r&&(E.s.r=y),V>E.e.r&&(E.e.r=V),L=[],N={},l={t:(v=Ww(a[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Kw(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(k={s:{r:y,c:S},e:{r:y+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=gy(k),D.push([k,l.F])),v.formula)l.f=JR(v.formula);else for(z=0;z<D.length;++z)y>=D[z][0].s.r&&y<=D[z][0].e.r&&S>=D[z][0].s.c&&S<=D[z][0].e.c&&(l.F=D[z][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(k={s:{r:y,c:S},e:{r:y+(parseInt(v["number-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-columns-spanned"],10)||0)-1}},x.push(k)),v["number-columns-repeated"]&&(F=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=Qw(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=Cw(v["date-value"]),r.cellDates||(l.t="n",l.v=cw(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=gw(v["time-value"])/86400,r.cellDates&&(l.t="d",l.v=pw(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(C=Kw(v["string-value"]),b=[])}}else{if(B=!1,"s"===l.t&&(l.v=C||"",b.length&&(l.R=b),B=0==w),M.Target&&(l.l=M),L.length>0&&(l.c=L,L=[]),C&&!1!==r.cellText&&(l.w=C),B&&(l.t="z",delete l.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=y))for(var W=0;W<A;++W){if(F=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[y+W]||(m[y+W]=[]),m[y+W][S]=0==W?l:bw(l);--F>0;)m[y+W][S+F]=bw(l);else for(m[hy({r:y+W,c:S})]=l;--F>0;)m[hy({r:y+W,c:S+F})]=bw(l);E.e.c<=S&&(E.e.c=S)}S+=(F=parseInt(v["number-columns-repeated"]||"1",10))-1,F=0,l={},C="",b=[]}M={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===a[1]){if((n=u.pop())[0]!==a[3])throw"Bad state: "+n}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((n=u.pop())[0]!==a[3])throw"Bad state: "+n;N.t=C,b.length&&(N.R=b),N.a=_,L.push(N)}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!1]);_="",G=0,C="",w=0,b=[];break;case"creator":"/"===a[1]?_=c.slice(G,a.index):G=a.index+a[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((n=u.pop())[0]!==a[3])throw"Bad state: "+n}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!1]);C="",w=0,b=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===a[1]){if(T[d.name]=h,(n=u.pop())[0]!==a[3])throw"Bad state: "+n}else"/"!==a[0].charAt(a[0].length-2)&&(h="",d=Ww(a[0],!1),u.push([a[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":i=Ww(a[0],!1),h+=Sx[a[3]]["long"===i.style?1:0]}break;case"text":if("/>"===a[0].slice(-2))break;if("/"===a[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(p,a.index)}else p=a.index+a[0].length;break;case"named-range":O=QR((i=Ww(a[0],!1))["cell-range-address"]);var U={Name:i.name,Ref:O[0]+"!"+O[1]};H&&(U.Sheet=f.length),I.Names.push(U);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==a[1]||v&&v["string-value"])Ww(a[0],!1),w=a.index+a[0].length;else{var j=yx(c.slice(w,a.index));C=(C.length>0?C+"\n":"")+j[0]}break;case"database-range":if("/"===a[1])break;try{g[(O=QR(Ww(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:O[1]}}catch(K){}break;case"a":if("/"!==a[1]){if(!(M=Ww(a[0],!1)).href)break;M.Target=Kw(M.href),delete M.href,"#"==M.Target.charAt(0)&&M.Target.indexOf(".")>-1?(O=QR(M.Target.slice(1)),M.Target="#"+O[0]+"!"+O[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(a)}}var $={Sheets:g,SheetNames:f,Workbook:I};return r.bookSheets&&delete $.Sheets,$}function Rx(e,t){t=t||{},Pw(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,i=gb(e);r=fb.exec(i);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=Ww(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Fw(e,"META-INF/manifest.xml"),t);var r=Dw(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ex(nb(r),t);return Pw(e,"meta.xml")&&(n.Props=Qy(Fw(e,"meta.xml"))),n}function Tx(e,t){return Ex(e,t)}function xx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function kx(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):nb(oC(e))}function Px(e){var t=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(t),n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}function Ax(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Fx(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function Dx(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Ix(e){for(var t=[],r=[0];r[0]<e.length;){var n,i=r[0],s=Fx(e,r),o=7&s,a=0;if(0==(s=Math.floor(s/8)))break;switch(o){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:a=4,n=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,n=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Fx(e,r),n=e.slice(r[0],r[0]+a),r[0]+=a;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(s," at offset ").concat(i))}var c={data:n,type:o};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function Mx(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function Ox(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Fx(e,n),s=Ix(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Dx(s[1][0].data),messages:[]};s[2].forEach((function(t){var r=Ix(t.data),i=Dx(r[3][0].data);o.messages.push({meta:r,data:e.slice(n[0],n[0]+i)}),n[0]+=i})),(null==(t=s[3])?void 0:t[0])&&(o.merge=Dx(s[3][0].data)>>>0>0),r.push(o)}return r}function Lx(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Fx(t,r),i=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var o=0,a=0;if(1==s?(a=4+(t[r[0]]>>2&7),o=(224&t[r[0]++])<<3,o|=t[r[0]++]):(a=1+(t[r[0]++]>>2),2==s?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Px(i)],0==o)throw new Error("Invalid offset 0");if(o>i[0].length)throw new Error("Invalid offset beyond length");if(a>=o)for(i.push(i[0].slice(-o)),a-=o;a>=i[i.length-1].length;)i.push(i[i.length-1]),a-=i[i.length-1].length;i.push(i[0].slice(-o,-o+a))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}i.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var u=Px(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Nx(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Lx(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Px(t)}function _x(e,t,r){var n,i=xx(e),s=i.getUint32(8,!0),o=12,a=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],i=t+13;i>=t;--i)n=256*n+e[i];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,o),o+=16),2&s&&(u=i.getFloat64(o,!0),o+=8),4&s&&(d.setTime(d.getTime()+1e3*i.getFloat64(o,!0)),o+=8),8&s&&(l=i.getUint32(o,!0),o+=4),16&s&&(a=i.getUint32(o,!0),o+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:d};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(a>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));n={t:"s",v:r[a]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return n}function Gx(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var i,s=xx(e),o=s.getUint32(4,!0),a=(n>1?12:8)+4*Ax(o&(n>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&o&&(l=s.getUint32(a,!0),a+=4),a+=4*Ax(o&(n>1?12288:4096)),16&o&&(c=s.getUint32(a,!0),a+=4),32&o&&(u=s.getFloat64(a,!0),a+=8),64&o&&(d.setTime(d.getTime()+1e3*s.getFloat64(a,!0)),a+=8),e[2]){case 0:break;case 2:i={t:"n",v:u};break;case 3:i={t:"s",v:t[c]};break;case 5:i={t:"d",v:d};break;case 6:i={t:"b",v:u>0};break;case 7:i={t:"n",v:u/86400};break;case 8:i={t:"e",v:0};break;case 9:if(l>-1)i={t:"s",v:r[l]};else if(c>-1)i={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));i={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return i}(e,t,r,e[0]);case 5:return _x(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Bx(e){return Fx(Ix(e)[1][0].data)}function Hx(e,t){var r=Ix(t.data),n=Dx(r[1][0].data),i=r[3],s=[];return(i||[]).forEach((function(t){var r=Ix(t.data),i=Dx(r[1][0].data)>>>0;switch(n){case 1:s[i]=kx(r[3][0].data);break;case 8:var o=Ix(e[Bx(r[9][0].data)][0].data),a=e[Bx(o[1][0].data)][0],l=Dx(a.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=Ix(a.data);s[i]=c[3].map((function(e){return kx(e.data)})).join("")}})),s}function zx(e,t){var r,n=Ix(t.data),i=(null==(r=null==n?void 0:n[7])?void 0:r[0])?Dx(n[7][0].data)>>>0>0?1:0:-1,s=Mx(n[5],(function(e){return function(e,t){var r,n,i,s,o,a,l,c,u,d,h,p,g,f,m,v,C=Ix(e),w=Dx(C[1][0].data)>>>0,b=Dx(C[2][0].data)>>>0,y=(null==(n=null==(r=C[8])?void 0:r[0])?void 0:n.data)&&Dx(C[8][0].data)>0||!1;if((null==(s=null==(i=C[7])?void 0:i[0])?void 0:s.data)&&0!=t)m=null==(a=null==(o=C[7])?void 0:o[0])?void 0:a.data,v=null==(c=null==(l=C[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=C[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(p=null==(h=C[4])?void 0:h[0])?void 0:p.data,v=null==(f=null==(g=C[3])?void 0:g[0])?void 0:f.data}for(var S=y?4:1,E=xx(m),R=[],T=0;T<m.length/2;++T){var x=E.getUint16(2*T,!0);x<65535&&R.push([T,x])}if(R.length!=b)throw"Expected ".concat(b," cells, found ").concat(R.length);var k=[];for(T=0;T<R.length-1;++T)k[R[T][0]]=v.subarray(R[T][1]*S,R[T+1][1]*S);return R.length>=1&&(k[R[R.length-1][0]]=v.subarray(R[R.length-1][1]*S)),{R:w,cells:k}}(e,i)}));return{nrows:Dx(n[4][0].data)>>>0,data:s.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function Vx(e,t){var r={"!ref":"A1"},n=e[Bx(Ix(t.data)[2][0].data)],i=Dx(n[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return function(e,t,r){var n,i=Ix(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Dx(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Dx(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=gy(s);var o=Ix(i[4][0].data),a=Hx(e,e[Bx(o[4][0].data)][0]),l=(null==(n=o[17])?void 0:n[0])?Hx(e,e[Bx(o[17][0].data)][0]):[],c=Ix(o[3][0].data),u=0;c[1].forEach((function(t){var n=Ix(t.data),i=e[Bx(n[2][0].data)][0],s=Dx(i.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var o=zx(0,i);o.data.forEach((function(e,t){e.forEach((function(e,n){var i=hy({r:u+t,c:n}),s=Gx(e,a,l);s&&(r[i]=s)}))})),u+=o.nrows}))}(e,n[0],r),r}function Wx(e,t){var r={SheetNames:[],Sheets:{}};if(Mx(Ix(t.data)[1],Bx).forEach((function(t){e[t].forEach((function(t){if(2==Dx(t.meta[1][0].data)){var n=function(e,t){var r,n=Ix(t.data),i={name:(null==(r=n[1])?void 0:r[0])?kx(n[1][0].data):"",sheets:[]};return Mx(n[2],Bx).forEach((function(t){e[t].forEach((function(t){6e3==Dx(t.meta[1][0].data)&&i.sheets.push(Vx(e,t))}))})),i}(e,t);n.sheets.forEach((function(e,t){uk(r,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function Ux(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=Nx(e.content)}catch(n){return console.log("?? "+e.content.length+" "+(n.message||n))}try{r=Ox(t)}catch(n){return console.log("## "+(n.message||n))}r.forEach((function(e){s[e.id]=e.messages,o.push(e.id)}))}})),!o.length)throw new Error("File has no messages");var a=(null==(i=null==(n=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:i[0].data)&&1==Dx(s[1][0].meta[1][0].data)&&s[1][0];if(a||o.forEach((function(e){s[e].forEach((function(e){if(1==Dx(e.meta[1][0].data)>>>0){if(a)throw new Error("Document has multiple roots");a=e}}))})),!a)throw new Error("Cannot find Document root");return Wx(s,a)}function jx(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function $x(e){jx([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Kx(e,t,r,n,i,s,o,a,l,c,u,d){try{s[n]=qy(Dw(e,r,!0),t);var h,p=Fw(e,t);switch(a){case"sheet":h=OT(p,t,i,l,s[n],c,u,d);break;case"chart":if(!(h=LT(p,t,i,l,s[n],c))||!h["!drawel"])break;var g=Nw(h["!drawel"].Target,t),f=Yy(g),m=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(Dw(e,g,!0),qy(Dw(e,f,!0),g)),v=Nw(m,g),C=Yy(v);h=yT(Dw(e,v,!0),0,0,qy(Dw(e,C,!0),v),0,h);break;case"macro":b=t,s[n],b.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=h;var w=[];s&&s[n]&&ow(s[n]).forEach((function(r){var i="";if(s[n][r].Type==Ky.CMNT){i=Nw(s[n][r].Target,t);var o=GT(Fw(e,i,!0),i,l);if(!o||!o.length)return;oR(h,o,!1)}s[n][r].Type==Ky.TCMNT&&(i=Nw(s[n][r].Target,t),w=w.concat(function(e,t){var r=[],n=!1,i={},s=0;return e.replace(Hw,(function(o,a){var l=Ww(o);switch(Uw(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=i.t&&r.push(i);break;case"<text>":case"<text":s=a+o.length;break;case"</text>":i.t=e.slice(s,a).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o})),r}(Fw(e,i,!0),l)))})),w&&w.length&&oR(h,w,!0,l.people||[])}catch(y){if(l.WTF)throw y}var b}function Yx(e){return"/"==e.charAt(0)?e.slice(1):e}function qx(e,t){if(ew(),$x(t=t||{}),Pw(e,"META-INF/manifest.xml"))return Rx(e,t);if(Pw(e,"objectdata.xml"))return Rx(e,t);if(Pw(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Ux(e);var r=iw.utils.cfb_new();return Mw(e).forEach((function(t){Ow(r,t,Iw(e,t))})),Ux(r)}if(!Pw(e,"[Content_Types].xml")){if(Pw(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Pw(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,i,s=Mw(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(Hw)||[]).forEach((function(e){var n=Ww(e);switch(n[0].replace(zw,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[$y[n.ContentType]]&&t[$y[n.ContentType]].push(n.PartName)}})),t.xmlns!==mb)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(Dw(e,"[Content_Types].xml")),a=!1;if(0===o.workbooks.length&&Fw(e,i="xl/workbook.xml",!0)&&o.workbooks.push(i),0===o.workbooks.length){if(!Fw(e,i="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(i),a=!0}"bin"==o.workbooks[0].slice(-3)&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(ZR=[],o.sst)try{ZR=_T(Fw(e,Yx(o.sst)),o.sst,t)}catch(F){if(t.WTF)throw F}t.cellStyles&&o.themes.length&&(l=function(e,t,r){return rR(e,r)}(Dw(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],t)),o.style&&(c=NT(Fw(e,Yx(o.style)),o.style,l,t))}o.links.map((function(r){try{qy(Dw(e,Yy(Yx(r))),r);return HT(Fw(e,Yx(r)),0,r,t)}catch(F){}}));var u=MT(Fw(e,Yx(o.workbooks[0])),o.workbooks[0],t),d={},h="";o.coreprops.length&&((h=Fw(e,Yx(o.coreprops[0]),!0))&&(d=Qy(h)),0!==o.extprops.length&&(h=Fw(e,Yx(o.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=nb(e),Zy.forEach((function(r){var i=(e.match(sb(r[0]))||[])[1];switch(r[2]){case"string":i&&(t[r[1]]=Kw(i));break;case"bool":t[r[1]]="true"===i;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1])}})),n.HeadingPairs&&n.TitlesOfParts&&eS(n.HeadingPairs,n.TitlesOfParts,t,r)}(h,d,t));var p={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(h=Dw(e,Yx(o.custprops[0]),!0))&&(p=function(e,t){var r={},n="",i=e.match(tS);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=Ww(o);switch(a[0]){case"<?xml":case"<Properties":break;case"<property":n=Kw(a.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=Kw(u);break;case"bool":r[n]=Qw(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Cw(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",o,c,l)}}else if("</"===o.slice(0,2));else if(t.WTF)throw new Error(o)}}return r}(h,t));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map((function(e){return e.name})):d.Worksheets&&d.SheetNames.length>0&&(n=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&"undefined"!==typeof n&&(g.SheetNames=n),t.bookSheets?g.SheetNames:t.bookProps))return g;n={};var f={};t.bookDeps&&o.calcchain&&(f=BT(Fw(e,Yx(o.calcchain)),o.calcchain));var m,v,C=0,w={},b=u.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var y=0;y!=b.length;++y)d.SheetNames[y]=b[y].name;var S=a?"bin":"xml",E=o.workbooks[0].lastIndexOf("/"),R=(o.workbooks[0].slice(0,E+1)+"_rels/"+o.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Pw(e,R)||(R="xl/_rels/workbook."+S+".rels");var T=qy(Dw(e,R,!0),R.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=zT(Fw(e,Yx(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(Hw,(function(e){var i=Ww(e);switch(Uw(i[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return e})),r}(Fw(e,Yx(o.people[0])),t)),T&&(T=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Ky.WS.indexOf(r)>-1?"sheet":Ky.CS&&r==Ky.CS?"chart":Ky.DS&&r==Ky.DS?"dialog":Ky.MS&&r==Ky.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(F){return null}return e&&0!==e.length?e:null}(T,u.Sheets));var x=Fw(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=d.Worksheets;++C){var k="sheet";if(T&&T[C]?(m="xl/"+T[C][1].replace(/[\/]?xl\//,""),Pw(e,m)||(m=T[C][1]),Pw(e,m)||(m=R.replace(/_rels\/.*$/,"")+T[C][1]),k=T[C][2]):m=(m="xl/worksheets/sheet"+(C+1-x)+"."+S).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(d.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,A=0;A!=t.sheets.length;++A)"number"==typeof t.sheets[A]&&t.sheets[A]==C&&(P=1),"string"==typeof t.sheets[A]&&t.sheets[A].toLowerCase()==d.SheetNames[C].toLowerCase()&&(P=1);if(!P)continue e}}Kx(e,m,v,d.SheetNames[C],C,w,n,k,t,u,l,c)}return g={Directory:o,Workbook:u,Props:d,Custprops:p,Deps:f,Sheets:n,SheetNames:d.SheetNames,Strings:ZR,Styles:c,Themes:l,SSF:bw(bC)},t&&t.bookFiles&&(e.files?(g.keys=s,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),g.keys.push(t),g.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(o.vba.length>0?g.vbaraw=Fw(e,Yx(o.vba[0]),!0):o.defaults&&"application/vnd.ms-office.vbaProject"===o.defaults.bin&&(g.vbaraw=Fw(e,"xl/vbaProject.bin",!0))),g}function Xx(e,t){var r=t||{},n="Workbook",i=iw.find(e,n);try{if(n="/!DataSpaces/Version",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=vE(e,4),t.U=vE(e,4),t.W=vE(e,4)}(i.content),n="/!DataSpaces/DataSpaceMap",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(CE(e));return t}(i.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);wE(i.content)}catch(l){}if(n="/EncryptionInfo",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=function(e){var t=vE(e);switch(t.Minor){case 2:return[t.Minor,SE(e)];case 3:return[t.Minor,EE()];case 4:return[t.Minor,RE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(n="/EncryptedPackage",!(i=iw.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==a[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(a[1],i.content,r.password||"",r);if(2==a[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Jx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=eC(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Qx(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ZT(e.slice(r),t);default:break e}return sE.to_workbook(e,t)}function Zx(e,t,r,n){return n?(r.type="string",sE.to_workbook(e,r)):sE.to_workbook(t,r)}function ek(e,t){jv();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return ek(new Uint8Array(e),((r=bw(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,i=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eT={},r.dateNF&&(eT.dateNF=r.dateNF),r.type||(r.type=tC&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=tC?"buffer":"binary",i=function(e){if("undefined"!==typeof sw)return sw.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||tC||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,i=function(e){return e.match(/[^\x00-\x7F]/)?ib(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return(r=bw(r)).type="array",ek(aC(i),r)}switch((n=Jx(i,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return iw.find(e,"EncryptedPackage")?Xx(e,t):lx(e,t)}(iw.read(i,r),r);break;case 9:if(n[1]<=8)return lx(i,r);break;case 60:return ZT(i,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=rE.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return sE.to_workbook(e,t)}}(i,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return nE.to_workbook(i,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=tC&&Buffer.isBuffer(e)?"buffer":"base64"),qx(Lw(r,n),n)}(i,r):Zx(e,i,r,s);case 239:return 60===n[3]?ZT(i,r):Zx(e,i,r,s);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=eC(r)),r=Yv.utils.decode(1200,r.slice(2),"str"),t.type="binary",Qx(r,t)}(i,r);if(0===n[1]&&2===n[2]&&0===n[3])return oE.to_workbook(i,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return oE.to_workbook(i,r);if(0===n[2]&&(8===n[3]||9===n[3]))return oE.to_workbook(i,r)}break;case 3:case 131:case 139:case 140:return tE.to_workbook(i,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return AE.to_workbook(i,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=Jx(e,t);switch(t.type){case"base64":r=eC(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ww(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=nb(r)),t.type="binary",Qx(r,t)}(i,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return eE.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?tE.to_workbook(i,r):Zx(e,i,r,s)}function tk(e,t,r,n,i,s,o,a){var l=ly(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(m){h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[r][p]:e[n[p]+l];if(void 0!==g&&void 0!==g.t){var f=g.v;switch(g.t){case"z":if(null==f)break;continue;case"e":f=0==f?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(null!=s[p]){if(null==f)if("e"==g.t&&null===f)h[s[p]]=null;else if(void 0!==c)h[s[p]]=c;else{if(!u||null!==f)continue;h[s[p]]=null}else h[s[p]]=u&&("n"!==g.t||"n"===g.t&&!1!==a.rawNumbers)?f:vy(g,f,a);null!=f&&(d=!1)}}else{if(void 0===c)continue;null!=s[p]&&(h[s[p]]=c)}}return{row:h,isempty:d}}function rk(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=fy(u);break;case"number":(l=fy(e["!ref"])).s.r=u;break;default:l=u}n>0&&(i=0);var d=ly(l.s.r),h=[],p=[],g=0,f=0,m=Array.isArray(e),v=l.s.r,C=0,w={};m&&!e[v]&&(e[v]=[]);var b=c.skipHidden&&e["!cols"]||[],y=c.skipHidden&&e["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(b[C]||{}).hidden)switch(h[C]=uy(C),r=m?e[v][C]:e[h[C]+d],n){case 1:s[C]=C-l.s.c;break;case 2:s[C]=h[C];break;case 3:s[C]=c.header[C-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),a=o=vy(r,null,c),f=w[o]||0){do{a=o+"_"+f++}while(w[a]);w[o]=f,w[a]=1}else w[o]=1;s[C]=a}for(v=l.s.r+i;v<=l.e.r;++v)if(!(y[v]||{}).hidden){var S=tk(e,l,v,h,n,s,m,c);(!1===S.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(p[g++]=S.row)}return p.length=g,p}var nk=/"/g;function ik(e,t,r,n,i,s,o,a){for(var l=!0,c=[],u="",d=ly(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=a.dense?(e[r]||[])[h]:e[n[h]+d];if(null==p)u="";else if(null!=p.v){l=!1,u=""+(a.rawNumbers&&"n"==p.t?p.v:vy(p,null,a));for(var g=0,f=0;g!==u.length;++g)if((f=u.charCodeAt(g))===i||f===s||34===f||a.forceQuotes){u='"'+u.replace(nk,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==p.f||p.F?u="":(l=!1,(u="="+p.f).indexOf(",")>=0&&(u='"'+u.replace(nk,'""')+'"'));c.push(u)}return!1===a.blankrows&&l?null:c.join(o)}function sk(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=fy(e["!ref"]),s=void 0!==n.FS?n.FS:",",o=s.charCodeAt(0),a=void 0!==n.RS?n.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(d[g]=uy(g));for(var f=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||null!=(u=ik(e,i,m,d,o,l,s,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&r.push((f++?a:"")+u));return delete n.dense,r.join("")}function ok(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=sk(e,t);if("undefined"==typeof Yv||"string"==t.type)return r;var n=Yv.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function ak(e,t,r){var n,i=r||{},s=+!i.skipHeader,o=e||{},a=0,l=0;if(o&&null!=i.origin)if("number"==typeof i.origin)a=i.origin;else{var c="string"==typeof i.origin?dy(i.origin):i.origin;a=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:a+t.length-1+s}};if(o["!ref"]){var d=fy(o["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==a&&(a=d.e.r+1,u.e.r=a+t.length-1+s)}else-1==a&&(a=0,u.e.r=t.length-1+s);var h=i.header||[],p=0;t.forEach((function(e,t){ow(e).forEach((function(r){-1==(p=h.indexOf(r))&&(h[p=h.length]=r);var c=e[r],u="z",d="",g=hy({c:l+p,r:a+t+s});n=lk(o,g),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",i.cellDates||(u="n",c=cw(c)),d=i.dateNF||bC[14]):null===c&&i.nullError&&(u="e",c=0),n?(n.t=u,n.v=c,delete n.w,delete n.R,d&&(n.z=d)):o[g]=n={t:u,v:c},d&&(n.z=d)):o[g]=c}))})),u.e.c=Math.max(u.e.c,l+h.length-1);var g=ly(a);if(s)for(p=0;p<h.length;++p)o[uy(p+l)+g]={t:"s",v:h[p]};return o["!ref"]=gy(u),o}function lk(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=dy(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return lk(e,hy("number"!=typeof t?t:{r:t,c:r||0}))}function ck(){return{SheetNames:[],Sheets:{}}}function uk(e,t,r,n){var i=1;if(!r)for(;i<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+i);++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(r=o+i);++i);}if(FT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dk(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var hk={encode_col:uy,encode_row:ly,encode_cell:hy,encode_range:gy,decode_col:cy,decode_row:ay,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:dy,decode_range:py,format_cell:vy,sheet_add_aoa:wy,sheet_add_json:ak,sheet_add_dom:Cx,aoa_to_sheet:by,json_to_sheet:function(e,t){return ak(null,e,t)},table_to_sheet:wx,table_to_book:function(e,t){return Cy(wx(e,t),t)},sheet_to_csv:sk,sheet_to_txt:ok,sheet_to_json:rk,sheet_to_html:vx,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var i,s=fy(e["!ref"]),o="",a=[],l=[],c=Array.isArray(e);for(i=s.s.c;i<=s.e.c;++i)a[i]=uy(i);for(var u=s.s.r;u<=s.e.r;++u)for(o=ly(u),i=s.s.c;i<=s.e.c;++i)if(r=a[i]+o,n="",void 0!==(t=c?(e[u]||[])[i]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:rk,sheet_get_cell:lk,book_new:ck,book_append_sheet:uk,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:dk,cell_set_internal_link:function(e,t,r){return dk(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var i="string"!=typeof t?t:fy(t),s="string"==typeof t?t:gy(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=lk(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Gv.version;const pk="excel-files",gk={async uploadExcelFile(e,t){const r=`${t}/${e.name}`,{error:n}=await fv.storage.from(pk).upload(r,e,{upsert:!0,contentType:e.type});if(n)throw console.error("Upload failed:",n.message),n;return r},async parseExcelFileFromStorage(e){const t=await this.getExcelFileFromStorage(e),r=ek(await t.arrayBuffer(),{type:"array"}),n=r.SheetNames[0],i=r.Sheets[n],s=hk.sheet_to_json(i);return console.log(s),s},async getExcelFileFromStorage(e){const{data:t,error:r}=await fv.storage.from(pk).download(e);if(r||!t)throw console.error("Failed to download file for parsing:",null===r||void 0===r?void 0:r.message),r;return t},async getAvailableYearsAndMonths(){const e={},{data:t,error:r}=await fv.storage.from(pk).list("");if(r)return console.error("Failed to list years:",r.message),e;for(const n of t||[]){if(!n.name)continue;const{data:t,error:r}=await fv.storage.from("excel-files").list(n.name);r?console.warn(`Failed to list months for ${n.name}:`,r.message):e[n.name]=(t||[]).filter((e=>e.name)).map((e=>e.name)).sort()}return e}};let fk=function(e){return e.AMERICAN_EXPRESS="American Express",e.LEUMI="Leumi",e.ISRACARD="Isracard",e.MAX="Max",e}({});async function mk(e,t){const r=ek(await e.arrayBuffer(),{type:"buffer"}),n=r.SheetNames[0],i=r.Sheets[n],s=hk.sheet_to_json(i,{defval:""});console.log(s);const o=t(s);return console.log(o),o}const vk={[fk.LEUMI]:new class{excelDateToISO(e){const t=Math.floor(e-25569);return new Date(86400*t*1e3).toISOString().split("T")[0]}formatDDMMYYToISO(e){const[t,r,n]=e.split("/");return`${parseInt(n)<50?"20"+n:"19"+n}-${r}-${t}`}transformRawData(e){return e.filter((e=>e["\u05d1\u05e0\u05e7 \u05dc\u05d0\u05d5\u05de\u05d9 |"]&&"\u05ea\u05d0\u05e8\u05d9\u05da \u05d4\u05e2\u05e1\u05e7\u05d4"!==e["\u05d1\u05e0\u05e7 \u05dc\u05d0\u05d5\u05de\u05d9 |"]&&e.__EMPTY_4)).map((e=>{const t=e["\u05d1\u05e0\u05e7 \u05dc\u05d0\u05d5\u05de\u05d9 |"];let r;return r="number"===typeof t?this.excelDateToISO(t):/^\d{2}\/\d{2}\/\d{2}$/.test(t)?this.formatDDMMYYToISO(t):t,{transactionType:Dg.CHANGING,date:r,vendor:e.__EMPTY||"",amount:parseFloat(e.__EMPTY_1)||0,type:e.__EMPTY_2||"",details:e.__EMPTY_3||"",billedAmount:parseFloat(e.__EMPTY_4)||0}}))}async parseExcelFile(e){return mk(e,this.transformRawData.bind(this))}},[fk.MAX]:new class{transformRawData(e){const t=Object.keys(e[0])[0];return e.filter((e=>e.__EMPTY_3&&!isNaN(Number(e.__EMPTY_3)))).map((e=>({transactionType:Dg.CHANGING,date:e[t]||"",vendor:e.__EMPTY||"",amount:parseFloat(e.__EMPTY_5),type:e.__EMPTY_2||"",details:e.__EMPTY_8||"",billedAmount:parseFloat(e.__EMPTY_3)})))}async parseExcelFile(e){return mk(e,this.transformRawData)}},[fk.ISRACARD]:new class{transformRawData(e){const t=Object.keys(e[1])[0];return e.filter((e=>e.__EMPTY_2&&!isNaN(Number(e.__EMPTY_2)))).map((e=>({transactionType:Dg.CHANGING,date:e[t]||"",vendor:e.__EMPTY_1||"",category:e[""]||"",amount:parseFloat(e.__EMPTY_2),billedAmount:parseFloat(e.__EMPTY_4)})))}async parseExcelFile(e){return mk(e,this.transformRawData)}},[fk.AMERICAN_EXPRESS]:new class{transformRawData(e){return e.filter((e=>!isNaN(Number(e.__EMPTY_1))||!isNaN(Number(e.__EMPTY_2)))).map((e=>isNaN(Number(e.__EMPTY_1))?{transactionType:Dg.CONSTANT,date:e["\u05d0\u05de\u05e8\u05d9\u05e7\u05df \u05d0\u05e7\u05e1\u05e4\u05e8\u05e1 \u05d6\u05d4\u05d1 - 5147"]||"",vendor:e.__EMPTY_1||"",amount:parseFloat(e.__EMPTY_2),billedAmount:parseFloat(e.__EMPTY_4)}:{transactionType:Dg.CONSTANT,date:e["\u05d0\u05de\u05e8\u05d9\u05e7\u05df \u05d0\u05e7\u05e1\u05e4\u05e8\u05e1 \u05d6\u05d4\u05d1 - 5147"]||"",vendor:e.__EMPTY||"",amount:parseFloat(e.__EMPTY_1),details:e.__EMPTY_6||"",billedAmount:parseFloat(e.__EMPTY_3)}))}async parseExcelFile(e){return mk(e,this.transformRawData)}}},Ck={[_v.AMERICAN_EXPRESS]:fk.AMERICAN_EXPRESS,[_v.LEUMI]:fk.LEUMI,[_v.ISRACARD]:fk.ISRACARD,[_v.MAX]:fk.MAX,[_v.LIFE_STYLE]:fk.ISRACARD,[_v.ONE_ZERO]:fk.ISRACARD},wk={[_v.AMERICAN_EXPRESS]:5147,[_v.LEUMI]:9432,[_v.ISRACARD]:6940,[_v.MAX]:2423,[_v.LIFE_STYLE]:3869,[_v.ONE_ZERO]:9456},bk=e=>{let{year:t,month:r,setYear:n,setMonth:i,onLoad:s}=e;const[o,a]=(0,u.useState)(""),[l,c]=(0,u.useState)({});(0,u.useEffect)((()=>{(async()=>{const e=await gk.getAvailableYearsAndMonths();if(c(e),!t||!r){var s;const o=Object.keys(e).sort(((e,t)=>Number(e)-Number(t))).at(-1)||"",a=((null===(s=e[o])||void 0===s?void 0:s.sort(((e,t)=>Number(e)-Number(t))))||[]).at(-1)||"";t||n(o),r||i(a)}})()}),[n,i,t,r]);const d=(0,u.useCallback)((async()=>{if(!t||!r)return void a("\u05d9\u05e9 \u05dc\u05d1\u05d7\u05d5\u05e8 \u05e9\u05e0\u05d4 \u05d5\u05d7\u05d5\u05d3\u05e9");const e=`${t}/${r}`,n=await Promise.all(Object.values(_v).map((n=>(async n=>{const i=`${e}/${wk[n]}_${r}_${t}.xlsx`;try{a("\u05d8\u05d5\u05e2\u05df \u05d0\u05ea \u05d4\u05e7\u05d5\u05d1\u05e5 \u05de\u05d4\u05d0\u05d7\u05e1\u05d5\u05df...");const e=await gk.parseExcelFileFromStorage(i);a("\u2705 \u05d4\u05e7\u05d5\u05d1\u05e5 \u05e0\u05d8\u05e2\u05df \u05d1\u05d4\u05e6\u05dc\u05d7\u05d4");const t=vk[Ck[n]];return t?t.transformRawData(e).map((e=>({...e,source:n}))):[]}catch(s){return console.error(s),a("\u274c \u05d4\u05e7\u05d5\u05d1\u05e5 \u05dc\u05d0 \u05e0\u05de\u05e6\u05d0 \u05d0\u05d5 \u05e9\u05d2\u05d9\u05d0\u05d4 \u05d1\u05e7\u05e8\u05d9\u05d0\u05d4"),[]}})(n))));s(n.flat())}),[t,r,s]);(0,u.useEffect)((()=>{t&&r&&d()}),[t,r,d]);const h=(0,u.useMemo)((()=>Object.keys(l).sort(((e,t)=>Number(e)-Number(t)))),[l]),p=(l[t]||[]).sort(((e,t)=>Number(e)-Number(t)));return l&&0!==Object.keys(l).length?(0,Ov.jsxs)("div",{className:"transaction-file-loader-container",dir:"rtl",children:[(0,Ov.jsx)("h2",{className:"transaction-file-loader-title",children:"\u05d8\u05e2\u05d9\u05e0\u05ea \u05e7\u05d5\u05d1\u05e5 \u05e2\u05e1\u05e7\u05d0\u05d5\u05ea \u05de\u05d4\u05d0\u05d7\u05e1\u05d5\u05df"}),(0,Ov.jsxs)("div",{className:"transaction-file-loader-selects",children:[(0,Ov.jsxs)("label",{children:["\u05e9\u05e0\u05d4:",(0,Ov.jsxs)("select",{value:h.includes(t)?t:"",onChange:e=>n(e.target.value),children:[(0,Ov.jsx)("option",{value:"",children:"\u05d1\u05d7\u05e8"}),h.map((e=>(0,Ov.jsx)("option",{value:e,children:e},e)))]})]}),(0,Ov.jsxs)("label",{children:["\u05d7\u05d5\u05d3\u05e9:",(0,Ov.jsxs)("select",{value:p.includes(r)?r:"",onChange:e=>i(e.target.value),children:[(0,Ov.jsx)("option",{value:"",children:"\u05d1\u05d7\u05e8"}),p.map((e=>(0,Ov.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,Ov.jsx)("p",{className:"transaction-file-loader-status",children:o})]}):(0,Ov.jsx)("div",{children:"\u05d8\u05d5\u05e2\u05df..."})},yk=e=>e.toLocaleString("he-IL",{maximumFractionDigits:0}),Sk=e=>{let{transactions:t,title:r,onCategoryClick:n,sumCalculation:i}=e;const s=(e=>{const t={};for(const n of e){var r;const e=`${n.category||"\u05dc\u05dc\u05d0 \u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"}::${n.transactionType||"\u05dc\u05d0 \u05d9\u05d3\u05d5\u05e2"}`,i=null!==(r=n.billedAmount)&&void 0!==r?r:0;t[e]=(t[e]||0)+i}return[...Object.entries(t).map((e=>{let[t,r]=e;const[n,i]=t.split("::");return{category:n,transactionType:i,total:r}}))].sort(((e,t)=>"\u05dc\u05dc\u05d0 \u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"===e.category?1:"\u05dc\u05dc\u05d0 \u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"===t.category?-1:e.category.localeCompare(t.category,"he")))})(t),o=Object.values(s).reduce(((e,t)=>e+t.total),0);return(0,u.useEffect)((()=>{i&&i(o)}),[o,i]),(0,Ov.jsxs)("div",{className:"summary-container",children:[r&&(0,Ov.jsx)("h3",{className:"summary-title",children:r}),(0,Ov.jsxs)("table",{className:"summary-table",children:[(0,Ov.jsx)("thead",{children:(0,Ov.jsxs)("tr",{children:[(0,Ov.jsx)("th",{children:"\u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"}),(0,Ov.jsx)("th",{children:"\u05e1\u05d4\u05f4\u05db"})]})}),(0,Ov.jsxs)("tbody",{children:[s.filter((e=>{let{total:t}=e;return t>0})).map((e=>{let{category:t,total:r}=e;return(0,Ov.jsxs)("tr",{children:[(0,Ov.jsx)("td",{onClick:()=>null===n||void 0===n?void 0:n(t),children:t}),(0,Ov.jsxs)("td",{className:"amount",children:[yk(r),"  \u20aa"]})]},`${t}`)})),(0,Ov.jsxs)("tr",{className:"summary-sum",children:[(0,Ov.jsx)("td",{onClick:()=>null===n||void 0===n?void 0:n(void 0),children:"\u05e1\u05d4\u05f4\u05db"}),(0,Ov.jsxs)("td",{children:[yk(o),"  \u20aa"]})]})]})]})]})};let Ek=function(e){return e.TAL_SALARY="\u05d4\u05de\u05e9\u05db\u05d5\u05e8\u05ea \u05e9\u05dc \u05d8\u05dc",e.RAVID_SALARY="\u05d4\u05de\u05e9\u05db\u05d5\u05e8\u05ea \u05e9\u05dc \u05e8\u05d1\u05d9\u05d3",e.RENT="\u05e9\u05db\u05d9\u05e8\u05d5\u05ea",e.CHILDREN_ALLOWANCE="\u05e7\u05e6\u05d1\u05ea \u05d9\u05dc\u05d3\u05d9\u05dd",e}({});class Rk{static async getIncomes(){const{data:e,error:t}=await fv.from("incomes").select("*");return t?[]:e.map((e=>({year:e.year,month:e.month,amount:e.amount,type:e.type})))}static async getIncomesByYearAndMonth(e,t){if(e&&t){const{data:r,error:n}=await fv.from("incomes").select("*").eq("year",e).eq("month",t);return n?[]:r.map((e=>({year:e.year,month:e.month,amount:e.amount,type:Ek[e.type]})))}return[]}}const Tk=e=>e.toLocaleString("he-IL",{maximumFractionDigits:0}),xk=e=>{let{sumCalculation:t,year:r,month:n}=e;const[i,s]=(0,u.useState)([]);(0,u.useEffect)((()=>{(async(e,t)=>{const r=await Rk.getIncomesByYearAndMonth(e,t);s(r)})(r,n)}),[r,n]);const o=i.reduce(((e,t)=>e+t.amount),0);return(0,u.useEffect)((()=>{t&&t(o)}),[o,t]),(0,Ov.jsxs)("div",{className:"summary-container",dir:"rtl",children:[(0,Ov.jsx)("h3",{className:"summary-title",children:"\u05d4\u05db\u05e0\u05e1\u05d5\u05ea \u05d7\u05d5\u05d3\u05e9\u05d9\u05d5\u05ea"}),(0,Ov.jsxs)("table",{className:"summary-table",children:[(0,Ov.jsx)("thead",{children:(0,Ov.jsxs)("tr",{children:[(0,Ov.jsx)("th",{children:"\u05e7\u05d8\u05d2\u05d5\u05e8\u05d9\u05d4"}),(0,Ov.jsx)("th",{children:"\u05e1\u05d4\u05f4\u05db"})]})}),(0,Ov.jsxs)("tbody",{children:[i.map(((e,t)=>(0,Ov.jsxs)("tr",{children:[(0,Ov.jsx)("td",{children:e.type}),(0,Ov.jsxs)("td",{className:"amount",children:[Tk(e.amount)," \u20aa"]})]},t))),(0,Ov.jsxs)("tr",{className:"summary-sum",children:[(0,Ov.jsx)("td",{children:"\u05e1\u05d4\u05f4\u05db"}),(0,Ov.jsxs)("td",{children:[Tk(o)," \u20aa"]})]})]})]})]})},kk=e=>{let{sumIncomes:t,sumConstantTransactions:r,sumChangingTransactions:n}=e;const i=t-r-n,s=e=>`${e<0?"-":" "} ${Math.abs(e).toLocaleString("he-IL",{maximumFractionDigits:0})+" \u20aa"}`;return(0,Ov.jsxs)("div",{className:"summary-container",children:[(0,Ov.jsx)("h3",{className:"summary-title",children:"\u05e1\u05d9\u05db\u05d5\u05dd \u05d7\u05d5\u05d3\u05e9\u05d9"}),(0,Ov.jsxs)("pre",{className:"summary-equation",children:[s(t),"\n",s(-r),"\n",s(-n),"\n","____________","\n"]}),(0,Ov.jsx)("pre",{className:"summary-sum",children:s(i)})]})};function Pk(){return Pk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pk.apply(this,arguments)}var Ak;!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(Ak||(Ak={}));const Fk="popstate";function Dk(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function Ik(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function Mk(e,t){return{usr:e.state,key:e.key,idx:t}}function Ok(e,t,r,n){return void 0===r&&(r=null),Pk({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?Nk(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function Lk(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function Nk(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function _k(e,t,r,n){void 0===n&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=Ak.Pop,l=null,c=u();function u(){return(o.state||{idx:null}).idx}function d(){a=Ak.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:a,location:p.location,delta:t})}function h(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,r="string"===typeof e?e:Lk(e);return r=r.replace(/ $/,"%20"),Dk(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==c&&(c=0,o.replaceState(Pk({},o.state,{idx:c}),""));let p={get action(){return a},get location(){return e(i,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Fk,d),l=e,()=>{i.removeEventListener(Fk,d),l=null}},createHref:e=>t(i,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){a=Ak.Push;let n=Ok(p.location,e,t);r&&r(n,e),c=u()+1;let d=Mk(n,c),h=p.createHref(n);try{o.pushState(d,"",h)}catch(g){if(g instanceof DOMException&&"DataCloneError"===g.name)throw g;i.location.assign(h)}s&&l&&l({action:a,location:p.location,delta:1})},replace:function(e,t){a=Ak.Replace;let n=Ok(p.location,e,t);r&&r(n,e),c=u();let i=Mk(n,c),d=p.createHref(n);o.replaceState(i,"",d),s&&l&&l({action:a,location:p.location,delta:0})},go:e=>o.go(e)};return p}var Gk;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Gk||(Gk={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function Bk(e,t,r){return void 0===r&&(r="/"),Hk(e,t,r,!1)}function Hk(e,t,r,n){let i=eP(("string"===typeof t?Nk(t):t).pathname||"/",r);if(null==i)return null;let s=zk(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=Zk(i);o=Jk(s[a],e,n)}return o}function zk(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(Dk(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(n.length));let a=sP([n,o.relativePath]),l=r.concat(o);e.children&&e.children.length>0&&(Dk(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),zk(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:Xk(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of Vk(e.path))i(e,t,n);else i(e,t)})),t}function Vk(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===n.length)return i?[s,""]:[s];let o=Vk(n.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const Wk=/^:[\w-]+$/,Uk=3,jk=2,$k=1,Kk=10,Yk=-2,qk=e=>"*"===e;function Xk(e,t){let r=e.split("/"),n=r.length;return r.some(qk)&&(n+=Yk),t&&(n+=jk),r.filter((e=>!qk(e))).reduce(((e,t)=>e+(Wk.test(t)?Uk:""===t?$k:Kk)),n)}function Jk(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,i={},s="/",o=[];for(let a=0;a<n.length;++a){let e=n[a],l=a===n.length-1,c="/"===s?t:t.slice(s.length)||"/",u=Qk({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=Qk({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:sP([s,u.pathname]),pathnameBase:oP(sP([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=sP([s,u.pathnameBase]))}return o}function Qk(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);Ik("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,n]}(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:i}=t;if("*"===n){let e=a[r]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[r];return e[n]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function Zk(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return Ik(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function eP(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function tP(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function rP(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function nP(e,t){let r=rP(e);return t?r.map(((e,t)=>t===r.length-1?e.pathname:e.pathnameBase)):r.map((e=>e.pathnameBase))}function iP(e,t,r,n){let i;void 0===n&&(n=!1),"string"===typeof e?i=Nk(e):(i=Pk({},e),Dk(!i.pathname||!i.pathname.includes("?"),tP("?","pathname","search",i)),Dk(!i.pathname||!i.pathname.includes("#"),tP("#","pathname","hash",i)),Dk(!i.search||!i.search.includes("#"),tP("#","search","hash",i)));let s,o=""===e||""===i.pathname,a=o?"/":i.pathname;if(null==a)s=r;else{let e=t.length-1;if(!n&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:i=""}="string"===typeof e?Nk(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:aP(n),hash:lP(i)}}(i,s),c=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const sP=e=>e.join("/").replace(/\/\/+/g,"/"),oP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),aP=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",lP=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function cP(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const uP=["post","put","patch","delete"],dP=(new Set(uP),["get",...uP]);new Set(dP),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function hP(){return hP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hP.apply(this,arguments)}const pP=u.createContext(null);const gP=u.createContext(null);const fP=u.createContext(null);const mP=u.createContext(null);const vP=u.createContext({outlet:null,matches:[],isDataRoute:!1});const CP=u.createContext(null);function wP(){return null!=u.useContext(mP)}function bP(){return wP()||Dk(!1),u.useContext(mP).location}function yP(e){u.useContext(fP).static||u.useLayoutEffect(e)}function SP(){let{isDataRoute:e}=u.useContext(vP);return e?function(){let{router:e}=DP(AP.UseNavigateStable),t=MP(FP.UseNavigateStable),r=u.useRef(!1);return yP((()=>{r.current=!0})),u.useCallback((function(n,i){void 0===i&&(i={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,hP({fromRouteId:t},i)))}),[e,t])}():function(){wP()||Dk(!1);let e=u.useContext(pP),{basename:t,future:r,navigator:n}=u.useContext(fP),{matches:i}=u.useContext(vP),{pathname:s}=bP(),o=JSON.stringify(nP(i,r.v7_relativeSplatPath)),a=u.useRef(!1);return yP((()=>{a.current=!0})),u.useCallback((function(r,i){if(void 0===i&&(i={}),!a.current)return;if("number"===typeof r)return void n.go(r);let l=iP(r,JSON.parse(o),s,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:sP([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)}),[t,n,o,s,e])}()}function EP(e,t,r,n){wP()||Dk(!1);let{navigator:i}=u.useContext(fP),{matches:s}=u.useContext(vP),o=s[s.length-1],a=o?o.params:{},l=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let c,d=bP();if(t){var h;let e="string"===typeof t?Nk(t):t;"/"===l||(null==(h=e.pathname)?void 0:h.startsWith(l))||Dk(!1),c=e}else c=d;let p=c.pathname||"/",g=p;if("/"!==l){let e=l.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let f=Bk(e,{pathname:g});let m=PP(f&&f.map((e=>Object.assign({},e,{params:Object.assign({},a,e.params),pathname:sP([l,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:sP([l,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,r,n);return t&&m?u.createElement(mP.Provider,{value:{location:hP({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ak.Pop}},m):m}function RP(){let e=function(){var e;let t=u.useContext(CP),r=IP(FP.UseRouteError),n=MP(FP.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=cP(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),r?u.createElement("pre",{style:i},r):null,null)}const TP=u.createElement(RP,null);class xP extends u.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?u.createElement(vP.Provider,{value:this.props.routeContext},u.createElement(CP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kP(e){let{routeContext:t,match:r,children:n}=e,i=u.useContext(pP);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),u.createElement(vP.Provider,{value:t},n)}function PP(e,t,r,n){var i;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var s;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(s=n)&&s.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let o=e,a=null==(i=r)?void 0:i.errors;if(null!=a){let e=o.findIndex((e=>e.route.id&&void 0!==(null==a?void 0:a[e.route.id])));e>=0||Dk(!1),o=o.slice(0,Math.min(o.length,e+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let e=o[u];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=u),e.route.id){let{loaderData:t,errors:n}=r,i=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||i){l=!0,o=c>=0?o.slice(0,c+1):[o[0]];break}}}return o.reduceRight(((e,n,i)=>{let s,d=!1,h=null,p=null;var g;r&&(s=a&&n.route.id?a[n.route.id]:void 0,h=n.route.errorElement||TP,l&&(c<0&&0===i?(g="route-fallback",!1||OP[g]||(OP[g]=!0),d=!0,p=null):c===i&&(d=!0,p=n.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,i+1)),m=()=>{let t;return t=s?h:d?p:n.route.Component?u.createElement(n.route.Component,null):n.route.element?n.route.element:e,u.createElement(kP,{match:n,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===i)?u.createElement(xP,{location:r.location,revalidation:r.revalidation,component:h,error:s,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}var AP=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(AP||{}),FP=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(FP||{});function DP(e){let t=u.useContext(pP);return t||Dk(!1),t}function IP(e){let t=u.useContext(gP);return t||Dk(!1),t}function MP(e){let t=function(){let e=u.useContext(vP);return e||Dk(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||Dk(!1),r.route.id}const OP={};function LP(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}d.startTransition;function NP(e){let{to:t,replace:r,state:n,relative:i}=e;wP()||Dk(!1);let{future:s,static:o}=u.useContext(fP),{matches:a}=u.useContext(vP),{pathname:l}=bP(),c=SP(),d=iP(t,nP(a,s.v7_relativeSplatPath),l,"path"===i),h=JSON.stringify(d);return u.useEffect((()=>c(JSON.parse(h),{replace:r,state:n,relative:i})),[c,h,i,r,n]),null}function _P(e){Dk(!1)}function GP(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ak.Pop,navigator:s,static:o=!1,future:a}=e;wP()&&Dk(!1);let l=t.replace(/^\/*/,"/"),c=u.useMemo((()=>({basename:l,navigator:s,static:o,future:hP({v7_relativeSplatPath:!1},a)})),[l,a,s,o]);"string"===typeof n&&(n=Nk(n));let{pathname:d="/",search:h="",hash:p="",state:g=null,key:f="default"}=n,m=u.useMemo((()=>{let e=eP(d,l);return null==e?null:{location:{pathname:e,search:h,hash:p,state:g,key:f},navigationType:i}}),[l,d,h,p,g,f,i]);return null==m?null:u.createElement(fP.Provider,{value:c},u.createElement(mP.Provider,{children:r,value:m}))}function BP(e){let{children:t,location:r}=e;return EP(HP(t),r)}new Promise((()=>{}));u.Component;function HP(e,t){void 0===t&&(t=[]);let r=[];return u.Children.forEach(e,((e,n)=>{if(!u.isValidElement(e))return;let i=[...t,n];if(e.type===u.Fragment)return void r.push.apply(r,HP(e.props.children,i));e.type!==_P&&Dk(!1),e.props.index&&e.props.children&&Dk(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=HP(e.props.children,i)),r.push(s)})),r}function zP(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map((e=>[r,e])):[[r,n]])}),[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(QP){}new Map;const VP=d.startTransition;Rd.flushSync,d.useId;function WP(e){let{basename:t,children:r,future:n,window:i}=e,s=u.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:i,v5Compat:!0})&&(o={}),_k((function(e,t){let{pathname:r,search:n,hash:i}=e.location;return Ok("",{pathname:r,search:n,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:Lk(t)}),null,o)));let a=s.current,[l,c]=u.useState({action:a.action,location:a.location}),{v7_startTransition:d}=n||{},h=u.useCallback((e=>{d&&VP?VP((()=>c(e))):c(e)}),[c,d]);return u.useLayoutEffect((()=>a.listen(h)),[a,h]),u.useEffect((()=>LP(n)),[n]),u.createElement(GP,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:a,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var UP,jP;function $P(e){let t=u.useRef(zP(e)),r=u.useRef(!1),n=bP(),i=u.useMemo((()=>function(e,t){let r=zP(e);return t&&t.forEach(((e,n)=>{r.has(n)||t.getAll(n).forEach((e=>{r.append(n,e)}))})),r}(n.search,r.current?null:t.current)),[n.search]),s=SP(),o=u.useCallback(((e,t)=>{const n=zP("function"===typeof e?e(i):e);r.current=!0,s("?"+n,t)}),[s,i]);return[i,o]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(UP||(UP={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(jP||(jP={}));const KP=e=>{let{transactions:t,onCategoryClick:r,year:n,month:i}=e;const[s,o]=(0,u.useState)(0),[a,l]=(0,u.useState)(0),[c,d]=(0,u.useState)(0),[h]=$P(),p=h.has("showIncomes");return console.log("showIncomes: "+p),(0,Ov.jsxs)("div",{className:"summaries-container",children:[(0,Ov.jsx)(Sk,{title:"\u05e1\u05d9\u05db\u05d5\u05dd \u05d4\u05d5\u05e6\u05d0\u05d5\u05ea \u05e7\u05d1\u05d5\u05e2\u05d5\u05ea",transactions:t.filter((e=>e.transactionType===Dg.CONSTANT)),onCategoryClick:r,sumCalculation:o}),(0,Ov.jsx)(Sk,{title:"\u05e1\u05d9\u05db\u05d5\u05dd \u05d4\u05d5\u05e6\u05d0\u05d5\u05ea \u05de\u05e9\u05ea\u05e0\u05d5\u05ea",transactions:t.filter((e=>e.transactionType===Dg.CHANGING)),onCategoryClick:r,sumCalculation:l}),p&&(0,Ov.jsxs)(Ov.Fragment,{children:[(0,Ov.jsx)(xk,{sumCalculation:d,year:n,month:i}),c&&s&&a?(0,Ov.jsx)(kk,{sumIncomes:c,sumConstantTransactions:s,sumChangingTransactions:a}):(0,Ov.jsx)(Ov.Fragment,{})]})]})},YP=()=>{const[e,t]=(0,u.useState)([]),[r,n]=(0,u.useState)(),{year:i,month:s}=function(){let{matches:e}=u.useContext(vP),t=e[e.length-1];return t?t.params:{}}(),o=SP(),[a]=$P(),[l,c]=(0,u.useState)(i||""),[d,h]=(0,u.useState)(s||""),p=a.has("showIncomes"),g=(e,t)=>{o(`/transactions/${e}/${t}${p?"?showIncomes":""}`)},f=(0,u.useRef)([]);(0,u.useEffect)((()=>{(async()=>{const e=Nv.getTransactions(),r=await m(e);t(r),f.current=r})()}),[]);const m=async e=>Promise.all(e.map((async e=>({...e,category:e.category||await Tv(e.date,e.vendor,e.amount)||await bv(e.vendor)||"",details:await Mv(e.date,e.vendor,e.amount)||e.details||""})))),v=(0,u.useCallback)((async e=>{const r=await m(e);t([...f.current,...r])}),[]);return(0,Ov.jsxs)("div",{children:[(0,Ov.jsx)(bk,{onLoad:v,year:l,month:d,setYear:e=>{c(e),d&&g(e,d)},setMonth:e=>{h(e),l&&g(l,e)}}),(0,Ov.jsx)(KP,{transactions:e,onCategoryClick:n,year:l,month:d}),e.length>0&&(0,Ov.jsx)(Lv,{transactions:e,filteredCategory:r})]})};function qP(){const{search:e}=bP();return(0,Ov.jsx)(NP,{to:`/transactions${e}`,replace:!0})}const XP=function(){return(0,Ov.jsxs)(BP,{children:[(0,Ov.jsx)(_P,{path:"/",element:(0,Ov.jsx)(qP,{})}),(0,Ov.jsx)(_P,{path:"/transactions",element:(0,Ov.jsx)(YP,{})}),(0,Ov.jsx)(_P,{path:"/transactions/:year/:month",element:(0,Ov.jsx)(YP,{})})]})},JP=e=>{e&&e instanceof Function&&r.e(453).then(r.bind(r,453)).then((t=>{let{getCLS:r,getFID:n,getFCP:i,getLCP:s,getTTFB:o}=t;r(e),n(e),i(e),s(e),o(e)}))};h.createRoot(document.getElementById("root")).render((0,Ov.jsx)(u.StrictMode,{children:(0,Ov.jsx)(WP,{basename:"/track-credit-cards-app",children:(0,Ov.jsx)(XP,{})})})),JP()})();
//# sourceMappingURL=main.ab618417.js.map